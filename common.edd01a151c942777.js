"use strict";(self.webpackChunkKaguraGithubPages=self.webpackChunkKaguraGithubPages||[]).push([[592],{6448:(F,x,e)=>{e.d(x,{h:()=>s});var i=e(9212),t=e(8645),_=e(7328),v=e(1687),n=e(4664),d=e(7398),m=e(3997),u=e(2181),C=e(7081),c=e(9773),l=e(9798),f=e(6593),w=e(6814);const h=["hostingSpan"];let s=(()=>{class r{http;sanitizer;error=new i.vpe;src;fill;stroke;height;width;hostingSpan;contents$;svg$;destroy$=new t.x;src$=new _.t;width$=new _.t;height$=new _.t;constructor(o,a){this.http=o,this.sanitizer=a}ngOnInit(){this.contents$=this.src$.pipe((0,n.w)(o=>this.http.fetchText(o)),(0,d.U)(o=>this.sanitizer.bypassSecurityTrustHtml(o))),this.svg$=this.contents$.pipe((0,n.w)(o=>(0,v.F)(200)),(0,d.U)(o=>this.getUniqueSvgElement()),(0,m.x)(),(0,u.h)(o=>null!==o),(0,C.d)(1)),this.connectAttribute(o=>`${o}`,"width",this.width$),this.connectAttribute(o=>`${o}`,"height",this.height$)}ngOnDestroy(){this.destroy$.next()}connectAttribute(o,a,D){D.pipe((0,n.w)(P=>this.svg$.pipe((0,d.U)(y=>[y,o(P)]))),(0,c.R)(this.destroy$)).subscribe(([P,y])=>{P.setAttribute(a,y)})}getUniqueSvgElement(){const o=this.hostingSpan.nativeElement.getElementsByTagName("svg");return 1!==o.length?null:o[0]}validateSrc(o){if("string"!=typeof o)return!1;const a=o;if(!a.startsWith("/"))throw new Error(`Currently just support hosting inline svg ${a}`);return!0}ngOnChanges(o){if("src"in o){const a=o.src.currentValue;if(!this.validateSrc(a))return;this.src$.next(a)}if("width"in o){const a=o.width.currentValue;if("number"!=typeof a)throw new Error(`Not a number ${a}`);this.width$.next(a)}if("height"in o){const a=o.height.currentValue;if("number"!=typeof a)throw new Error(`Not a number ${a}`);this.height$.next(o.height.currentValue)}}static \u0275fac=function(a){return new(a||r)(i.Y36(l.OE),i.Y36(f.H7))};static \u0275cmp=i.Xpm({type:r,selectors:[["app-inline-svg"]],viewQuery:function(a,D){if(1&a&&i.Gf(h,5),2&a){let P;i.iGM(P=i.CRH())&&(D.hostingSpan=P.first)}},inputs:{src:"src",fill:"fill",stroke:"stroke",height:"height",width:"width"},outputs:{error:"error"},features:[i.TTD],decls:3,vars:7,consts:[[3,"innerHTML"],["hostingSpan",""]],template:function(a,D){1&a&&(i._UZ(0,"span",0,1),i.ALo(2,"async")),2&a&&(i.Udp("fill",D.fill)("stroke",D.stroke),i.Q6J("innerHTML",i.lcZ(2,5,D.contents$),i.oJD))},dependencies:[w.Ov]})}return r})()},1601:(F,x,e)=>{e.d(x,{a:()=>t});var i=e(9212);let t=(()=>{class _{transform(n){if(null===n)return null;const d=Math.floor(Date.now()/1e3),m=Math.floor(d-n.getTime()/1e3);if(m<-10)return null;if(m<60)return"\u305f\u3063\u305f\u4eca";const u=Math.floor(m/60);if(u<60)return`${u} \u5206\u524d`;const C=Math.floor(u/60);if(C<24)return`${C} \u6642\u9593\u524d`;const c=Math.floor(C/24);if(c<30)return`${c} \u65e5\u524d`;const l=Math.floor(c/30);if(l<12)return`${l} \u30f6\u6708\u524d`;const f=Math.floor(c/365);return f<10?`${f} \u5e74\u524d`:"\u304b\u306a\u308a\u6614"}static \u0275fac=function(d){return new(d||_)};static \u0275pipe=i.Yjl({name:"relativeTime",type:_,pure:!1})}return _})()},9240:(F,x,e)=>{e.d(x,{x:()=>l});var i=e(5861),t=e(9212),_=e(7142),n=(e(752),e(553)),d=e(434),m=e(2425),u=e(6814);function C(f,w){if(1&f){const h=t.EpF();t.TgZ(0,"div",2)(1,"button",3),t._uU(2,"\u305d\u306e\u4ed6\u306e\u30ed\u30b0\u30a4\u30f3\u65b9\u6cd5"),t.qZA(),t.TgZ(3,"div",4)(4,"p"),t._uU(5,"\u4ee5\u4e0b\u306e\u30ed\u30b0\u30a4\u30f3\u6a5f\u80fd\u3092\u4f7f\u3046\u969b\u306f\u30d6\u30e9\u30a6\u30b6\u306e\u8a2d\u5b9a\u3067 "),t.TgZ(6,"b"),t._uU(7),t.qZA(),t._uU(8,"\u304b\u3089\u306e\u7b2c\u4e09\u8005\u30af\u30c3\u30ad\u30fc (Third-Party Cookie) \u3092\u53d7\u3051\u5bb9\u308c\u308b\u8a2d\u5b9a\u306b\u3057\u3066\u304f\u3060\u3055\u3044\u3002"),t.qZA(),t.TgZ(9,"p"),t._uU(10,"\u30a2\u30ab\u30a6\u30f3\u30c8\u3092\u4f5c\u3063\u3066\u3044\u306a\u3044\u5834\u5408\u306f\u81ea\u52d5\u7684\u306b\u4f5c\u6210\u3055\u308c\u307e\u3059\u3002\u5fc5\u305a "),t.TgZ(11,"a",5),t._uU(12,"[\u5229\u7528\u898f\u7d04]"),t.qZA(),t._uU(13," \u3092\u78ba\u8a8d\u3057\u3066\u304f\u3060\u3055\u3044\u3002"),t.qZA(),t.TgZ(14,"div")(15,"img",6),t.NdJ("click",function(r){t.CHM(h);const O=t.oxw();return t.KtG(O.onClickGoogleAuth(r))}),t.qZA(),t.TgZ(16,"img",7),t.NdJ("click",function(r){t.CHM(h);const O=t.oxw();return t.KtG(O.onClickTwitterAuth(r))}),t.qZA(),t.TgZ(17,"span",8),t.NdJ("click",function(r){t.CHM(h);const O=t.oxw();return t.KtG(O.onClickGithubAuth(r))}),t._UZ(18,"img",9),t._uU(19,"Sign in with Github"),t.qZA()()()()}if(2&f){const h=t.oxw();t.xp6(7),t.hij("",h.apiHostname," ")}}function c(f,w){if(1&f){const h=t.EpF();t.TgZ(0,"div")(1,"img",10),t.NdJ("click",function(r){t.CHM(h);const O=t.oxw();return t.KtG(O.onClickGoogleAuth(r))}),t.qZA(),t.TgZ(2,"img",11),t.NdJ("click",function(r){t.CHM(h);const O=t.oxw();return t.KtG(O.onClickTwitterAuth(r))}),t.qZA(),t.TgZ(3,"img",12),t.NdJ("click",function(r){t.CHM(h);const O=t.oxw();return t.KtG(O.onClickGithubAuth(r))}),t.qZA()()}}let l=(()=>{class f{auth;toastr;apiHostname=n.NZ.firebaseConfig.authDomain;isTiny=!1;loginSucceeded=new t.vpe;loginFailed=new t.vpe;constructor(h,s){this.auth=h,this.toastr=s}ngOnInit(){(0,n.eM)("OauthFederationsComponent.OnInit()")}doOauth(h){var s=this;return(0,i.Z)(function*(){try{yield s.auth.signInWithPopup(h),s.loginSucceeded.next()}catch(r){s.loginFailed.next(r)}})()}onClickGoogleAuth(h){var s=this;return(0,i.Z)(function*(){h.preventDefault();const r=new _.Z.auth.GoogleAuthProvider;yield s.doOauth(r)})()}onClickTwitterAuth(h){var s=this;return(0,i.Z)(function*(){h.preventDefault();const r=new _.Z.auth.TwitterAuthProvider;yield s.doOauth(r)})()}onClickGithubAuth(h){var s=this;return(0,i.Z)(function*(){h.preventDefault();const r=new _.Z.auth.GithubAuthProvider;yield s.doOauth(r)})()}static \u0275fac=function(s){return new(s||f)(t.Y36(d.zQ),t.Y36(m._W))};static \u0275cmp=t.Xpm({type:f,selectors:[["app-oauth-federations"]],inputs:{isTiny:"isTiny"},outputs:{loginSucceeded:"loginSucceeded",loginFailed:"loginFailed"},decls:2,vars:2,consts:[["class","row m-3",4,"ngIf"],[4,"ngIf"],[1,"row","m-3"],["type","button","data-bs-toggle","collapse","data-bs-target","#appGitfireOauthFederationsList","role","button","aria-label","Toggle other login","aria-expanded","false","aria-controls","appGitfireOauthFederationsList",1,"btn","btn-secondary","collapsed"],["id","appGitfireOauthFederationsList",1,"collapse","m-3"],["tabindex","-1","about","_blank","href","/terms.htm",1,""],["src","assets/google-login.png","alt","Google",1,"m-2","oauth-login-button","oauth-width-login-img",3,"click"],["src","assets/twitter-login.png","alt","Twitter",1,"m-2","oauth-login-button","oauth-width-login-img",3,"click"],[1,"m-2","oauth-login-button","oauth-pseudo-img",3,"click"],["src","assets/github-login.png","alt","Github",1,"m-1","oauth-circle-login-img"],["src","assets/google-login.png",1,"m-1","oauth-tiny-wide-img",3,"click"],["src","assets/twitter-login-small.png",1,"m-1","oauth-tiny-circle-img",3,"click"],["src","assets/github-login.png",1,"m-1","oauth-tiny-circle-img",3,"click"]],template:function(s,r){1&s&&t.YNc(0,C,20,1,"div",0)(1,c,4,0,"div",1),2&s&&(t.Q6J("ngIf",!r.isTiny),t.xp6(1),t.Q6J("ngIf",r.isTiny))},dependencies:[u.O5],styles:[".oauth-login-button[_ngcontent-%COMP%]{cursor:pointer}.oauth-width-login-img[_ngcontent-%COMP%]{width:150px}.oauth-pseudo-img[_ngcontent-%COMP%]{border-style:ridge;border-radius:5px;padding:5px;white-space:nowrap}.oauth-circle-login-img[_ngcontent-%COMP%]{height:20px;width:20px}.oauth-tiny-wide-img[_ngcontent-%COMP%]{height:30px}.oauth-tiny-circle-img[_ngcontent-%COMP%]{width:30px}"]})}return f})()},6450:(F,x,e)=>{e.d(x,{F:()=>y});var i=e(5861),t=e(7142);class _{saveNeverAsk;isConfirmed}var v=function(p){return p[p.Ok=0]="Ok",p[p.No=1]="No",p[p.OkPermanent=2]="OkPermanent",p}(v||{}),n=e(9212),d=e(5739),m=e(1248),u=e(553),C=e(6814),c=e(5187);function l(p,L){1&p&&n._UZ(0,"span",12)}function f(p,L){if(1&p&&(n.ynx(0),n.TgZ(1,"div",10),n._UZ(2,"div",13),n.qZA(),n.BQk()),2&p){const A=n.oxw();n.xp6(2),n.Q6J("innerHTML",A.tosJson.html,n.oJD)}}let w=(()=>{class p extends m.W{confirmed=new n.vpe;inputConfirmForm;tosJson;constructor(){super()}ngOnInit(){(0,u.eM)("TosConfirmComponent.OnInit()"),this.inputConfirmForm=new d.cw({}),this.inputConfirmForm.addControl("neverConfirmTosCheck",new d.NI(!1))}ngAfterViewInit(){(0,u.eM)("TosConfirmComponent.AfterViewInit()")}get neverCheckTosControl(){return this.inputConfirmForm.get("neverConfirmTosCheck")}onClickConfirm(A){if(A.preventDefault(),this.inputConfirmForm.markAllAsTouched(),this.inputConfirmForm.invalid)return;const g=new _,E=this.inputConfirmForm.get("neverConfirmTosCheck");g.saveNeverAsk=E.value,g.isConfirmed=!0,this.confirmed.emit(g)}static \u0275fac=function(g){return new(g||p)};static \u0275cmp=n.Xpm({type:p,selectors:[["gitfire-tos-confirm"]],inputs:{tosJson:"tosJson"},outputs:{confirmed:"confirmed"},features:[n.qOj],decls:19,vars:6,consts:[["loadingTemplate",""],[1,"container"],[4,"ngIf","ngIfElse"],[1,"text-center"],[3,"formGroup"],[1,"m-5","custom-control","custom-checkbox"],["for","appGitfireTosConfirmNeverDismissCheck",1,"visually-hidden"],["id","appGitfireTosConfirmNeverDismissCheck","name","neverConfirmTosCheck","formControlName","neverConfirmTosCheck","type","checkbox",1,"form-check-input"],[1,"text-muted","fw-light"],["routerLink","/terms.htm"],[1,"m-3"],["id","appGitfireTosConfirmButton","data-bs-dismiss","modal",1,"btn","btn-success",3,"disabled","click"],["role","status",1,"spinner-border","text-primary"],[3,"innerHTML"]],template:function(g,E){if(1&g&&(n.YNc(0,l,1,0,"ng-template",null,0,n.W1O),n.TgZ(2,"div",1),n.YNc(3,f,3,1,"ng-container",2),n.TgZ(4,"div",3)(5,"form",4)(6,"div",5)(7,"label",6),n._uU(8,"\u518d\u5ea6\u8868\u793a\u3057\u306a\u3044"),n.qZA(),n._UZ(9,"input",7),n._uU(10,"\u518d\u5ea6\u8868\u793a\u3057\u306a\u3044"),n.qZA(),n.TgZ(11,"div",8),n._uU(12,"\u8a73\u3057\u304f\u306f"),n.TgZ(13,"a",9),n._uU(14,"[\u5229\u7528\u898f\u7d04]"),n.qZA(),n._uU(15,"\u3092\u3054\u78ba\u8a8d\u304f\u3060\u3055\u3044\u3002 "),n.qZA(),n.TgZ(16,"div",10)(17,"button",11),n.NdJ("click",function(Z){return E.onClickConfirm(Z)}),n._uU(18,"\u78ba\u8a8d\u3057\u307e\u3057\u305f"),n.qZA()()()()()),2&g){const M=n.MAs(1);n.xp6(3),n.Q6J("ngIf",E.tosJson)("ngIfElse",M),n.xp6(2),n.Q6J("formGroup",E.inputConfirmForm),n.xp6(1),n.ekj("was-validated",E.neverCheckTosControl.dirty||E.neverCheckTosControl.touched),n.xp6(11),n.Q6J("disabled",!E.inputConfirmForm.valid)}},dependencies:[C.O5,d._Y,d.Wl,d.JJ,d.JL,d.sg,d.u,c.rH]})}return p})();var h=e(7319),s=e(8645),r=e(8180),O=e(4664),o=e(7398),a=e(9798),D=e(103),P=e(5579);let y=(()=>{class p{http;dialog;store;privUser;constructor(A,g,E){this.http=A,this.dialog=g,this.store=E,this.privUser=this.store.collection("/users/v1/protected")}constructSetupTosConfirm(A,g){return E=>{E.tosJson=g.json,E.confirmed.subscribe(M=>{if(!M.isConfirmed)throw new Error("assert");g.answer=M.saveNeverAsk?v.OkPermanent:v.Ok,A.next(g)})}}confirmTos$(A,g){var E=this;if(A.match(/\/$/))throw new Error(`Assertion. Not a supported ${A}`);const M=new s.x,I=(new s.x,new s.x),$=new s.x,k=this.http.fetchGhJson(g).pipe((0,r.q)(1),(0,O.w)(T=>{const U=this.privUser.doc(`${A}/${T.version}`),B={json:T,cached:!1,cacheRef:U};return U.get().pipe((0,o.U)((b,W)=>(b.exists&&b.data().alwaysConfirmed&&((0,u.eM)("TOS has already been confirmed."),B.cached=!0),B)))}));return $.pipe().subscribe({next:T=>{this.dialog.createDefaultBuilder().prepareBody(w).setupChild(this.constructSetupTosConfirm(I,T)).setType(h.iR.Warn).setSize(h.PW.Default).setTitle("\u5229\u7528\u898f\u7d04\u306e\u78ba\u8a8d").closeButton(()=>{T.answer=v.No,I.next(T)}).setFinalize(()=>{T.answer=v.No,I.next(T)}).open()},complete:()=>{(0,u.eM)("completeed dialog$")},error:T=>{(0,u.wb)("error dialog$",T)}}),k.pipe((0,r.q)(1)).subscribe({next:T=>{T.cached?M.next(!0):$.next(T)},complete:()=>{(0,u.eM)("Completed TOS reading")},error:T=>{(0,u.wb)("Failed reading TOS cache")}}),I.pipe((0,r.q)(1)).subscribe({next:(T=(0,i.Z)(function*(U){switch(U.answer){case v.Ok:M.next(!0);break;case v.No:M.next(!1);break;case v.OkPermanent:const B={_docClass:"User:UserAgreementStore",alwaysConfirmed:!0,createdAt:E.fieldTimestamp()};M.next(!0),yield U.cacheRef.set(B);break;default:throw new Error(`Not a valid answer ${U.answer}`)}}),function(B){return T.apply(this,arguments)}),complete:()=>{(0,u.eM)("Completed dialog result."),M.complete()},error:T=>{(0,u.wb)("Failed receive dialog result"),M.complete()}}),M;var T}fieldTimestamp(){return t.Z.firestore.FieldValue.serverTimestamp()}static \u0275fac=function(g){return new(g||p)(n.LFG(a.OE),n.LFG(D.xA),n.LFG(P.ST))};static \u0275prov=n.Yz7({token:p,factory:p.\u0275fac,providedIn:"root"})}return p})()},7910:(F,x,e)=>{e.d(x,{K:()=>m});var i=e(2096),t=e(7081),_=e(7398),v=e(9212),n=e(5579),d=e(9782);let m=(()=>{class u{store;auth;pubUser;nicknameCache={};userCache={};constructor(c,l){this.store=c,this.auth=l,this.pubUser=this.store.collection("/users/v1/public")}myNickname$(){return this.auth.myUid?this.nickname$(this.auth.myUid):(0,i.of)("")}user$(c){let l=this.userCache[c];return l||(l=this.pubUser.doc(c).valueChanges().pipe((0,t.d)(1)),this.userCache[c]=l,l)}nickname$(c){let l=this.nicknameCache[c];return l||(l=this.user$(c).pipe((0,_.U)(f=>f?f.nickname:null)),this.nicknameCache[c]=l,l)}static \u0275fac=function(l){return new(l||u)(v.LFG(n.ST),v.LFG(d.e))};static \u0275prov=v.Yz7({token:u,factory:u.\u0275fac,providedIn:"root"})}return u})()},3429:(F,x,e)=>{e.d(x,{a:()=>d});var i=e(9212),t=e(6814);function _(m,u){1&m&&(i.TgZ(0,"span",2),i._uU(1,"[\u524a\u9664]"),i.qZA())}function v(m,u){1&m&&i._UZ(0,"img",5),2&m&&i.s9C("src",u.$implicit,i.LSH)}function n(m,u){if(1&m&&(i.TgZ(0,"span",3),i.YNc(1,v,1,1,"img",4),i._uU(2),i.qZA()),2&m){const C=u.$implicit;i.s9C("title",C.about),i.xp6(1),i.Q6J("ngIf",C.photoURL),i.xp6(1),i.Oqu(C.nickname)}}let d=(()=>{class m{userPublic;constructor(){}static \u0275fac=function(c){return new(c||m)};static \u0275cmp=i.Xpm({type:m,selectors:[["gitfire-user-box"]],inputs:{userPublic:"userPublic"},decls:3,vars:2,consts:[["voidUser",""],["class","p-1",3,"title",4,"ngIf","ngIfElse"],["title","\u524a\u9664\u3055\u308c\u305f\u30e6\u30fc\u30b6\u3067\u3059",1,"text-warning"],[1,"p-1",3,"title"],["class","p-1","style","height: 100%; width: 2rem;",3,"src",4,"ngIf"],[1,"p-1",2,"height","100%","width","2rem",3,"src"]],template:function(c,l){if(1&c&&i.YNc(0,_,2,0,"ng-template",null,0,i.W1O)(2,n,3,3,"span",1),2&c){const f=i.MAs(1);i.xp6(2),i.Q6J("ngIf",l.userPublic)("ngIfElse",f)}},dependencies:[t.O5]})}return m})()},752:(F,x,e)=>{e(4562),e(9058),e(6122),e(7879),e(4537)}}]);