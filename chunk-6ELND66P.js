import{H as p,L as x,Oc as u,Z as h,aa as C,ba as d,c as b,ja as S,la as I,m as k,o as v,r as E,va as P,wc as w,z as m}from"./chunk-WAQAKQHN.js";var y=(()=>{class i{constructor(){this.document=d(S),this.platformId=d(P),this.documentIsAccessible=w(this.platformId)}static getCookieRegExp(e){let t=e.replace(/([[\]{}()|=;+?,.*^$\\])/gi,"\\$1");return new RegExp("(?:^"+t+"|;\\s*"+t+")=(.*?)(?:;|$)","g")}static safeDecodeURIComponent(e){try{return decodeURIComponent(e)}catch{return e}}check(e){return this.documentIsAccessible?(e=encodeURIComponent(e),i.getCookieRegExp(e).test(this.document.cookie)):!1}get(e){if(this.check(e)){e=encodeURIComponent(e);let n=i.getCookieRegExp(e).exec(this.document.cookie);return n?.[1]?i.safeDecodeURIComponent(n[1]):""}else return""}getAll(){if(!this.documentIsAccessible)return{};let e={},t=this.document;return t.cookie&&t.cookie!==""&&t.cookie.split(";").forEach(n=>{let[a,r]=n.split("=");e[i.safeDecodeURIComponent(a.replace(/^ /,""))]=i.safeDecodeURIComponent(r)}),e}set(e,t,n,a,r,l,f,D){if(!this.documentIsAccessible)return;if(typeof n=="number"||n instanceof Date||a||r||l||f){let g={expires:n,path:a,domain:r,secure:l,sameSite:f||"Lax",partitioned:D};this.set(e,t,g);return}let c=encodeURIComponent(e)+"="+encodeURIComponent(t)+";",o=n||{};if(o.expires)if(typeof o.expires=="number"){let g=new Date(new Date().getTime()+o.expires*1e3*60*60*24);c+="expires="+g.toUTCString()+";"}else c+="expires="+o.expires.toUTCString()+";";o.path&&(c+="path="+o.path+";"),o.domain&&(c+="domain="+o.domain+";"),o.secure===!1&&o.sameSite==="None"&&(o.secure=!0,console.warn(`[ngx-cookie-service] Cookie ${e} was forced with secure flag because sameSite=None.More details : https://github.com/stevermeister/ngx-cookie-service/issues/86#issuecomment-597720130`)),o.secure&&(c+="secure;"),o.sameSite||(o.sameSite="Lax"),c+="sameSite="+o.sameSite+";",o.partitioned&&(c+="Partitioned;"),this.document.cookie=c}delete(e,t,n,a,r="Lax"){if(!this.documentIsAccessible)return;let l=new Date("Thu, 01 Jan 1970 00:00:01 GMT");this.set(e,"",{expires:l,path:t,domain:n,secure:a,sameSite:r})}deleteAll(e,t,n,a="Lax"){if(!this.documentIsAccessible)return;let r=this.getAll();for(let l in r)r.hasOwnProperty(l)&&this.delete(l,e,t,n,a)}static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275prov=h({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();var $=class i{constructor(s){this.cookie=s;this.cookie.check("grant")&&(this.permission="allow"),this.loginStateEmitter=new b(this.cookie.check("login")),this._loginPhotoChangedSource$=this.loginPhotoEmitter.pipe(p()),this._loginPhotoChanged$=this._loginPhotoChangedSource$.pipe(m(e=>!!e)),this._loginStateChanged$=this.loginStateEmitter.pipe(p()),this._logoutEmitter=this.loginStateEmitter.pipe(x((e,t)=>[t,e[0]],[!1]),m(([e,t])=>t===!0&&e===!1),v(e=>{}))}permission="not-yet";_seemsLogin=!1;loginPhotoEmitter=new I;loginStateEmitter;_loginPhotoChangedSource$;_loginPhotoChanged$;_loginStateChanged$;_loginPhotoUrl=null;_logoutEmitter;get markedLogout$(){return this._logoutEmitter}loginPhoto$(){return E(k(this._loginPhotoUrl),this.loginPhotoChanged$)}get loginPhotoChanged$(){return this._loginPhotoChanged$}get loginStateChanged$(){return this._loginStateChanged$}get isSeemsLogin(){return this._seemsLogin}grantAccess(){this.permission="allow";let s=new Date;s.setMinutes(s.getMinutes()+u.grantSessionExpires),this.cookie.set("grant","1",s,"/Gitfire")}declineAccess(){this.permission="inhibit",this.cookie.deleteAll()}shouldConfirm(){return this.permission==="not-yet"&&!this.isCookieGranted()}isCookieGranted(){return this.cookie.check("grant")}isMarkedAsLogin(){return this.cookie.check("login")}updateLoginPhoto(s){this._loginPhotoUrl=s,this.loginPhotoEmitter.emit(s)}markLogin(){if(this._seemsLogin=!0,this.permission==="allow")return;let s=new Date;s.setMinutes(s.getMinutes()+u.localSessionExpires),this.cookie.set("login","1",s,"/"),this.loginStateEmitter.next(!0)}unmarkLogin(){this._seemsLogin=!1,this.cookie.delete("login"),this.loginStateEmitter.next(!1),this.loginPhotoEmitter.emit(null)}static \u0275fac=function(e){return new(e||i)(C(y))};static \u0275prov=h({token:i,factory:i.\u0275fac,providedIn:"root"})};export{$ as a};
