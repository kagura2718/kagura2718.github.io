"use strict";(self.webpackChunkKaguraGithubPages=self.webpackChunkKaguraGithubPages||[]).push([[483],{3483:(K,P,s)=>{s.r(P),s.d(P,{EvolutionRadarModule:()=>Q});var a=s(1180),Z=s(6814),T=s(1858),M=s(5187),f=s(3185),V=s(9935),R=s(553),p=s(8645),F=s(5619),g=s(2572),$=s(9773),c=s(7398),x=s(3019),y=s(1687),S=s(2096),L=s(6232),b=s(2459),E=s(9026),B=s(1479),O=s(3620),k=s(4664),U=s(9336),A=s(9769),I=s(9071),i=s(5879),H=s(4154),N=s(271),z=s(2933),w=s(6457),D=s(8822);const J=["statusChart"],G=[{path:"",redirectTo:"index.htm"},{path:"index.htm",component:(()=>{var u;class l{constructor(o,n){(0,a.Z)(this,"master",void 0),(0,a.Z)(this,"dom",void 0),(0,a.Z)(this,"HUE_COLORS",["#FF0000AA","#FFFF00AA","#00FF00AA","#00FFFFAA","#0000FFAA","#FF00FFAA","#FF4000AA","#BFFF00AA","#00FF40AA","#00BFFFAA","#4000FFAA","#FF00BFAA","#FF8000AA","#80FF00AA","#00FF80AA","#0080FFAA","#8000FFAA","#FF0080AA","#FFBF00AA","#40FF00AA","#00FFBFAA","#0040FFAA","#BF00FFAA","#FF0040AA"]),(0,a.Z)(this,"basicPokemonId$",new p.x),(0,a.Z)(this,"isValidPokemonTree$",void 0),(0,a.Z)(this,"inputHasError",void 0),(0,a.Z)(this,"inputPL",20),(0,a.Z)(this,"inputIV",{AP:15,DP:15,HP:15}),(0,a.Z)(this,"evolutionNodeSelected$",new p.x),(0,a.Z)(this,"evolutionRootCleared$",new F.X(void 0)),(0,a.Z)(this,"currentStatus$",new F.X(null)),(0,a.Z)(this,"computePLValidator$",new p.x),(0,a.Z)(this,"initializeVisibleStatus$",new p.x),(0,a.Z)(this,"inputPL$",new F.X(this.inputPL)),(0,a.Z)(this,"inputStatus$",new p.x),(0,a.Z)(this,"inputFormChanged$",new F.X(void 0)),(0,a.Z)(this,"pokemonForm$",new p.x),(0,a.Z)(this,"pokemonIV$",new F.X(this.inputIV)),(0,a.Z)(this,"destroy$",new p.x),(0,a.Z)(this,"evolutionRoot$",void 0),(0,a.Z)(this,"evolutionRootTree$",void 0),(0,a.Z)(this,"statusChart",void 0),(0,a.Z)(this,"chartMap",{}),(0,a.Z)(this,"statusChartDataset",[]),(0,a.Z)(this,"chartUpdated$",new p.x),(0,a.Z)(this,"statusChartOptions",{responsive:!0,scales:{r:{min:0,ticks:{stepSize:50}}},plugins:{legend:{position:"top"}},elements:{point:{radius:5,hoverRadius:10}}}),(0,a.Z)(this,"statusChartLabels",["Attack","Defence","Stamina"]),(0,a.Z)(this,"statusChartLegend",!0),(0,a.Z)(this,"evolveForms$",void 0),this.master=o,this.dom=n}ngAfterViewInit(){}ngOnInit(){this.dom.setTitle("Evoution status radar (Junk)"),(0,g.a)([this.master.level$,this.pokemonForm$,this.pokemonIV$,this.inputStatus$]).pipe((0,$.R)(this.destroy$)).subscribe(([t,e,r,m])=>{this.maybeComputePL(t,e,r,m)});const o=new V.i(this.master);this.evolutionRoot$=this.pokemonForm$.pipe((0,O.b)(500),(0,k.w)(t=>o.fetchEvolutionRoot$(t))),this.evolutionRootTree$=this.evolutionRoot$.pipe((0,c.U)(t=>o.buildEvolutionTree(t))),(0,g.a)([this.pokemonIV$,this.inputPL$]).pipe((0,c.U)(()=>{})),this.prepareChartStream(),this.isValidPokemonTree$=(0,x.T)(this.basicPokemonId$.pipe((0,c.U)(()=>!0)),this.evolutionRootCleared$.pipe((0,c.U)(()=>!1))).pipe()}prepareChartStream(){(0,y.F)(500).pipe((0,$.R)(this.destroy$)).subscribe(t=>{});const o=(0,g.a)([(0,S.of)(0),this.evolutionRootTree$]).pipe((0,k.w)(t=>(0,S.of)(t)),(0,U.j)(([t,e])=>e.children$?e.children$.pipe((0,A.z)(r=>(0,b.D)(r)),(0,c.U)(r=>[t+1,r])):L.E),(0,A.z)(([t,e])=>this.master.level$.pipe((0,c.U)(r=>{const m=new I.PokemonForm(r,e.formJson),h={};e.form.megaBranch&&(h.megaBranch=e.form.megaBranch);const d=m.getPokemonId(h),C={depth:t,settings:m,nodeId:d,label:d};return e.form.megaBranch&&(C.megaBranch=e.form.megaBranch),C}))),(0,A.z)(t=>this.master.readPokemonName(t.label).pipe((0,c.U)(e=>(t.label=e,t))))),n=(0,E.$)([o,(0,B.w)(1,999999)]).pipe((0,c.U)(([t,e])=>{const r=t;return r.pseudoId=e,r.colorHex=this.HUE_COLORS[e%this.HUE_COLORS.length],r}));this.inputFormChanged$.pipe((0,$.R)(this.destroy$)).subscribe(t=>{this.initializeVisibleStatus$.next(),this.currentStatus$.next(null),this.statusChartDataset=[],this.chartMap={},this.chartUpdated$.next()}),n.pipe((0,$.R)(this.destroy$)).subscribe(t=>{let e=this.chartMap[t.nodeId];if(!e){const r={backgroundColor:t.colorHex,fill:!0,data:[],label:t.label};this.statusChartDataset.push(r),e={model:t,statusView:r},this.chartMap[t.nodeId]=e}this.chartUpdated$.next()}),(0,g.a)([this.pokemonIV$,this.inputPL$,this.chartUpdated$]).pipe((0,$.R)(this.destroy$)).subscribe(([t,e,r])=>{for(const m in this.chartMap){const h=this.chartMap[m],C=h.model.settings.computeStatus(t,e,{megaBranch:h.model.megaBranch});h.statusView.data=[C.AP,C.DP,C.HP]}this.statusChart.update()})}tooltipEvolutionItem(o){let n="";for(const t of o)n+=`Name: ${t.dataset.label}\n`,n+=`CP: ${t.parsed.y}\n`;return n}statusChartClick({event:o,active:n}){(0,R.eM)("MainComponent.statusChartClick()",o,n),this.clickChartItem(o,n)}clickChartItem(o,n){if(!n||0===n.length||!o)return;const m=o.chart.data.datasets[n[0].datasetIndex];for(const h in this.chartMap){const d=this.chartMap[h];if(d.statusView===m)return void this.evolutionNodeSelected$.next(d.model)}}statusChartHover(o){}onChangePL(o){this.inputPL$.next(o)}onChangeIV(o){this.inputIV=o,this.pokemonIV$.next(this.inputIV)}ngOnDestroy(){this.destroy$.next()}maybeComputePL(o,n,t,e){if(!e.CP)return;const r=e.HP,m=e.CP;try{const d=new I.PokemonForm(o,n).computeMatchingLevel(m,r,t);this.currentStatus$.next(d),this.computePLValidator$.next(!0)}catch(h){(0,R.wb)("Seems compution failed. This message should be hidden.",h),this.computePLValidator$.next(!1)}}onValidatedPokemonName(o){this.basicPokemonId$.next(o)}onSelectedPokemonForm(o){this.evolutionNodeSelected$.next({settings:o})}onFormValueChanged(){this.inputFormChanged$.next()}onSelectedRawForm(o){this.pokemonForm$.next(o)}onClearedPokemonId(){this.evolutionRootCleared$.next()}onClickShowGrowUpStatus(){}onChangeVisibleStatus(o){this.inputStatus$.next(o)}}return u=l,(0,a.Z)(l,"\u0275fac",function(o){return new(o||u)(i.Y36(H.m),i.Y36(N.v))}),(0,a.Z)(l,"\u0275cmp",i.Xpm({type:u,selectors:[["app-evolution-radar"]],viewQuery:function(o,n){if(1&o&&i.Gf(J,5,f.jh),2&o){let t;i.iGM(t=i.CRH())&&(n.statusChart=t.first)}},decls:8,vars:9,consts:[[1,"toolInputGroup"],[3,"validatedName","selectedForm","selectedRawForm","valueChanged","valueCleared"],[1,"m-2","toolInputGroup",3,"valueChanged"],[1,"toolInputGroup","m-2",2,"display","block",3,"validatorResult","initialize","disabled","currentStatus$","valueChanged"],[2,"display","block"],["baseChart","","type","radar",3,"datasets","labels","options","chartHover","chartClick"],["statusChart",""]],template:function(o,n){1&o&&(i.TgZ(0,"div",0)(1,"app-pokemon-form",1),i.NdJ("validatedName",function(e){return n.onValidatedPokemonName(e)})("selectedForm",function(e){return n.onSelectedPokemonForm(e)})("selectedRawForm",function(e){return n.onSelectedRawForm(e)})("valueChanged",function(){return n.onFormValueChanged()})("valueCleared",function(){return n.onClearedPokemonId()}),i.qZA(),i.TgZ(2,"app-pokemon-iv",2),i.NdJ("valueChanged",function(e){return n.onChangeIV(e)}),i.qZA(),i.TgZ(3,"app-pokemon-visible-status",3),i.NdJ("valueChanged",function(e){return n.onChangeVisibleStatus(e)}),i.ALo(4,"async"),i.qZA()(),i.TgZ(5,"div",4)(6,"canvas",5,6),i.NdJ("chartHover",function(e){return n.statusChartHover(e)})("chartClick",function(e){return n.statusChartClick(e)}),i.qZA()()),2&o&&(i.xp6(3),i.Q6J("validatorResult",n.computePLValidator$)("initialize",n.initializeVisibleStatus$)("disabled",!i.lcZ(4,7,n.isValidPokemonTree$))("currentStatus$",n.currentStatus$),i.xp6(3),i.Q6J("datasets",n.statusChartDataset)("labels",n.statusChartLabels)("options",n.statusChartOptions))},dependencies:[f.jh,z.l,w.J,D.k,Z.Ov],styles:[".toolInputGroup[_ngcontent-%COMP%]{border:solid #eeeeee;border-radius:5px}.toolSmallText[_ngcontent-%COMP%]{font-size:.8em}.toolExtraSmallText[_ngcontent-%COMP%]{font-size:.5em}.appPokemonThumb[_ngcontent-%COMP%]{max-width:40px;max-height:40px}"]})),l})(),data:{gitweeTitle:"TITLE_POKEMON_RADAR_CHART"}}];let j=(()=>{var u;class l{}return u=l,(0,a.Z)(l,"\u0275fac",function(o){return new(o||u)}),(0,a.Z)(l,"\u0275mod",i.oAB({type:u})),(0,a.Z)(l,"\u0275inj",i.cJS({imports:[M.Bz.forChild(G),M.Bz]})),l})();var X=s(3766);let Q=(()=>{var u;class l{}return u=l,(0,a.Z)(l,"\u0275fac",function(o){return new(o||u)}),(0,a.Z)(l,"\u0275mod",i.oAB({type:u})),(0,a.Z)(l,"\u0275inj",i.cJS({providers:[{provide:X.uY,useValue:"app/tools/pokemongo/evolution-radar/evolution-radar/"}],imports:[Z.ez,f.vQ,T.p,j]})),l})()}}]);