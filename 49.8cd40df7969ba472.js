"use strict";(self.webpackChunkKaguraGithubPages=self.webpackChunkKaguraGithubPages||[]).push([[49],{9049:(St,Ue,g)=>{g.r(Ue),g.d(Ue,{GitfireModule:()=>ee});var S=g(6814),r=g(5739),Q=g(7217),ue=g(5070),te=g(6622),pe=g(434),ce=g(8024),N=g(5861),e=g(9212),He=g(8326),Ae=g(3338),be=g(2096),he=g(6232),Pe=g(5592),Le=g(5211),V=g(5137),ie=g(3093),ae=g(4664),we=g(7398),W=g(304),H=g(4867),Oe=g(6306),Ie=g(9769),$e=g(3572),le=g(7142);const ne=new e.OlP("angularfire2.messaging.vapid-key"),Be=new e.OlP("angularfire2.messaging.service-worker-registeration");let y=(()=>{class l{requestPermission;getToken;tokenChanges;messages;requestToken;deleteToken;constructor(i,s,d,C,E,de,We){const je=We,Qe=(0,be.of)(void 0).pipe((0,V.R)(E.outsideAngular),(0,ie.Q)(E.insideAngular),(0,ae.w)(Ae.Gb),(0,ae.w)(Re=>Re?g.e(490).then(g.bind(g,2490)):he.E),(0,we.U)(()=>(0,Q.on)(i,C,s)),(0,ae.w)(Re=>(0,Q.cc)(`${Re.name}.messaging`,"AngularFireMessaging",Re.name,()=>(0,be.of)(Re.messaging()),[])),(0,W.d)({bufferSize:1,refCount:!1}));this.requestPermission=Qe.pipe((0,V.R)(E.outsideAngular),(0,ie.Q)(E.insideAngular),(0,ae.w)(()=>Notification.requestPermission())),this.getToken=Qe.pipe((0,V.R)(E.outsideAngular),(0,ie.Q)(E.insideAngular),(0,ae.w)(function(){var Re=(0,N.Z)(function*(Rt){if("granted"===Notification.permission){const Ft=je?yield je:null;return yield Rt.getToken({vapidKey:de,serviceWorkerRegistration:Ft})}return null});return function(Rt){return Re.apply(this,arguments)}}()));const Lt=new Pe.y(Re=>{navigator.permissions.query({name:"notifications"}).then(Rt=>{Rt.onchange=()=>Re.next()})}),Ee=Qe.pipe((0,V.R)(E.outsideAngular),(0,ie.Q)(E.insideAngular),(0,H.c)(Lt),(0,H.c)(this.getToken));return this.tokenChanges=Qe.pipe((0,V.R)(E.outsideAngular),(0,ie.Q)(E.insideAngular),(0,ae.w)(()=>(0,Le.z)(this.getToken,Ee))),this.messages=Qe.pipe((0,V.R)(E.outsideAngular),(0,ie.Q)(E.insideAngular),(0,ae.w)(Re=>new Pe.y(Rt=>Re.onMessage(Rt)))),this.requestToken=Qe.pipe((0,V.R)(E.outsideAngular),(0,ie.Q)(E.insideAngular),(0,ae.w)(()=>this.requestPermission),(0,Oe.K)(()=>(0,be.of)(null)),(0,Ie.z)(()=>this.tokenChanges)),this.deleteToken=()=>Qe.pipe((0,V.R)(E.outsideAngular),(0,ie.Q)(E.insideAngular),(0,ae.w)(Re=>Re.deleteToken()),(0,$e.d)(!1)),(0,Q.pX)(this,Qe,C)}static \u0275fac=function(s){return new(s||l)(e.LFG(Q.Dh),e.LFG(Q.xv,8),e.LFG(e.Lbi),e.LFG(e.R0b),e.LFG(He.HU),e.LFG(ne,8),e.LFG(Be,8))};static \u0275prov=e.Yz7({token:l,factory:l.\u0275fac,providedIn:"any"})}return l})(),T=(()=>{class l{constructor(){le.Z.registerVersion("angularfire",He.q4.full,"fcm-compat")}static \u0275fac=function(s){return new(s||l)};static \u0275mod=e.oAB({type:l});static \u0275inj=e.cJS({providers:[y]})}return l})();var b=g(2425),I=g(2589),U=g(5187),_=g(8645),P=g(9773),k=g(8180),O=g(2181),m=g(553),q=g(103),se=g(1248);let oe=(()=>{class l extends se.W{constructor(){super()}ngOnInit(){(0,m.eM)("DeleteConfirmComponent.OnInit()")}static \u0275fac=function(s){return new(s||l)};static \u0275cmp=e.Xpm({type:l,selectors:[["gitfire-delete-confirm"]],features:[e.qOj],decls:10,vars:0,consts:[[1,"m-3"]],template:function(s,d){1&s&&(e.TgZ(0,"div",0)(1,"div"),e._uU(2,"\u672c\u5f53\u306b\u524a\u9664\u3057\u307e\u3059\u304b\uff1f"),e.qZA(),e.TgZ(3,"ul")(4,"li"),e._uU(5,"Google / Twitter \u306a\u3069\u306e\u30a2\u30ab\u30a6\u30f3\u30c8\u60c5\u5831\u306f\u524a\u9664\u3055\u308c\u307e\u305b\u3093\u3002"),e.qZA(),e.TgZ(6,"li"),e._uU(7,"\u516c\u958b\u3055\u308c\u305f\u6295\u7a3f\u306f\u524a\u9664\u3055\u308c\u307e\u305b\u3093\u3002"),e.qZA(),e.TgZ(8,"li"),e._uU(9,"\u53d6\u308a\u6d88\u3057\u306f\u3067\u304d\u307e\u305b\u3093\u3002"),e.qZA()()())}})}return l})();g(4015);var Y=g(353);const Ge=["specialAuthContainer"];function B(l,R){if(1&l){const i=e.EpF();e.TgZ(0,"a",7),e.NdJ("click",function(d){const E=e.CHM(i).$implicit,de=e.oxw();return e.KtG(de.onClickReauthProvider(d,E))}),e._uU(1),e.qZA()}if(2&l){const i=R.$implicit;e.xp6(),e.Oqu(i.providerId)}}class K extends se.W{loader;toastr;static SUPPORTED_PROVIDERS={};static SupportedOauthProviderIds=[];destroy$=new _.x;get providers(){return this.currentUser.providerData}currentUser;reauthed=new e.vpe;specialAuthContainer;static#e=(()=>{const R=K.SUPPORTED_PROVIDERS,i=le.Z.auth;R[i.EmailAuthProvider.PROVIDER_ID]=i.EmailAuthProvider,R[i.TwitterAuthProvider.PROVIDER_ID]=i.TwitterAuthProvider,R[i.GoogleAuthProvider.PROVIDER_ID]=i.GoogleAuthProvider,R[i.GithubAuthProvider.PROVIDER_ID]=i.GithubAuthProvider;const s=K.SupportedOauthProviderIds;s.push(i.TwitterAuthProvider.PROVIDER_ID),s.push(i.GoogleAuthProvider.PROVIDER_ID),s.push(i.GithubAuthProvider.PROVIDER_ID)})();constructor(R,i){super(),this.loader=R,this.toastr=i}ngOnDestroy(){this.destroy$.next()}isOAuthProvider(R){return!!K.SupportedOauthProviderIds.includes(R)}onClickReauthProvider(R,i){var s=()=>super.close,d=this;return(0,N.Z)(function*(){(0,m.eM)("onClickReauthProvider()",R,i),R.preventDefault();const E=new(0,K.SUPPORTED_PROVIDERS[i.providerId]);if(d.specialAuthContainer.clear(),d.isOAuthProvider(i.providerId)){try{yield d.currentUser.reauthenticateWithPopup(E)}catch(de){(0,m.wb)("Error while reauth",de);const We=de instanceof Error?de.message:"Unknown error";return void d.toastr.error(`\u518d\u8a8d\u8a3c\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002 ( ${We} )`)}(0,m.eM)("Reanthenticated via OAuth provider")}else{const{GitfireLoginModule:de}=yield Promise.resolve().then(g.bind(g,3128)),{InputAuthComponent:We}=yield Promise.resolve().then(g.bind(g,8337)),je=d.loader.appendComponent(d.specialAuthContainer,de,We);je.isReauth=!0,je.reauthUser=d.currentUser,je.showFederations=!1;const Qe=je.reauthed.pipe((0,k.q)(1));try{yield Qe.toPromise()}catch(Lt){(0,m.wb)("Error while reauth done",Lt);const Ee=Lt instanceof Error?Lt.message:"Unknown error";return void d.toastr.error(`\u518d\u8a8d\u8a3c\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002 ( ${Ee} )`)}(0,m.eM)("Reanthenticated via password")}d.reauthed.next(),s().call(d)})()}static \u0275fac=function(i){return new(i||K)(e.Y36(Y.j),e.Y36(b._W))};static \u0275cmp=e.Xpm({type:K,selectors:[["gitfire-reauth-box"]],viewQuery:function(i,s){if(1&i&&e.Gf(Ge,5,e.s_b),2&i){let d;e.iGM(d=e.CRH())&&(s.specialAuthContainer=d.first)}},inputs:{currentUser:"currentUser"},outputs:{reauthed:"reauthed"},features:[e.qOj],decls:10,vars:1,consts:[[1,"m-3"],[1,"btn-group"],["type","button","data-bs-toggle","dropdown","aria-haspopup","true","aria-expanded","false",1,"btn","btn-primary","dropdown-toggle"],[1,"visually-hidden"],[1,"dropdown-menu"],["class","dropdown-item","href","#",3,"click",4,"ngFor","ngForOf"],["specialAuthContainer",""],["href","#",1,"dropdown-item",3,"click"]],template:function(i,s){1&i&&(e.TgZ(0,"div",0)(1,"div",1)(2,"button",2)(3,"span",3),e._uU(4,"Toggle Dropdown"),e.qZA(),e._uU(5,"\u8a8d\u8a3c\u65b9\u6cd5"),e.qZA(),e.TgZ(6,"div",4),e.YNc(7,B,2,1,"a",5),e.qZA()(),e._UZ(8,"div",null,6),e.qZA()),2&i&&(e.xp6(7),e.Q6J("ngForOf",s.providers))},dependencies:[S.sg]})}var x=g(1748);function L(l,R){if(l.value!==R){if(l.dirty)return void(0,m.wb)(`Upstream value has been changed to ${l.value} -> ${R} but sillengly ignore the value.`);l.setErrors(null),l.setValue(R)}}function D(l){l.markAsPristine(),l.markAsUntouched()}var X=g(9782),Ze=g(2413),Ve=g(9339),Me=g(3867),ke=g(2572),qe=g(3997),Ne=g(9397),Ye=g(7319);let lt=(()=>{class l{controlLabel;formName;tooltipText;parentForm;checkChanged=new e.vpe;autoGeneratedId;constructor(){const i=Math.random().toString(36).substring(2);this.autoGeneratedId=`appViewInput-${i}`}ngOnInit(){(0,m.eM)("SwitchComponent.OnInit()")}onChangeBox(i){(0,m.eM)("SwitchComponent.onChangeBox()",this.parentForm),this.checkChanged.emit(i)}static \u0275fac=function(s){return new(s||l)};static \u0275cmp=e.Xpm({type:l,selectors:[["app-switch"]],inputs:{controlLabel:"controlLabel",formName:"formName",tooltipText:"tooltipText",parentForm:"parentForm"},outputs:{checkChanged:"checkChanged"},decls:4,vars:7,consts:[[1,"custom-control","custom-switch",3,"formGroup","title"],["type","checkbox",1,"custom-control-input",3,"id","name","formControlName","change"],[1,"custom-control-label",3,"for"]],template:function(s,d){1&s&&(e.TgZ(0,"span",0)(1,"input",1),e.NdJ("change",function(E){return d.onChangeBox(E)}),e.qZA(),e.TgZ(2,"label",2),e._uU(3),e.qZA()()),2&s&&(e.s9C("title",d.tooltipText),e.Q6J("formGroup",d.parentForm),e.xp6(),e.s9C("id",d.autoGeneratedId),e.s9C("name",d.formName),e.s9C("formControlName",d.formName),e.xp6(),e.s9C("for",d.autoGeneratedId),e.xp6(),e.Oqu(d.controlLabel))},dependencies:[r.Wl,r.JJ,r.JL,r.sg,r.u]})}return l})();function ze(l,R){if(1&l){const i=e.EpF();e.TgZ(0,"button",22),e.NdJ("click",function(d){e.CHM(i);const C=e.oxw().$implicit,E=e.oxw();return e.KtG(E.onClickDeleteDevice(d,C))}),e._uU(1,"\u524a\u9664"),e.qZA()}}function Pt(l,R){if(1&l){const i=e.EpF();e.TgZ(0,"div",19)(1,"app-switch",20),e.NdJ("checkChanged",function(d){const E=e.CHM(i).$implicit,de=e.oxw();return e.KtG(de.onToggleDevice(d,E))}),e.ALo(2,"date"),e.qZA(),e.YNc(3,ze,2,0,"button",21),e.qZA()}if(2&l){const i=R.$implicit,s=e.oxw();e.xp6(),e.cQ8("controlLabel","",i.name||"No Name"," ",i.id===s.registeredDeviceId?"[\u3053\u306e\u7aef\u672b]":null," (\u767b\u9332\u65e5: ",e.xi3(2,6,i.createdAt.toDate(),"yyyy-MM-dd"),")"),e.MGl("formName","device-",i.id,""),e.Q6J("parentForm",s.deviceForm),e.xp6(2),e.Q6J("ngIf",i.id!==s.registeredDeviceId)}}function It(l,R){if(1&l&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&l){const i=R.$implicit,s=R.index;e.xp6(),e.AsE("",s,": ",i,"")}}function dt(l,R){if(1&l&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&l){const i=R.$implicit,s=R.index;e.xp6(),e.AsE("",s,": ",i,"")}}function Ot(l,R){if(1&l&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&l){const i=R.$implicit,s=R.index;e.xp6(),e.AsE("",s,": ",i,"")}}function pt(l,R){if(1&l&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"json"),e.qZA()),2&l){const i=R.$implicit;e.xp6(),e.Oqu(e.lcZ(2,1,i))}}let kt=(()=>{class l{auth;dialog;toastr;store;funcs;messaging;destroy$=new _.x;mainForm;userPrivStore$;deviceForm;messagingTypeArray;configArray;currentUser$;registeredDeviceId;registeredToken;debugObservable={};devices;tokenReceived=new _.x;tokenReceived$;privUser;constructor(i,s,d,C,E,de){this.auth=i,this.dialog=s,this.toastr=d,this.store=C,this.funcs=E,this.messaging=de,this.privUser=this.store.collection("/users/v1/protected"),this.currentUser$=this.auth.clientSideUser$.pipe((0,O.h)(We=>!!We))}onToggleDevice(i,s){(0,m.eM)("onToggleDevice()");const d=this.getDeviceControl(s),C={deviceId:s.id,off:!d.value};try{this.funcs.call("toggleSuspendDevice",C),this.toastr.success("\u7aef\u672b\u306e\u8a2d\u5b9a\u3092\u66f4\u65b0\u3057\u307e\u3057\u305f\u3002")}catch{this.toastr.error("\u7aef\u672b\u306e\u8a2d\u5b9a\u304c\u66f4\u65b0\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002")}}onClickDeleteDevice(i,s){var E,d=this;(0,m.eM)("onClickDeleteDevice()"),this.messaging.deleteToken(s.token).pipe((0,P.R)(this.destroy$)).subscribe({next:(E=(0,N.Z)(function*(de){(0,m.H_)(`deleteToken() result ${de}`),d.toastr.success("\u7aef\u672b\u306e\u901a\u77e5\u3092\u89e3\u9664\u3057\u307e\u3057\u305f\u3002")}),function(We){return E.apply(this,arguments)}),error:E=>{(0,m.wb)(`Failed to delete token token: ${s.token}`,E),this.toastr.error("\u7aef\u672b\u306e\u901a\u77e5\u3092\u89e3\u9664\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002\u65e2\u306b\u5931\u52b9\u3057\u3066\u3044\u308b\u53ef\u80fd\u6027\u304c\u3042\u308a\u307e\u3059\u3002")}});const C={deviceId:s.id};try{this.funcs.call("revokeDevice",C),this.toastr.success("\u30b7\u30b9\u30c6\u30e0\u4e0a\u304b\u3089\u7aef\u672b\u306e\u901a\u77e5\u3092\u89e3\u9664\u3057\u307e\u3057\u305f\u3002")}catch{this.toastr.error("\u30b7\u30b9\u30c6\u30e0\u4e0a\u306e\u7aef\u672b\u306e\u901a\u77e5\u3092\u89e3\u9664\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002")}}ngOnInit(){var i=this;const d=this.currentUser$.pipe((0,k.q)(1),(0,O.h)(C=>!!C)).pipe((0,ae.w)(C=>this.store.collection(`users/v1/protected/${C.uid}/fcm`).valueChanges({idField:"id"})),(0,W.d)(1));d.pipe((0,P.R)(this.destroy$)).subscribe(C=>{this.devices=C;for(const E in this.deviceForm.controls)this.deviceForm.removeControl(E);for(const E of this.devices)this.addDeviceControl(E);this.triggerTokenRefresh()}),this.mainForm.addControl("messagingOn",new r.NI(!1,[])),this.deviceForm=new r.cw({}),this.mainForm.addControl("devices",this.deviceForm),this.mainForm.addControl("messagingSystemCheck",new r.NI(!1,[])),this.mainForm.addControl("messagingTrivialCheck",new r.NI(!1,[])),this.mainForm.addControl("messagingMentionCheck",new r.NI(!1,[])),this.mainForm.addControl("messagingAdminCheck",new r.NI(!1,[])),this.messagingTypeArray=new r.Oe([this.typeSystemControl,this.typeMentionControl,this.typeAdminControl]),this.configArray=new r.Oe([this.typeTrivialControl,this.messagingTypeArray]),this.userPrivStore$.pipe((0,P.R)(this.destroy$)).subscribe(C=>{(0,m.H_)("this.userPrivStore$.subscribe()",C);const E=C.messagingTypes||["mention","admin"];L(this.typeSystemControl,E.includes("system")),L(this.typeMentionControl,E.includes("mention")),L(this.typeAdminControl,E.includes("admin")),L(this.typeTrivialControl,C.isWatchTrivial)}),this.tokenReceived$=this.tokenReceived.pipe((0,O.h)(C=>null!==C),(0,qe.x)()),(0,ke.a)(this.tokenReceived$,d).pipe((0,P.R)(this.destroy$)).subscribe(function(){var C=(0,N.Z)(function*([E,de]){if((0,m.eM)("this.messaging.tokenReceived subscribe()",E,de),i.debugObservable.registeredToken=E,i.registeredToken=E,E){const je=i.findDeviceId(E,de);i.registeredDeviceId=je}L(i.messagingOnControl,!!i.registeredDeviceId)});return function(E){return C.apply(this,arguments)}}()),this.triggerTokenRefresh(),this.debugObservable.messages=[],this.messaging.messages.pipe((0,P.R)(this.destroy$)).subscribe(C=>{(0,m.H_)("message received from messaging",C),this.debugObservable.messages.push(C)}),this.debugObservable.getToken$=this.messaging.getToken,this.debugObservable.getToken=[],this.debugObservable.getToken$.subscribe({next:C=>this.debugObservable.getToken.push(C),complete:()=>(0,m.H_)("Complete getToken()")}),this.debugObservable.tokenChanges$=this.messaging.tokenChanges,this.debugObservable.tokenChanges=[],this.debugObservable.tokenChanges$.subscribe({next:C=>this.debugObservable.tokenChanges.push(C),complete:()=>(0,m.H_)("Complete tokenChanges()")}),this.debugObservable.tokenReceived=[]}findDeviceId(i,s){for(const d of s)if(d.token===i)return d.id;return null}ngOnDestroy(){this.destroy$.next()}triggerTokenRefresh(){this.messaging.getToken.pipe((0,k.q)(1),(0,P.R)(this.destroy$)).subscribe({next:i=>this.tokenReceived.next(i),complete:()=>(0,m.eM)("Completed getToken")})}get messagingOnControl(){return this.mainForm.get("messagingOn")}getDeviceControl(i){return this.deviceForm.get(`device-${i.id}`)}addDeviceControl(i){const s=new r.NI(!i.isSuspend,[]);this.deviceForm.addControl(`device-${i.id}`,s)}get typeTrivialControl(){return this.mainForm.get("messagingTrivialCheck")}get typeSystemControl(){return this.mainForm.get("messagingSystemCheck")}get typeMentionControl(){return this.mainForm.get("messagingMentionCheck")}get typeAdminControl(){return this.mainForm.get("messagingAdminCheck")}revokeNotification(){var i=this;return(0,N.Z)(function*(){if(!i.registeredDeviceId)return(0,m.wb)("Unexpectedly no deviceId is found."),void i.toastr.error("\u30c7\u30d0\u30a4\u30b9\u60c5\u5831\u3092\u7121\u52b9\u306b\u3067\u304d\u307e\u305b\u3093\u3002");try{i.funcs.call("revokeDevice",{deviceId:i.registeredDeviceId}),i.toastr.info("\u30b7\u30b9\u30c6\u30e0\u304b\u3089\u901a\u77e5\u60c5\u5831\u3092\u524a\u9664\u3057\u307e\u3057\u305f\u3002")}catch(s){return(0,m.wb)("Error while deleting token via Functions",s),i.messagingOnControl.setValue(!0),D(i.messagingOnControl),void i.toastr.error("\u30b7\u30b9\u30c6\u30e0\u306e\u901a\u77e5\u60c5\u5831\u3092\u524a\u9664\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002")}i.messaging.getToken.pipe((0,Ne.b)(s=>(0,m.eM)(`getToken before deleteToken ${s}`)),(0,Ie.z)(s=>i.messaging.deleteToken(s)),(0,k.q)(1),(0,P.R)(i.destroy$)).subscribe({next:s=>{(0,m.H_)(`Deleted result: ${s} on FCM.`),D(i.messagingOnControl),i.toastr.success("\u901a\u77e5\u60c5\u5831\u3092\u524a\u9664\u3057\u307e\u3057\u305f\u3002")},error:s=>{(0,m.wb)("Error while deleting token on FCM",s),i.toastr.error("\u901a\u77e5\u60c5\u5831\u304c\u524a\u9664\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002")}})})()}onToggleMessaging(i){var s=this;return(0,N.Z)(function*(){if((0,m.eM)("UserSettingsComponent.onToggleMessaging()"),s.messagingOnControl.value){if(!s.registeredDeviceId&&s.devices&&s.devices.length>=m.NZ.FCMDeviceMaxCount)return void s.toastr.error("\u767b\u9332\u3055\u308c\u305f\u30c7\u30d0\u30a4\u30b9\u304c\u591a\u3059\u304e\u307e\u3059\u3002\u524a\u9664\u3057\u3066\u304b\u3089\u3084\u308a\u76f4\u3057\u3066\u304f\u3060\u3055\u3044\u3002");yield s.updateRequestToken()}else{const C=s.dialog.createHtmlBuilder(),E=new Ye.ww("\n<div>\n\u767b\u9332\u3092\u89e3\u9664\u3059\u308b\u3068\u3059\u3079\u3066\u306e\u901a\u77e5\u306f\u505c\u6b62\u3057\u307e\u3059\u3002\u3088\u308d\u3057\u3044\u3067\u3059\u304b\uff1f\n</div>\n");C.setMessage(E).setType(q.iR.Warn).setSize(q.PW.Default).setTitle("\u78ba\u8a8d").okButton((0,N.Z)(function*(){yield s.revokeNotification()})).cancelButton(()=>{s.messagingOnControl.setValue(!0),D(s.messagingOnControl)}).open()}})()}getMessagingTypes(){const i=[];return this.typeSystemControl.value&&i.push("system"),this.typeMentionControl.value&&i.push("mention"),this.typeAdminControl.value&&i.push("admin"),i}updateRequestToken(){var i=this;return(0,N.Z)(function*(){var s;i.messaging.requestToken.pipe((0,k.q)(1),(0,P.R)(i.destroy$)).subscribe({next:(s=(0,N.Z)(function*(d){if(i.tokenReceived.next(d),i.debugObservable.tokenReceived.push(d),!d)return(0,m.wb)("No token returned from requestToken"),i.messagingOnControl.setValue(!1),D(i.messagingOnControl),void i.toastr.error("\u901a\u77e5\u60c5\u5831\u3092\u53d6\u5f97\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002");try{(0,m.eM)(`Updated token with ${d}`);const C={token:d,deviceId:i.registeredDeviceId};i.registeredToken=d,i.registeredDeviceId=yield i.funcs.call("saveDeviceToken",C),i.toastr.success("\u901a\u77e5\u60c5\u5831\u3092\u4fdd\u5b58\u3057\u307e\u3057\u305f\u3002"),D(i.messagingOnControl)}catch(C){(0,m.wb)("Error while save token to Firestore",C),i.messagingOnControl.setValue(!1),D(i.messagingOnControl),i.toastr.error("\u901a\u77e5\u60c5\u5831\u3092\u4fdd\u5b58\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002")}}),function(C){return s.apply(this,arguments)}),error:s=>{(0,m.wb)("Error while request Token",s),i.messagingOnControl.setValue(!1),D(i.messagingOnControl),i.toastr.error("\u901a\u77e5\u3092\u6709\u52b9\u306b\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002\u30d6\u30e9\u30a6\u30b6\u306e\u8a2d\u5b9a\u3092\u78ba\u8a8d\u3057\u3066\u304f\u3060\u3055\u3044\u3002")}})})()}onClickUpdateMessaging(i){var s=this;return(0,N.Z)(function*(){(0,m.eM)("UserSettingsComponent.onClickUpdateMessaging()");try{const d={messageTypes:s.getMessagingTypes(),token:s.registeredToken,isWatchTrivial:s.typeTrivialControl.value};yield s.funcs.call("setNotifications",d),D(s.configArray),s.toastr.success("\u8a2d\u5b9a\u3092\u4fdd\u5b58\u3057\u307e\u3057\u305f\u3002")}catch(d){(0,m.wb)("Failed to save configuration",d),s.toastr.error("\u8a2d\u5b9a\u304c\u4fdd\u5b58\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002")}})()}onClickSubscribeTopic(i){var s=this;return(0,N.Z)(function*(){if(!s.debugObservable.topicText)return void alert("Not set");const d={topic:s.debugObservable.topicText,token:s.registeredToken},C=yield s.funcs.call("subscribeTopicTest",d);(0,m.H_)("subscribeTopicTest ->",C),s.toastr.success(`done subscribe ${C}`)})()}onClickUnsubscribeTopic(i){var s=this;return(0,N.Z)(function*(){if(!s.debugObservable.topicText)return void alert("Not set");const d={topic:s.debugObservable.topicText,token:s.registeredToken},C=yield s.funcs.call("unsubscribeTopicTest",d);(0,m.H_)("unsubscribeTopicTest ->",C),s.toastr.success(`done unsubscribe ${C}`)})()}onClickPostToTopic(i){var s=this;return(0,N.Z)(function*(){if(!s.debugObservable.topicText||!s.debugObservable.topicPostText)return void alert("Not set");const d={topic:s.debugObservable.topicText,title:s.debugObservable.topicPostText},C=yield s.funcs.call("postTopicTest",d);(0,m.H_)("postTopicTest ->",C),s.toastr.success(`done post ${C}`)})()}onClickConditionPostToTopic(i){var s=this;return(0,N.Z)(function*(){if(!s.debugObservable.conditionTopicPostText||!s.debugObservable.conditionTopicPostText)return void alert("Not set");const d={topic:s.debugObservable.conditionTopicPostText,title:s.debugObservable.topicPostText},C=yield s.funcs.call("postConditionTopicTest",d);(0,m.H_)("postConditionTopicTest ->",C),s.toastr.success(`done post ${C}`)})()}onClickClearMessages(i){this.debugObservable.messages=[]}static \u0275fac=function(s){return new(s||l)(e.Y36(X.e),e.Y36(q.xA),e.Y36(b._W),e.Y36(te.ST),e.Y36(Ze.c),e.Y36(y))};static \u0275cmp=e.Xpm({type:l,selectors:[["gitfire-user-notification"]],inputs:{mainForm:"mainForm",userPrivStore$:"userPrivStore$"},decls:69,vars:16,consts:[[1,"m-2"],["title","\u3053\u306e\u6a5f\u80fd\u306f\u30c6\u30b9\u30c8\u4e2d\u306e\u305f\u3081\u5909\u66f4\u3055\u308c\u308b\u3053\u3068\u3084\u3001\u60f3\u5b9a\u5916\u306e\u6319\u52d5\u3092\u3059\u308b\u5834\u5408\u304c\u3042\u308a\u307e\u3059\u3002\u30d6\u30e9\u30a6\u30b6\u304b\u3089\u306e\u901a\u77e5\u3092\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u3057\u307e\u3059\u3002\u8a2d\u5b9a\u304c\u3046\u307e\u304f\u3044\u304b\u306a\u3044\u5834\u5408\u306f\u30d6\u30e9\u30a6\u30b6\u304b\u3089\u5f53\u30b5\u30a4\u30c8\u306e\u901a\u77e5 on/off \u3092\u3057\u305f\u308a\u3001\u300e\u7aef\u672b\u306e\u524a\u9664\u300f\u3092\u304a\u8a66\u3057\u304f\u3060\u3055\u3044\u3002","src","/assets/octicons/question.svg",1,"m-3","octicon-info","help-icon"],[1,"m-2",3,"formGroup"],[1,"row","p-1"],[1,"d-flex","align-content-start","flex-wrap","p-1"],["controlLabel","\u901a\u77e5\u3092\u53d7\u3051\u53d6\u308b","formName","messagingOn","tooltipText","\u30d6\u30e9\u30a6\u30b6\u304b\u3089\u306e\u901a\u77e5\u3092\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u3057\u307e\u3059\u3002",1,"p-2",3,"parentForm","checkChanged"],[1,"d-flex","align-content-start","flex-wrap","p-3"],["class","m-1 input-group",4,"ngFor","ngForOf"],[1,"row","m-2"],["controlLabel","\u3061\u3087\u3063\u3068\u3057\u305f\u901a\u77e5","formName","messagingTrivialCheck","tooltipText","\u3061\u3087\u3063\u3068\u3057\u305f\u901a\u77e5\u3082\u53d7\u3051\u53d6\u308b\u304b\u3069\u3046\u304b\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\u901a\u5e38\u306f\u4e0d\u8981\u3067\u3059\u3002",1,"p-2",3,"parentForm"],["controlLabel","\u30b7\u30b9\u30c6\u30e0","formName","messagingSystemCheck","tooltipText","\u30b7\u30b9\u30c6\u30e0\u304b\u3089\u306e\u901a\u77e5\u3092\u9001\u308b\u304b\u3069\u3046\u304b\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002",1,"p-2",3,"parentForm"],["controlLabel","\u3042\u306a\u305f\u3078\u306e\u8a00\u53ca","formName","messagingMentionCheck","tooltipText","\u30b7\u30b9\u30c6\u30e0\u306e\u30e1\u30c3\u30bb\u30fc\u30b8\u30b7\u30b9\u30c6\u30e0\u3067\u3042\u306a\u305f\u306b\u8a00\u53ca\u3055\u308c\u305f\u5834\u5408\u306b\u901a\u77e5\u3092\u9001\u308b\u304b\u3069\u3046\u304b\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002",1,"p-2",3,"parentForm"],["controlLabel","\u7ba1\u7406\u4eba\u304b\u3089","formName","messagingAdminCheck","tooltipText","\u7ba1\u7406\u4eba\u304c\u624b\u52d5\u3067\u3042\u306a\u305f\u306b\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u9001\u3063\u305f\u5834\u5408\u306b\u901a\u77e5\u3092\u9001\u308b\u304b\u3069\u3046\u304b\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002",1,"p-2",3,"parentForm"],[1,"btn","btn-primary",3,"disabled","click"],[2,"width","100%","overflow-wrap","break-word"],[4,"ngFor","ngForOf"],["type","text",3,"ngModel","ngModelChange"],[1,"btn","btn-primary",3,"click"],[1,"btn","btn-warning",3,"click"],[1,"m-1","input-group"],["tooltipText","\u767b\u9332\u3055\u308c\u305f Device \u306e\u901a\u77e5\u3092\u4e00\u6642\u7684\u306b\u505c\u6b62\u3057\u307e\u3059\u3002",1,"m-2",3,"parentForm","controlLabel","formName","checkChanged"],["class","btn btn-warning","title","\u767b\u9332\u60c5\u5831\u3092\u524a\u9664\u3057\u3066\u3001\u3053\u306e\u7aef\u672b\u3078\u306e\u901a\u77e5\u3092\u89e3\u9664\u3057\u307e\u3059\u3002",3,"click",4,"ngIf"],["title","\u767b\u9332\u60c5\u5831\u3092\u524a\u9664\u3057\u3066\u3001\u3053\u306e\u7aef\u672b\u3078\u306e\u901a\u77e5\u3092\u89e3\u9664\u3057\u307e\u3059\u3002",1,"btn","btn-warning",3,"click"]],template:function(s,d){1&s&&(e.TgZ(0,"h2",0),e._uU(1,"\u901a\u77e5\u8a2d\u5b9a (\u30c6\u30b9\u30c8\u4e2d)"),e._UZ(2,"img",1),e.qZA(),e.TgZ(3,"div",2)(4,"div",3)(5,"div",4)(6,"app-switch",5),e.NdJ("checkChanged",function(E){return d.onToggleMessaging(E)}),e.qZA()()(),e.TgZ(7,"div",0)(8,"h3"),e._uU(9,"\u767b\u9332\u3055\u308c\u305f\u30c7\u30d0\u30a4\u30b9"),e.qZA(),e.TgZ(10,"div",6),e.YNc(11,Pt,4,9,"div",7),e.qZA()(),e.TgZ(12,"div")(13,"div",8)(14,"h3"),e._uU(15,"\u91cd\u8981\u5ea6"),e.qZA(),e.TgZ(16,"div",4),e._UZ(17,"app-switch",9),e.qZA()(),e.TgZ(18,"div",8)(19,"h3"),e._uU(20,"\u7a2e\u985e"),e.qZA(),e.TgZ(21,"div",4),e._UZ(22,"app-switch",10)(23,"app-switch",11)(24,"app-switch",12),e.qZA()(),e.TgZ(25,"div",8)(26,"button",13),e.NdJ("click",function(E){return d.onClickUpdateMessaging(E)}),e._uU(27,"\u66f4\u65b0"),e.qZA()()()(),e.TgZ(28,"div",14)(29,"div"),e._uU(30,"Token: "),e.TgZ(31,"div"),e._uU(32),e.qZA()(),e.TgZ(33,"div"),e._uU(34,"GetToken: "),e.YNc(35,It,2,2,"div",15),e.qZA(),e.TgZ(36,"div"),e._uU(37,"TokenChanges: "),e.YNc(38,dt,2,2,"div",15),e.qZA(),e.TgZ(39,"div"),e._uU(40,"TokenReceived: "),e.YNc(41,Ot,2,2,"div",15),e.qZA(),e.TgZ(42,"div")(43,"div")(44,"label"),e._uU(45,"Topic: "),e.TgZ(46,"input",16),e.NdJ("ngModelChange",function(E){return d.debugObservable.topicText=E}),e.qZA()(),e.TgZ(47,"button",17),e.NdJ("click",function(E){return d.onClickSubscribeTopic(E)}),e._uU(48,"subscribe"),e.qZA(),e.TgZ(49,"button",17),e.NdJ("click",function(E){return d.onClickUnsubscribeTopic(E)}),e._uU(50,"unsubscribe"),e.qZA()(),e.TgZ(51,"div")(52,"label"),e._uU(53,"Post Title: "),e.TgZ(54,"input",16),e.NdJ("ngModelChange",function(E){return d.debugObservable.topicPostText=E}),e.qZA()(),e.TgZ(55,"button",17),e.NdJ("click",function(E){return d.onClickPostToTopic(E)}),e._uU(56,"Post"),e.qZA()(),e.TgZ(57,"div")(58,"label"),e._uU(59,"Condition Topic Post: "),e.TgZ(60,"input",16),e.NdJ("ngModelChange",function(E){return d.debugObservable.conditionTopicPostText=E}),e.qZA()(),e.TgZ(61,"button",17),e.NdJ("click",function(E){return d.onClickConditionPostToTopic(E)}),e._uU(62,"CondPost"),e.qZA()()()(),e.TgZ(63,"div")(64,"button",18),e.NdJ("click",function(E){return d.onClickClearMessages(E)}),e._uU(65,"Clear"),e.qZA(),e.TgZ(66,"div"),e._uU(67,"Messages: "),e.YNc(68,pt,3,3,"div",15),e.qZA()()),2&s&&(e.xp6(3),e.Q6J("formGroup",d.mainForm),e.xp6(3),e.Q6J("parentForm",d.mainForm),e.xp6(5),e.Q6J("ngForOf",d.devices),e.xp6(6),e.Q6J("parentForm",d.mainForm),e.xp6(5),e.Q6J("parentForm",d.mainForm),e.xp6(),e.Q6J("parentForm",d.mainForm),e.xp6(),e.Q6J("parentForm",d.mainForm),e.xp6(2),e.Q6J("disabled",d.configArray.invalid||!d.configArray.dirty),e.xp6(6),e.Oqu(d.debugObservable.registeredToken),e.xp6(3),e.Q6J("ngForOf",d.debugObservable.getToken),e.xp6(3),e.Q6J("ngForOf",d.debugObservable.tokenChanges),e.xp6(3),e.Q6J("ngForOf",d.debugObservable.tokenReceived),e.xp6(5),e.Q6J("ngModel",d.debugObservable.topicText),e.xp6(8),e.Q6J("ngModel",d.debugObservable.topicPostText),e.xp6(6),e.Q6J("ngModel",d.debugObservable.conditionTopicPostText),e.xp6(8),e.Q6J("ngForOf",d.debugObservable.messages))},dependencies:[S.sg,S.O5,r.Fj,r.JJ,r.JL,r.On,r.sg,lt,S.Ts,S.uU]})}return l})();const ht=["protectedSettings"],Dt=["imageBox"];function ft(l,R){1&l&&e._uU(0,"\u753b\u50cf\u304c\u3042\u308a\u307e\u305b\u3093")}function _e(l,R){if(1&l&&e._UZ(0,"img",39),2&l){const i=e.oxw().ngIf;e.s9C("src",i.photoURL,e.LSH)}}function rt(l,R){if(1&l){const i=e.EpF();e.ynx(0),e.TgZ(1,"span",40),e._uU(2," -> "),e.qZA(),e.TgZ(3,"label",8),e._uU(4,"\u65b0\u3057\u3044\u753b\u50cf"),e.qZA(),e._UZ(5,"img",41),e.TgZ(6,"button",42),e.NdJ("click",function(d){const E=e.CHM(i).ngIf,de=e.oxw(2);return e.KtG(de.onClickOkImage(d,E))}),e._uU(7,"\u78ba\u5b9a"),e.qZA(),e.BQk()}if(2&l){const i=R.ngIf;e.xp6(5),e.s9C("src",i,e.LSH)}}function Ke(l,R){1&l&&e._UZ(0,"div",43)}function it(l,R){if(1&l&&(e.TgZ(0,"div",43),e._uU(1),e.qZA()),2&l){const i=e.oxw(3);e.xp6(),e.hij("\u6b8b\u308a ",i.nicknameResult.changesRemain," \u56de \u5909\u66f4\u3067\u304d\u307e\u3059\u3002")}}function gt(l,R){1&l&&(e.TgZ(0,"div",45),e._uU(1,"\u3053\u308c\u4ee5\u4e0a\u306f\u5909\u66f4\u3067\u304d\u307e\u305b\u3093\u3002"),e.qZA())}function st(l,R){if(1&l&&(e.ynx(0),e.YNc(1,it,2,1,"div",19)(2,gt,2,0,"div",44),e.BQk()),2&l){const i=e.oxw(2);e.xp6(),e.Q6J("ngIf",i.nicknameResult.changesRemain>0),e.xp6(),e.Q6J("ngIf",0===i.nicknameResult.changesRemain)}}function tt(l,R){1&l&&(e.TgZ(0,"div",45),e._uU(1,"\u5165\u529b\u5fc5\u9808\u3067\u3059\u3002"),e.qZA())}function xt(l,R){1&l&&(e.TgZ(0,"div",45),e._uU(1,"\u9577\u3059\u304e\u307e\u3059\u3002"),e.qZA())}function nt(l,R){1&l&&(e.TgZ(0,"div",45),e._uU(1,"\u77ed\u3059\u304e\u307e\u3059\u3002"),e.qZA())}function Ut(l,R){if(1&l&&(e.ynx(0),e.YNc(1,tt,2,0,"div",44)(2,xt,2,0,"div",44)(3,nt,2,0,"div",44),e.BQk()),2&l){const i=e.oxw(2);e.xp6(),e.Q6J("ngIf",null==i.nicknameControl.errors?null:i.nicknameControl.errors.required),e.xp6(),e.Q6J("ngIf",null==i.nicknameControl.errors?null:i.nicknameControl.errors.maxlength),e.xp6(),e.Q6J("ngIf",null==i.nicknameControl.errors?null:i.nicknameControl.errors.minlength)}}function xe(l,R){1&l&&e._UZ(0,"div",43)}function mt(l,R){1&l&&(e.TgZ(0,"div",45),e._uU(1,"\u9577\u3059\u304e\u307e\u3059\u3002"),e.qZA())}function Bt(l,R){if(1&l&&(e.ynx(0),e.YNc(1,mt,2,0,"div",44),e.BQk()),2&l){const i=e.oxw(2);e.xp6(),e.Q6J("ngIf",null==i.aboutControl.errors?null:i.aboutControl.errors.maxlength)}}function _t(l,R){if(1&l&&(e.ynx(0),e._UZ(1,"hr")(2,"gitfire-user-notification",46),e.BQk()),2&l){const i=e.oxw(2);e.xp6(2),e.Q6J("mainForm",i.notificationForm)("userPrivStore$",i.userPrivate$)}}function vt(l,R){1&l&&e._UZ(0,"div",43)}function at(l,R){1&l&&(e.TgZ(0,"div",45),e._uU(1,"E \u30e1\u30fc\u30eb\u306f\u5fc5\u9808\u3067\u3059\u3002"),e.qZA())}function ve(l,R){1&l&&(e.TgZ(0,"div",45),e._uU(1,"E \u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044\u3002"),e.qZA())}function Xe(l,R){if(1&l&&(e.ynx(0),e.YNc(1,at,2,0,"div",44)(2,ve,2,0,"div",44),e.BQk()),2&l){const i=e.oxw(2);e.xp6(),e.Q6J("ngIf",null==i.emailControl.errors?null:i.emailControl.errors.required),e.xp6(),e.Q6J("ngIf",(null==i.emailControl.errors?null:i.emailControl.errors.minlength)||(null==i.emailControl.errors?null:i.emailControl.errors.maxlength))}}function Zt(l,R){1&l&&(e.TgZ(0,"div",43),e._uU(1,"\u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u5f37\u5ea6\u306f\u5145\u5206\u306b\u3057\u3066\u304f\u3060\u3055\u3044\u3002"),e.qZA())}function Je(l,R){1&l&&(e.TgZ(0,"div",45),e._uU(1,"\u30d1\u30b9\u30ef\u30fc\u30c9\u306f\u5fc5\u9808\u3067\u3059\u3002"),e.qZA())}function Ct(l,R){1&l&&(e.TgZ(0,"div",45),e._uU(1,"\u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u9577\u3055\u304c\u8db3\u308a\u307e\u305b\u3093\u3002"),e.qZA())}function yt(l,R){if(1&l&&(e.ynx(0),e.YNc(1,Je,2,0,"div",44)(2,Ct,2,0,"div",44),e.BQk()),2&l){const i=e.oxw(2);e.xp6(),e.Q6J("ngIf",null==i.passwordControl.errors?null:i.passwordControl.errors.required),e.xp6(),e.Q6J("ngIf",null==i.passwordControl.errors?null:i.passwordControl.errors.minlength)}}const ut=()=>["(\u5371\u967a)","(\u5f31\u3044)","(\u666e\u901a)","(\u5f37\u3044)","(\u5145\u5206\u306b\u5b89\u5168)"],Gt=()=>["#DD2C00","#FF6D00","#FFD600","#AEEA00","#00C853"];function ct(l,R){if(1&l){const i=e.EpF();e.ynx(0),e.TgZ(1,"div",1)(2,"form",2,3)(4,"h2",4),e._uU(5,"\u516c\u958b\u8a2d\u5b9a"),e._UZ(6,"img",5),e.qZA(),e.TgZ(7,"div")(8,"div",6)(9,"div",7)(10,"label",8),e._uU(11,"\u73fe\u5728\u306e\u753b\u50cf"),e.qZA(),e.YNc(12,ft,1,0,"ng-template",null,9,e.W1O)(14,_e,1,1,"img",10)(15,rt,8,1,"ng-container",0),e.ALo(16,"async"),e.qZA(),e.TgZ(17,"div",11),e._UZ(18,"input",12,13),e.TgZ(20,"button",14),e.NdJ("click",function(d){e.CHM(i);const C=e.oxw();return e.KtG(C.onClickUploadImage(d))}),e._uU(21,"Upload"),e.qZA()()(),e.TgZ(22,"div",15)(23,"label",16),e._uU(24,"\u30cb\u30c3\u30af\u30cd\u30fc\u30e0"),e._UZ(25,"img",17),e.qZA(),e._UZ(26,"input",18),e.TgZ(27,"button",14),e.NdJ("click",function(d){e.CHM(i);const C=e.oxw();return e.KtG(C.onClickUpdateNickname(d))}),e._uU(28,"\u66f4\u65b0"),e.qZA()(),e.YNc(29,Ke,1,0,"div",19)(30,st,3,2,"ng-container",0)(31,Ut,4,3,"ng-container",0),e.TgZ(32,"div",15)(33,"label",16),e._uU(34,"\u81ea\u5df1\u7d39\u4ecb"),e._UZ(35,"img",20),e.qZA(),e._UZ(36,"textarea",21),e.TgZ(37,"button",22),e.NdJ("click",function(d){e.CHM(i);const C=e.oxw();return e.KtG(C.onClickUpdateAbout(d))}),e._uU(38,"\u66f4\u65b0"),e.qZA()()(),e.YNc(39,xe,1,0,"div",19)(40,Bt,2,1,"ng-container",0)(41,_t,3,2,"ng-container",0),e._UZ(42,"hr"),e.TgZ(43,"a",23),e.NdJ("click",function(d){e.CHM(i);const C=e.oxw();return e.KtG(C.onClickImportant(d))}),e._uU(44),e.qZA(),e.TgZ(45,"div",24,25)(47,"div",26)(48,"label",27),e._uU(49,"\u540d\u524d"),e._UZ(50,"img",28),e.qZA(),e._UZ(51,"input",29),e.qZA(),e.TgZ(52,"div",26)(53,"label",27),e._uU(54,"Email"),e._UZ(55,"img",30),e.qZA(),e._UZ(56,"input",31),e.TgZ(57,"button",32),e.NdJ("click",function(d){e.CHM(i);const C=e.oxw();return e.KtG(C.onClickUpdateEmail(d))}),e._uU(58,"\u66f4\u65b0"),e.qZA(),e.YNc(59,vt,1,0,"div",19)(60,Xe,3,2,"ng-container",0),e.qZA(),e.TgZ(61,"div",26)(62,"label",27),e._uU(63,"Password"),e._UZ(64,"img",33),e.qZA(),e._UZ(65,"input",34),e.TgZ(66,"button",32),e.NdJ("click",function(d){e.CHM(i);const C=e.oxw();return e.KtG(C.onClickUpdatePassword(d))}),e._uU(67,"\u66f4\u65b0"),e.qZA(),e._UZ(68,"ng9-password-strength-bar",35),e.ALo(69,"async"),e.YNc(70,Zt,2,0,"div",19)(71,yt,3,2,"ng-container",0),e.qZA(),e.TgZ(72,"h3",36),e._uU(73,"\u30a2\u30ab\u30a6\u30f3\u30c8\u306e\u7d42\u4e86"),e.qZA(),e.TgZ(74,"div",37)(75,"button",38),e.NdJ("click",function(d){e.CHM(i);const C=e.oxw();return e.KtG(C.onClickDeleteAccount(d))}),e._uU(76,"\u30a2\u30ab\u30a6\u30f3\u30c8\u3092\u524a\u9664"),e.qZA()()()()(),e.BQk()}if(2&l){const i=R.ngIf,s=e.MAs(13),d=e.oxw();e.xp6(2),e.Q6J("formGroup",d.inputForm),e.xp6(12),e.Q6J("ngIf",i.photoURL)("ngIfElse",s),e.xp6(),e.Q6J("ngIf",e.lcZ(16,35,d.profileTempImage$)),e.xp6(5),e.Q6J("disabled",d.userIconControl.invalid||!d.userIconControl.dirty),e.xp6(2),e.ekj("was-validated",d.nicknameControl.dirty||d.nicknameControl.touched),e.xp6(5),e.Q6J("disabled",d.nicknameControl.invalid||!d.nicknameControl.dirty),e.xp6(2),e.Q6J("ngIf",!d.nicknameControl.invalid),e.xp6(),e.Q6J("ngIf",d.nicknameResult),e.xp6(),e.Q6J("ngIf",d.nicknameControl.invalid),e.xp6(),e.ekj("was-validated",d.aboutControl.dirty||d.aboutControl.touched),e.xp6(5),e.Q6J("disabled",d.aboutControl.invalid||!d.aboutControl.dirty),e.xp6(2),e.Q6J("ngIf",!d.aboutControl.invalid),e.xp6(),e.Q6J("ngIf",d.aboutControl.invalid),e.xp6(),e.Q6J("ngIf",d.auth.isDeveloper),e.xp6(3),e.Oqu(d.isOpenOther?"\u518d\u8a8d\u8a3c":"\u305d\u306e\u4ed6\u306e\u8a2d\u5b9a"),e.xp6(7),e.Q6J("value",i.displayName),e.xp6(),e.ekj("was-validated",d.emailControl.dirty||d.emailControl.touched),e.xp6(5),e.Q6J("disabled",d.emailControl.invalid||!d.emailControl.dirty),e.xp6(2),e.Q6J("ngIf",!d.emailControl.invalid),e.xp6(),e.Q6J("ngIf",d.emailControl.invalid),e.xp6(),e.ekj("was-validated",d.passwordControl.dirty||d.passwordControl.touched),e.xp6(5),e.Q6J("disabled",!d.passwordControl.value||d.passwordControl.invalid||!d.passwordControl.dirty),e.xp6(2),e.Udp("display",""===d.passwordControl.value?"none":null),e.Q6J("passwordToCheck",e.lcZ(69,37,d.passwordControl.valueChanges))("barLabel","\u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u5f37\u5ea6(\u76ee\u5b89): ")("strengthLabels",e.DdM(39,ut))("barColors",e.DdM(40,Gt)),e.xp6(2),e.Q6J("ngIf",!d.passwordControl.invalid),e.xp6(),e.Q6J("ngIf",d.passwordControl.invalid)}}let Mt=(()=>{class l{auth;storage;funcs;store;toastr;router;dialog;localSession;destroy$=new _.x;currentUser;currentUser$;userPublic;userPrivate$=new _.x;profileTempImage$;inputForm;notificationForm;isOpenOther=!1;nicknameResult=null;protectedSettings;imageBox;pubUser;privUser;nicknameIndex;constructor(i,s,d,C,E,de,We,je){this.auth=i,this.storage=s,this.funcs=d,this.store=C,this.toastr=E,this.router=de,this.dialog=We,this.localSession=je,this.pubUser=this.store.collection("/users/v1/public"),this.privUser=this.store.collection("/users/v1/protected"),this.nicknameIndex=this.store.collection("/index/users/usernick"),this.currentUser$=this.auth.clientSideUser$,this.currentUser$.pipe((0,P.R)(this.destroy$)).subscribe(Qe=>{this.currentUser=Qe})}ngOnInit(){this.inputForm=new r.cw({}),this.inputForm.addControl("userIcon",new r.NI("",[r.kI.required])),this.inputForm.addControl("email",new r.NI({value:"",disabled:!1},[r.kI.required])),this.inputForm.addControl("password",new r.NI("",[])),this.inputForm.addControl("nickname",new r.NI({value:"",disabled:!0},[r.kI.required])),this.inputForm.addControl("about",new r.NI({value:"",disabled:!0},[])),this.notificationForm=new r.cw({}),this.inputForm.addControl("messaging",this.notificationForm)}ngAfterViewInit(){const i=this.currentUser$.pipe((0,k.q)(1),(0,O.h)(s=>!!s));i.pipe((0,ae.w)(s=>this.pubUser.doc(s.uid).valueChanges()),(0,P.R)(this.destroy$)).subscribe(s=>{this.userPublic=s,L(this.aboutControl,s.about),this.aboutControl.enable(),L(this.nicknameControl,s.nickname),this.nicknameControl.enable()}),i.pipe((0,ae.w)(s=>this.privUser.doc(s.uid).valueChanges()),(0,P.R)(this.destroy$)).subscribe(s=>{this.userPrivate$.next(s)}),i.pipe((0,P.R)(this.destroy$)).subscribe(s=>{this.emailControl.setValue(s.email)})}ngOnDestroy(){this.destroy$.next()}get emailControl(){return this.inputForm.get("email")}get passwordControl(){return this.inputForm.get("password")}get aboutControl(){return this.inputForm.get("about")}get nicknameControl(){return this.inputForm.get("nickname")}get userIconControl(){return this.inputForm.get("userIcon")}onClickDeleteAccount(i){this.dialog.createDefaultBuilder().prepareBody(oe).setType(q.iR.Warn).setSize(q.PW.Default).setTitle("\u6700\u7d42\u78ba\u8a8d").okButton(()=>{this.doDeleteAccount()}).cancelButton(()=>{}).open()}doDeleteAccount(){var i=this;return(0,N.Z)(function*(){try{yield i.currentUser.delete(),(0,m.eM)("Account is deleted")}catch(d){(0,m.wb)("Error while delete account",d);const C=d instanceof Error?d.message:"Unknown error";return void i.toastr.error(`\u30a2\u30ab\u30a6\u30f3\u30c8\u3092\u524a\u9664\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002 ( ${C} )`)}i.localSession.unmarkLogin(),i.router.navigate(["/"])})()}updateError(i,s){(0,m.wb)(`Error while update tag:${i}`,s);const d=s instanceof Error?s.message:"Unknown error";this.toastr.error(`${i} \u306e\u66f4\u65b0\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002 ( ${d} )`)}updateSucceeded(i,s){this.toastr.success(`${i} \u3092 "${s}" \u306b\u66f4\u65b0\u3057\u307e\u3057\u305f\u3002`)}updateProfileImage(i){var s=this;return(0,N.Z)(function*(){if(""===i)return;const d="\u30d7\u30ed\u30d5\u30a3\u30fc\u30eb\u753b\u50cf";try{yield s.currentUser.updateProfile({photoURL:i});const E={photoURL:i,updatedAt:le.Z.firestore.FieldValue.serverTimestamp()};yield s.pubUser.doc(s.currentUser.uid).update(E),s.updateSucceeded(d,"Upload \u3057\u305f\u753b\u50cf"),s.getProfileRef("temp_profile").delete(),s.profileTempImage$=null,s.userIconControl.setValue(""),D(s.userIconControl)}catch(C){s.updateError(d,C)}})()}onClickUpdateNickname(i){var s=this;return(0,N.Z)(function*(){if(s.nicknameControl.invalid)return;const d=s.nicknameControl.value;if(d===s.userPublic.nickname)return;const C="\u30cb\u30c3\u30af\u30cd\u30fc\u30e0";try{const E={nickname:d};s.nicknameResult=yield s.funcs.call("updateNickname",E),s.updateSucceeded(C,d),D(s.nicknameControl)}catch(E){s.updateError(C,E)}})()}onClickUpdateAbout(i){var s=this;return(0,N.Z)(function*(){if(s.aboutControl.invalid)return;const d=s.aboutControl.value;if(d===s.userPublic.about)return;const C="\u81ea\u5df1\u7d39\u4ecb";try{const E={about:d};yield s.funcs.call("updateAbout",E),s.updateSucceeded(C,d),D(s.aboutControl)}catch(E){s.updateError(C,E)}})()}onClickUpdateEmail(i){var s=this;return(0,N.Z)(function*(){if(s.emailControl.invalid)return;const d=s.emailControl.value;d!==s.currentUser.email&&s.dialog.createSimpleBuilder().setType(q.iR.Warn).setSize(q.PW.Default).setMessage("\u767b\u9332\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u3092\u5909\u66f4\u3057\u307e\u3059\u3002\u3088\u308d\u3057\u3044\u3067\u3059\u304b\uff1f").setTitle("\u78ba\u8a8d").okButton(()=>{s.doChangeEmail(d)}).cancelButton(()=>{}).open()})()}doChangeEmail(i){var s=this;return(0,N.Z)(function*(){const d="Email";try{yield s.currentUser.updateEmail(i),yield s.currentUser.sendEmailVerification(),s.updateSucceeded(d,i),D(s.emailControl),s.toastr.info("\u78ba\u8a8d\u306e\u30e1\u30fc\u30eb\u3092\u9001\u4fe1\u3057\u307e\u3057\u305f\u3002")}catch(C){s.updateError(d,C)}})()}onClickUpdatePassword(i){var s=this;return(0,N.Z)(function*(){if(s.passwordControl.invalid)return;const d=s.passwordControl.value;if(""===d)return;const C="\u30d1\u30b9\u30ef\u30fc\u30c9";try{yield s.currentUser.updatePassword(d),s.updateSucceeded(C,"********"),D(s.passwordControl)}catch(E){s.updateError(C,E)}finally{s.passwordControl.setValue("")}})()}listProvider(){}ensureImageFile(){const i=this.imageBox.nativeElement;if(0===i.files.length)return this.toastr.error("\u30d5\u30a1\u30a4\u30eb\u3092\u9078\u629e\u3057\u3066\u304f\u3060\u3055\u3044\u3002"),null;const s=i.files[0];return s.size>=524288?(this.toastr.error("\u30d5\u30a1\u30a4\u30eb\u306e\u30b5\u30a4\u30ba\u304c\u5927\u304d\u3059\u304e\u307e\u3059\u3002(\u7d04 500kb \u307e\u3067)"),null):s}getProfileRef(i){return this.storage.ref(`/image/${this.currentUser.uid}/profile/${i}`)}onClickUploadImage(i){var s=this;return(0,N.Z)(function*(){const d=s.ensureImageFile();if(!d)return;const C=yield s.uploadProfileImage("temp_profile",d);s.profileTempImage$=C.ref.getDownloadURL()})()}uploadProfileImage(i,s){var d=this;return(0,N.Z)(function*(){return yield d.getProfileRef(i).put(s)})()}doChangePhoto(i){var s=this;return(0,N.Z)(function*(){const C=yield(yield s.uploadProfileImage("profile",i)).ref.getDownloadURL();s.updateProfileImage(C)})()}initializeReauth(i){i.currentUser=this.currentUser,i.reauthed.subscribe(()=>{new x.UO(this.protectedSettings.nativeElement).show(),this.isOpenOther=!0})}constructReauth(){return i=>{}}onClickImportant(i){(0,m.eM)("onClickImportant()"),this.dialog.createDefaultBuilder().prepareBody(K,d=>this.initializeReauth(d)).setupChild(this.constructReauth()).setType(q.iR.Info).setSize(q.PW.Default).setTitle("\u518d\u8a8d\u8a3c").cancelButton(()=>{}).closeButton(()=>{}).open()}onClickOkImage(i,s){const d=this.ensureImageFile();d&&this.dialog.createSimpleBuilder().setType(q.iR.Info).setSize(q.PW.Default).setMessage("\u753b\u50cf\u306f\u516c\u958b\u3055\u308c\u307e\u3059\u3002\u3088\u308d\u3057\u3044\u3067\u3059\u304b\uff1f").setTitle("\u78ba\u8a8d").okButton(()=>{this.doChangePhoto(d)}).cancelButton(()=>{}).open()}static \u0275fac=function(s){return new(s||l)(e.Y36(X.e),e.Y36(ce.Q1),e.Y36(Ze.c),e.Y36(te.ST),e.Y36(b._W),e.Y36(Ve.Z),e.Y36(q.xA),e.Y36(Me.m))};static \u0275cmp=e.Xpm({type:l,selectors:[["ng-component"]],viewQuery:function(s,d){if(1&s&&(e.Gf(ht,5),e.Gf(Dt,5)),2&s){let C;e.iGM(C=e.CRH())&&(d.protectedSettings=C.first),e.iGM(C=e.CRH())&&(d.imageBox=C.first)}},decls:1,vars:1,consts:[[4,"ngIf"],[1,"container"],[3,"formGroup"],["configForm",""],[1,"mb-3"],["title","\u4e00\u822c\u516c\u958b\u3055\u308c\u308b\u60c5\u5831\u3092\u7de8\u96c6\u3067\u304d\u307e\u3059\u3002","src","/assets/octicons/question.svg",1,"m-3","octicon-info","help-icon"],[1,"my-2"],[1,"input-group","my-1"],[1,"visually-hidden"],["noPhoto",""],["class","user-settings-profile-image rounded","alt","Profile \u753b\u50cf",3,"src",4,"ngIf","ngIfElse"],[1,"input-group"],["id","appGitfireInputIconFileInput","name","userIcon","formControlName","userIcon","type","file","placeholder","\u30a2\u30a4\u30b3\u30f3\u3092\u9078\u629e","accept","image/*",1,"form-control"],["imageBox",""],[1,"btn","btn-primary",3,"disabled","click"],[1,"input-group","my-2"],[1,"input-group-text"],["title","\u30e1\u30c3\u30bb\u30fc\u30b8\u4e0a\u306b\u8868\u793a\u3055\u308c\u308b\u3042\u306a\u305f\u306e\u540d\u524d\u3067\u3059\u3002","src","/assets/octicons/question.svg",1,"m-1","octicon-info","help-icon"],["name","nickname","placeholder","\u4f8b: hogehoge1032","formControlName","nickname","autofocus","","type","text","maxlength","19","minlength","4","required","",1,"form-control"],["class","valid-feedback",4,"ngIf"],["title","\u30d5\u30ea\u30fc\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u3067\u3059\u3002","src","/assets/octicons/question.svg",1,"m-1","octicon-info","help-icon"],["name","about","placeholder","\u4f8b: Ingress: kagura2718 (RES) \u30dd\u30b1\u30e2\u30f3go: kagura271(\u8d64)","formControlName","about","maxlength","200","type","text",1,"form-control"],["type","button",1,"btn","btn-primary",3,"disabled","click"],["role","button","aria-expanded","false",1,"btn","btn-secondary","collapsed",3,"click"],["id","appGitfireUserSettingsSecretContainer",1,"collapse","m-3"],["protectedSettings",""],[1,"row","input-group","m-3"],[1,"col-2","text-md-end","col-form-label"],["title","\u8a8d\u8a3c\u30d7\u30ed\u30d0\u30a4\u30c0\u304b\u3089\u63d0\u4f9b\u3055\u308c\u305f\u540d\u524d\u3067\u3059\u3002(\u975e\u516c\u958b)","src","/assets/octicons/question.svg",1,"m-1","octicon-info","help-icon"],["name","displayname","placeholder","\u4f8b: hogehoge1032","type","text","disabled","",1,"col-10","form-control",3,"value"],["title","\u8a8d\u8a3c\u306b\u4f7f\u308f\u308c\u308b\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u3067\u3059\u3002(\u975e\u516c\u958b)","src","/assets/octicons/question.svg",1,"m-1","octicon-info","help-icon"],["name","email","placeholder","email@example.com","formControlName","email","autocomplete","email","type","email","required","","autofill","","maxlength","1024","minlength","5",1,"col-8","form-control"],[1,"btn","btn-primary","col-2",3,"disabled","click"],["title","\u30ed\u30b0\u30a4\u30f3\u6642\u306e\u30d1\u30b9\u30ef\u30fc\u30c9\u3067\u3059\u3002\u4ed6\u4eba\u306b\u63a8\u6e2c\u3055\u308c\u306a\u3044\u3082\u306e\u3092\u4f7f\u7528\u3057\u3066\u304f\u3060\u3055\u3044\u3002(\u975e\u516c\u958b)","src","/assets/octicons/question.svg",1,"m-1","octicon-info","help-icon"],["name","password","placeholder","\u5909\u66f4\u306a\u3057","formControlName","password","type","password","autocomplete","new-password","maxlength","256","minlength","6",1,"col-8","form-control"],[1,"col-lg-5","col-form-label",3,"passwordToCheck","barLabel","strengthLabels","barColors"],[1,"m-3"],[1,"input-group","m-3"],["tabindex","-1",1,"btn","btn-warning",3,"click"],["alt","Profile \u753b\u50cf",1,"user-settings-profile-image","rounded",3,"src"],[1,"p-3"],["alt","\u65b0\u3057\u3044 Profile \u753b\u50cf",1,"user-settings-profile-image","rounded",3,"src"],[1,"btn","btn-primary",3,"click"],[1,"valid-feedback"],["class","invalid-feedback",4,"ngIf"],[1,"invalid-feedback"],[3,"mainForm","userPrivStore$"]],template:function(s,d){1&s&&e.YNc(0,ct,77,41,"ng-container",0),2&s&&e.Q6J("ngIf",d.currentUser)},dependencies:[S.O5,r._Y,r.Fj,r.JJ,r.JL,r.Q7,r.wO,r.nD,r.sg,r.u,I.e,kt,S.Ov],styles:[".user-settings-profile-image[_ngcontent-%COMP%]{width:80px;height:80px}.help-icon[_ngcontent-%COMP%]{width:20px;height:20px}"]})}return l})();function bt(l,R){if(1&l&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&l){const i=e.oxw().$implicit;e.xp6(),e.hij("URL: ",i.url,"")}}function Nt(l,R){if(1&l&&(e.TgZ(0,"div")(1,"div")(2,"div"),e._uU(3),e.qZA(),e.YNc(4,bt,2,1,"div",0),e.TgZ(5,"div"),e._uU(6),e.qZA(),e.TgZ(7,"div"),e._uU(8),e.ALo(9,"date"),e.qZA()(),e._UZ(10,"hr"),e.TgZ(11,"div"),e._uU(12),e.qZA()()),2&l){const i=R.$implicit;e.xp6(3),e.hij("Title: ",i.title,""),e.xp6(),e.Q6J("ngIf",i.url),e.xp6(2),e.hij("Done: ",i.hasRead,""),e.xp6(2),e.hij("Date: ",e.xi3(9,5,i.createdAt.toDate(),"yyyy-MM-dd hh:mm:ss"),""),e.xp6(4),e.Oqu(i.body)}}let Tt=(()=>{class l{auth;route;store;destroy$=new _.x;id$;trayStore;constructor(i,s,d){this.auth=i,this.route=s,this.store=d}ngOnDestroy(){this.destroy$.next()}ngOnInit(){(0,m.eM)("UserTrayMessageComponent.OnInit()",this.route.snapshot),this.id$=this.route.queryParams.pipe((0,O.h)(i=>"id"in i),(0,we.U)(i=>i.id)),this.id$.pipe((0,ae.w)(i=>(0,ke.a)((0,be.of)(i),this.auth.clientSideUser$)),(0,O.h)(([i,s])=>null!==s),(0,ae.w)(([i,s])=>this.store.doc(`/users/v1/protected/${s.uid}/tray/${i}`).valueChanges({idField:"id"}).pipe((0,k.q)(1))),(0,P.R)(this.destroy$)).subscribe(i=>{this.trayStore=i})}static \u0275fac=function(s){return new(s||l)(e.Y36(X.e),e.Y36(U.gz),e.Y36(te.ST))};static \u0275cmp=e.Xpm({type:l,selectors:[["app-user-tray-message"]],decls:1,vars:1,consts:[[4,"ngIf"]],template:function(s,d){1&s&&e.YNc(0,Nt,13,8,"div",0),2&s&&e.Q6J("ngIf",d.trayStore)},dependencies:[S.O5,S.uU]})}return l})(),c=(()=>{class l{auth;localSession;router;constructor(i,s,d){this.auth=i,this.localSession=s,this.router=d,(0,m.eM)("AuthGuard.constructor")}canActivate(i,s){return this.auth.clientSideUser$.pipe((0,we.U)(d=>{if((0,m.H_)("AuthGuard",d),d)return!0;const C={queryParams:{redirectPath:s.url}};return(0,m.eM)("auth.guard Prepare to redirect",C),this.router.createUrlTree(["/Gitfire/login"],C)}))}static \u0275fac=function(s){return new(s||l)(e.LFG(X.e),e.LFG(Me.m),e.LFG(U.F0))};static \u0275prov=e.Yz7({token:l,factory:l.\u0275fac,providedIn:"root"})}return l})(),h=(()=>{class l{auth;localSession;router;constructor(i,s,d){this.auth=i,this.localSession=s,this.router=d}canActivate(i,s){return this.auth.authState.pipe((0,we.U)(d=>((0,m.H_)("LoginGuard",d),!d||this.router.createUrlTree(["/"]))))}static \u0275fac=function(s){return new(s||l)(e.LFG(pe.zQ),e.LFG(Me.m),e.LFG(U.F0))};static \u0275prov=e.Yz7({token:l,factory:l.\u0275fac,providedIn:"root"})}return l})();const F=[{path:"login.htm",loadChildren:()=>Promise.resolve().then(g.bind(g,3128)).then(l=>l.GitfireLoginModule),data:{mode:"login"},canActivate:[h]},{path:"login",redirectTo:"login.htm"},{path:"signup.htm",loadChildren:()=>Promise.resolve().then(g.bind(g,3128)).then(l=>l.GitfireLoginModule),data:{mode:"signup"},canActivate:[h]},{path:"signup",redirectTo:"signup.htm"},{path:"reset.htm",loadChildren:()=>Promise.resolve().then(g.bind(g,3128)).then(l=>l.GitfireLoginModule),data:{mode:"reset"}},{path:"reset",redirectTo:"reset.htm"},{path:"chat.htm",loadChildren:()=>Promise.all([g.e(592),g.e(918)]).then(g.bind(g,5918)).then(l=>l.GitfireChatModule),canActivate:[c]},{path:"chat",redirectTo:"chat.htm"},{path:"post.htm",loadChildren:()=>g.e(284).then(g.bind(g,3284)).then(l=>l.GitfirePostModule),canActivate:[c]},{path:"post",redirectTo:"post.htm"},{path:"settings.htm",component:Mt,canActivate:[c]},{path:"settings",redirectTo:"settings.htm"},{path:"tray.htm",component:Tt,canActivate:[c]},{path:"tray",redirectTo:"tray.htm"}];let Z=(()=>{class l{static \u0275fac=function(s){return new(s||l)};static \u0275mod=e.oAB({type:l});static \u0275inj=e.cJS({imports:[U.Bz.forChild(F),U.Bz]})}return l})();var J=g(3128),u=g(1134),f=g(6450),A=g(7910);let $=(()=>{class l{static \u0275fac=function(s){return new(s||l)};static \u0275mod=e.oAB({type:l});static \u0275inj=e.cJS({providers:[A.K,f.F],imports:[S.ez,r.u5,r.UX,u.M]})}return l})();var re=g(5101);let ee=(()=>{class l{constructor(){(0,m.H_)("Dynamically loaded GitfireModule")}static \u0275fac=function(s){return new(s||l)};static \u0275mod=e.oAB({type:l});static \u0275inj=e.cJS({providers:[b._W,X.e,c,h,Ze.c,{provide:ue.Xz,useValue:m.NZ.FirebaseCloudFunctionsRegion},{provide:ne,useValue:m.NZ.firebaseVapidKey}],imports:[S.ez,r.u5,r.UX,Z,J.GitfireLoginModule,$,I._,b.Rh.forRoot(m.NZ.toastrConfig),Q.hO.initializeApp(m.NZ.firebaseConfig),te.yb,pe.ww,ce.TE,ue.Qv,T,re.R]})}return l})()},3128:(St,Ue,g)=>{g.r(Ue),g.d(Ue,{GitfireLoginModule:()=>U});var S=g(6814),r=g(5739),Q=g(7217),ue=g(6622),te=g(434),pe=g(2425),ce=g(5187),N=g(553),e=g(9212),He=g(8645),Ae=g(8337);let be=(()=>{class _{router;destroy$=new He.x;constructor(k){this.router=k}ngOnInit(){(0,N.eM)("LoginComponent.OnInit()")}ngOnDestroy(){this.destroy$.next()}static \u0275fac=function(O){return new(O||_)(e.Y36(ce.F0))};static \u0275cmp=e.Xpm({type:_,selectors:[["gitfire-login"]],decls:12,vars:1,consts:[[1,"h3","mb-3","fw-normal"],[3,"isLogin"],["routerLink","/Gitfire/signup"],["routerLink","/Gitfire/reset"],["routerLink","/"]],template:function(O,m){1&O&&(e.TgZ(0,"h1",0),e._uU(1,"\u30ed\u30b0\u30a4\u30f3\u60c5\u5831"),e.qZA(),e._UZ(2,"gitfire-login-input-auth",1),e.TgZ(3,"div")(4,"a",2),e._uU(5,"\u30a2\u30ab\u30a6\u30f3\u30c8\u3092\u4f5c\u6210\u3059\u308b"),e.qZA()(),e.TgZ(6,"div")(7,"a",3),e._uU(8,"\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u5fd8\u308c\u305f\u5834\u5408"),e.qZA()(),e.TgZ(9,"div")(10,"a",4),e._uU(11,"Top"),e.qZA()()),2&O&&(e.xp6(2),e.Q6J("isLogin",!0))},dependencies:[ce.rH,Ae.InputAuthComponent]})}return _})();var he=g(3867);const Pe=["app-cookie-confirm",""];function Le(_,P){if(1&_){const k=e.EpF();e.TgZ(0,"button",4),e.NdJ("click",function(){e.CHM(k);const m=e.oxw();return e.KtG(m.remove())}),e.TgZ(1,"span",5),e._uU(2,"\xd7"),e.qZA()()}}let V=(()=>{class _ extends pe.FN{toastr;toastPackage;localSession;constructor(k,O,m){super(k,O),this.toastr=k,this.toastPackage=O,this.localSession=m}ngOnInit(){(0,N.eM)("CookieConfirmComponent.OnInit()")}onClickDeny(k){this.localSession.declineAccess(),this.remove()}onClickGrant(k){this.localSession.grantAccess(),this.remove()}static \u0275fac=function(O){return new(O||_)(e.Y36(pe._W),e.Y36(pe.PR),e.Y36(he.m))};static \u0275cmp=e.Xpm({type:_,selectors:[["","app-cookie-confirm",""]],features:[e.qOj],attrs:Pe,decls:12,vars:4,consts:[["class","toast-close-button","aria-label","Close",3,"click",4,"ngIf"],["role","alertdialog","aria-live","polite"],["href","/terms.htm"],[1,"btn","btn-outline-primary",3,"click"],["aria-label","Close",1,"toast-close-button",3,"click"],["aria-hidden","true"]],template:function(O,m){1&O&&(e.YNc(0,Le,3,0,"button",0),e.TgZ(1,"div",1)(2,"p"),e._uU(3,"\u5f53\u30b5\u30a4\u30c8\u3067\u306f\u5229\u7528\u8005\u306e\u5229\u4fbf\u6027\u306e\u305f\u3081\u306b\u30af\u30c3\u30ad\u30fc (Cookies) \u3092\u4f7f\u7528\u3057\u307e\u3059\u3002\u8a73\u3057\u304f\u306f"),e.TgZ(4,"a",2),e._uU(5," [\u5229\u7528\u898f\u7d04] "),e.qZA(),e._uU(6,"\u3092\u3054\u89a7\u304f\u3060\u3055\u3044\u3002"),e.qZA(),e.TgZ(7,"div")(8,"button",3),e.NdJ("click",function(se){return m.onClickGrant(se)}),e._uU(9,"\u8a31\u53ef\u3059\u308b"),e.qZA(),e.TgZ(10,"button",3),e.NdJ("click",function(se){return m.onClickDeny(se)}),e._uU(11,"\u62d2\u5426\u3059\u308b"),e.qZA()()()),2&O&&(e.Q6J("ngIf",m.options.closeButton),e.xp6(),e.Tol(m.options.messageClass),e.uIk("aria-label",m.message))},styles:["[_nghost-%COMP%]{background:#eefef0;width:100%;height:100%}a[_ngcontent-%COMP%]:link{color:red}a[_ngcontent-%COMP%]:visited{color:#a00}a[_ngcontent-%COMP%]:hover{color:red}a[_ngcontent-%COMP%]:active{color:#ff8000}"]})}return _})(),ie=(()=>{class _{toastr;localSession;constructor(k,O){this.toastr=k,this.localSession=O}ngOnInit(){(0,N.eM)("SignupComponent.OnInit()")}ngAfterViewInit(){this.maybeConfirm()}maybeConfirm(){this.localSession.shouldConfirm()&&this.toastr.info(void 0,void 0,{toastComponent:V,disableTimeOut:!0,tapToDismiss:!1,preventDuplicates:!0})}static \u0275fac=function(O){return new(O||_)(e.Y36(pe._W),e.Y36(he.m))};static \u0275cmp=e.Xpm({type:_,selectors:[["gitfire-signup"]],decls:9,vars:1,consts:[[1,"h3","mb-3","fw-normal"],[3,"isSignup"],["routerLink","/Gitfire/login"],["routerLink","/"]],template:function(O,m){1&O&&(e.TgZ(0,"h1",0),e._uU(1,"\u30a2\u30ab\u30a6\u30f3\u30c8\u306e\u4f5c\u6210"),e.qZA(),e._UZ(2,"gitfire-login-input-auth",1),e.TgZ(3,"div")(4,"a",2),e._uU(5,"\u30ed\u30b0\u30a4\u30f3"),e.qZA()(),e.TgZ(6,"div")(7,"a",3),e._uU(8,"Top"),e.qZA()()),2&O&&(e.xp6(2),e.Q6J("isSignup",!0))},dependencies:[ce.rH,Ae.InputAuthComponent]})}return _})();var ae=g(5861),we=g(7319),W=g(103);const H=["resetForm"];function Oe(_,P){1&_&&(e.TgZ(0,"div",11),e._uU(1,"E \u30e1\u30fc\u30eb\u306f\u5fc5\u9808\u3067\u3059\u3002"),e.qZA())}function Ie(_,P){1&_&&(e.TgZ(0,"div",11),e._uU(1,"E \u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044\u3002"),e.qZA())}function $e(_,P){if(1&_&&(e.ynx(0),e.YNc(1,Oe,2,0,"div",10)(2,Ie,2,0,"div",10),e.BQk()),2&_){e.oxw();const k=e.MAs(6);e.xp6(),e.Q6J("ngIf",null==k.errors?null:k.errors.required),e.xp6(),e.Q6J("ngIf",null==k.errors?null:k.errors.minlength)}}let le=(()=>{class _{auth;dialog;toastr;emailInput="";resetForm;constructor(k,O,m){this.auth=k,this.dialog=O,this.toastr=m}ngOnInit(){(0,N.eM)("ResetPasswordComponent.OnInit()")}onClickReset(k){this.dialog.createSimpleBuilder().setType(we.iR.Warn).setSize(we.PW.Default).setTitle("\u78ba\u8a8d").setMessage(`\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u306f\u6b63\u3057\u3044\u3067\u3059\u304b\uff1f ${this.emailInput}`).okButton(()=>{this.tryResetPassword(this.emailInput)}).cancelButton(()=>{}).open()}tryResetPassword(k){var O=this;return(0,ae.Z)(function*(){try{yield O.auth.sendPasswordResetEmail(k),O.toastr.info("\u30e1\u30fc\u30eb\u3092\u9001\u4fe1\u3057\u307e\u3057\u305f\u3002")}catch(m){(0,N.wb)("Error while sent reset mail",m),Error,O.toastr.error("\u5931\u6557\u3057\u307e\u3057\u305f\u3002( ${errmsg} )")}})()}static \u0275fac=function(O){return new(O||_)(e.Y36(te.zQ),e.Y36(W.xA),e.Y36(pe._W))};static \u0275cmp=e.Xpm({type:_,selectors:[["gitfire-login-reset-password"]],viewQuery:function(O,m){if(1&O&&e.Gf(H,5),2&O){let q;e.iGM(q=e.CRH())&&(m.resetForm=q.first)}},decls:19,vars:5,consts:[["resetForm",""],[1,"row","p-3"],[1,"visually-hidden"],["autofocus","","type","email","name","email","placeholder","Email address","required","","autofill","","maxlength","1024","minlength","5",1,"form-control","col-8",3,"ngModel","ngModelChange"],["email","ngModel"],[1,"btn","btn-warning",3,"disabled","click"],[4,"ngIf"],["routerLink","/"],["routerLink","/Gitfire/signup"],["routerLink","/Gitfire/login"],["class","invalid-feedback",4,"ngIf"],[1,"invalid-feedback"]],template:function(O,m){if(1&O&&(e.TgZ(0,"form",null,0)(2,"div",1)(3,"label",2),e._uU(4,"Email"),e.qZA(),e.TgZ(5,"input",3,4),e.NdJ("ngModelChange",function(se){return m.emailInput=se}),e.qZA(),e.TgZ(7,"button",5),e.NdJ("click",function(se){return m.onClickReset(se)}),e._uU(8,"\u30d1\u30b9\u30ef\u30fc\u30c9\u30ea\u30bb\u30c3\u30c8"),e.qZA(),e.YNc(9,$e,3,2,"ng-container",6),e.qZA()(),e.TgZ(10,"div")(11,"a",7),e._uU(12,"Top"),e.qZA()(),e.TgZ(13,"div")(14,"a",8),e._uU(15,"\u30a2\u30ab\u30a6\u30f3\u30c8\u3092\u4f5c\u6210\u3059\u308b"),e.qZA()(),e.TgZ(16,"div")(17,"a",9),e._uU(18,"\u30ed\u30b0\u30a4\u30f3"),e.qZA()()),2&O){const q=e.MAs(6);e.xp6(2),e.ekj("was-validated",q.dirty||q.touched),e.xp6(3),e.Q6J("ngModel",m.emailInput),e.xp6(2),e.Q6J("disabled",!q.valid),e.xp6(2),e.Q6J("ngIf",q.invalid)}},dependencies:[S.O5,r._Y,r.Fj,r.JJ,r.JL,r.Q7,r.wO,r.nD,r.On,r.F,ce.rH]})}return _})();function De(_,P){1&_&&e._UZ(0,"gitfire-signup")}function ne(_,P){1&_&&e._UZ(0,"gitfire-login")}function Be(_,P){1&_&&e._UZ(0,"gitfire-login-reset-password")}const T=[{path:"",component:(()=>{class _{route;mode;constructor(k){this.route=k,this.mode=k.snapshot.data.mode}ngOnInit(){(0,N.eM)("LoginRouterComponent.OnInit()")}static \u0275fac=function(O){return new(O||_)(e.Y36(ce.gz))};static \u0275cmp=e.Xpm({type:_,selectors:[["ng-component"]],decls:4,vars:4,consts:[[3,"ngSwitch"],[4,"ngSwitchCase"]],template:function(O,m){1&O&&(e.ynx(0,0),e.YNc(1,De,1,0,"gitfire-signup",1)(2,ne,1,0,"gitfire-login",1)(3,Be,1,0,"gitfire-login-reset-password",1),e.BQk()),2&O&&(e.Q6J("ngSwitch",m.mode),e.xp6(),e.Q6J("ngSwitchCase","signup"),e.xp6(),e.Q6J("ngSwitchCase","login"),e.xp6(),e.Q6J("ngSwitchCase","reset"))},dependencies:[S.RF,S.n9,be,ie,le]})}return _})()}];let b=(()=>{class _{static \u0275fac=function(O){return new(O||_)};static \u0275mod=e.oAB({type:_});static \u0275inj=e.cJS({imports:[ce.Bz.forChild(T),ce.Bz]})}return _})();var I=g(2589);let U=(()=>{class _{static \u0275fac=function(O){return new(O||_)};static \u0275mod=e.oAB({type:_});static \u0275inj=e.cJS({providers:[pe._W],imports:[S.ez,r.u5,r.UX,b,pe.Rh.forRoot(N.NZ.toastrConfig),Q.hO.initializeApp(N.NZ.firebaseConfig),ue.yb,te.ww,I._]})}return _})()},8337:(St,Ue,g)=>{g.r(Ue),g.d(Ue,{InputAuthComponent:()=>Ge});var S=g(5861),r=g(9212),Q=g(5739),ue=g(8645),te=g(5619),pe=g(2459),ce=g(9773),N=g(8180),e=g(7142),Ae=(g(752),g(553)),be=g(434),he=g(2425),Pe=g(5187),Le=g(6814),V=g(2589),ie=g(9240);const ae=["mainForm"],we=["confirmPasswordInput"];function W(B,K){1&B&&(r.TgZ(0,"div",15),r._uU(1,"OK!"),r.qZA())}function H(B,K){1&B&&(r.TgZ(0,"div",17),r._uU(1,"E \u30e1\u30fc\u30eb\u306f\u5fc5\u9808\u3067\u3059\u3002"),r.qZA())}function Oe(B,K){1&B&&(r.TgZ(0,"div",17),r._uU(1,"E \u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044\u3002"),r.qZA())}function Ie(B,K){if(1&B&&(r.ynx(0),r.YNc(1,H,2,0,"div",16)(2,Oe,2,0,"div",16),r.BQk()),2&B){const x=r.oxw();r.xp6(),r.Q6J("ngIf",null==x.emailControl.errors?null:x.emailControl.errors.required),r.xp6(),r.Q6J("ngIf",null==x.emailControl.errors?null:x.emailControl.errors.minlength)}}function $e(B,K){1&B&&(r.TgZ(0,"div",15),r._uU(1,"\u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u5f37\u5ea6\u306f\u5145\u5206\u306b\u3057\u3066\u304f\u3060\u3055\u3044\u3002"),r.qZA())}function le(B,K){1&B&&(r.TgZ(0,"div",17),r._uU(1,"\u30d1\u30b9\u30ef\u30fc\u30c9\u306f\u5fc5\u9808\u3067\u3059\u3002"),r.qZA())}function De(B,K){1&B&&(r.TgZ(0,"div",17),r._uU(1,"\u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u9577\u3055\u304c\u8db3\u308a\u307e\u305b\u3093\u3002"),r.qZA())}function ne(B,K){if(1&B&&(r.ynx(0,18),r.YNc(1,le,2,0,"div",16)(2,De,2,0,"div",16),r.BQk()),2&B){const x=r.oxw();r.xp6(),r.Q6J("ngIf",null==x.passwordControl.errors?null:x.passwordControl.errors.required),r.xp6(),r.Q6J("ngIf",null==x.passwordControl.errors?null:x.passwordControl.errors.minlength)}}const Be=()=>["(\u5371\u967a)","(\u5f31\u3044)","(\u666e\u901a)","(\u5f37\u3044)","(\u5145\u5206\u306b\u5b89\u5168)"],y=()=>["#DD2C00","#FF6D00","#FFD600","#AEEA00","#00C853"];function T(B,K){if(1&B&&(r._UZ(0,"ng9-password-strength-bar",19),r.ALo(1,"async")),2&B){const x=r.oxw();r.Q6J("passwordToCheck",r.lcZ(1,4,x.passwordControl.valueChanges))("barLabel","\u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u5f37\u5ea6(\u76ee\u5b89): ")("strengthLabels",r.DdM(6,Be))("barColors",r.DdM(7,y))}}function b(B,K){1&B&&(r.TgZ(0,"div",15),r._uU(1,"\u4e00\u81f4\u3057\u307e\u3057\u305f\uff01"),r.qZA())}function I(B,K){1&B&&(r.TgZ(0,"div",17),r._uU(1,"\u30d1\u30b9\u30ef\u30fc\u30c9\u306f\u5fc5\u9808\u3067\u3059\u3002"),r.qZA())}function U(B,K){1&B&&(r.TgZ(0,"div",17),r._uU(1,"\u30d1\u30b9\u30ef\u30fc\u30c9\u304c\u4e00\u81f4\u3057\u307e\u305b\u3093\u3002"),r.qZA())}function _(B,K){if(1&B&&(r.ynx(0),r.YNc(1,I,2,0,"div",16)(2,U,2,0,"div",16),r.BQk()),2&B){const x=r.oxw(2);r.xp6(),r.Q6J("ngIf",null==x.confirmPasswordControl.errors?null:x.confirmPasswordControl.errors.required),r.xp6(),r.Q6J("ngIf",null==x.confirmPasswordControl.errors?null:x.confirmPasswordControl.errors.passwordMisMatch)}}function P(B,K){if(1&B&&(r.TgZ(0,"div",2)(1,"label",20),r._uU(2,"Confirm Password"),r.qZA(),r._UZ(3,"input",21,22),r.YNc(5,b,2,0,"div",5)(6,_,3,2,"ng-container",6),r.qZA()),2&B){const x=r.oxw();r.ekj("was-validated",x.confirmPasswordControl.dirty||x.confirmPasswordControl.touched),r.xp6(3),r.Q6J("autocomplete",x.passwordAutocomplete),r.xp6(2),r.Q6J("ngIf",!x.confirmPasswordControl.invalid),r.xp6(),r.Q6J("ngIf",x.confirmPasswordControl.invalid)}}function k(B,K){1&B&&(r.TgZ(0,"div",29),r._uU(1,"OK!"),r.qZA())}function O(B,K){1&B&&(r.TgZ(0,"div",31),r._uU(1,"\u898f\u7d04\u306b\u540c\u610f\u3057\u3066\u3044\u305f\u3060\u304f\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002"),r.qZA())}function m(B,K){if(1&B&&(r.ynx(0),r.YNc(1,O,2,0,"div",30),r.BQk()),2&B){const x=r.oxw(2);r.xp6(),r.Q6J("ngIf",null==x.agreeTosControl.errors?null:x.agreeTosControl.errors.required)}}function q(B,K){if(1&B&&(r.TgZ(0,"div",23)(1,"label",24),r._uU(2,"\u898f\u7d04\u306b\u540c\u610f\u3059\u308b"),r.qZA(),r._UZ(3,"input",25),r.TgZ(4,"a",26),r._uU(5," [\u5229\u7528\u898f\u7d04] "),r.qZA(),r.TgZ(6,"span",27),r._uU(7,"\u306b\u540c\u610f\u3057\u307e\u3059\u3002"),r.qZA(),r.YNc(8,k,2,0,"div",28)(9,m,2,1,"ng-container",6),r.qZA()),2&B){const x=r.oxw();r.ekj("was-validated",x.agreeTosControl.dirty||x.agreeTosControl.touched),r.xp6(8),r.Q6J("ngIf",!x.agreeTosControl.invalid),r.xp6(),r.Q6J("ngIf",x.agreeTosControl.invalid)}}function se(B,K){if(1&B){const x=r.EpF();r.TgZ(0,"button",32),r.NdJ("click",function(D){r.CHM(x);const X=r.oxw();return r.KtG(X.onClickSignup(D))}),r._uU(1,"\u30a2\u30ab\u30a6\u30f3\u30c8\u4f5c\u6210"),r.qZA()}if(2&B){const x=r.oxw();r.Q6J("disabled",!x.inputAuthForm.valid)}}function oe(B,K){if(1&B){const x=r.EpF();r.TgZ(0,"button",32),r.NdJ("click",function(D){r.CHM(x);const X=r.oxw();return r.KtG(X.onClickLogin(D))}),r._UZ(1,"img",33),r._uU(2,"\u30ed\u30b0\u30a4\u30f3"),r.qZA()}if(2&B){const x=r.oxw();r.Q6J("disabled",!x.inputAuthForm.valid)}}function me(B,K){if(1&B){const x=r.EpF();r.TgZ(0,"button",32),r.NdJ("click",function(D){r.CHM(x);const X=r.oxw();return r.KtG(X.onClickReauth(D))}),r._UZ(1,"img",33),r._uU(2,"\u518d\u8a8d\u8a3c"),r.qZA()}if(2&B){const x=r.oxw();r.Q6J("disabled",!x.inputAuthForm.valid)}}function Y(B,K){if(1&B){const x=r.EpF();r.TgZ(0,"app-oauth-federations",34),r.NdJ("loginSucceeded",function(){r.CHM(x);const D=r.oxw();return r.KtG(D.onOauthLoginSucceeded())})("loginFailed",function(D){r.CHM(x);const X=r.oxw();return r.KtG(X.onOauthLoginFailed(D))}),r.qZA()}}let Ge=(()=>{class B{auth;toastr;router;route;isLogin=!1;isReauth=!1;reauthUser=null;isSignup=!1;showFederations=!0;reauthed=new r.vpe;destroy$=new ue.x;inputAuthForm;loginUser$=new te.X(null);passwordAutocomplete;mainForm;confirmPasswordInput;constructor(x,L,D,X){this.auth=x,this.toastr=L,this.router=D,this.route=X}ngOnInit(){this.passwordAutocomplete=this.isSignup?"new-password":"current-password",this.inputAuthForm=new Q.cw({}),this.inputAuthForm.addControl("email",new Q.NI("")),this.inputAuthForm.addControl("password",new Q.NI("")),this.isSignup&&(this.inputAuthForm.addControl("retypePassword",new Q.NI("")),this.inputAuthForm.addControl("agreeTosCheck",new Q.NI(!1)),this.inputAuthForm.setValidators([this.validateXFPassword.bind(this)])),this.inputAuthForm.disable(),this.initializeAuthForm()}ngOnDestroy(){this.destroy$.next()}ngAfterViewInit(){this.auth.authState.pipe((0,ce.R)(this.destroy$)).subscribe(x=>{this.loginUser$.next(x)})}navigateAfterSucceeded(){this.route.queryParams.pipe((0,ce.R)(this.destroy$),(0,N.q)(1)).subscribe(x=>{const L=x.redirectPath;this.router.navigate(L?[L]:["/"])})}erroredConnected(x){(0,Ae.wb)("error while connecting account",x);const L=x instanceof Error?x.message:"Unknown error";this.toastr.error(`Login \u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002 \n ( ${L} )`)}loginSucceeded(){this.toastr.success("Login \u3057\u307e\u3057\u305f\u3002"),this.navigateAfterSucceeded()}connectSucceeded(x){this.toastr.success("Sign-up \u3057\u307e\u3057\u305f\u3002"),this.navigateAfterSucceeded()}get emailControl(){return this.inputAuthForm.get("email")}get passwordControl(){return this.inputAuthForm.get("password")}get confirmPasswordControl(){return this.inputAuthForm.get("retypePassword")}get agreeTosControl(){return this.inputAuthForm.get("agreeTosCheck")}validateXFPassword(x){const L=x.get("password"),D=x.get("retypePassword");return L.value!==D.value?(D.setErrors({passwordMisMatch:!0}),this.confirmPasswordInput&&this.confirmPasswordInput.nativeElement.setCustomValidity("create error state"),null):(this.confirmPasswordInput&&this.confirmPasswordInput.nativeElement.setCustomValidity(""),D.setErrors(null),null)}validateAuthForm(){return this.inputAuthForm.markAllAsTouched(),!this.inputAuthForm.invalid||((0,Ae.wb)("Assert! Button should be disabled."),!1)}initializeAuthForm(){(0,pe.D)(this.auth.setPersistence(e.Z.auth.Auth.Persistence.SESSION)).pipe((0,N.q)(1),(0,ce.R)(this.destroy$)).subscribe({next:()=>{this.inputAuthForm.enable()},error:x=>{this.toastr.error("\u8a8d\u8a3c Server \u3092\u521d\u671f\u5316\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002")}})}onClickSignup(x){var L=this;return(0,S.Z)(function*(){if(x.preventDefault(),L.validateAuthForm())try{const D=yield L.auth.createUserWithEmailAndPassword(L.emailControl.value,L.passwordControl.value);L.toastr.info("\u30a2\u30ab\u30a6\u30f3\u30c8\u3092\u4f5c\u6210\u3057\u307e\u3057\u305f\u3002\u30e1\u30fc\u30eb\u3092\u78ba\u8a8d\u3057\u3066\u304f\u3060\u3055\u3044\u3002"),yield D.user.sendEmailVerification(),L.navigateAfterSucceeded()}catch(D){(0,Ae.wb)("Error while reject",D);const X=D instanceof Error?D.message:"Unknown error";L.toastr.error(`\u30a2\u30ab\u30a6\u30f3\u30c8\u306e\u4f5c\u6210\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002\u6700\u521d\u304b\u3089\u3084\u308a\u76f4\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n ( ${X} )`)}})()}onClickLogin(x){var L=this;return(0,S.Z)(function*(){if(x.preventDefault(),L.validateAuthForm())try{yield L.auth.signInWithEmailAndPassword(L.emailControl.value,L.passwordControl.value),L.loginSucceeded()}catch(D){L.erroredConnected(D)}})()}onClickReauth(x){var L=this;return(0,S.Z)(function*(){if(x.preventDefault(),L.validateAuthForm())try{const D=e.Z.auth.EmailAuthProvider.credential(L.emailControl.value,L.passwordControl.value);yield L.reauthUser.reauthenticateWithCredential(D),L.reauthed.next()}catch(D){L.erroredConnected(D)}})()}onOauthLoginFailed(x){this.erroredConnected(x)}onOauthLoginSucceeded(){this.loginSucceeded()}static \u0275fac=function(L){return new(L||B)(r.Y36(be.zQ),r.Y36(he._W),r.Y36(Pe.F0),r.Y36(Pe.gz))};static \u0275cmp=r.Xpm({type:B,selectors:[["gitfire-login-input-auth"]],viewQuery:function(L,D){if(1&L&&(r.Gf(ae,5),r.Gf(we,5)),2&L){let X;r.iGM(X=r.CRH())&&(D.mainForm=X.first),r.iGM(X=r.CRH())&&(D.confirmPasswordInput=X.first)}},inputs:{isLogin:"isLogin",isReauth:"isReauth",reauthUser:"reauthUser",isSignup:"isSignup",showFederations:"showFederations"},outputs:{reauthed:"reauthed"},decls:22,vars:17,consts:[[3,"formGroup"],["mainForm",""],[1,"row","m-3"],["for","appGitfireLoginEmailInput",1,"visually-hidden"],["id","appGitfireLoginEmailInput","name","email","formControlName","email","placeholder","email@example.com","autocomplete","email","type","email","required","","autofill","","autofocus","","maxlength","1024","minlength","5",1,"form-control","col-12"],["class","valid-feedback",4,"ngIf"],[4,"ngIf"],["for","appGitfireLoginPasswordInput",1,"visually-hidden"],["id","appGitfireLoginPasswordInput","type","password","name","password","formControlName","password","placeholder","Password","required","","autofill","","maxlength","256","minlength","6",1,"form-control","col-12",3,"autocomplete"],["class"," ",4,"ngIf"],["class","col-12 m-3",3,"passwordToCheck","barLabel","strengthLabels","barColors",4,"ngIf"],["class","row m-3",3,"was-validated",4,"ngIf"],["class","row custom-control custom-checkbox m-5 text-center",3,"was-validated",4,"ngIf"],["class","btn btn-lg btn-primary btn-block",3,"disabled","click",4,"ngIf"],[3,"loginSucceeded","loginFailed",4,"ngIf"],[1,"valid-feedback"],["class","invalid-feedback",4,"ngIf"],[1,"invalid-feedback"],[1,""],[1,"col-12","m-3",3,"passwordToCheck","barLabel","strengthLabels","barColors"],["for","appGitfireSignupPasswordConfirmInput",1,"visually-hidden"],["id","appGitfireSignupPasswordConfirmInput","type","password","name","password_confirm","formControlName","retypePassword","placeholder","Confirm password","required","",1,"form-control","col-12",3,"autocomplete"],["confirmPasswordInput",""],[1,"row","custom-control","custom-checkbox","m-5","text-center"],["for","appGitfireAgreeTosCheck",1,"col-auto","visually-hidden"],["id","col-auto appGitfireAgreeTosCheck","formControlName","agreeTosCheck","type","checkbox","required","",1,"form-check-input"],["tabindex","-1","about","_blank","href","/terms.htm",1,"col-auto"],[1,"col-auto"],["class","valid-feedback col-auto",4,"ngIf"],[1,"valid-feedback","col-auto"],["class","invalid-feedback col-auto",4,"ngIf"],[1,"invalid-feedback","col-auto"],[1,"btn","btn-lg","btn-primary","btn-block",3,"disabled","click"],["src","/assets/octicons/sign-in.svg",1,"m-1","gitfire-link-icon","octicon-info"],[3,"loginSucceeded","loginFailed"]],template:function(L,D){1&L&&(r.TgZ(0,"form",0,1)(2,"div",2)(3,"label",3),r._uU(4,"Email"),r.qZA(),r._UZ(5,"input",4),r.YNc(6,W,2,0,"div",5)(7,Ie,3,2,"ng-container",6),r.qZA(),r.TgZ(8,"div",2)(9,"label",7),r._uU(10,"Password"),r.qZA(),r._UZ(11,"input",8),r.YNc(12,$e,2,0,"div",5)(13,ne,3,2,"ng-container",9)(14,T,2,8,"ng9-password-strength-bar",10),r.qZA(),r.YNc(15,P,7,5,"div",11)(16,q,10,4,"div",12),r.TgZ(17,"div",2),r.YNc(18,se,2,1,"button",13)(19,oe,3,1,"button",13)(20,me,3,1,"button",13),r.qZA(),r.YNc(21,Y,1,0,"app-oauth-federations",14),r.qZA()),2&L&&(r.Q6J("formGroup",D.inputAuthForm),r.xp6(2),r.ekj("was-validated",D.emailControl.dirty||D.emailControl.touched),r.xp6(4),r.Q6J("ngIf",!D.emailControl.invalid),r.xp6(),r.Q6J("ngIf",D.emailControl.invalid),r.xp6(),r.ekj("was-validated",D.passwordControl.dirty||D.passwordControl.touched),r.xp6(3),r.Q6J("autocomplete",D.passwordAutocomplete),r.xp6(),r.Q6J("ngIf",D.isSignup&&!D.passwordControl.invalid),r.xp6(),r.Q6J("ngIf",D.passwordControl.invalid),r.xp6(),r.Q6J("ngIf",D.isSignup),r.xp6(),r.Q6J("ngIf",D.isSignup),r.xp6(),r.Q6J("ngIf",D.isSignup),r.xp6(2),r.Q6J("ngIf",D.isSignup),r.xp6(),r.Q6J("ngIf",D.isLogin),r.xp6(),r.Q6J("ngIf",D.isReauth),r.xp6(),r.Q6J("ngIf",D.showFederations))},dependencies:[Le.O5,Q._Y,Q.Fj,Q.Wl,Q.JJ,Q.JL,Q.Q7,Q.wO,Q.nD,Q.Zs,Q.sg,Q.u,V.e,ie.x,Le.Ov]})}return B})()},1134:(St,Ue,g)=>{g.d(Ue,{M:()=>Q});var S=g(6814),r=g(9212);let Q=(()=>{class ue{static \u0275fac=function(ce){return new(ce||ue)};static \u0275mod=r.oAB({type:ue});static \u0275inj=r.cJS({imports:[S.ez]})}return ue})()},2589:(St,Ue,g)=>{function te(y,T,b,I){var P,U=arguments.length,_=U<3?T:null===I?I=Object.getOwnPropertyDescriptor(T,b):I;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)_=Reflect.decorate(y,T,b,I);else for(var k=y.length-1;k>=0;k--)(P=y[k])&&(_=(U<3?P(_):U>3?P(T,b,_):P(T,b))||_);return U>3&&_&&Object.defineProperty(T,b,_),_}g.d(Ue,{e:()=>ne,_:()=>Be});var De,le=g(9212);let ne=De=class{constructor(){this.onStrengthChanged=new le.vpe,this.defaultColors=["#F00","#F90","#FF0","#9F0","#0F0"],this.defaultThresholds=[90,70,40,20],this.defaultBaseColor="#DDD",this.colors=this.defaultColors,this.thresholds=this.defaultThresholds}static measureStrength(T){let b=0;const I={};for(let P=0;P<T.length;P++)I[T[P]]=(I[T[P]]||0)+1,b+=5/I[T[P]];const U={digits:/\d/.test(T),lower:/[a-z]/.test(T),upper:/[A-Z]/.test(T),nonWords:/\W/.test(T)};let _=0;for(let P in U)_+=U[P]?1:0;return b+=10*(_-1),Math.trunc(b)}checkBarColors(){this.colors=this.barColors&&5===this.barColors.length?this.barColors.slice():this.defaultColors,this.strengths=this.strengthLabels&&5===this.strengthLabels.length?this.strengthLabels.slice():null,this.setStrengthLabel(0),/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(this.baseColor)||(this.baseColor=this.defaultBaseColor)}checkThresholds(){this.thresholds=this.customThresholds&&4===this.customThresholds.length?this.customThresholds.slice():this.defaultThresholds}getColor(T){let b=0;return T>this.thresholds[0]?b=4:T>this.thresholds[1]?b=3:T>=this.thresholds[2]?b=2:T>=this.thresholds[3]&&(b=1),{idx:b+1,col:this.colors[b]}}getStrengthIndexAndColor(T){return this.getColor(De.measureStrength(T))}ngOnChanges(T){if(!T.passwordToCheck)return;const b=T.passwordToCheck.currentValue;this.checkBarColors(),this.checkThresholds(),this.setBarColors(5,this.baseColor);let I=0;if(b){const U=this.getStrengthIndexAndColor(b);I=U.idx-1,this.setStrengthLabel(I),this.setBarColors(U.idx,U.col)}this.onStrengthChanged.emit(I)}setBarColors(T,b){for(let I=0;I<T;I++)this["bar"+I]=b}setStrengthLabel(T){this.strengths&&(this.strengthLabel=this.strengths[T])}};te([(0,le.IIB)()],ne.prototype,"passwordToCheck",void 0),te([(0,le.IIB)()],ne.prototype,"barLabel",void 0),te([(0,le.IIB)()],ne.prototype,"barColors",void 0),te([(0,le.IIB)()],ne.prototype,"baseColor",void 0),te([(0,le.IIB)()],ne.prototype,"strengthLabels",void 0),te([(0,le.IIB)()],ne.prototype,"customThresholds",void 0),te([(0,le.r_U)()],ne.prototype,"onStrengthChanged",void 0),ne=De=te([(0,le.wA2)({selector:"ng9-password-strength-bar",template:'\n    <div id="strength" #strength>\n      <small>{{barLabel}}</small>\n      <ul id="strengthBar" class="strengthBar">\n        <li id="bar0" class="point" [style.background-color]="bar0"></li>\n        <li class="point" [style.background-color]="bar1"></li>\n        <li class="point" [style.background-color]="bar2"></li>\n        <li class="point" [style.background-color]="bar3"></li>\n        <li class="point" [style.background-color]="bar4"></li>\n      </ul>\n      <small [hidden]="!strengths" class="pre">  {{strengthLabel}}</small>\n    </div>\n  ',styles:["\n    .strengthBar {\n      display: inline;\n      list-style: none;\n      margin: 0 0 0 15px;\n      padding: 0;\n      vertical-align: 2px;\n    }\n\n    .strengthBar .point {\n      background: #DDD;\n      border-radius: 2px;\n      display: inline-block;\n      height: 5px;\n      margin-right: 1px;\n      width: 20px;\n    }\n\n    .strengthBar .point:last-child {\n      margin: 0;\n    }\n    .pre {\n      white-space: pre;\n    }\n  "]})],ne);let Be=(()=>{let y=class{};return y=te([(0,le.LVF)({declarations:[ne],imports:[],exports:[ne]})],y),y})()},8024:(St,Ue,g)=>{g.d(Ue,{Q1:()=>_n,TE:()=>io});var S=g(8326),r=g(5592),Q=g(2096),ue=g(2459),te=g(3620),pe=g(7398),ce=g(4664),N=g(9212),e=g(7217),He=g(8168),Ae=g(5861),be=g(9032),he=g(963),Pe=g(3427);const Le="firebasestorage.googleapis.com",V="storageBucket";class W extends he.ZR{constructor(t,o,a=0){super(Oe(t),`Firebase Storage: ${o} (${Oe(t)})`),this.status_=a,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,W.prototype)}get status(){return this.status_}set status(t){this.status_=t}_codeEquals(t){return Oe(t)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(t){this.customData.serverResponse=t,this.message=this.customData.serverResponse?`${this._baseMessage}\n${this.customData.serverResponse}`:this._baseMessage}}var H=function(n){return n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment",n}(H||{});function Oe(n){return"storage/"+n}function Ie(){return new W(H.UNKNOWN,"An unknown error occurred, please check the error payload for server response.")}function y(){return new W(H.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function T(){return new W(H.CANCELED,"User canceled the upload/download.")}function _(){return new W(H.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function m(n){return new W(H.INVALID_ARGUMENT,n)}function q(){return new W(H.APP_DELETED,"The Firebase app was deleted.")}function se(n){return new W(H.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function oe(n,t){return new W(H.INVALID_FORMAT,"String does not match format '"+n+"': "+t)}function me(n){throw new W(H.INTERNAL_ERROR,"Internal error: "+n)}class Y{constructor(t,o){this.bucket=t,this.path_=o}get path(){return this.path_}get isRoot(){return 0===this.path.length}fullServerUrl(){const t=encodeURIComponent;return"/b/"+t(this.bucket)+"/o/"+t(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(t,o){let a;try{a=Y.makeFromUrl(t,o)}catch{return new Y(t,"")}if(""===a.path)return a;throw function I(n){return new W(H.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}(t)}static makeFromUrl(t,o){let a=null;const p="([A-Za-z0-9.\\-_]+)",G=new RegExp("^gs://"+p+"(/(.*))?$","i");function j(Fe){Fe.path_=decodeURIComponent(Fe.path)}const Ce=o.replace(/[.]/g,"\\."),Se=[{regex:G,indices:{bucket:1,path:3},postModify:function v(Fe){"/"===Fe.path.charAt(Fe.path.length-1)&&(Fe.path_=Fe.path_.slice(0,-1))}},{regex:new RegExp(`^https?://${Ce}/v[A-Za-z0-9_]+/b/${p}/o(/([^?#]*).*)?$`,"i"),indices:{bucket:1,path:3},postModify:j},{regex:new RegExp(`^https?://${o===Le?"(?:storage.googleapis.com|storage.cloud.google.com)":o}/${p}/([^?#]*)`,"i"),indices:{bucket:1,path:2},postModify:j}];for(let Fe=0;Fe<Se.length;Fe++){const qt=Se[Fe],Jt=qt.regex.exec(t);if(Jt){let jt=Jt[qt.indices.path];jt||(jt=""),a=new Y(Jt[qt.indices.bucket],jt),qt.postModify(a);break}}if(null==a)throw function b(n){return new W(H.INVALID_URL,"Invalid URL '"+n+"'.")}(t);return a}}class Ge{constructor(t){this.promise_=Promise.reject(t)}getPromise(){return this.promise_}cancel(t=!1){}}function X(n){return"string"==typeof n||n instanceof String}function Ze(n){return Ve()&&n instanceof Blob}function Ve(){return typeof Blob<"u"}function Me(n,t,o,a){if(a<t)throw m(`Invalid value for '${n}'. Expected ${t} or greater.`);if(a>o)throw m(`Invalid value for '${n}'. Expected ${o} or less.`)}function ke(n,t,o){let a=t;return null==o&&(a=`https://${t}`),`${o}://${a}/v0${n}`}function qe(n){const t=encodeURIComponent;let o="?";for(const a in n)n.hasOwnProperty(a)&&(o=o+(t(a)+"=")+t(n[a])+"&");return o=o.slice(0,-1),o}var Ne=function(n){return n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT",n}(Ne||{});function Ye(n,t){const o=n>=500&&n<600,p=-1!==[408,429].indexOf(n),v=-1!==t.indexOf(n);return o||p||v}class lt{constructor(t,o,a,p,v,w,G,M,j,z,Ce,fe=!0){this.url_=t,this.method_=o,this.headers_=a,this.body_=p,this.successCodes_=v,this.additionalRetryCodes_=w,this.callback_=G,this.errorCallback_=M,this.timeout_=j,this.progressCallback_=z,this.connectionFactory_=Ce,this.retry=fe,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((ge,ye)=>{this.resolve_=ge,this.reject_=ye,this.start_()})}start_(){const o=(a,p)=>{const v=this.resolve_,w=this.reject_,G=p.connection;if(p.wasSuccessCode)try{const M=this.callback_(G,G.getResponse());!function x(n){return void 0!==n}(M)?v():v(M)}catch(M){w(M)}else if(null!==G){const M=Ie();M.serverResponse=G.getErrorText(),w(this.errorCallback_?this.errorCallback_(G,M):M)}else w(p.canceled?this.appDelete_?q():T():y())};this.canceled_?o(0,new ze(!1,null,!0)):this.backoffId_=function B(n,t,o){let a=1,p=null,v=null,w=!1,G=0;function M(){return 2===G}let j=!1;function z(...Te){j||(j=!0,t.apply(null,Te))}function Ce(Te){p=setTimeout(()=>{p=null,n(ge,M())},Te)}function fe(){v&&clearTimeout(v)}function ge(Te,...wt){if(j)return void fe();if(Te)return fe(),void z.call(null,Te,...wt);if(M()||w)return fe(),void z.call(null,Te,...wt);let Se;a<64&&(a*=2),1===G?(G=2,Se=0):Se=1e3*(a+Math.random()),Ce(Se)}let ye=!1;function et(Te){ye||(ye=!0,fe(),!j&&(null!==p?(Te||(G=2),clearTimeout(p),Ce(0)):Te||(G=1)))}return Ce(0),v=setTimeout(()=>{w=!0,et(!0)},o),et}((a,p)=>{if(p)return void a(!1,new ze(!1,null,!0));const v=this.connectionFactory_();this.pendingConnection_=v;const w=G=>{null!==this.progressCallback_&&this.progressCallback_(G.loaded,G.lengthComputable?G.total:-1)};null!==this.progressCallback_&&v.addUploadProgressListener(w),v.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{null!==this.progressCallback_&&v.removeUploadProgressListener(w),this.pendingConnection_=null;const G=v.getErrorCode()===Ne.NO_ERROR,M=v.getStatus();if(!G||Ye(M,this.additionalRetryCodes_)&&this.retry){const z=v.getErrorCode()===Ne.ABORT;return void a(!1,new ze(!1,null,z))}const j=-1!==this.successCodes_.indexOf(M);a(!0,new ze(j,v))})},o,this.timeout_)}getPromise(){return this.promise_}cancel(t){this.canceled_=!0,this.appDelete_=t||!1,null!==this.backoffId_&&function K(n){n(!1)}(this.backoffId_),null!==this.pendingConnection_&&this.pendingConnection_.abort()}}class ze{constructor(t,o,a){this.wasSuccessCode=t,this.connection=o,this.canceled=!!a}}function ht(...n){const t=function kt(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}();if(void 0!==t){const o=new t;for(let a=0;a<n.length;a++)o.append(n[a]);return o.getBlob()}if(Ve())return new Blob(n);throw new W(H.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}const _e={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class rt{constructor(t,o){this.data=t,this.contentType=o||null}}function Ke(n,t){switch(n){case _e.RAW:return new rt(it(t));case _e.BASE64:case _e.BASE64URL:return new rt(st(n,t));case _e.DATA_URL:return new rt(function xt(n){const t=new tt(n);return t.base64?st(_e.BASE64,t.rest):function gt(n){let t;try{t=decodeURIComponent(n)}catch{throw oe(_e.DATA_URL,"Malformed data URL.")}return it(t)}(t.rest)}(t),function nt(n){return new tt(n).contentType}(t))}throw Ie()}function it(n){const t=[];for(let o=0;o<n.length;o++){let a=n.charCodeAt(o);a<=127?t.push(a):a<=2047?t.push(192|a>>6,128|63&a):55296==(64512&a)?o<n.length-1&&56320==(64512&n.charCodeAt(o+1))?(a=65536|(1023&a)<<10|1023&n.charCodeAt(++o),t.push(240|a>>18,128|a>>12&63,128|a>>6&63,128|63&a)):t.push(239,191,189):56320==(64512&a)?t.push(239,191,189):t.push(224|a>>12,128|a>>6&63,128|63&a)}return new Uint8Array(t)}function st(n,t){switch(n){case _e.BASE64:{const p=-1!==t.indexOf("-"),v=-1!==t.indexOf("_");if(p||v)throw oe(n,"Invalid character '"+(p?"-":"_")+"' found: is it base64url encoded?");break}case _e.BASE64URL:{const p=-1!==t.indexOf("+"),v=-1!==t.indexOf("/");if(p||v)throw oe(n,"Invalid character '"+(p?"+":"/")+"' found: is it base64 encoded?");t=t.replace(/-/g,"+").replace(/_/g,"/");break}}let o;try{o=function ft(n){if(typeof atob>"u")throw function O(n){return new W(H.UNSUPPORTED_ENVIRONMENT,`${n} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}("base-64");return atob(n)}(t)}catch(p){throw p.message.includes("polyfill")?p:oe(n,"Invalid character found")}const a=new Uint8Array(o.length);for(let p=0;p<o.length;p++)a[p]=o.charCodeAt(p);return a}class tt{constructor(t){this.base64=!1,this.contentType=null;const o=t.match(/^data:([^,]+)?,/);if(null===o)throw oe(_e.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const a=o[1]||null;null!=a&&(this.base64=function Ut(n,t){return n.length>=t.length&&n.substring(n.length-t.length)===t}(a,";base64"),this.contentType=this.base64?a.substring(0,a.length-7):a),this.rest=t.substring(t.indexOf(",")+1)}}class xe{constructor(t,o){let a=0,p="";Ze(t)?(this.data_=t,a=t.size,p=t.type):t instanceof ArrayBuffer?(o?this.data_=new Uint8Array(t):(this.data_=new Uint8Array(t.byteLength),this.data_.set(new Uint8Array(t))),a=this.data_.length):t instanceof Uint8Array&&(o?this.data_=t:(this.data_=new Uint8Array(t.length),this.data_.set(t)),a=t.length),this.size_=a,this.type_=p}size(){return this.size_}type(){return this.type_}slice(t,o){if(Ze(this.data_)){const p=function Dt(n,t,o){return n.webkitSlice?n.webkitSlice(t,o):n.mozSlice?n.mozSlice(t,o):n.slice?n.slice(t,o):null}(this.data_,t,o);return null===p?null:new xe(p)}{const a=new Uint8Array(this.data_.buffer,t,o-t);return new xe(a,!0)}}static getBlob(...t){if(Ve()){const o=t.map(a=>a instanceof xe?a.data_:a);return new xe(ht.apply(null,o))}{const o=t.map(w=>X(w)?Ke(_e.RAW,w).data:w.data_);let a=0;o.forEach(w=>{a+=w.byteLength});const p=new Uint8Array(a);let v=0;return o.forEach(w=>{for(let G=0;G<w.length;G++)p[v++]=w[G]}),new xe(p,!0)}}uploadData(){return this.data_}}function mt(n){let t;try{t=JSON.parse(n)}catch{return null}return function D(n){return"object"==typeof n&&!Array.isArray(n)}(t)?t:null}function vt(n){const t=n.lastIndexOf("/",n.length-2);return-1===t?n:n.slice(t+1)}function at(n,t){return t}class ve{constructor(t,o,a,p){this.server=t,this.local=o||t,this.writable=!!a,this.xform=p||at}}let Xe=null;function Je(){if(Xe)return Xe;const n=[];n.push(new ve("bucket")),n.push(new ve("generation")),n.push(new ve("metageneration")),n.push(new ve("name","fullPath",!0));const o=new ve("name");o.xform=function t(v,w){return function Zt(n){return!X(n)||n.length<2?n:vt(n)}(w)},n.push(o);const p=new ve("size");return p.xform=function a(v,w){return void 0!==w?Number(w):w},n.push(p),n.push(new ve("timeCreated")),n.push(new ve("updated")),n.push(new ve("md5Hash",null,!0)),n.push(new ve("cacheControl",null,!0)),n.push(new ve("contentDisposition",null,!0)),n.push(new ve("contentEncoding",null,!0)),n.push(new ve("contentLanguage",null,!0)),n.push(new ve("contentType",null,!0)),n.push(new ve("metadata","customMetadata",!0)),Xe=n,Xe}function ut(n,t,o){const a=mt(t);return null===a?null:function yt(n,t,o){const a={type:"file"},p=o.length;for(let v=0;v<p;v++){const w=o[v];a[w.local]=w.xform(a,t[w.server])}return function Ct(n,t){Object.defineProperty(n,"ref",{get:function o(){const v=new Y(n.bucket,n.fullPath);return t._makeStorageReference(v)}})}(a,n),a}(n,a,o)}function ct(n,t){const o={},a=t.length;for(let p=0;p<a;p++){const v=t[p];v.writable&&(o[v.server]=n[v.local])}return JSON.stringify(o)}const Mt="prefixes",bt="items";class c{constructor(t,o,a,p){this.url=t,this.method=o,this.handler=a,this.timeout=p,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}function h(n){if(!n)throw Ie()}function F(n,t){return function o(a,p){const v=ut(n,p,t);return h(null!==v),v}}function u(n){return function t(o,a){let p;return p=401===o.getStatus()?o.getErrorText().includes("Firebase App Check token is invalid")?function ne(){return new W(H.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}():function De(){return new W(H.UNAUTHENTICATED,"User is not authenticated, please authenticate using Firebase Authentication and try again.")}():402===o.getStatus()?function le(n){return new W(H.QUOTA_EXCEEDED,"Quota for bucket '"+n+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}(n.bucket):403===o.getStatus()?function Be(n){return new W(H.UNAUTHORIZED,"User does not have permission to access '"+n+"'.")}(n.path):a,p.status=o.getStatus(),p.serverResponse=a.serverResponse,p}}function f(n){const t=u(n);return function o(a,p){let v=t(a,p);return 404===a.getStatus()&&(v=function $e(n){return new W(H.OBJECT_NOT_FOUND,"Object '"+n+"' does not exist.")}(n.path)),v.serverResponse=p.serverResponse,v}}function A(n,t,o){const p=ke(t.fullServerUrl(),n.host,n._protocol),w=n.maxOperationRetryTime,G=new c(p,"GET",F(n,o),w);return G.errorHandler=f(t),G}function $(n,t,o,a,p){const v={};v.prefix=t.isRoot?"":t.path+"/",o&&o.length>0&&(v.delimiter=o),a&&(v.pageToken=a),p&&(v.maxResults=p);const G=ke(t.bucketOnlyServerUrl(),n.host,n._protocol),j=n.maxOperationRetryTime,z=new c(G,"GET",function Z(n,t){return function o(a,p){const v=function Tt(n,t,o){const a=mt(o);return null===a?null:function Nt(n,t,o){const a={prefixes:[],items:[],nextPageToken:o.nextPageToken};if(o[Mt])for(const p of o[Mt]){const v=p.replace(/\/$/,""),w=n._makeStorageReference(new Y(t,v));a.prefixes.push(w)}if(o[bt])for(const p of o[bt]){const v=n._makeStorageReference(new Y(t,p.name));a.items.push(v)}return a}(n,t,a)}(n,t,p);return h(null!==v),v}}(n,t.bucket),j);return z.urlParams=v,z.errorHandler=u(t),z}function s(n,t,o){const a=Object.assign({},o);return a.fullPath=n.path,a.size=t.size(),a.contentType||(a.contentType=function i(n,t){return n&&n.contentType||t&&t.type()||"application/octet-stream"}(null,t)),a}class C{constructor(t,o,a,p){this.current=t,this.total=o,this.finalized=!!a,this.metadata=p||null}}function E(n,t){let o=null;try{o=n.getResponseHeader("X-Goog-Upload-Status")}catch{h(!1)}return h(!!o&&-1!==(t||["active"]).indexOf(o)),o}const Lt={STATE_CHANGED:"state_changed"},Ee={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function Re(n){switch(n){case"running":case"pausing":case"canceling":return Ee.RUNNING;case"paused":return Ee.PAUSED;case"success":return Ee.SUCCESS;case"canceled":return Ee.CANCELED;default:return Ee.ERROR}}class Rt{constructor(t,o,a){if(function L(n){return"function"==typeof n}(t)||null!=o||null!=a)this.next=t,this.error=o??void 0,this.complete=a??void 0;else{const v=t;this.next=v.next,this.error=v.error,this.complete=v.complete}}}function Ft(n){return(...t)=>{Promise.resolve().then(()=>n(...t))}}let zt=null;class vn{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Ne.NO_ERROR,this.sendPromise_=new Promise(t=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=Ne.ABORT,t()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=Ne.NETWORK_ERROR,t()}),this.xhr_.addEventListener("load",()=>{t()})})}send(t,o,a,p){if(this.sent_)throw me("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(o,t,!0),void 0!==p)for(const v in p)p.hasOwnProperty(v)&&this.xhr_.setRequestHeader(v,p[v].toString());return void 0!==a?this.xhr_.send(a):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw me("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw me("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw me("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw me("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(t){return this.xhr_.getResponseHeader(t)}addUploadProgressListener(t){null!=this.xhr_.upload&&this.xhr_.upload.addEventListener("progress",t)}removeUploadProgressListener(t){null!=this.xhr_.upload&&this.xhr_.upload.removeEventListener("progress",t)}}class Cn extends vn{initXhr(){this.xhr_.responseType="text"}}function ot(){return zt?zt():new Cn}class Xt{constructor(t,o,a=null){this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=t,this._blob=o,this._metadata=a,this._mappings=Je(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=p=>{if(this._request=void 0,this._chunkMultiplier=1,p._codeEquals(H.CANCELED))this._needToFetchStatus=!0,this.completeTransitions_();else{const v=this.isExponentialBackoffExpired();if(Ye(p.status,[])){if(!v)return this.sleepTime=Math.max(2*this.sleepTime,1e3),this._needToFetchStatus=!0,void this.completeTransitions_();p=y()}this._error=p,this._transition("error")}},this._metadataErrorHandler=p=>{this._request=void 0,p._codeEquals(H.CANCELED)?this.completeTransitions_():(this._error=p,this._transition("error"))},this.sleepTime=0,this.maxSleepTime=this._ref.storage.maxUploadRetryTime,this._promise=new Promise((p,v)=>{this._resolve=p,this._reject=v,this._start()}),this._promise.then(null,()=>{})}isExponentialBackoffExpired(){return this.sleepTime>this.maxSleepTime}_makeProgressCallback(){const t=this._transferred;return o=>this._updateProgress(t+o)}_shouldDoResumable(t){return t.size()>262144}_start(){"running"===this._state&&void 0===this._request&&(this._resumable?void 0===this._uploadUrl?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this.pendingTimeout=setTimeout(()=>{this.pendingTimeout=void 0,this._continueUpload()},this.sleepTime):this._oneShotUpload())}_resolveToken(t){Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then(([o,a])=>{switch(this._state){case"running":t(o,a);break;case"canceling":this._transition("canceled");break;case"pausing":this._transition("paused")}})}_createResumable(){this._resolveToken((t,o)=>{const a=function de(n,t,o,a,p){const v=t.bucketOnlyServerUrl(),w=s(t,a,p),G={name:w.fullPath},M=ke(v,n.host,n._protocol),z={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${a.size()}`,"X-Goog-Upload-Header-Content-Type":w.contentType,"Content-Type":"application/json; charset=utf-8"},Ce=ct(w,o),ye=new c(M,"POST",function ge(et){let Te;E(et);try{Te=et.getResponseHeader("X-Goog-Upload-URL")}catch{h(!1)}return h(X(Te)),Te},n.maxUploadRetryTime);return ye.urlParams=G,ye.headers=z,ye.body=Ce,ye.errorHandler=u(t),ye}(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),p=this._ref.storage._makeRequest(a,ot,t,o);this._request=p,p.getPromise().then(v=>{this._request=void 0,this._uploadUrl=v,this._needToFetchStatus=!1,this.completeTransitions_()},this._errorHandler)})}_fetchStatus(){const t=this._uploadUrl;this._resolveToken((o,a)=>{const p=function We(n,t,o,a){const M=new c(o,"POST",function v(j){const z=E(j,["active","final"]);let Ce=null;try{Ce=j.getResponseHeader("X-Goog-Upload-Size-Received")}catch{h(!1)}Ce||h(!1);const fe=Number(Ce);return h(!isNaN(fe)),new C(fe,a.size(),"final"===z)},n.maxUploadRetryTime);return M.headers={"X-Goog-Upload-Command":"query"},M.errorHandler=u(t),M}(this._ref.storage,this._ref._location,t,this._blob),v=this._ref.storage._makeRequest(p,ot,o,a);this._request=v,v.getPromise().then(w=>{this._request=void 0,this._updateProgress(w.current),this._needToFetchStatus=!1,w.finalized&&(this._needToFetchMetadata=!0),this.completeTransitions_()},this._errorHandler)})}_continueUpload(){const t=262144*this._chunkMultiplier,o=new C(this._transferred,this._blob.size()),a=this._uploadUrl;this._resolveToken((p,v)=>{let w;try{w=function Qe(n,t,o,a,p,v,w,G){const M=new C(0,0);if(w?(M.current=w.current,M.total=w.total):(M.current=0,M.total=a.size()),a.size()!==M.total)throw function P(){return new W(H.SERVER_FILE_WRONG_SIZE,"Server recorded incorrect upload file size, please retry the upload.")}();const j=M.total-M.current;let z=j;p>0&&(z=Math.min(z,p));const Ce=M.current;let ge="";ge=0===z?"finalize":j===z?"upload, finalize":"upload";const ye={"X-Goog-Upload-Command":ge,"X-Goog-Upload-Offset":`${M.current}`},et=a.slice(Ce,Ce+z);if(null===et)throw _();const Se=new c(o,"POST",function Te(Fe,qt){const Jt=E(Fe,["active","final"]),Vt=M.current+z,jt=a.size();let Yt;return Yt="final"===Jt?F(t,v)(Fe,qt):null,new C(Vt,jt,"final"===Jt,Yt)},t.maxUploadRetryTime);return Se.headers=ye,Se.body=et.uploadData(),Se.progressCallback=G||null,Se.errorHandler=u(n),Se}(this._ref._location,this._ref.storage,a,this._blob,t,this._mappings,o,this._makeProgressCallback())}catch(M){return this._error=M,void this._transition("error")}const G=this._ref.storage._makeRequest(w,ot,p,v,!1);this._request=G,G.getPromise().then(M=>{this._increaseMultiplier(),this._request=void 0,this._updateProgress(M.current),M.finalized?(this._metadata=M.metadata,this._transition("success")):this.completeTransitions_()},this._errorHandler)})}_increaseMultiplier(){262144*this._chunkMultiplier*2<33554432&&(this._chunkMultiplier*=2)}_fetchMetadata(){this._resolveToken((t,o)=>{const a=A(this._ref.storage,this._ref._location,this._mappings),p=this._ref.storage._makeRequest(a,ot,t,o);this._request=p,p.getPromise().then(v=>{this._request=void 0,this._metadata=v,this._transition("success")},this._metadataErrorHandler)})}_oneShotUpload(){this._resolveToken((t,o)=>{const a=function d(n,t,o,a,p){const v=t.bucketOnlyServerUrl(),w={"X-Goog-Upload-Protocol":"multipart"},M=function G(){let Se="";for(let Fe=0;Fe<2;Fe++)Se+=Math.random().toString().slice(2);return Se}();w["Content-Type"]="multipart/related; boundary="+M;const j=s(t,a,p),z=ct(j,o),ge=xe.getBlob("--"+M+"\r\nContent-Type: application/json; charset=utf-8\r\n\r\n"+z+"\r\n--"+M+"\r\nContent-Type: "+j.contentType+"\r\n\r\n",a,"\r\n--"+M+"--");if(null===ge)throw _();const ye={name:j.fullPath},et=ke(v,n.host,n._protocol),wt=n.maxUploadRetryTime,Et=new c(et,"POST",F(n,o),wt);return Et.urlParams=ye,Et.headers=w,Et.body=ge.uploadData(),Et.errorHandler=u(t),Et}(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),p=this._ref.storage._makeRequest(a,ot,t,o);this._request=p,p.getPromise().then(v=>{this._request=void 0,this._metadata=v,this._updateProgress(this._blob.size()),this._transition("success")},this._errorHandler)})}_updateProgress(t){const o=this._transferred;this._transferred=t,this._transferred!==o&&this._notifyObservers()}_transition(t){if(this._state!==t)switch(t){case"canceling":case"pausing":this._state=t,void 0!==this._request?this._request.cancel():this.pendingTimeout&&(clearTimeout(this.pendingTimeout),this.pendingTimeout=void 0,this.completeTransitions_());break;case"running":const o="paused"===this._state;this._state=t,o&&(this._notifyObservers(),this._start());break;case"paused":case"error":case"success":this._state=t,this._notifyObservers();break;case"canceled":this._error=T(),this._state=t,this._notifyObservers()}}completeTransitions_(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start()}}get snapshot(){const t=Re(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:t,metadata:this._metadata,task:this,ref:this._ref}}on(t,o,a,p){const v=new Rt(o||void 0,a||void 0,p||void 0);return this._addObserver(v),()=>{this._removeObserver(v)}}then(t,o){return this._promise.then(t,o)}catch(t){return this.then(null,t)}_addObserver(t){this._observers.push(t),this._notifyObserver(t)}_removeObserver(t){const o=this._observers.indexOf(t);-1!==o&&this._observers.splice(o,1)}_notifyObservers(){this._finishPromise(),this._observers.slice().forEach(o=>{this._notifyObserver(o)})}_finishPromise(){if(void 0!==this._resolve){let t=!0;switch(Re(this._state)){case Ee.SUCCESS:Ft(this._resolve.bind(null,this.snapshot))();break;case Ee.CANCELED:case Ee.ERROR:Ft(this._reject.bind(null,this._error))();break;default:t=!1}t&&(this._resolve=void 0,this._reject=void 0)}}_notifyObserver(t){switch(Re(this._state)){case Ee.RUNNING:case Ee.PAUSED:t.next&&Ft(t.next.bind(t,this.snapshot))();break;case Ee.SUCCESS:t.complete&&Ft(t.complete.bind(t))();break;default:t.error&&Ft(t.error.bind(t,this._error))()}}resume(){const t="paused"===this._state||"pausing"===this._state;return t&&this._transition("running"),t}pause(){const t="running"===this._state;return t&&this._transition("pausing"),t}cancel(){const t="running"===this._state||"pausing"===this._state;return t&&this._transition("canceling"),t}}class $t{constructor(t,o){this._service=t,this._location=o instanceof Y?o:Y.makeFromUrl(o,t.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(t,o){return new $t(t,o)}get root(){const t=new Y(this._location.bucket,"");return this._newRef(this._service,t)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return vt(this._location.path)}get storage(){return this._service}get parent(){const t=function Bt(n){if(0===n.length)return null;const t=n.lastIndexOf("/");return-1===t?"":n.slice(0,t)}(this._location.path);if(null===t)return null;const o=new Y(this._location.bucket,t);return new $t(this._service,o)}_throwIfRoot(t){if(""===this._location.path)throw se(t)}}function tn(n,t,o){return Kt.apply(this,arguments)}function Kt(){return(Kt=(0,Ae.Z)(function*(n,t,o){const p=yield nn(n,{pageToken:o});t.prefixes.push(...p.prefixes),t.items.push(...p.items),null!=p.nextPageToken&&(yield tn(n,t,p.nextPageToken))})).apply(this,arguments)}function nn(n,t){null!=t&&"number"==typeof t.maxResults&&Me("options.maxResults",1,1e3,t.maxResults);const o=t||{},a=$(n.storage,n._location,"/",o.pageToken,o.maxResults);return n.storage.makeRequestWithTokens(a,ot)}function Fn(n){n._throwIfRoot("getDownloadURL");const t=function ee(n,t,o){const p=ke(t.fullServerUrl(),n.host,n._protocol),w=n.maxOperationRetryTime,G=new c(p,"GET",function J(n,t){return function o(a,p){const v=ut(n,p,t);return h(null!==v),function Gt(n,t,o,a){const p=mt(t);if(null===p||!X(p.downloadTokens))return null;const v=p.downloadTokens;if(0===v.length)return null;const w=encodeURIComponent;return v.split(",").map(j=>{const Ce=n.fullPath;return ke("/b/"+w(n.bucket)+"/o/"+w(Ce),o,a)+qe({alt:"media",token:j})})[0]}(v,p,n.host,n._protocol)}}(n,o),w);return G.errorHandler=f(t),G}(n.storage,n._location,Je());return n.storage.makeRequestWithTokens(t,ot).then(o=>{if(null===o)throw function k(){return new W(H.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}();return o})}function on(n,t){const o=function _t(n,t){const o=t.split("/").filter(a=>a.length>0).join("/");return 0===n.length?o:n+"/"+o}(n._location.path,t),a=new Y(n._location.bucket,o);return new $t(n.storage,a)}function rn(n,t){if(n instanceof Wt){const o=n;if(null==o._bucket)throw function U(){return new W(H.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+V+"' property when initializing the app?")}();const a=new $t(o,o._bucket);return null!=t?rn(a,t):a}return void 0!==t?on(n,t):n}function Dn(n,t){if(t&&function Pn(n){return/^[A-Za-z]+:\/\//.test(n)}(t)){if(n instanceof Wt)return function On(n,t){return new $t(n,t)}(n,t);throw m("To use ref(service, url), the first argument must be a Storage instance.")}return rn(n,t)}function sn(n,t){const o=t?.[V];return null==o?null:Y.makeFromBucketSpec(o,n)}class Wt{constructor(t,o,a,p,v){this.app=t,this._authProvider=o,this._appCheckProvider=a,this._url=p,this._firebaseVersion=v,this._bucket=null,this._host=Le,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=12e4,this._maxUploadRetryTime=6e5,this._requests=new Set,this._bucket=null!=p?Y.makeFromBucketSpec(p,this._host):sn(this._host,this.app.options)}get host(){return this._host}set host(t){this._host=t,this._bucket=null!=this._url?Y.makeFromBucketSpec(this._url,t):sn(t,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(t){Me("time",0,Number.POSITIVE_INFINITY,t),this._maxUploadRetryTime=t}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(t){Me("time",0,Number.POSITIVE_INFINITY,t),this._maxOperationRetryTime=t}_getAuthToken(){var t=this;return(0,Ae.Z)(function*(){if(t._overrideAuthToken)return t._overrideAuthToken;const o=t._authProvider.getImmediate({optional:!0});if(o){const a=yield o.getToken();if(null!==a)return a.accessToken}return null})()}_getAppCheckToken(){var t=this;return(0,Ae.Z)(function*(){const o=t._appCheckProvider.getImmediate({optional:!0});return o?(yield o.getToken()).token:null})()}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(t=>t.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(t){return new $t(this,t)}_makeRequest(t,o,a,p,v=!0){if(this._deleted)return new Ge(q());{const w=function pt(n,t,o,a,p,v,w=!0){const G=qe(n.urlParams),M=n.url+G,j=Object.assign({},n.headers);return function dt(n,t){t&&(n["X-Firebase-GMPID"]=t)}(j,t),function Pt(n,t){null!==t&&t.length>0&&(n.Authorization="Firebase "+t)}(j,o),function It(n,t){n["X-Firebase-Storage-Version"]="webjs/"+(t??"AppManager")}(j,v),function Ot(n,t){null!==t&&(n["X-Firebase-AppCheck"]=t)}(j,a),new lt(M,n.method,j,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,p,w)}(t,this._appId,a,p,o,this._firebaseVersion,v);return this._requests.add(w),w.getPromise().then(()=>this._requests.delete(w),()=>this._requests.delete(w)),w}}makeRequestWithTokens(t,o){var a=this;return(0,Ae.Z)(function*(){const[p,v]=yield Promise.all([a._getAuthToken(),a._getAppCheckToken()]);return a._makeRequest(t,o,p,v).getPromise()})()}}const an="@firebase/storage";function ln(n,t){return Dn(n=(0,he.m9)(n),t)}function jn(n,{instanceIdentifier:t}){const o=n.getProvider("app").getImmediate(),a=n.getProvider("auth-internal"),p=n.getProvider("app-check-internal");return new Wt(o,a,p,t,be.SDK_VERSION)}!function Qn(){(0,be._registerComponent)(new Pe.wA("storage",jn,"PUBLIC").setMultipleInstances(!0)),(0,be.registerVersion)(an,"0.12.1",""),(0,be.registerVersion)(an,"0.12.1","esm2017")}();class Qt{constructor(t,o,a){this._delegate=t,this.task=o,this.ref=a}get bytesTransferred(){return this._delegate.bytesTransferred}get metadata(){return this._delegate.metadata}get state(){return this._delegate.state}get totalBytes(){return this._delegate.totalBytes}}class pn{constructor(t,o){this._delegate=t,this._ref=o,this.cancel=this._delegate.cancel.bind(this._delegate),this.catch=this._delegate.catch.bind(this._delegate),this.pause=this._delegate.pause.bind(this._delegate),this.resume=this._delegate.resume.bind(this._delegate)}get snapshot(){return new Qt(this._delegate.snapshot,this,this._ref)}then(t,o){return this._delegate.then(a=>{if(t)return t(new Qt(a,this,this._ref))},o)}on(t,o,a,p){let v;return o&&(v="function"==typeof o?w=>o(new Qt(w,this,this._ref)):{next:o.next?w=>o.next(new Qt(w,this,this._ref)):void 0,complete:o.complete||void 0,error:o.error||void 0}),this._delegate.on(t,v,a||void 0,p||void 0)}}class hn{constructor(t,o){this._delegate=t,this._service=o}get prefixes(){return this._delegate.prefixes.map(t=>new At(t,this._service))}get items(){return this._delegate.items.map(t=>new At(t,this._service))}get nextPageToken(){return this._delegate.nextPageToken||null}}class At{constructor(t,o){this._delegate=t,this.storage=o}get name(){return this._delegate.name}get bucket(){return this._delegate.bucket}get fullPath(){return this._delegate.fullPath}toString(){return this._delegate.toString()}child(t){const o=function Jn(n,t){return on(n,t)}(this._delegate,t);return new At(o,this.storage)}get root(){return new At(this._delegate.root,this.storage)}get parent(){const t=this._delegate.parent;return null==t?null:new At(t,this.storage)}put(t,o){return this._throwIfRoot("put"),new pn(function Zn(n,t,o){return function In(n,t,o){return n._throwIfRoot("uploadBytesResumable"),new Xt(n,new xe(t),o)}(n=(0,he.m9)(n),t,o)}(this._delegate,t,o),this)}putString(t,o=_e.RAW,a){this._throwIfRoot("putString");const p=Ke(o,t),v=Object.assign({},a);return null==v.contentType&&null!=p.contentType&&(v.contentType=p.contentType),new pn(new Xt(this._delegate,new xe(p.data,!0),v),this)}listAll(){return function $n(n){return function xn(n){const t={prefixes:[],items:[]};return tn(n,t).then(()=>t)}(n=(0,he.m9)(n))}(this._delegate).then(t=>new hn(t,this.storage))}list(t){return function Ln(n,t){return nn(n=(0,he.m9)(n),t)}(this._delegate,t||void 0).then(o=>new hn(o,this.storage))}getMetadata(){return function Mn(n){return function Un(n){n._throwIfRoot("getMetadata");const t=A(n.storage,n._location,Je());return n.storage.makeRequestWithTokens(t,ot)}(n=(0,he.m9)(n))}(this._delegate)}updateMetadata(t){return function Nn(n,t){return function Rn(n,t){n._throwIfRoot("updateMetadata");const o=function l(n,t,o,a){const v=ke(t.fullServerUrl(),n.host,n._protocol),G=ct(o,a),j=n.maxOperationRetryTime,z=new c(v,"PATCH",F(n,a),j);return z.headers={"Content-Type":"application/json; charset=utf-8"},z.body=G,z.errorHandler=f(t),z}(n.storage,n._location,t,Je());return n.storage.makeRequestWithTokens(o,ot)}(n=(0,he.m9)(n),t)}(this._delegate,t)}getDownloadURL(){return function Gn(n){return Fn(n=(0,he.m9)(n))}(this._delegate)}delete(){return this._throwIfRoot("delete"),function qn(n){return function Sn(n){n._throwIfRoot("deleteObject");const t=function R(n,t){const a=ke(t.fullServerUrl(),n.host,n._protocol),G=new c(a,"DELETE",function w(M,j){},n.maxOperationRetryTime);return G.successCodes=[200,204],G.errorHandler=f(t),G}(n.storage,n._location);return n.storage.makeRequestWithTokens(t,ot)}(n=(0,he.m9)(n))}(this._delegate)}_throwIfRoot(t){if(""===this._delegate._location.path)throw se(t)}}class fn{constructor(t,o){this.app=t,this._delegate=o}get maxOperationRetryTime(){return this._delegate.maxOperationRetryTime}get maxUploadRetryTime(){return this._delegate.maxUploadRetryTime}ref(t){if(gn(t))throw m("ref() expected a child path but got a URL, use refFromURL instead.");return new At(ln(this._delegate,t),this)}refFromURL(t){if(!gn(t))throw m("refFromURL() expected a full URL but got a child path, use ref() instead.");try{Y.makeFromUrl(t,this._delegate.host)}catch{throw m("refFromUrl() expected a valid full URL but got an invalid one.")}return new At(ln(this._delegate,t),this)}setMaxUploadRetryTime(t){this._delegate.maxUploadRetryTime=t}setMaxOperationRetryTime(t){this._delegate.maxOperationRetryTime=t}useEmulator(t,o,a={}){!function dn(n,t,o,a={}){!function Bn(n,t,o,a={}){n.host=`${t}:${o}`,n._protocol="http";const{mockUserToken:p}=a;p&&(n._overrideAuthToken="string"==typeof p?p:(0,he.Sg)(p,n.app.options.projectId))}(n,t,o,a)}(this._delegate,t,o,a)}}function gn(n){return/^[A-Za-z]+:\/\//.test(n)}function Vn(n,{instanceIdentifier:t}){const o=n.getProvider("app-compat").getImmediate(),a=n.getProvider("storage").getImmediate({identifier:t});return new fn(o,a)}!function Yn(n){const t={TaskState:Ee,TaskEvent:Lt,StringFormat:_e,Storage:fn,Reference:At};n.INTERNAL.registerComponent(new Pe.wA("storage-compat",Vn,"PUBLIC").setServiceProps(t).setMultipleInstances(!0)),n.registerVersion("@firebase/storage-compat","0.3.4")}(He.Z);var zn=g(7142);function mn(n){const t=function Xn(n){return new r.y(t=>{const o=w=>t.next(w);o(n.snapshot);const v=n.on("state_changed",o);return n.then(w=>{o(w),t.complete()},w=>{o(n.snapshot),(w=>{t.error(w)})(w)}),function(){v()}}).pipe((0,te.b)(0))}(n);return{task:n,then:n.then.bind(n),catch:n.catch.bind(n),pause:n.pause.bind(n),cancel:n.cancel.bind(n),resume:n.resume.bind(n),snapshotChanges:()=>t,percentageChanges:()=>t.pipe((0,pe.U)(o=>o.bytesTransferred/o.totalBytes*100))}}function Ht(n){return{getDownloadURL:()=>(0,Q.of)(void 0).pipe(S.fc,(0,ce.w)(()=>n.getDownloadURL()),S.iC),getMetadata:()=>(0,Q.of)(void 0).pipe(S.fc,(0,ce.w)(()=>n.getMetadata()),S.iC),delete:()=>(0,ue.D)(n.delete()),child:t=>Ht(n.child(t)),updateMetadata:t=>(0,ue.D)(n.updateMetadata(t)),put:(t,o)=>mn(n.put(t,o)),putString:(t,o,a)=>mn(n.putString(t,o,a)),list:t=>(0,ue.D)(n.list(t)),listAll:()=>(0,ue.D)(n.listAll())}}const eo=new N.OlP("angularfire2.storageBucket"),to=new N.OlP("angularfire2.storage.maxUploadRetryTime"),no=new N.OlP("angularfire2.storage.maxOperationRetryTime"),oo=new N.OlP("angularfire2.storage.use-emulator");let _n=(()=>{class n{storage;constructor(o,a,p,v,w,G,M,j,z,Ce){const fe=(0,e.on)(o,w,a);this.storage=(0,e.cc)(`${fe.name}.storage.${p}`,"AngularFireStorage",fe.name,()=>{const ge=w.runOutsideAngular(()=>fe.storage(p||void 0)),ye=z;return ye&&ge.useEmulator(...ye),M&&ge.setMaxUploadRetryTime(M),j&&ge.setMaxOperationRetryTime(j),ge},[M,j])}ref(o){return Ht(this.storage.ref(o))}refFromURL(o){return Ht(this.storage.refFromURL(o))}upload(o,a,p){return Ht(this.storage.ref(o)).put(a,p)}static \u0275fac=function(a){return new(a||n)(N.LFG(e.Dh),N.LFG(e.xv,8),N.LFG(eo,8),N.LFG(N.Lbi),N.LFG(N.R0b),N.LFG(S.HU),N.LFG(to,8),N.LFG(no,8),N.LFG(oo,8),N.LFG(S.Rf,8))};static \u0275prov=N.Yz7({token:n,factory:n.\u0275fac,providedIn:"any"})}return n})(),ro=(()=>{class n{static \u0275fac=function(a){return new(a||n)};static \u0275mod=N.oAB({type:n});static \u0275inj=N.cJS({})}return n})(),io=(()=>{class n{constructor(){zn.Z.registerVersion("angularfire",S.q4.full,"gcs-compat")}static \u0275fac=function(a){return new(a||n)};static \u0275mod=N.oAB({type:n});static \u0275inj=N.cJS({providers:[_n],imports:[ro]})}return n})()},6294:(St,Ue,g)=>{var S=g(5861),r=g(9032),Q=g(3427),ue=g(963),te=g(8667);const pe="@firebase/installations",ce="0.6.5",N=1e4,e=`w:${ce}`,He="FIS_v2",Ae="https://firebaseinstallations.googleapis.com/v1",be=36e5,V=new ue.LL("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function ie(u){return u instanceof ue.ZR&&u.code.includes("request-failed")}function ae({projectId:u}){return`${Ae}/projects/${u}/installations`}function we(u){return{token:u.token,requestStatus:2,expiresIn:De(u.expiresIn),creationTime:Date.now()}}function W(u,f){return H.apply(this,arguments)}function H(){return(H=(0,S.Z)(function*(u,f){const $=(yield f.json()).error;return V.create("request-failed",{requestName:u,serverCode:$.code,serverMessage:$.message,serverStatus:$.status})})).apply(this,arguments)}function Oe({apiKey:u}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":u})}function $e(u){return le.apply(this,arguments)}function le(){return(le=(0,S.Z)(function*(u){const f=yield u();return f.status>=500&&f.status<600?u():f})).apply(this,arguments)}function De(u){return Number(u.replace("s","000"))}function y(){return(y=(0,S.Z)(function*({appConfig:u,heartbeatServiceProvider:f},{fid:A}){const $=ae(u),re=Oe(u),ee=f.getImmediate({optional:!0});if(ee){const s=yield ee.getHeartbeatsHeader();s&&re.append("x-firebase-client",s)}const R={method:"POST",headers:re,body:JSON.stringify({fid:A,authVersion:He,appId:u.appId,sdkVersion:e})},i=yield $e(()=>fetch($,R));if(i.ok){const s=yield i.json();return{fid:s.fid||A,registrationStatus:2,refreshToken:s.refreshToken,authToken:we(s.authToken)}}throw yield W("Create Installation",i)})).apply(this,arguments)}function T(u){return new Promise(f=>{setTimeout(f,u)})}const I=/^[cdef][\w-]{21}$/,U="";function _(){try{const u=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(u),u[0]=112+u[0]%16;const A=function P(u){return function b(u){return btoa(String.fromCharCode(...u)).replace(/\+/g,"-").replace(/\//g,"_")}(u).substr(0,22)}(u);return I.test(A)?A:U}catch{return U}}function k(u){return`${u.appName}!${u.appId}`}const O=new Map;function m(u,f){const A=k(u);oe(A,f),function me(u,f){const A=function Ge(){return!Y&&"BroadcastChannel"in self&&(Y=new BroadcastChannel("[Firebase] FID Change"),Y.onmessage=u=>{oe(u.data.key,u.data.fid)}),Y}();A&&A.postMessage({key:u,fid:f}),function B(){0===O.size&&Y&&(Y.close(),Y=null)}()}(A,f)}function oe(u,f){const A=O.get(u);if(A)for(const $ of A)$(f)}let Y=null;const K="firebase-installations-database",x=1,L="firebase-installations-store";let D=null;function X(){return D||(D=(0,te.X3)(K,x,{upgrade:(u,f)=>{0===f&&u.createObjectStore(L)}})),D}function Ze(u,f){return Ve.apply(this,arguments)}function Ve(){return(Ve=(0,S.Z)(function*(u,f){const A=k(u),re=(yield X()).transaction(L,"readwrite"),ee=re.objectStore(L),l=yield ee.get(A);return yield ee.put(f,A),yield re.done,(!l||l.fid!==f.fid)&&m(u,f.fid),f})).apply(this,arguments)}function Me(u){return ke.apply(this,arguments)}function ke(){return(ke=(0,S.Z)(function*(u){const f=k(u),$=(yield X()).transaction(L,"readwrite");yield $.objectStore(L).delete(f),yield $.done})).apply(this,arguments)}function qe(u,f){return Ne.apply(this,arguments)}function Ne(){return(Ne=(0,S.Z)(function*(u,f){const A=k(u),re=(yield X()).transaction(L,"readwrite"),ee=re.objectStore(L),l=yield ee.get(A),R=f(l);return void 0===R?yield ee.delete(A):yield ee.put(R,A),yield re.done,R&&(!l||l.fid!==R.fid)&&m(u,R.fid),R})).apply(this,arguments)}function Ye(u){return lt.apply(this,arguments)}function lt(){return lt=(0,S.Z)(function*(u){let f;const A=yield qe(u.appConfig,$=>{const re=function ze(u){return ht(u||{fid:_(),registrationStatus:0})}($),ee=function Pt(u,f){if(0===f.registrationStatus){if(!navigator.onLine)return{installationEntry:f,registrationPromise:Promise.reject(V.create("app-offline"))};const A={fid:f.fid,registrationStatus:1,registrationTime:Date.now()},$=function It(u,f){return dt.apply(this,arguments)}(u,A);return{installationEntry:A,registrationPromise:$}}return 1===f.registrationStatus?{installationEntry:f,registrationPromise:Ot(u)}:{installationEntry:f}}(u,re);return f=ee.registrationPromise,ee.installationEntry});return A.fid===U?{installationEntry:yield f}:{installationEntry:A,registrationPromise:f}}),lt.apply(this,arguments)}function dt(){return dt=(0,S.Z)(function*(u,f){try{const A=yield function Be(u,f){return y.apply(this,arguments)}(u,f);return Ze(u.appConfig,A)}catch(A){throw ie(A)&&409===A.customData.serverCode?yield Me(u.appConfig):yield Ze(u.appConfig,{fid:f.fid,registrationStatus:0}),A}}),dt.apply(this,arguments)}function Ot(u){return pt.apply(this,arguments)}function pt(){return(pt=(0,S.Z)(function*(u){let f=yield kt(u.appConfig);for(;1===f.registrationStatus;)yield T(100),f=yield kt(u.appConfig);if(0===f.registrationStatus){const{installationEntry:A,registrationPromise:$}=yield Ye(u);return $||A}return f})).apply(this,arguments)}function kt(u){return qe(u,f=>{if(!f)throw V.create("installation-not-found");return ht(f)})}function ht(u){return function Dt(u){return 1===u.registrationStatus&&u.registrationTime+N<Date.now()}(u)?{fid:u.fid,registrationStatus:0}:u}function _e(){return(_e=(0,S.Z)(function*({appConfig:u,heartbeatServiceProvider:f},A){const $=function rt(u,{fid:f}){return`${ae(u)}/${f}/authTokens:generate`}(u,A),re=function Ie(u,{refreshToken:f}){const A=Oe(u);return A.append("Authorization",function ne(u){return`${He} ${u}`}(f)),A}(u,A),ee=f.getImmediate({optional:!0});if(ee){const s=yield ee.getHeartbeatsHeader();s&&re.append("x-firebase-client",s)}const R={method:"POST",headers:re,body:JSON.stringify({installation:{sdkVersion:e,appId:u.appId}})},i=yield $e(()=>fetch($,R));if(i.ok)return we(yield i.json());throw yield W("Generate Auth Token",i)})).apply(this,arguments)}function Ke(u){return it.apply(this,arguments)}function it(){return it=(0,S.Z)(function*(u,f=!1){let A;const $=yield qe(u.appConfig,ee=>{if(!Ut(ee))throw V.create("not-registered");const l=ee.authToken;if(!f&&function xe(u){return 2===u.requestStatus&&!function mt(u){const f=Date.now();return f<u.creationTime||u.creationTime+u.expiresIn<f+be}(u)}(l))return ee;if(1===l.requestStatus)return A=function gt(u,f){return st.apply(this,arguments)}(u,f),ee;{if(!navigator.onLine)throw V.create("app-offline");const R=function Bt(u){const f={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},u),{authToken:f})}(ee);return A=function xt(u,f){return nt.apply(this,arguments)}(u,R),R}});return A?yield A:$.authToken}),it.apply(this,arguments)}function st(){return(st=(0,S.Z)(function*(u,f){let A=yield tt(u.appConfig);for(;1===A.authToken.requestStatus;)yield T(100),A=yield tt(u.appConfig);const $=A.authToken;return 0===$.requestStatus?Ke(u,f):$})).apply(this,arguments)}function tt(u){return qe(u,f=>{if(!Ut(f))throw V.create("not-registered");return function _t(u){return 1===u.requestStatus&&u.requestTime+N<Date.now()}(f.authToken)?Object.assign(Object.assign({},f),{authToken:{requestStatus:0}}):f})}function nt(){return nt=(0,S.Z)(function*(u,f){try{const A=yield function ft(u,f){return _e.apply(this,arguments)}(u,f),$=Object.assign(Object.assign({},f),{authToken:A});return yield Ze(u.appConfig,$),A}catch(A){if(!ie(A)||401!==A.customData.serverCode&&404!==A.customData.serverCode){const $=Object.assign(Object.assign({},f),{authToken:{requestStatus:0}});yield Ze(u.appConfig,$)}else yield Me(u.appConfig);throw A}}),nt.apply(this,arguments)}function Ut(u){return void 0!==u&&2===u.registrationStatus}function at(){return(at=(0,S.Z)(function*(u){const f=u,{installationEntry:A,registrationPromise:$}=yield Ye(f);return $?$.catch(console.error):Ke(f).catch(console.error),A.fid})).apply(this,arguments)}function Xe(){return Xe=(0,S.Z)(function*(u,f=!1){const A=u;return yield function Zt(u){return Je.apply(this,arguments)}(A),(yield Ke(A,f)).token}),Xe.apply(this,arguments)}function Je(){return(Je=(0,S.Z)(function*(u){const{registrationPromise:f}=yield Ye(u);f&&(yield f)})).apply(this,arguments)}function Tt(u){return V.create("missing-app-config-values",{valueName:u})}const c="installations",F=u=>{const f=u.getProvider("app").getImmediate(),A=function Nt(u){if(!u||!u.options)throw Tt("App Configuration");if(!u.name)throw Tt("App Name");const f=["projectId","apiKey","appId"];for(const A of f)if(!u.options[A])throw Tt(A);return{appName:u.name,projectId:u.options.projectId,apiKey:u.options.apiKey,appId:u.options.appId}}(f);return{app:f,appConfig:A,heartbeatServiceProvider:(0,r._getProvider)(f,"heartbeat"),_delete:()=>Promise.resolve()}},Z=u=>{const f=u.getProvider("app").getImmediate(),A=(0,r._getProvider)(f,c).getImmediate();return{getId:()=>function vt(u){return at.apply(this,arguments)}(A),getToken:re=>function ve(u){return Xe.apply(this,arguments)}(A,re)}};(function J(){(0,r._registerComponent)(new Q.wA(c,F,"PUBLIC")),(0,r._registerComponent)(new Q.wA("installations-internal",Z,"PRIVATE"))})(),(0,r.registerVersion)(pe,ce),(0,r.registerVersion)(pe,ce,"esm2017")},3338:(St,Ue,g)=>{g.d(Ue,{Gb:()=>Je,LP:()=>Mt,pQ:()=>Nt,ps:()=>Tt});var S=g(5861),Q=(g(6294),g(3427)),ue=g(8667),te=g(963),pe=g(9032);const ce="/firebase-messaging-sw.js",N="/firebase-cloud-messaging-push-scope",e="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",He="https://fcmregistrations.googleapis.com/v1",Ae="google.c.a.c_id",be="google.c.a.c_l",he="google.c.a.ts";var V=function(c){return c.PUSH_RECEIVED="push-received",c.NOTIFICATION_CLICKED="notification-clicked",c}(V||{});function ie(c){const h=new Uint8Array(c);return btoa(String.fromCharCode(...h)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function ae(c){const F=(c+"=".repeat((4-c.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),Z=atob(F),J=new Uint8Array(Z.length);for(let u=0;u<Z.length;++u)J[u]=Z.charCodeAt(u);return J}const we="fcm_token_details_db",W=5,H="fcm_token_object_Store";function Ie(){return Ie=(0,S.Z)(function*(c){if("databases"in indexedDB&&!(yield indexedDB.databases()).map(u=>u.name).includes(we))return null;let h=null;return(yield(0,ue.X3)(we,W,{upgrade:(Z=(0,S.Z)(function*(J,u,f,A){var $;if(u<2||!J.objectStoreNames.contains(H))return;const re=A.objectStore(H),ee=yield re.index("fcmSenderId").get(c);if(yield re.clear(),ee)if(2===u){const l=ee;if(!l.auth||!l.p256dh||!l.endpoint)return;h={token:l.fcmToken,createTime:null!==($=l.createTime)&&void 0!==$?$:Date.now(),subscriptionOptions:{auth:l.auth,p256dh:l.p256dh,endpoint:l.endpoint,swScope:l.swScope,vapidKey:"string"==typeof l.vapidKey?l.vapidKey:ie(l.vapidKey)}}}else if(3===u){const l=ee;h={token:l.fcmToken,createTime:l.createTime,subscriptionOptions:{auth:ie(l.auth),p256dh:ie(l.p256dh),endpoint:l.endpoint,swScope:l.swScope,vapidKey:ie(l.vapidKey)}}}else if(4===u){const l=ee;h={token:l.fcmToken,createTime:l.createTime,subscriptionOptions:{auth:ie(l.auth),p256dh:ie(l.p256dh),endpoint:l.endpoint,swScope:l.swScope,vapidKey:ie(l.vapidKey)}}}}),function(u,f,A,$){return Z.apply(this,arguments)})})).close(),yield(0,ue.Lj)(we),yield(0,ue.Lj)("fcm_vapid_details_db"),yield(0,ue.Lj)("undefined"),function $e(c){if(!c||!c.subscriptionOptions)return!1;const{subscriptionOptions:h}=c;return"number"==typeof c.createTime&&c.createTime>0&&"string"==typeof c.token&&c.token.length>0&&"string"==typeof h.auth&&h.auth.length>0&&"string"==typeof h.p256dh&&h.p256dh.length>0&&"string"==typeof h.endpoint&&h.endpoint.length>0&&"string"==typeof h.swScope&&h.swScope.length>0&&"string"==typeof h.vapidKey&&h.vapidKey.length>0}(h)?h:null;var Z}),Ie.apply(this,arguments)}const le="firebase-messaging-database",De=1,ne="firebase-messaging-store";let Be=null;function y(){return Be||(Be=(0,ue.X3)(le,De,{upgrade:(c,h)=>{0===h&&c.createObjectStore(ne)}})),Be}function T(c){return b.apply(this,arguments)}function b(){return b=(0,S.Z)(function*(c){const h=k(c),Z=yield(yield y()).transaction(ne).objectStore(ne).get(h);if(Z)return Z;{const J=yield function Oe(c){return Ie.apply(this,arguments)}(c.appConfig.senderId);if(J)return yield I(c,J),J}}),b.apply(this,arguments)}function I(c,h){return U.apply(this,arguments)}function U(){return(U=(0,S.Z)(function*(c,h){const F=k(c),J=(yield y()).transaction(ne,"readwrite");return yield J.objectStore(ne).put(h,F),yield J.done,h})).apply(this,arguments)}function P(){return(P=(0,S.Z)(function*(c){const h=k(c),Z=(yield y()).transaction(ne,"readwrite");yield Z.objectStore(ne).delete(h),yield Z.done})).apply(this,arguments)}function k({appConfig:c}){return c.appId}const m=new te.LL("messaging","Messaging",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."});function q(c,h){return se.apply(this,arguments)}function se(){return(se=(0,S.Z)(function*(c,h){const F=yield K(c),Z=L(h),J={method:"POST",headers:F,body:JSON.stringify(Z)};let u;try{u=yield(yield fetch(B(c.appConfig),J)).json()}catch(f){throw m.create("token-subscribe-failed",{errorInfo:f?.toString()})}if(u.error)throw m.create("token-subscribe-failed",{errorInfo:u.error.message});if(!u.token)throw m.create("token-subscribe-no-token");return u.token})).apply(this,arguments)}function me(){return(me=(0,S.Z)(function*(c,h){const F=yield K(c),Z=L(h.subscriptionOptions),J={method:"PATCH",headers:F,body:JSON.stringify(Z)};let u;try{u=yield(yield fetch(`${B(c.appConfig)}/${h.token}`,J)).json()}catch(f){throw m.create("token-update-failed",{errorInfo:f?.toString()})}if(u.error)throw m.create("token-update-failed",{errorInfo:u.error.message});if(!u.token)throw m.create("token-update-no-token");return u.token})).apply(this,arguments)}function Y(c,h){return Ge.apply(this,arguments)}function Ge(){return(Ge=(0,S.Z)(function*(c,h){const Z={method:"DELETE",headers:yield K(c)};try{const u=yield(yield fetch(`${B(c.appConfig)}/${h}`,Z)).json();if(u.error)throw m.create("token-unsubscribe-failed",{errorInfo:u.error.message})}catch(J){throw m.create("token-unsubscribe-failed",{errorInfo:J?.toString()})}})).apply(this,arguments)}function B({projectId:c}){return`${He}/projects/${c}/registrations`}function K(c){return x.apply(this,arguments)}function x(){return(x=(0,S.Z)(function*({appConfig:c,installations:h}){const F=yield h.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":c.apiKey,"x-goog-firebase-installations-auth":`FIS ${F}`})})).apply(this,arguments)}function L({p256dh:c,auth:h,endpoint:F,vapidKey:Z}){const J={web:{endpoint:F,auth:h,p256dh:c}};return Z!==e&&(J.web.applicationPubKey=Z),J}const D=6048e5;function Ze(){return Ze=(0,S.Z)(function*(c){const h=yield function lt(c,h){return ze.apply(this,arguments)}(c.swRegistration,c.vapidKey),F={vapidKey:c.vapidKey,swScope:c.swRegistration.scope,endpoint:h.endpoint,auth:ie(h.getKey("auth")),p256dh:ie(h.getKey("p256dh"))},Z=yield T(c.firebaseDependencies);if(Z){if(function Pt(c,h){return h.vapidKey===c.vapidKey&&h.endpoint===c.endpoint&&h.auth===c.auth&&h.p256dh===c.p256dh}(Z.subscriptionOptions,F))return Date.now()>=Z.createTime+D?function ke(c,h){return qe.apply(this,arguments)}(c,{token:Z.token,createTime:Date.now(),subscriptionOptions:F}):Z.token;try{yield Y(c.firebaseDependencies,Z.token)}catch(J){console.warn(J)}return Ne(c.firebaseDependencies,F)}return Ne(c.firebaseDependencies,F)}),Ze.apply(this,arguments)}function Ve(c){return Me.apply(this,arguments)}function Me(){return Me=(0,S.Z)(function*(c){const h=yield T(c.firebaseDependencies);h&&(yield Y(c.firebaseDependencies,h.token),yield function _(c){return P.apply(this,arguments)}(c.firebaseDependencies));const F=yield c.swRegistration.pushManager.getSubscription();return!F||F.unsubscribe()}),Me.apply(this,arguments)}function qe(){return qe=(0,S.Z)(function*(c,h){try{const F=yield function oe(c,h){return me.apply(this,arguments)}(c.firebaseDependencies,h),Z=Object.assign(Object.assign({},h),{token:F,createTime:Date.now()});return yield I(c.firebaseDependencies,Z),F}catch(F){throw yield Ve(c),F}}),qe.apply(this,arguments)}function Ne(c,h){return Ye.apply(this,arguments)}function Ye(){return(Ye=(0,S.Z)(function*(c,h){const Z={token:yield q(c,h),createTime:Date.now(),subscriptionOptions:h};return yield I(c,Z),Z.token})).apply(this,arguments)}function ze(){return(ze=(0,S.Z)(function*(c,h){return(yield c.pushManager.getSubscription())||c.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:ae(h)})})).apply(this,arguments)}function It(c){const h={from:c.from,collapseKey:c.collapse_key,messageId:c.fcmMessageId};return function dt(c,h){if(!h.notification)return;c.notification={};const F=h.notification.title;F&&(c.notification.title=F);const Z=h.notification.body;Z&&(c.notification.body=Z);const J=h.notification.image;J&&(c.notification.image=J);const u=h.notification.icon;u&&(c.notification.icon=u)}(h,c),function Ot(c,h){h.data&&(c.data=h.data)}(h,c),function pt(c,h){var F,Z,J,u,f;if(!(h.fcmOptions||null!==(F=h.notification)&&void 0!==F&&F.click_action))return;c.fcmOptions={};const A=null!==(J=null===(Z=h.fcmOptions)||void 0===Z?void 0:Z.link)&&void 0!==J?J:null===(u=h.notification)||void 0===u?void 0:u.click_action;A&&(c.fcmOptions.link=A);const $=null===(f=h.fcmOptions)||void 0===f?void 0:f.analytics_label;$&&(c.fcmOptions.analyticsLabel=$)}(h,c),h}function ht(c,h){const F=[];for(let Z=0;Z<c.length;Z++)F.push(c.charAt(Z)),Z<h.length&&F.push(h.charAt(Z));return F.join("")}function ft(c){return m.create("missing-app-config-values",{valueName:c})}ht("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),ht("AzSCbw63g1R0nCw85jG8","Iaya3yLKwmgvh7cF0q4");class _e{constructor(h,F,Z){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const J=function Dt(c){if(!c||!c.options)throw ft("App Configuration Object");if(!c.name)throw ft("App Name");const h=["projectId","apiKey","appId","messagingSenderId"],{options:F}=c;for(const Z of h)if(!F[Z])throw ft(Z);return{appName:c.name,projectId:F.projectId,apiKey:F.apiKey,appId:F.appId,senderId:F.messagingSenderId}}(h);this.firebaseDependencies={app:h,appConfig:J,installations:F,analyticsProvider:Z}}_delete(){return Promise.resolve()}}function rt(c){return Ke.apply(this,arguments)}function Ke(){return(Ke=(0,S.Z)(function*(c){try{c.swRegistration=yield navigator.serviceWorker.register(ce,{scope:N}),c.swRegistration.update().catch(()=>{})}catch(h){throw m.create("failed-service-worker-registration",{browserErrorMessage:h?.message})}})).apply(this,arguments)}function gt(){return(gt=(0,S.Z)(function*(c,h){if(!h&&!c.swRegistration&&(yield rt(c)),h||!c.swRegistration){if(!(h instanceof ServiceWorkerRegistration))throw m.create("invalid-sw-registration");c.swRegistration=h}})).apply(this,arguments)}function tt(){return(tt=(0,S.Z)(function*(c,h){h?c.vapidKey=h:c.vapidKey||(c.vapidKey=e)})).apply(this,arguments)}function xt(c,h){return nt.apply(this,arguments)}function nt(){return nt=(0,S.Z)(function*(c,h){if(!navigator)throw m.create("only-available-in-window");if("default"===Notification.permission&&(yield Notification.requestPermission()),"granted"!==Notification.permission)throw m.create("permission-blocked");return yield function st(c,h){return tt.apply(this,arguments)}(c,h?.vapidKey),yield function it(c,h){return gt.apply(this,arguments)}(c,h?.serviceWorkerRegistration),function X(c){return Ze.apply(this,arguments)}(c)}),nt.apply(this,arguments)}function xe(){return(xe=(0,S.Z)(function*(c,h,F){const Z=function mt(c){switch(c){case V.NOTIFICATION_CLICKED:return"notification_open";case V.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}(h);(yield c.firebaseDependencies.analyticsProvider.get()).logEvent(Z,{message_id:F[Ae],message_name:F[be],message_time:F[he],message_device_time:Math.floor(Date.now()/1e3)})})).apply(this,arguments)}function _t(){return _t=(0,S.Z)(function*(c,h){const F=h.data;if(!F.isFirebaseMessaging)return;c.onMessageHandler&&F.messageType===V.PUSH_RECEIVED&&("function"==typeof c.onMessageHandler?c.onMessageHandler(It(F)):c.onMessageHandler.next(It(F)));const Z=F.data;(function kt(c){return"object"==typeof c&&!!c&&Ae in c})(Z)&&"1"===Z["google.c.a.e"]&&(yield function Ut(c,h,F){return xe.apply(this,arguments)}(c,F.messageType,Z))}),_t.apply(this,arguments)}const vt="@firebase/messaging",ve=c=>{const h=new _e(c.getProvider("app").getImmediate(),c.getProvider("installations-internal").getImmediate(),c.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",F=>function Bt(c,h){return _t.apply(this,arguments)}(h,F)),h},Xe=c=>{const h=c.getProvider("messaging").getImmediate();return{getToken:Z=>xt(h,Z)}};function Je(){return Ct.apply(this,arguments)}function Ct(){return(Ct=(0,S.Z)(function*(){try{yield(0,te.eu)()}catch{return!1}return typeof window<"u"&&(0,te.hl)()&&(0,te.zI)()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")})).apply(this,arguments)}function ut(){return(ut=(0,S.Z)(function*(c){if(!navigator)throw m.create("only-available-in-window");return c.swRegistration||(yield rt(c)),Ve(c)})).apply(this,arguments)}function Mt(c,h){return bt.apply(this,arguments)}function bt(){return(bt=(0,S.Z)(function*(c,h){return xt(c=(0,te.m9)(c),h)})).apply(this,arguments)}function Nt(c){return function yt(c){return ut.apply(this,arguments)}(c=(0,te.m9)(c))}function Tt(c,h){return function Gt(c,h){if(!navigator)throw m.create("only-available-in-window");return c.onMessageHandler=h,()=>{c.onMessageHandler=null}}(c=(0,te.m9)(c),h)}!function Zt(){(0,pe._registerComponent)(new Q.wA("messaging",ve,"PUBLIC")),(0,pe._registerComponent)(new Q.wA("messaging-internal",Xe,"PRIVATE")),(0,pe.registerVersion)(vt,"0.12.6"),(0,pe.registerVersion)(vt,"0.12.6","esm2017")}()}}]);