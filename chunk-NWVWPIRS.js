import{$ as y,H as d,K as C,Nc as f,Pc as g,Y as h,aa as u,b as v,c as k,ia as I,ka as P,m as S,o as E,r as x,ua as D,vc as $,z as p}from"./chunk-FWGH4434.js";var w=(()=>{class i{constructor(){this.document=u(I),this.platformId=u(D),this.documentIsAccessible=$(this.platformId)}static getCookieRegExp(e){let t=e.replace(/([[\]{}()|=;+?,.*^$\\])/gi,"\\$1");return new RegExp("(?:^"+t+"|;\\s*"+t+")=(.*?)(?:;|$)","g")}static safeDecodeURIComponent(e){try{return decodeURIComponent(e)}catch{return e}}check(e){return this.documentIsAccessible?(e=encodeURIComponent(e),i.getCookieRegExp(e).test(this.document.cookie)):!1}get(e){if(this.check(e)){e=encodeURIComponent(e);let n=i.getCookieRegExp(e).exec(this.document.cookie);return n?.[1]?i.safeDecodeURIComponent(n[1]):""}else return""}getAll(){if(!this.documentIsAccessible)return{};let e={},t=this.document;return t.cookie&&t.cookie!==""&&t.cookie.split(";").forEach(n=>{let[a,r]=n.split("=");e[i.safeDecodeURIComponent(a.replace(/^ /,""))]=i.safeDecodeURIComponent(r)}),e}set(e,t,n,a,r,l,b,U){if(!this.documentIsAccessible)return;if(typeof n=="number"||n instanceof Date||a||r||l||b){let m={expires:n,path:a,domain:r,secure:l,sameSite:b||"Lax",partitioned:U};this.set(e,t,m);return}let c=encodeURIComponent(e)+"="+encodeURIComponent(t)+";",o=n||{};if(o.expires)if(typeof o.expires=="number"){let m=new Date(new Date().getTime()+o.expires*1e3*60*60*24);c+="expires="+m.toUTCString()+";"}else c+="expires="+o.expires.toUTCString()+";";o.path&&(c+="path="+o.path+";"),o.domain&&(c+="domain="+o.domain+";"),o.secure===!1&&o.sameSite==="None"&&(o.secure=!0,console.warn(`[ngx-cookie-service] Cookie ${e} was forced with secure flag because sameSite=None.More details : https://github.com/stevermeister/ngx-cookie-service/issues/86#issuecomment-597720130`)),o.secure&&(c+="secure;"),o.sameSite||(o.sameSite="Lax"),c+="sameSite="+o.sameSite+";",o.partitioned&&(c+="Partitioned;"),this.document.cookie=c}delete(e,t,n,a,r="Lax"){if(!this.documentIsAccessible)return;let l=new Date("Thu, 01 Jan 1970 00:00:01 GMT");this.set(e,"",{expires:l,path:t,domain:n,secure:a,sameSite:r})}deleteAll(e,t,n,a="Lax"){if(!this.documentIsAccessible)return;let r=this.getAll();for(let l in r)r.hasOwnProperty(l)&&this.delete(l,e,t,n,a)}static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275prov=h({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();var L=class i{constructor(s){this.cookie=s;this.cookie.check("grant")&&(this.permission="allow"),this.loginStateEmitter=new k(this.cookie.check("login")),this._loginPhotoChangedSource$=this.loginPhotoEmitter.pipe(d()),this._loginPhotoChanged$=this._loginPhotoChangedSource$.pipe(p(e=>!!e)),this._loginStateChanged$=this.loginStateEmitter.pipe(d()),this._logoutEmitter=this.loginStateEmitter.pipe(C((e,t)=>[t,e[0]],[!1]),p(([e,t])=>t===!0&&e===!1),E(e=>{}))}destroy$=new v;permission="not-yet";_seemsLogin=!1;loginPhotoEmitter=new P;loginStateEmitter;_loginPhotoChangedSource$;_loginPhotoChanged$;_loginStateChanged$;_loginPhotoUrl=null;_logoutEmitter;ngOnDestroy(){g("SessionService.OnDestroy"),this.destroy$.next()}get markedLogout$(){return this._logoutEmitter}loginPhoto$(){return x(S(this._loginPhotoUrl),this.loginPhotoChanged$)}get loginPhotoChanged$(){return this._loginPhotoChanged$}get loginStateChanged$(){return this._loginStateChanged$}get isSeemsLogin(){return this._seemsLogin}grantAccess(){this.permission="allow";let s=new Date;s.setMinutes(s.getMinutes()+f.grantSessionExpires),this.cookie.set("grant","1",s,"/Gitfire")}declineAccess(){this.permission="inhibit",this.cookie.deleteAll()}shouldConfirm(){return this.permission==="not-yet"&&!this.isCookieGranted()}isCookieGranted(){return this.cookie.check("grant")}isMarkedAsLogin(){return this.cookie.check("login")}updateLoginPhoto(s){g("SessionService.updateLoginPhoto",s),this._loginPhotoUrl=s,this.loginPhotoEmitter.emit(s)}markLogin(){if(g("SessionService.markLogin"),this._seemsLogin=!0,this.permission==="allow")return;let s=new Date;s.setMinutes(s.getMinutes()+f.localSessionExpires),this.cookie.set("login","1",s,"/"),this.loginStateEmitter.next(!0)}unmarkLogin(){g("SessionService.unmarkLogin"),this._seemsLogin=!1,this.cookie.delete("login"),this.loginStateEmitter.next(!1),this.loginPhotoEmitter.emit(null)}static \u0275fac=function(e){return new(e||i)(y(w))};static \u0275prov=h({token:i,factory:i.\u0275fac,providedIn:"root"})};export{L as a};
