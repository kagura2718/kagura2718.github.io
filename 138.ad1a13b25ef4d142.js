"use strict";(self.webpackChunkKaguraGithubPages=self.webpackChunkKaguraGithubPages||[]).push([[79,138],{1409(X,G,s){var k=s(9574),c=s(467),P=s(1631),v=s(1871),T=s(8779);function z(e,n){const t={};for(const r in e)e.hasOwnProperty(r)&&(t[r]=n(e[r]));return t}function U(e){if(null==e)return null;if(e instanceof Number&&(e=e.valueOf()),"number"==typeof e&&isFinite(e)||!0===e||!1===e||"[object String]"===Object.prototype.toString.call(e))return e;if(e instanceof Date)return e.toISOString();if(Array.isArray(e))return e.map(n=>U(n));if("function"==typeof e||"object"==typeof e)return z(e,n=>U(n));throw new Error("Data cannot be encoded in JSON: "+e)}function D(e){if(null==e)return e;if(e["@type"])switch(e["@type"]){case"type.googleapis.com/google.protobuf.Int64Value":case"type.googleapis.com/google.protobuf.UInt64Value":{const n=Number(e.value);if(isNaN(n))throw new Error("Data cannot be decoded from JSON: "+e);return n}default:throw new Error("Data cannot be decoded from JSON: "+e)}return Array.isArray(e)?e.map(n=>D(n)):"function"==typeof e||"object"==typeof e?z(e,n=>D(n)):e}const j="functions",F={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class A extends v.g{constructor(n,t,r){super(`${j}/${n}`,t||""),this.details=r,Object.setPrototypeOf(this,A.prototype)}}function u(e,n){let a,t=function o(e){if(e>=200&&e<300)return"ok";switch(e){case 0:case 500:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}(e),r=t;try{const l=n&&n.error;if(l){const h=l.status;if("string"==typeof h){if(!F[h])return new A("internal","internal");t=F[h],r=h}const p=l.message;"string"==typeof p&&(r=p),a=l.details,void 0!==a&&(a=D(a))}}catch{}return"ok"===t?null:new A(t,r,a)}class _{constructor(n,t,r,a){this.app=n,this.auth=null,this.messaging=null,this.appCheck=null,this.serverAppAppCheckToken=null,(0,P._isFirebaseServerApp)(n)&&n.settings.appCheckToken&&(this.serverAppAppCheckToken=n.settings.appCheckToken),this.auth=t.getImmediate({optional:!0}),this.messaging=r.getImmediate({optional:!0}),this.auth||t.get().then(l=>this.auth=l,()=>{}),this.messaging||r.get().then(l=>this.messaging=l,()=>{}),this.appCheck||a?.get().then(l=>this.appCheck=l,()=>{})}getAuthToken(){var n=this;return(0,c.A)(function*(){if(n.auth)try{const t=yield n.auth.getToken();return t?.accessToken}catch{return}})()}getMessagingToken(){var n=this;return(0,c.A)(function*(){if(n.messaging&&"Notification"in self&&"granted"===Notification.permission)try{return yield n.messaging.getToken()}catch{return}})()}getAppCheckToken(n){var t=this;return(0,c.A)(function*(){if(t.serverAppAppCheckToken)return t.serverAppAppCheckToken;if(t.appCheck){const r=n?yield t.appCheck.getLimitedUseToken():yield t.appCheck.getToken();return r.error?null:r.token}return null})()}getContext(n){var t=this;return(0,c.A)(function*(){return{authToken:yield t.getAuthToken(),messagingToken:yield t.getMessagingToken(),appCheckToken:yield t.getAppCheckToken(n)}})()}}const f="us-central1",b=/^data: (.*?)(?:\n|$)/;class y{constructor(n,t,r,a,l=f,h=(...p)=>fetch(...p)){this.app=n,this.fetchImpl=h,this.emulatorOrigin=null,this.contextProvider=new _(n,t,r,a),this.cancelAllRequests=new Promise(p=>{this.deleteService=()=>Promise.resolve(p())});try{const p=new URL(l);this.customDomain=p.origin+("/"===p.pathname?"":p.pathname),this.region=f}catch{this.customDomain=null,this.region=l}}_delete(){return this.deleteService()}_url(n){const t=this.app.options.projectId;return null!==this.emulatorOrigin?`${this.emulatorOrigin}/${t}/${this.region}/${n}`:null!==this.customDomain?`${this.customDomain}/${n}`:`https://${this.region}-${t}.cloudfunctions.net/${n}`}}function w(e,n,t,r){return R.apply(this,arguments)}function R(){return(R=(0,c.A)(function*(e,n,t,r){let a;t["Content-Type"]="application/json";try{a=yield r(e,{method:"POST",body:JSON.stringify(n),headers:t})}catch{return{status:0,json:null}}let l=null;try{l=yield a.json()}catch{}return{status:a.status,json:l}})).apply(this,arguments)}function N(e,n){return B.apply(this,arguments)}function B(){return(B=(0,c.A)(function*(e,n){const t={},r=yield e.contextProvider.getContext(n.limitedUseAppCheckTokens);return r.authToken&&(t.Authorization="Bearer "+r.authToken),r.messagingToken&&(t["Firebase-Instance-ID-Token"]=r.messagingToken),null!==r.appCheckToken&&(t["X-Firebase-AppCheck"]=r.appCheckToken),t})).apply(this,arguments)}function C(e,n,t,r){return W.apply(this,arguments)}function W(){return(W=(0,c.A)(function*(e,n,t,r){const a={data:t=U(t)},l=yield N(e,r),p=function d(e){let n=null;return{promise:new Promise((t,r)=>{n=setTimeout(()=>{r(new A("deadline-exceeded","deadline-exceeded"))},e)}),cancel:()=>{n&&clearTimeout(n)}}}(r.timeout||7e4),I=yield Promise.race([w(n,a,l,e.fetchImpl),p.promise,e.cancelAllRequests]);if(p.cancel(),!I)throw new A("cancelled","Firebase Functions instance was deleted.");const $=u(I.status,I.json);if($)throw $;if(!I.json)throw new A("internal","Response is not valid JSON object.");let g=I.json.data;if(typeof g>"u"&&(g=I.json.result),typeof g>"u")throw new A("internal","Response is missing data field.");return{data:D(g)}})).apply(this,arguments)}function E(e,n,t,r){return K.apply(this,arguments)}function K(){return K=(0,c.A)(function*(e,n,t,r){var a;const l={data:t=U(t)},h=yield N(e,r);let p,I,$;h["Content-Type"]="application/json",h.Accept="text/event-stream";try{p=yield e.fetchImpl(n,{method:"POST",body:JSON.stringify(l),headers:h,signal:r?.signal})}catch(x){if(x instanceof Error&&"AbortError"===x.name){const Z=new A("cancelled","Request was cancelled.");return{data:Promise.reject(Z),stream:{[Symbol.asyncIterator]:()=>({next:()=>Promise.reject(Z)})}}}const Q=u(0,null);return{data:Promise.reject(Q),stream:{[Symbol.asyncIterator]:()=>({next:()=>Promise.reject(Q)})}}}const g=new Promise((x,Q)=>{I=x,$=Q});null===(a=r?.signal)||void 0===a||a.addEventListener("abort",()=>{const x=new A("cancelled","Request was cancelled.");$(x)});const Y=function H(e,n,t,r){const a=(h,p)=>{const I=h.match(b);if(!I)return;const $=I[1];try{const g=JSON.parse($);if("result"in g)return void n(D(g.result));if("message"in g)return void p.enqueue(D(g.message));if("error"in g){const V=u(0,g);return p.error(V),void t(V)}}catch(g){if(g instanceof A)return p.error(g),void t(g)}},l=new TextDecoder;return new ReadableStream({start(h){let p="";return I();function I(){return $.apply(this,arguments)}function $(){return $=(0,c.A)(function*(){if(r?.aborted){const g=new A("cancelled","Request was cancelled");return h.error(g),t(g),Promise.resolve()}try{const{value:g,done:V}=yield e.read();if(V)return p.trim()&&a(p.trim(),h),void h.close();if(r?.aborted){const x=new A("cancelled","Request was cancelled");return h.error(x),t(x),void(yield e.cancel())}p+=l.decode(g,{stream:!0});const Y=p.split("\n");p=Y.pop()||"";for(const x of Y)x.trim()&&a(x.trim(),h);return I()}catch(g){const V=g instanceof A?g:u(0,null);h.error(V),t(V)}}),$.apply(this,arguments)}},cancel:()=>e.cancel()})}(p.body.getReader(),I,$,r?.signal);return{stream:{[Symbol.asyncIterator](){const x=Y.getReader();return{next:()=>(0,c.A)(function*(){const{value:Q,done:Z}=yield x.read();return{value:Q,done:Z}})(),return:()=>(0,c.A)(function*(){return yield x.cancel(),{done:!0,value:void 0}})()}}},data:g}}),K.apply(this,arguments)}const ee="@firebase/functions";function q(e,n,t){!function M(e,n,t){const r=(0,v.zJ)(n);e.emulatorOrigin=`http${r?"s":""}://${n}:${t}`,r&&((0,v.gE)(e.emulatorOrigin),(0,v.P1)("Functions",!0))}((0,v.Ku)(e),n,t)}!function ie(e){(0,P._registerComponent)(new T.uA(j,(t,{instanceIdentifier:r})=>{const a=t.getProvider("app").getImmediate(),l=t.getProvider("auth-internal"),h=t.getProvider("messaging-internal"),p=t.getProvider("app-check-internal");return new y(a,l,h,p,r)},"PUBLIC").setMultipleInstances(!0)),(0,P.registerVersion)(ee,"0.12.9",e),(0,P.registerVersion)(ee,"0.12.9","esm2017")}();class ne{constructor(n,t){this.app=n,this._delegate=t,this._region=this._delegate.region,this._customDomain=this._delegate.customDomain}httpsCallable(n,t){return function ae(e,n,t){return function i(e,n,t){const r=a=>function O(e,n,t,r){const a=e._url(n);return C(e,a,t,r)}(e,n,a,t||{});return r.stream=(a,l)=>function m(e,n,t,r){const a=e._url(n);return E(e,a,t,r||{})}(e,n,a,l),r}((0,v.Ku)(e),n,t)}(this._delegate,n,t)}httpsCallableFromURL(n,t){return function ue(e,n,t){return function L(e,n,t){const r=a=>C(e,n,a,t||{});return r.stream=(a,l)=>E(e,n,a,l||{}),r}((0,v.Ku)(e),n,t)}(this._delegate,n,t)}useFunctionsEmulator(n){const t=n.match("[a-zA-Z]+://([a-zA-Z0-9.-]+)(?::([0-9]+))?");if(null==t)throw new v.g("functions","No origin provided to useFunctionsEmulator()");if(null==t[2])throw new v.g("functions","Port missing in origin provided to useFunctionsEmulator()");return q(this._delegate,t[1],Number(t[2]))}useEmulator(n,t){return q(this._delegate,n,t)}}const fe=(e,{instanceIdentifier:n})=>{const t=e.getProvider("app-compat").getImmediate(),r=e.getProvider("functions").getImmediate({identifier:n??"us-central1"});return new ne(t,r)};(function pe(){const e={Functions:ne};k.A.INTERNAL.registerComponent(new T.uA("functions-compat",fe,"PUBLIC").setServiceProps(e).setMultipleInstances(!0))})(),k.A.registerVersion("@firebase/functions-compat","0.3.26")},1474(X,G,s){s.d(G,{u:()=>M});var k=s(467),c=s(375),P=s(1413),v=s(2771),T=s(7673),J=s(152),S=s(3294),z=s(5964),U=s(9568),D=s(5558),j=s(6697),F=s(6977),A=s(8141),o=s(5312),u=s(1152),_=s(4871),f=s(9182),b=s(8334),d=s(4715);class y{auth;funcs;localSession;store;dom;finalize$=new P.B;state$;localUser$;isAdminUser=!1;isDevelopUser=!1;hasMessagingDevice=!1;loginUid=null;env=(0,c.WQX)(c.uvJ);sourceValue$=new v.m;constructor(L,w,R,N,B){var O=this;this.auth=L,this.funcs=w,this.localSession=R,this.store=N,this.dom=B,(0,o.Oi)("SingletonAuth.constructor()"),this.dom.addResourceHint("https://identitytoolkit.googleapis.com","preconnect"),this.dom.addResourceHint("https://firebaseinstallations.googleapis.com","preconnect"),this.dom.addResourceHint("https://firestore.googleapis.com","preconnect"),this.dom.addResourceHint("https://apis.google.com","preconnect"),this.dom.addResourceHint(`https://${o.cA.firebaseConfig.authDomain}`,"preconnect"),this.dom.addResourceHint(`https://${o.cA.FirebaseCloudFunctionsHost}`,"preconnect");const C=this.auth.user.pipe((0,S.F)());C.pipe((0,S.F)(),(0,F.Q)(this.finalize$)).subscribe(m=>{this.sourceValue$.next()}),this.state$=C.pipe((0,z.p)(m=>null!==m)),this.localSession.markedLogout$.pipe((0,F.Q)(this.finalize$)).subscribe(()=>{this.sourceValue$.next()}),this.state$.pipe((0,F.Q)(this.finalize$)).subscribe({error:m=>{(0,o.sJ)("AuthService.state$ error",m),this.doFinalize()},complete:()=>{(0,o.rD)("AuthService.state$ completed."),this.doFinalize()}}),this.state$.pipe((0,D.n)(m=>(0,c.N4e)(this.env,()=>this.store.collection(`/users/v1/protected/${m.uid}/fcm`).valueChanges().pipe((0,A.M)(E=>(0,o.Oi)("UserProtectedStore has changed.",E))))),(0,F.Q)(this.finalize$)).subscribe({next:m=>{this.sourceValue$.next()},error:m=>{(0,o.sJ)("AuthService.state$ Maybe after logout permission error. Ignore it.",m),this.doFinalize()},complete:()=>{(0,o.rD)("AuthService.state$ completed."),this.doFinalize()}});const W=this.state$.pipe((0,D.n)(function(){var m=(0,k.A)(function*(E){try{const K=yield O.funcs.call("readUserSettings"),H=E;return H.isAdmin=K.isAdmin,H.isDeveloper=K.isDeveloper,H.hasMessaging=K.hasMessaging,H}catch(K){return(0,o.sJ)("AuthService while check user settings.",K),null}});return function(E){return m.apply(this,arguments)}}()));var m;this.localUser$=this.sourceValue$.pipe((0,J.B)(100),(0,D.n)(()=>C.pipe((0,D.n)(m=>null===m?(0,T.of)(null):W))),(0,U.t)(1)),this.localUser$.pipe((0,F.Q)(this.finalize$)).subscribe({next:(m=(0,k.A)(function*(E){(0,o.Oi)("AuthService.localUser$.subscribe()",E),E?(O.loginUid=E.uid,O.isAdminUser=!!E.isAdmin,O.isDevelopUser=!!E.isDeveloper,O.hasMessagingDevice=!!E.hasMessaging,O.localSession.updateLoginPhoto(E.photoURL),O.localSession.markLogin()):(O.localSession.unmarkLogin(),O.localSession.updateLoginPhoto(null),O.loginUid=null,O.isAdminUser=!1,O.isDevelopUser=!1,O.hasMessagingDevice=!1,(0,o.rD)("Explicitly logout on client sdk."),yield O.auth.signOut())}),function(K){return m.apply(this,arguments)}),complete:()=>{(0,o.rD)("AuthService.localUser$ complete."),this.doFinalize()},error:m=>{(0,o.sJ)("AuthService.localUser$ error while retrieving.",m),this.doFinalize()}})}doFinalize(){this.finalize$.isStopped||((0,o.rD)("Do finalize Singleton Auth"),this.finalize$.next(),this.finalize$.complete())}}let M=(()=>{class i{auth;funcs;localSession;store;dom;static AUTH=null;_clientSideUser$;constructor(w,R,N,B,O){this.auth=w,this.funcs=R,this.localSession=N,this.store=B,this.dom=O,(0,o.Oi)("AuthService.constructor()");const C=new v.m;null===i.AUTH&&(i.AUTH=new y(w,R,N,B,O),i.AUTH.finalize$.pipe((0,j.s)(1)).subscribe({next:()=>{(0,o.rD)("Finalize singleton auth continue..")},complete:()=>{(0,o.rD)("Finalizing singleton auth completed."),i.AUTH=null,C.next()},error:W=>{(0,o.sJ)("Finalizing singleton auth cause by error.",W),i.AUTH=null,C.next()}})),this._clientSideUser$=C.pipe((0,D.n)(()=>null===i.AUTH?(0,T.of)(null):i.AUTH.localUser$),(0,U.t)(1)),C.next()}get clientSideUser$(){return this._clientSideUser$}get isAdmin(){return!!i.AUTH&&i.AUTH.isAdminUser}get isDeveloper(){return!!i.AUTH&&i.AUTH.isDevelopUser}get hasMessaging(){return!!i.AUTH&&i.AUTH.hasMessagingDevice}get myUid(){return i.AUTH?i.AUTH.loginUid:null}static \u0275fac=function(R){return new(R||i)(c.KVO(u.DS),c.KVO(_.Y),c.KVO(f.Q),c.KVO(b.Qe),c.KVO(d.K))};static \u0275prov=c.jDH({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})()},4441(X,G,s){s.d(G,{Zg:()=>u,s:()=>f}),s(1409);var c=s(375),P=s(5407),v=s(4121),T=s(9253),J=s(8455),S=s(7673),z=s(6354),U=s(941),D=s(9568),j=s(5558);s(762);const o=new c.nKC("angularfire2.functions.origin"),u=new c.nKC("angularfire2.functions.region"),_=new c.nKC("angularfire2.functions.use-emulator");let f=(()=>{class d{httpsCallable;constructor(M,i,L,w,R,N,B,O){const C=B,W=(0,S.of)(void 0).pipe((0,U.Q)(w.outsideAngular),(0,j.n)(()=>Promise.resolve().then(s.bind(s,1409))),(0,z.T)(()=>(0,T.iB)(M,L,i)),(0,z.T)(m=>(0,T.BM)(`${m.name}.functions.${R||N}`,"AngularFireFunctions",m.name,()=>{let E;if(R&&N)throw new Error("REGION and ORIGIN can't be used at the same time.");return E=m.functions(R||N||void 0),C&&E.useEmulator(...C),E},[R,N,C])),(0,D.t)({bufferSize:1,refCount:!1}));return this.httpsCallable=(m,E)=>K=>(0,J.H)(W).pipe((0,U.Q)(w.insideAngular),(0,j.n)(H=>H.httpsCallable(m,E)(K)),(0,z.T)(H=>H.data)),(0,T.Gt)(this,W,L)}static \u0275fac=function(i){return new(i||d)(c.KVO(T.rx),c.KVO(T.uP,8),c.KVO(c.SKi),c.KVO(P.u0),c.KVO(u,8),c.KVO(o,8),c.KVO(_,8),c.KVO(v.kR,8))};static \u0275prov=c.jDH({token:d,factory:d.\u0275fac,providedIn:"any"})}return d})()},4871(X,G,s){s.d(G,{Y:()=>J});var k=s(467),c=s(6697),P=s(5312),v=s(375),T=s(4441);let J=(()=>{class S{remote;constructor(U){this.remote=U,(0,P.Oi)("LocalFunctionsService.constructor()")}call(U,D){var j=this;return(0,k.A)(function*(){return yield j.remote.httpsCallable(U)(D).pipe((0,c.s)(1)).toPromise()})()}static \u0275fac=function(D){return new(D||S)(v.KVO(T.s))};static \u0275prov=v.jDH({token:S,factory:S.\u0275fac,providedIn:"root"})}return S})()},9079(X,G,s){s.d(G,{YV:()=>F,pQ:()=>v});var k=s(1985),c=s(6977),P=s(375);function v(o){o||(o=(0,P.WQX)(P.abz));const u=new k.c(_=>{if(!o.destroyed)return o.onDestroy(_.next.bind(_));_.next()});return _=>_.pipe((0,c.Q)(u))}function F(o){void 0===o&&(o=(0,P.WQX)(P.zZn));const u=o.get(P.u5s);return _=>new k.c(f=>{const b=u.add();let d=!1;function y(){d||(b(),d=!0)}const M=_.subscribe({next:i=>{f.next(i),y()},complete:()=>{f.complete(),y()},error:i=>{f.error(i),y()}});return M.add(()=>{f.unsubscribe(),y()}),M})}}}]);