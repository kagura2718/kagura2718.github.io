"use strict";(self.webpackChunkKaguraGithubPages=self.webpackChunkKaguraGithubPages||[]).push([[49],{9049:(Ut,De,p)=>{p.r(De),p.d(De,{GitfireModule:()=>Ge});var c=p(1180),H=p(6814),i=p(5739),X=p(7217),re=p(5070),ge=p(5579),Ce=p(434),pe=p(4186),L=p(5861),e=p(5879),Ne=p(8326),we=p(2650),ke=p(2096),_e=p(6232),Le=p(5592),ce=p(5211),le=p(5137),de=p(3093),ue=p(4664),Ue=p(7398),te=p(7081),ne=p(4867),Oe=p(6306),Re=p(9769),ve=p(3572),F=p(7142);const W=new e.OlP("angularfire2.messaging.vapid-key"),v=new e.OlP("angularfire2.messaging.service-worker-registeration");let C=(()=>{var h;class g{constructor(u,r,b,w,N,Me,Ke){(0,c.Z)(this,"requestPermission",void 0),(0,c.Z)(this,"getToken",void 0),(0,c.Z)(this,"tokenChanges",void 0),(0,c.Z)(this,"messages",void 0),(0,c.Z)(this,"requestToken",void 0),(0,c.Z)(this,"deleteToken",void 0);const lt=Ke,he=(0,ke.of)(void 0).pipe((0,le.R)(N.outsideAngular),(0,de.Q)(N.insideAngular),(0,ue.w)(we.Gb),(0,ue.w)(Ze=>Ze?p.e(29).then(p.bind(p,29)):_e.E),(0,Ue.U)(()=>(0,X.on)(u,w,r)),(0,ue.w)(Ze=>(0,X.cc)(`${Ze.name}.messaging`,"AngularFireMessaging",Ze.name,()=>(0,ke.of)(Ze.messaging()),[])),(0,te.d)({bufferSize:1,refCount:!1}));this.requestPermission=he.pipe((0,le.R)(N.outsideAngular),(0,de.Q)(N.insideAngular),(0,ue.w)(()=>Notification.requestPermission())),this.getToken=he.pipe((0,le.R)(N.outsideAngular),(0,de.Q)(N.insideAngular),(0,ue.w)(function(){var Ze=(0,L.Z)(function*(It){if("granted"===Notification.permission){const Yt=lt?yield lt:null;return yield It.getToken({vapidKey:Me,serviceWorkerRegistration:Yt})}return null});return function(It){return Ze.apply(this,arguments)}}()));const $t=new Le.y(Ze=>{navigator.permissions.query({name:"notifications"}).then(It=>{It.onchange=()=>Ze.next()})}),Kt=he.pipe((0,le.R)(N.outsideAngular),(0,de.Q)(N.insideAngular),(0,ne.c)($t),(0,ne.c)(this.getToken));return this.tokenChanges=he.pipe((0,le.R)(N.outsideAngular),(0,de.Q)(N.insideAngular),(0,ue.w)(()=>(0,ce.z)(this.getToken,Kt))),this.messages=he.pipe((0,le.R)(N.outsideAngular),(0,de.Q)(N.insideAngular),(0,ue.w)(Ze=>new Le.y(It=>Ze.onMessage(It)))),this.requestToken=he.pipe((0,le.R)(N.outsideAngular),(0,de.Q)(N.insideAngular),(0,ue.w)(()=>this.requestPermission),(0,Oe.K)(()=>(0,ke.of)(null)),(0,Re.z)(()=>this.tokenChanges)),this.deleteToken=()=>he.pipe((0,le.R)(N.outsideAngular),(0,de.Q)(N.insideAngular),(0,ue.w)(Ze=>Ze.deleteToken()),(0,ve.d)(!1)),(0,X.pX)(this,he,w)}}return h=g,(0,c.Z)(g,"\u0275fac",function(u){return new(u||h)(e.LFG(X.Dh),e.LFG(X.xv,8),e.LFG(e.Lbi),e.LFG(e.R0b),e.LFG(Ne.HU),e.LFG(W,8),e.LFG(v,8))}),(0,c.Z)(g,"\u0275prov",e.Yz7({token:h,factory:h.\u0275fac,providedIn:"any"})),g})(),T=(()=>{var h;class g{constructor(){F.Z.registerVersion("angularfire",Ne.q4.full,"fcm-compat")}}return h=g,(0,c.Z)(g,"\u0275fac",function(u){return new(u||h)}),(0,c.Z)(g,"\u0275mod",e.oAB({type:h})),(0,c.Z)(g,"\u0275inj",e.cJS({providers:[C]})),g})();var I=p(2425),D=p(2589),U=p(5187),E=p(8645),S=p(9773),Q=p(8180),A=p(2181),x=p(553),K=p(103),oe=p(1248);let Ee=(()=>{var h;class g extends oe.W{constructor(){super()}ngOnInit(){(0,x.eM)("DeleteConfirmComponent.OnInit()")}}return h=g,(0,c.Z)(g,"\u0275fac",function(u){return new(u||h)}),(0,c.Z)(g,"\u0275cmp",e.Xpm({type:h,selectors:[["gitfire-delete-confirm"]],features:[e.qOj],decls:10,vars:0,consts:[[1,"m-3"]],template:function(u,r){1&u&&(e.TgZ(0,"div",0)(1,"div"),e._uU(2,"\u672c\u5f53\u306b\u524a\u9664\u3057\u307e\u3059\u304b\uff1f"),e.qZA(),e.TgZ(3,"ul")(4,"li"),e._uU(5,"Google / Twitter \u306a\u3069\u306e\u30a2\u30ab\u30a6\u30f3\u30c8\u60c5\u5831\u306f\u524a\u9664\u3055\u308c\u307e\u305b\u3093\u3002"),e.qZA(),e.TgZ(6,"li"),e._uU(7,"\u516c\u958b\u3055\u308c\u305f\u6295\u7a3f\u306f\u524a\u9664\u3055\u308c\u307e\u305b\u3093\u3002"),e.qZA(),e.TgZ(8,"li"),e._uU(9,"\u53d6\u308a\u6d88\u3057\u306f\u3067\u304d\u307e\u305b\u3093\u3002"),e.qZA()()())}})),g})();p(4015);var qe,fe=p(353);const G=["specialAuthContainer"];function ie(h,g){if(1&h){const y=e.EpF();e.TgZ(0,"a",7),e.NdJ("click",function(r){const w=e.CHM(y).$implicit,N=e.oxw();return e.KtG(N.onClickReauthProvider(r,w))}),e._uU(1),e.qZA()}if(2&h){const y=g.$implicit;e.xp6(1),e.Oqu(y.providerId)}}class M extends oe.W{get providers(){return this.currentUser.providerData}constructor(g,y){super(),(0,c.Z)(this,"loader",void 0),(0,c.Z)(this,"toastr",void 0),(0,c.Z)(this,"destroy$",new E.x),(0,c.Z)(this,"currentUser",void 0),(0,c.Z)(this,"reauthed",new e.vpe),(0,c.Z)(this,"specialAuthContainer",void 0),this.loader=g,this.toastr=y}ngOnDestroy(){this.destroy$.next()}isOAuthProvider(g){return!!M.SupportedOauthProviderIds.includes(g)}onClickReauthProvider(g,y){var u=()=>super.close,r=this;return(0,L.Z)(function*(){(0,x.eM)("onClickReauthProvider()",g,y),g.preventDefault();const w=new(0,M.SUPPORTED_PROVIDERS[y.providerId]);if(r.specialAuthContainer.clear(),r.isOAuthProvider(y.providerId)){try{yield r.currentUser.reauthenticateWithPopup(w)}catch(N){(0,x.wb)("Error while reauth",N);const Me=N instanceof Error?N.message:"Unknown error";return void r.toastr.error(`\u518d\u8a8d\u8a3c\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002 ( ${Me} )`)}(0,x.eM)("Reanthenticated via OAuth provider")}else{const{GitfireLoginModule:N}=yield Promise.resolve().then(p.bind(p,3128)),{InputAuthComponent:Me}=yield Promise.resolve().then(p.bind(p,8337)),Ke=r.loader.appendComponent(r.specialAuthContainer,N,Me);Ke.isReauth=!0,Ke.reauthUser=r.currentUser,Ke.showFederations=!1;const lt=Ke.reauthed.pipe((0,Q.q)(1));try{yield lt.toPromise()}catch(he){(0,x.wb)("Error while reauth done",he);const $t=he instanceof Error?he.message:"Unknown error";return void r.toastr.error(`\u518d\u8a8d\u8a3c\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002 ( ${$t} )`)}(0,x.eM)("Reanthenticated via password")}r.reauthed.next(),u().call(r)})()}}qe=M,(0,c.Z)(M,"SUPPORTED_PROVIDERS",{}),(0,c.Z)(M,"SupportedOauthProviderIds",[]),(()=>{const h=qe.SUPPORTED_PROVIDERS,g=F.Z.auth;h[g.EmailAuthProvider.PROVIDER_ID]=g.EmailAuthProvider,h[g.TwitterAuthProvider.PROVIDER_ID]=g.TwitterAuthProvider,h[g.GoogleAuthProvider.PROVIDER_ID]=g.GoogleAuthProvider,h[g.GithubAuthProvider.PROVIDER_ID]=g.GithubAuthProvider;const y=qe.SupportedOauthProviderIds;y.push(g.TwitterAuthProvider.PROVIDER_ID),y.push(g.GoogleAuthProvider.PROVIDER_ID),y.push(g.GithubAuthProvider.PROVIDER_ID)})(),(0,c.Z)(M,"\u0275fac",function(g){return new(g||qe)(e.Y36(fe.j),e.Y36(I._W))}),(0,c.Z)(M,"\u0275cmp",e.Xpm({type:qe,selectors:[["gitfire-reauth-box"]],viewQuery:function(g,y){if(1&g&&e.Gf(G,5,e.s_b),2&g){let u;e.iGM(u=e.CRH())&&(y.specialAuthContainer=u.first)}},inputs:{currentUser:"currentUser"},outputs:{reauthed:"reauthed"},features:[e.qOj],decls:10,vars:1,consts:[[1,"m-3"],[1,"btn-group"],["type","button","data-bs-toggle","dropdown","aria-haspopup","true","aria-expanded","false",1,"btn","btn-primary","dropdown-toggle"],[1,"visually-hidden"],[1,"dropdown-menu"],["class","dropdown-item","href","#",3,"click",4,"ngFor","ngForOf"],["specialAuthContainer",""],["href","#",1,"dropdown-item",3,"click"]],template:function(g,y){1&g&&(e.TgZ(0,"div",0)(1,"div",1)(2,"button",2)(3,"span",3),e._uU(4,"Toggle Dropdown"),e.qZA(),e._uU(5,"\u8a8d\u8a3c\u65b9\u6cd5"),e.qZA(),e.TgZ(6,"div",4),e.YNc(7,ie,2,1,"a",5),e.qZA()(),e._UZ(8,"div",null,6),e.qZA()),2&g&&(e.xp6(7),e.Q6J("ngForOf",y.providers))},dependencies:[H.sg]}));var V=p(1748);function O(h,g){if(h.value!==g){if(h.dirty)return void(0,x.wb)(`Upstream value has been changed to ${h.value} -> ${g} but sillengly ignore the value.`);h.setErrors(null),h.setValue(g)}}function j(h){h.markAsPristine(),h.markAsUntouched()}var Be=p(9782),He=p(2413),Xe=p(9339),be=p(3867),ze=p(2572),Je=p(3997),it=p(9397),dt=p(7319);let st=(()=>{var h;class g{constructor(){(0,c.Z)(this,"controlLabel",void 0),(0,c.Z)(this,"formName",void 0),(0,c.Z)(this,"tooltipText",void 0),(0,c.Z)(this,"parentForm",void 0),(0,c.Z)(this,"checkChanged",new e.vpe),(0,c.Z)(this,"autoGeneratedId",void 0);const u=Math.random().toString(36).substring(2);this.autoGeneratedId=`appViewInput-${u}`}ngOnInit(){(0,x.eM)("SwitchComponent.OnInit()")}onChangeBox(u){(0,x.eM)("SwitchComponent.onChangeBox()",this.parentForm),this.checkChanged.emit(u)}}return h=g,(0,c.Z)(g,"\u0275fac",function(u){return new(u||h)}),(0,c.Z)(g,"\u0275cmp",e.Xpm({type:h,selectors:[["app-switch"]],inputs:{controlLabel:"controlLabel",formName:"formName",tooltipText:"tooltipText",parentForm:"parentForm"},outputs:{checkChanged:"checkChanged"},decls:4,vars:7,consts:[[1,"custom-control","custom-switch",3,"formGroup","title"],["type","checkbox",1,"custom-control-input",3,"id","name","formControlName","change"],[1,"custom-control-label",3,"for"]],template:function(u,r){1&u&&(e.TgZ(0,"span",0)(1,"input",1),e.NdJ("change",function(w){return r.onChangeBox(w)}),e.qZA(),e.TgZ(2,"label",2),e._uU(3),e.qZA()()),2&u&&(e.s9C("title",r.tooltipText),e.Q6J("formGroup",r.parentForm),e.xp6(1),e.s9C("id",r.autoGeneratedId),e.s9C("name",r.formName),e.s9C("formControlName",r.formName),e.xp6(1),e.s9C("for",r.autoGeneratedId),e.xp6(1),e.Oqu(r.controlLabel))},dependencies:[i.Wl,i.JJ,i.JL,i.sg,i.u]})),g})();function St(h,g){if(1&h){const y=e.EpF();e.TgZ(0,"button",22),e.NdJ("click",function(r){e.CHM(y);const b=e.oxw().$implicit,w=e.oxw();return e.KtG(w.onClickDeleteDevice(r,b))}),e._uU(1,"\u524a\u9664"),e.qZA()}}function ht(h,g){if(1&h){const y=e.EpF();e.TgZ(0,"div",19)(1,"app-switch",20),e.NdJ("checkChanged",function(r){const w=e.CHM(y).$implicit,N=e.oxw();return e.KtG(N.onToggleDevice(r,w))}),e.ALo(2,"date"),e.qZA(),e.YNc(3,St,2,0,"button",21),e.qZA()}if(2&h){const y=g.$implicit,u=e.oxw();e.xp6(1),e.cQ8("controlLabel","",y.name||"No Name"," ",y.id===u.registeredDeviceId?"[\u3053\u306e\u7aef\u672b]":null," (\u767b\u9332\u65e5: ",e.xi3(2,6,y.createdAt.toDate(),"yyyy-MM-dd"),")"),e.MGl("formName","device-",y.id,""),e.Q6J("parentForm",u.deviceForm),e.xp6(2),e.Q6J("ngIf",y.id!==u.registeredDeviceId)}}function Mt(h,g){if(1&h&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&h){const y=g.$implicit,u=g.index;e.xp6(1),e.AsE("",u,": ",y,"")}}function pt(h,g){if(1&h&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&h){const y=g.$implicit,u=g.index;e.xp6(1),e.AsE("",u,": ",y,"")}}function Zt(h,g){if(1&h&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&h){const y=g.$implicit,u=g.index;e.xp6(1),e.AsE("",u,": ",y,"")}}function ft(h,g){if(1&h&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"json"),e.qZA()),2&h){const y=g.$implicit;e.xp6(1),e.Oqu(e.lcZ(2,1,y))}}let Nt=(()=>{var h;class g{constructor(u,r,b,w,N,Me){(0,c.Z)(this,"auth",void 0),(0,c.Z)(this,"dialog",void 0),(0,c.Z)(this,"toastr",void 0),(0,c.Z)(this,"store",void 0),(0,c.Z)(this,"funcs",void 0),(0,c.Z)(this,"messaging",void 0),(0,c.Z)(this,"destroy$",new E.x),(0,c.Z)(this,"mainForm",void 0),(0,c.Z)(this,"userPrivStore$",void 0),(0,c.Z)(this,"deviceForm",void 0),(0,c.Z)(this,"messagingTypeArray",void 0),(0,c.Z)(this,"configArray",void 0),(0,c.Z)(this,"currentUser$",void 0),(0,c.Z)(this,"registeredDeviceId",void 0),(0,c.Z)(this,"registeredToken",void 0),(0,c.Z)(this,"debugObservable",{}),(0,c.Z)(this,"devices",void 0),(0,c.Z)(this,"tokenReceived",new E.x),(0,c.Z)(this,"tokenReceived$",void 0),(0,c.Z)(this,"privUser",void 0),this.auth=u,this.dialog=r,this.toastr=b,this.store=w,this.funcs=N,this.messaging=Me,this.privUser=this.store.collection("/users/v1/protected"),this.currentUser$=this.auth.clientSideUser$.pipe((0,A.h)(Ke=>!!Ke))}onToggleDevice(u,r){(0,x.eM)("onToggleDevice()");const b=this.getDeviceControl(r),w={deviceId:r.id,off:!b.value};try{this.funcs.call("toggleSuspendDevice",w),this.toastr.success("\u7aef\u672b\u306e\u8a2d\u5b9a\u3092\u66f4\u65b0\u3057\u307e\u3057\u305f\u3002")}catch{this.toastr.error("\u7aef\u672b\u306e\u8a2d\u5b9a\u304c\u66f4\u65b0\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002")}}onClickDeleteDevice(u,r){var N,b=this;(0,x.eM)("onClickDeleteDevice()"),this.messaging.deleteToken(r.token).pipe((0,S.R)(this.destroy$)).subscribe({next:(N=(0,L.Z)(function*(Me){(0,x.H_)(`deleteToken() result ${Me}`),b.toastr.success("\u7aef\u672b\u306e\u901a\u77e5\u3092\u89e3\u9664\u3057\u307e\u3057\u305f\u3002")}),function(Ke){return N.apply(this,arguments)}),error:N=>{(0,x.wb)(`Failed to delete token token: ${r.token}`,N),this.toastr.error("\u7aef\u672b\u306e\u901a\u77e5\u3092\u89e3\u9664\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002\u65e2\u306b\u5931\u52b9\u3057\u3066\u3044\u308b\u53ef\u80fd\u6027\u304c\u3042\u308a\u307e\u3059\u3002")}});const w={deviceId:r.id};try{this.funcs.call("revokeDevice",w),this.toastr.success("\u30b7\u30b9\u30c6\u30e0\u4e0a\u304b\u3089\u7aef\u672b\u306e\u901a\u77e5\u3092\u89e3\u9664\u3057\u307e\u3057\u305f\u3002")}catch{this.toastr.error("\u30b7\u30b9\u30c6\u30e0\u4e0a\u306e\u7aef\u672b\u306e\u901a\u77e5\u3092\u89e3\u9664\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002")}}ngOnInit(){var u=this;const b=this.currentUser$.pipe((0,Q.q)(1),(0,A.h)(w=>!!w)).pipe((0,ue.w)(w=>this.store.collection(`users/v1/protected/${w.uid}/fcm`).valueChanges({idField:"id"})),(0,te.d)(1));b.pipe((0,S.R)(this.destroy$)).subscribe(w=>{this.devices=w;for(const N in this.deviceForm.controls)this.deviceForm.removeControl(N);for(const N of this.devices)this.addDeviceControl(N);this.triggerTokenRefresh()}),this.mainForm.addControl("messagingOn",new i.NI(!1,[])),this.deviceForm=new i.cw({}),this.mainForm.addControl("devices",this.deviceForm),this.mainForm.addControl("messagingSystemCheck",new i.NI(!1,[])),this.mainForm.addControl("messagingTrivialCheck",new i.NI(!1,[])),this.mainForm.addControl("messagingMentionCheck",new i.NI(!1,[])),this.mainForm.addControl("messagingAdminCheck",new i.NI(!1,[])),this.messagingTypeArray=new i.Oe([this.typeSystemControl,this.typeMentionControl,this.typeAdminControl]),this.configArray=new i.Oe([this.typeTrivialControl,this.messagingTypeArray]),this.userPrivStore$.pipe((0,S.R)(this.destroy$)).subscribe(w=>{(0,x.H_)("this.userPrivStore$.subscribe()",w);const N=w.messagingTypes||["mention","admin"];O(this.typeSystemControl,N.includes("system")),O(this.typeMentionControl,N.includes("mention")),O(this.typeAdminControl,N.includes("admin")),O(this.typeTrivialControl,w.isWatchTrivial)}),this.tokenReceived$=this.tokenReceived.pipe((0,A.h)(w=>null!==w),(0,Je.x)()),(0,ze.a)(this.tokenReceived$,b).pipe((0,S.R)(this.destroy$)).subscribe(function(){var w=(0,L.Z)(function*([N,Me]){if((0,x.eM)("this.messaging.tokenReceived subscribe()",N,Me),u.debugObservable.registeredToken=N,u.registeredToken=N,N){const lt=u.findDeviceId(N,Me);u.registeredDeviceId=lt}O(u.messagingOnControl,!!u.registeredDeviceId)});return function(N){return w.apply(this,arguments)}}()),this.triggerTokenRefresh(),this.debugObservable.messages=[],this.messaging.messages.pipe((0,S.R)(this.destroy$)).subscribe(w=>{(0,x.H_)("message received from messaging",w),this.debugObservable.messages.push(w)}),this.debugObservable.getToken$=this.messaging.getToken,this.debugObservable.getToken=[],this.debugObservable.getToken$.subscribe({next:w=>this.debugObservable.getToken.push(w),complete:()=>(0,x.H_)("Complete getToken()")}),this.debugObservable.tokenChanges$=this.messaging.tokenChanges,this.debugObservable.tokenChanges=[],this.debugObservable.tokenChanges$.subscribe({next:w=>this.debugObservable.tokenChanges.push(w),complete:()=>(0,x.H_)("Complete tokenChanges()")}),this.debugObservable.tokenReceived=[]}findDeviceId(u,r){for(const b of r)if(b.token===u)return b.id;return null}ngOnDestroy(){this.destroy$.next()}triggerTokenRefresh(){this.messaging.getToken.pipe((0,Q.q)(1),(0,S.R)(this.destroy$)).subscribe({next:u=>this.tokenReceived.next(u),complete:()=>(0,x.eM)("Completed getToken")})}get messagingOnControl(){return this.mainForm.get("messagingOn")}getDeviceControl(u){return this.deviceForm.get(`device-${u.id}`)}addDeviceControl(u){const r=new i.NI(!u.isSuspend,[]);this.deviceForm.addControl(`device-${u.id}`,r)}get typeTrivialControl(){return this.mainForm.get("messagingTrivialCheck")}get typeSystemControl(){return this.mainForm.get("messagingSystemCheck")}get typeMentionControl(){return this.mainForm.get("messagingMentionCheck")}get typeAdminControl(){return this.mainForm.get("messagingAdminCheck")}revokeNotification(){var u=this;return(0,L.Z)(function*(){if(!u.registeredDeviceId)return(0,x.wb)("Unexpectedly no deviceId is found."),void u.toastr.error("\u30c7\u30d0\u30a4\u30b9\u60c5\u5831\u3092\u7121\u52b9\u306b\u3067\u304d\u307e\u305b\u3093\u3002");try{u.funcs.call("revokeDevice",{deviceId:u.registeredDeviceId}),u.toastr.info("\u30b7\u30b9\u30c6\u30e0\u304b\u3089\u901a\u77e5\u60c5\u5831\u3092\u524a\u9664\u3057\u307e\u3057\u305f\u3002")}catch(r){return(0,x.wb)("Error while deleting token via Functions",r),u.messagingOnControl.setValue(!0),j(u.messagingOnControl),void u.toastr.error("\u30b7\u30b9\u30c6\u30e0\u306e\u901a\u77e5\u60c5\u5831\u3092\u524a\u9664\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002")}u.messaging.getToken.pipe((0,it.b)(r=>(0,x.eM)(`getToken before deleteToken ${r}`)),(0,Re.z)(r=>u.messaging.deleteToken(r)),(0,Q.q)(1),(0,S.R)(u.destroy$)).subscribe({next:r=>{(0,x.H_)(`Deleted result: ${r} on FCM.`),j(u.messagingOnControl),u.toastr.success("\u901a\u77e5\u60c5\u5831\u3092\u524a\u9664\u3057\u307e\u3057\u305f\u3002")},error:r=>{(0,x.wb)("Error while deleting token on FCM",r),u.toastr.error("\u901a\u77e5\u60c5\u5831\u304c\u524a\u9664\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002")}})})()}onToggleMessaging(u){var r=this;return(0,L.Z)(function*(){if((0,x.eM)("UserSettingsComponent.onToggleMessaging()"),r.messagingOnControl.value){if(!r.registeredDeviceId&&r.devices&&r.devices.length>=x.NZ.FCMDeviceMaxCount)return void r.toastr.error("\u767b\u9332\u3055\u308c\u305f\u30c7\u30d0\u30a4\u30b9\u304c\u591a\u3059\u304e\u307e\u3059\u3002\u524a\u9664\u3057\u3066\u304b\u3089\u3084\u308a\u76f4\u3057\u3066\u304f\u3060\u3055\u3044\u3002");yield r.updateRequestToken()}else{const w=r.dialog.createHtmlBuilder(),N=new dt.ww("\n<div>\n\u767b\u9332\u3092\u89e3\u9664\u3059\u308b\u3068\u3059\u3079\u3066\u306e\u901a\u77e5\u306f\u505c\u6b62\u3057\u307e\u3059\u3002\u3088\u308d\u3057\u3044\u3067\u3059\u304b\uff1f\n</div>\n");w.setMessage(N).setType(K.iR.Warn).setSize(K.PW.Default).setTitle("\u78ba\u8a8d").okButton((0,L.Z)(function*(){yield r.revokeNotification()})).cancelButton(()=>{r.messagingOnControl.setValue(!0),j(r.messagingOnControl)}).open()}})()}getMessagingTypes(){const u=[];return this.typeSystemControl.value&&u.push("system"),this.typeMentionControl.value&&u.push("mention"),this.typeAdminControl.value&&u.push("admin"),u}updateRequestToken(){var u=this;return(0,L.Z)(function*(){var r;u.messaging.requestToken.pipe((0,Q.q)(1),(0,S.R)(u.destroy$)).subscribe({next:(r=(0,L.Z)(function*(b){if(u.tokenReceived.next(b),u.debugObservable.tokenReceived.push(b),!b)return(0,x.wb)("No token returned from requestToken"),u.messagingOnControl.setValue(!1),j(u.messagingOnControl),void u.toastr.error("\u901a\u77e5\u60c5\u5831\u3092\u53d6\u5f97\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002");try{(0,x.eM)(`Updated token with ${b}`);const w={token:b,deviceId:u.registeredDeviceId};u.registeredToken=b,u.registeredDeviceId=yield u.funcs.call("saveDeviceToken",w),u.toastr.success("\u901a\u77e5\u60c5\u5831\u3092\u4fdd\u5b58\u3057\u307e\u3057\u305f\u3002"),j(u.messagingOnControl)}catch(w){(0,x.wb)("Error while save token to Firestore",w),u.messagingOnControl.setValue(!1),j(u.messagingOnControl),u.toastr.error("\u901a\u77e5\u60c5\u5831\u3092\u4fdd\u5b58\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002")}}),function(w){return r.apply(this,arguments)}),error:r=>{(0,x.wb)("Error while request Token",r),u.messagingOnControl.setValue(!1),j(u.messagingOnControl),u.toastr.error("\u901a\u77e5\u3092\u6709\u52b9\u306b\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002\u30d6\u30e9\u30a6\u30b6\u306e\u8a2d\u5b9a\u3092\u78ba\u8a8d\u3057\u3066\u304f\u3060\u3055\u3044\u3002")}})})()}onClickUpdateMessaging(u){var r=this;return(0,L.Z)(function*(){(0,x.eM)("UserSettingsComponent.onClickUpdateMessaging()");try{const b={messageTypes:r.getMessagingTypes(),token:r.registeredToken,isWatchTrivial:r.typeTrivialControl.value};yield r.funcs.call("setNotifications",b),j(r.configArray),r.toastr.success("\u8a2d\u5b9a\u3092\u4fdd\u5b58\u3057\u307e\u3057\u305f\u3002")}catch(b){(0,x.wb)("Failed to save configuration",b),r.toastr.error("\u8a2d\u5b9a\u304c\u4fdd\u5b58\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002")}})()}onClickSubscribeTopic(u){var r=this;return(0,L.Z)(function*(){if(!r.debugObservable.topicText)return void alert("Not set");const b={topic:r.debugObservable.topicText,token:r.registeredToken},w=yield r.funcs.call("subscribeTopicTest",b);(0,x.H_)("subscribeTopicTest ->",w),r.toastr.success(`done subscribe ${w}`)})()}onClickUnsubscribeTopic(u){var r=this;return(0,L.Z)(function*(){if(!r.debugObservable.topicText)return void alert("Not set");const b={topic:r.debugObservable.topicText,token:r.registeredToken},w=yield r.funcs.call("unsubscribeTopicTest",b);(0,x.H_)("unsubscribeTopicTest ->",w),r.toastr.success(`done unsubscribe ${w}`)})()}onClickPostToTopic(u){var r=this;return(0,L.Z)(function*(){if(!r.debugObservable.topicText||!r.debugObservable.topicPostText)return void alert("Not set");const b={topic:r.debugObservable.topicText,title:r.debugObservable.topicPostText},w=yield r.funcs.call("postTopicTest",b);(0,x.H_)("postTopicTest ->",w),r.toastr.success(`done post ${w}`)})()}onClickConditionPostToTopic(u){var r=this;return(0,L.Z)(function*(){if(!r.debugObservable.conditionTopicPostText||!r.debugObservable.conditionTopicPostText)return void alert("Not set");const b={topic:r.debugObservable.conditionTopicPostText,title:r.debugObservable.topicPostText},w=yield r.funcs.call("postConditionTopicTest",b);(0,x.H_)("postConditionTopicTest ->",w),r.toastr.success(`done post ${w}`)})()}onClickClearMessages(u){this.debugObservable.messages=[]}}return h=g,(0,c.Z)(g,"\u0275fac",function(u){return new(u||h)(e.Y36(Be.e),e.Y36(K.xA),e.Y36(I._W),e.Y36(ge.ST),e.Y36(He.c),e.Y36(C))}),(0,c.Z)(g,"\u0275cmp",e.Xpm({type:h,selectors:[["gitfire-user-notification"]],inputs:{mainForm:"mainForm",userPrivStore$:"userPrivStore$"},decls:69,vars:16,consts:[[1,"m-2"],["title","\u3053\u306e\u6a5f\u80fd\u306f\u30c6\u30b9\u30c8\u4e2d\u306e\u305f\u3081\u5909\u66f4\u3055\u308c\u308b\u3053\u3068\u3084\u3001\u60f3\u5b9a\u5916\u306e\u6319\u52d5\u3092\u3059\u308b\u5834\u5408\u304c\u3042\u308a\u307e\u3059\u3002\u30d6\u30e9\u30a6\u30b6\u304b\u3089\u306e\u901a\u77e5\u3092\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u3057\u307e\u3059\u3002\u8a2d\u5b9a\u304c\u3046\u307e\u304f\u3044\u304b\u306a\u3044\u5834\u5408\u306f\u30d6\u30e9\u30a6\u30b6\u304b\u3089\u5f53\u30b5\u30a4\u30c8\u306e\u901a\u77e5 on/off \u3092\u3057\u305f\u308a\u3001\u300e\u7aef\u672b\u306e\u524a\u9664\u300f\u3092\u304a\u8a66\u3057\u304f\u3060\u3055\u3044\u3002","src","/assets/octicons/question.svg",1,"m-3","octicon-info","help-icon"],[1,"m-2",3,"formGroup"],[1,"row","p-1"],[1,"d-flex","align-content-start","flex-wrap","p-1"],["controlLabel","\u901a\u77e5\u3092\u53d7\u3051\u53d6\u308b","formName","messagingOn","tooltipText","\u30d6\u30e9\u30a6\u30b6\u304b\u3089\u306e\u901a\u77e5\u3092\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u3057\u307e\u3059\u3002",1,"p-2",3,"parentForm","checkChanged"],[1,"d-flex","align-content-start","flex-wrap","p-3"],["class","m-1 input-group",4,"ngFor","ngForOf"],[1,"row","m-2"],["controlLabel","\u3061\u3087\u3063\u3068\u3057\u305f\u901a\u77e5","formName","messagingTrivialCheck","tooltipText","\u3061\u3087\u3063\u3068\u3057\u305f\u901a\u77e5\u3082\u53d7\u3051\u53d6\u308b\u304b\u3069\u3046\u304b\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\u901a\u5e38\u306f\u4e0d\u8981\u3067\u3059\u3002",1,"p-2",3,"parentForm"],["controlLabel","\u30b7\u30b9\u30c6\u30e0","formName","messagingSystemCheck","tooltipText","\u30b7\u30b9\u30c6\u30e0\u304b\u3089\u306e\u901a\u77e5\u3092\u9001\u308b\u304b\u3069\u3046\u304b\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002",1,"p-2",3,"parentForm"],["controlLabel","\u3042\u306a\u305f\u3078\u306e\u8a00\u53ca","formName","messagingMentionCheck","tooltipText","\u30b7\u30b9\u30c6\u30e0\u306e\u30e1\u30c3\u30bb\u30fc\u30b8\u30b7\u30b9\u30c6\u30e0\u3067\u3042\u306a\u305f\u306b\u8a00\u53ca\u3055\u308c\u305f\u5834\u5408\u306b\u901a\u77e5\u3092\u9001\u308b\u304b\u3069\u3046\u304b\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002",1,"p-2",3,"parentForm"],["controlLabel","\u7ba1\u7406\u4eba\u304b\u3089","formName","messagingAdminCheck","tooltipText","\u7ba1\u7406\u4eba\u304c\u624b\u52d5\u3067\u3042\u306a\u305f\u306b\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u9001\u3063\u305f\u5834\u5408\u306b\u901a\u77e5\u3092\u9001\u308b\u304b\u3069\u3046\u304b\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002",1,"p-2",3,"parentForm"],[1,"btn","btn-primary",3,"disabled","click"],[2,"width","100%","overflow-wrap","break-word"],[4,"ngFor","ngForOf"],["type","text",3,"ngModel","ngModelChange"],[1,"btn","btn-primary",3,"click"],[1,"btn","btn-warning",3,"click"],[1,"m-1","input-group"],["tooltipText","\u767b\u9332\u3055\u308c\u305f Device \u306e\u901a\u77e5\u3092\u4e00\u6642\u7684\u306b\u505c\u6b62\u3057\u307e\u3059\u3002",1,"m-2",3,"parentForm","controlLabel","formName","checkChanged"],["class","btn btn-warning","title","\u767b\u9332\u60c5\u5831\u3092\u524a\u9664\u3057\u3066\u3001\u3053\u306e\u7aef\u672b\u3078\u306e\u901a\u77e5\u3092\u89e3\u9664\u3057\u307e\u3059\u3002",3,"click",4,"ngIf"],["title","\u767b\u9332\u60c5\u5831\u3092\u524a\u9664\u3057\u3066\u3001\u3053\u306e\u7aef\u672b\u3078\u306e\u901a\u77e5\u3092\u89e3\u9664\u3057\u307e\u3059\u3002",1,"btn","btn-warning",3,"click"]],template:function(u,r){1&u&&(e.TgZ(0,"h2",0),e._uU(1,"\u901a\u77e5\u8a2d\u5b9a (\u30c6\u30b9\u30c8\u4e2d)"),e._UZ(2,"img",1),e.qZA(),e.TgZ(3,"div",2)(4,"div",3)(5,"div",4)(6,"app-switch",5),e.NdJ("checkChanged",function(w){return r.onToggleMessaging(w)}),e.qZA()()(),e.TgZ(7,"div",0)(8,"h3"),e._uU(9,"\u767b\u9332\u3055\u308c\u305f\u30c7\u30d0\u30a4\u30b9"),e.qZA(),e.TgZ(10,"div",6),e.YNc(11,ht,4,9,"div",7),e.qZA()(),e.TgZ(12,"div")(13,"div",8)(14,"h3"),e._uU(15,"\u91cd\u8981\u5ea6"),e.qZA(),e.TgZ(16,"div",4),e._UZ(17,"app-switch",9),e.qZA()(),e.TgZ(18,"div",8)(19,"h3"),e._uU(20,"\u7a2e\u985e"),e.qZA(),e.TgZ(21,"div",4),e._UZ(22,"app-switch",10)(23,"app-switch",11)(24,"app-switch",12),e.qZA()(),e.TgZ(25,"div",8)(26,"button",13),e.NdJ("click",function(w){return r.onClickUpdateMessaging(w)}),e._uU(27,"\u66f4\u65b0"),e.qZA()()()(),e.TgZ(28,"div",14)(29,"div"),e._uU(30,"Token: "),e.TgZ(31,"div"),e._uU(32),e.qZA()(),e.TgZ(33,"div"),e._uU(34,"GetToken: "),e.YNc(35,Mt,2,2,"div",15),e.qZA(),e.TgZ(36,"div"),e._uU(37,"TokenChanges: "),e.YNc(38,pt,2,2,"div",15),e.qZA(),e.TgZ(39,"div"),e._uU(40,"TokenReceived: "),e.YNc(41,Zt,2,2,"div",15),e.qZA(),e.TgZ(42,"div")(43,"div")(44,"label"),e._uU(45,"Topic: "),e.TgZ(46,"input",16),e.NdJ("ngModelChange",function(w){return r.debugObservable.topicText=w}),e.qZA()(),e.TgZ(47,"button",17),e.NdJ("click",function(w){return r.onClickSubscribeTopic(w)}),e._uU(48,"subscribe"),e.qZA(),e.TgZ(49,"button",17),e.NdJ("click",function(w){return r.onClickUnsubscribeTopic(w)}),e._uU(50,"unsubscribe"),e.qZA()(),e.TgZ(51,"div")(52,"label"),e._uU(53,"Post Title: "),e.TgZ(54,"input",16),e.NdJ("ngModelChange",function(w){return r.debugObservable.topicPostText=w}),e.qZA()(),e.TgZ(55,"button",17),e.NdJ("click",function(w){return r.onClickPostToTopic(w)}),e._uU(56,"Post"),e.qZA()(),e.TgZ(57,"div")(58,"label"),e._uU(59,"Condition Topic Post: "),e.TgZ(60,"input",16),e.NdJ("ngModelChange",function(w){return r.debugObservable.conditionTopicPostText=w}),e.qZA()(),e.TgZ(61,"button",17),e.NdJ("click",function(w){return r.onClickConditionPostToTopic(w)}),e._uU(62,"CondPost"),e.qZA()()()(),e.TgZ(63,"div")(64,"button",18),e.NdJ("click",function(w){return r.onClickClearMessages(w)}),e._uU(65,"Clear"),e.qZA(),e.TgZ(66,"div"),e._uU(67,"Messages: "),e.YNc(68,ft,3,3,"div",15),e.qZA()()),2&u&&(e.xp6(3),e.Q6J("formGroup",r.mainForm),e.xp6(3),e.Q6J("parentForm",r.mainForm),e.xp6(5),e.Q6J("ngForOf",r.devices),e.xp6(6),e.Q6J("parentForm",r.mainForm),e.xp6(5),e.Q6J("parentForm",r.mainForm),e.xp6(1),e.Q6J("parentForm",r.mainForm),e.xp6(1),e.Q6J("parentForm",r.mainForm),e.xp6(2),e.Q6J("disabled",r.configArray.invalid||!r.configArray.dirty),e.xp6(6),e.Oqu(r.debugObservable.registeredToken),e.xp6(3),e.Q6J("ngForOf",r.debugObservable.getToken),e.xp6(3),e.Q6J("ngForOf",r.debugObservable.tokenChanges),e.xp6(3),e.Q6J("ngForOf",r.debugObservable.tokenReceived),e.xp6(5),e.Q6J("ngModel",r.debugObservable.topicText),e.xp6(8),e.Q6J("ngModel",r.debugObservable.topicPostText),e.xp6(6),e.Q6J("ngModel",r.debugObservable.conditionTopicPostText),e.xp6(8),e.Q6J("ngForOf",r.debugObservable.messages))},dependencies:[H.sg,H.O5,i.Fj,i.JJ,i.JL,i.On,i.sg,st,H.Ts,H.uU]})),g})();const gt=["protectedSettings"],mt=["imageBox"];function Se(h,g){1&h&&e._uU(0,"\u753b\u50cf\u304c\u3042\u308a\u307e\u305b\u3093")}function Ye(h,g){if(1&h&&e._UZ(0,"img",39),2&h){const y=e.oxw().ngIf;e.s9C("src",y.photoURL,e.LSH)}}function et(h,g){if(1&h){const y=e.EpF();e.ynx(0),e.TgZ(1,"span",40),e._uU(2," -> "),e.qZA(),e.TgZ(3,"label",8),e._uU(4,"\u65b0\u3057\u3044\u753b\u50cf"),e.qZA(),e._UZ(5,"img",41),e.TgZ(6,"button",42),e.NdJ("click",function(r){const w=e.CHM(y).ngIf,N=e.oxw(2);return e.KtG(N.onClickOkImage(r,w))}),e._uU(7,"\u78ba\u5b9a"),e.qZA(),e.BQk()}if(2&h){const y=g.ngIf;e.xp6(5),e.s9C("src",y,e.LSH)}}function at(h,g){1&h&&e._UZ(0,"div",43)}function _t(h,g){if(1&h&&(e.TgZ(0,"div",43),e._uU(1),e.qZA()),2&h){const y=e.oxw(3);e.xp6(1),e.hij("\u6b8b\u308a ",y.nicknameResult.changesRemain," \u56de \u5909\u66f4\u3067\u304d\u307e\u3059\u3002")}}function tt(h,g){1&h&&(e.TgZ(0,"div",45),e._uU(1,"\u3053\u308c\u4ee5\u4e0a\u306f\u5909\u66f4\u3067\u304d\u307e\u305b\u3093\u3002"),e.qZA())}function vt(h,g){if(1&h&&(e.ynx(0),e.YNc(1,_t,2,1,"div",19),e.YNc(2,tt,2,0,"div",44),e.BQk()),2&h){const y=e.oxw(2);e.xp6(1),e.Q6J("ngIf",y.nicknameResult.changesRemain>0),e.xp6(1),e.Q6J("ngIf",0===y.nicknameResult.changesRemain)}}function nt(h,g){1&h&&(e.TgZ(0,"div",45),e._uU(1,"\u5165\u529b\u5fc5\u9808\u3067\u3059\u3002"),e.qZA())}function Ft(h,g){1&h&&(e.TgZ(0,"div",45),e._uU(1,"\u9577\u3059\u304e\u307e\u3059\u3002"),e.qZA())}function Ct(h,g){1&h&&(e.TgZ(0,"div",45),e._uU(1,"\u77ed\u3059\u304e\u307e\u3059\u3002"),e.qZA())}function je(h,g){if(1&h&&(e.ynx(0),e.YNc(1,nt,2,0,"div",44),e.YNc(2,Ft,2,0,"div",44),e.YNc(3,Ct,2,0,"div",44),e.BQk()),2&h){const y=e.oxw(2);e.xp6(1),e.Q6J("ngIf",null==y.nicknameControl.errors?null:y.nicknameControl.errors.required),e.xp6(1),e.Q6J("ngIf",null==y.nicknameControl.errors?null:y.nicknameControl.errors.maxlength),e.xp6(1),e.Q6J("ngIf",null==y.nicknameControl.errors?null:y.nicknameControl.errors.minlength)}}function yt(h,g){1&h&&e._UZ(0,"div",43)}function bt(h,g){1&h&&(e.TgZ(0,"div",45),e._uU(1,"\u9577\u3059\u304e\u307e\u3059\u3002"),e.qZA())}function Pt(h,g){if(1&h&&(e.ynx(0),e.YNc(1,bt,2,0,"div",44),e.BQk()),2&h){const y=e.oxw(2);e.xp6(1),e.Q6J("ngIf",null==y.aboutControl.errors?null:y.aboutControl.errors.maxlength)}}function ot(h,g){if(1&h&&(e.ynx(0),e._UZ(1,"hr")(2,"gitfire-user-notification",46),e.BQk()),2&h){const y=e.oxw(2);e.xp6(2),e.Q6J("mainForm",y.notificationForm)("userPrivStore$",y.userPrivate$)}}function Lt(h,g){1&h&&e._UZ(0,"div",43)}function Te(h,g){1&h&&(e.TgZ(0,"div",45),e._uU(1,"E \u30e1\u30fc\u30eb\u306f\u5fc5\u9808\u3067\u3059\u3002"),e.qZA())}function ut(h,g){1&h&&(e.TgZ(0,"div",45),e._uU(1,"E \u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044\u3002"),e.qZA())}function ct(h,g){if(1&h&&(e.ynx(0),e.YNc(1,Te,2,0,"div",44),e.YNc(2,ut,2,0,"div",44),e.BQk()),2&h){const y=e.oxw(2);e.xp6(1),e.Q6J("ngIf",null==y.emailControl.errors?null:y.emailControl.errors.required),e.xp6(1),e.Q6J("ngIf",(null==y.emailControl.errors?null:y.emailControl.errors.minlength)||(null==y.emailControl.errors?null:y.emailControl.errors.maxlength))}}function Ve(h,g){1&h&&(e.TgZ(0,"div",43),e._uU(1,"\u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u5f37\u5ea6\u306f\u5145\u5206\u306b\u3057\u3066\u304f\u3060\u3055\u3044\u3002"),e.qZA())}function Tt(h,g){1&h&&(e.TgZ(0,"div",45),e._uU(1,"\u30d1\u30b9\u30ef\u30fc\u30c9\u306f\u5fc5\u9808\u3067\u3059\u3002"),e.qZA())}function At(h,g){1&h&&(e.TgZ(0,"div",45),e._uU(1,"\u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u9577\u3055\u304c\u8db3\u308a\u307e\u305b\u3093\u3002"),e.qZA())}function Gt(h,g){if(1&h&&(e.ynx(0),e.YNc(1,Tt,2,0,"div",44),e.YNc(2,At,2,0,"div",44),e.BQk()),2&h){const y=e.oxw(2);e.xp6(1),e.Q6J("ngIf",null==y.passwordControl.errors?null:y.passwordControl.errors.required),e.xp6(1),e.Q6J("ngIf",null==y.passwordControl.errors?null:y.passwordControl.errors.minlength)}}const Dt=function(){return["(\u5371\u967a)","(\u5f31\u3044)","(\u666e\u901a)","(\u5f37\u3044)","(\u5145\u5206\u306b\u5b89\u5168)"]},Ot=function(){return["#DD2C00","#FF6D00","#FFD600","#AEEA00","#00C853"]};function wt(h,g){if(1&h){const y=e.EpF();e.ynx(0),e.TgZ(1,"div",1)(2,"form",2,3)(4,"h2",4),e._uU(5,"\u516c\u958b\u8a2d\u5b9a"),e._UZ(6,"img",5),e.qZA(),e.TgZ(7,"div")(8,"div",6)(9,"div",7)(10,"label",8),e._uU(11,"\u73fe\u5728\u306e\u753b\u50cf"),e.qZA(),e.YNc(12,Se,1,0,"ng-template",null,9,e.W1O),e.YNc(14,Ye,1,1,"img",10),e.YNc(15,et,8,1,"ng-container",0),e.ALo(16,"async"),e.qZA(),e.TgZ(17,"div",11),e._UZ(18,"input",12,13),e.TgZ(20,"button",14),e.NdJ("click",function(r){e.CHM(y);const b=e.oxw();return e.KtG(b.onClickUploadImage(r))}),e._uU(21,"Upload"),e.qZA()()(),e.TgZ(22,"div",15)(23,"label",16),e._uU(24,"\u30cb\u30c3\u30af\u30cd\u30fc\u30e0"),e._UZ(25,"img",17),e.qZA(),e._UZ(26,"input",18),e.TgZ(27,"button",14),e.NdJ("click",function(r){e.CHM(y);const b=e.oxw();return e.KtG(b.onClickUpdateNickname(r))}),e._uU(28,"\u66f4\u65b0"),e.qZA()(),e.YNc(29,at,1,0,"div",19),e.YNc(30,vt,3,2,"ng-container",0),e.YNc(31,je,4,3,"ng-container",0),e.TgZ(32,"div",15)(33,"label",16),e._uU(34,"\u81ea\u5df1\u7d39\u4ecb"),e._UZ(35,"img",20),e.qZA(),e._UZ(36,"textarea",21),e.TgZ(37,"button",22),e.NdJ("click",function(r){e.CHM(y);const b=e.oxw();return e.KtG(b.onClickUpdateAbout(r))}),e._uU(38,"\u66f4\u65b0"),e.qZA()()(),e.YNc(39,yt,1,0,"div",19),e.YNc(40,Pt,2,1,"ng-container",0),e.YNc(41,ot,3,2,"ng-container",0),e._UZ(42,"hr"),e.TgZ(43,"a",23),e.NdJ("click",function(r){e.CHM(y);const b=e.oxw();return e.KtG(b.onClickImportant(r))}),e._uU(44),e.qZA(),e.TgZ(45,"div",24,25)(47,"div",26)(48,"label",27),e._uU(49,"\u540d\u524d"),e._UZ(50,"img",28),e.qZA(),e._UZ(51,"input",29),e.qZA(),e.TgZ(52,"div",26)(53,"label",27),e._uU(54,"Email"),e._UZ(55,"img",30),e.qZA(),e._UZ(56,"input",31),e.TgZ(57,"button",32),e.NdJ("click",function(r){e.CHM(y);const b=e.oxw();return e.KtG(b.onClickUpdateEmail(r))}),e._uU(58,"\u66f4\u65b0"),e.qZA(),e.YNc(59,Lt,1,0,"div",19),e.YNc(60,ct,3,2,"ng-container",0),e.qZA(),e.TgZ(61,"div",26)(62,"label",27),e._uU(63,"Password"),e._UZ(64,"img",33),e.qZA(),e._UZ(65,"input",34),e.TgZ(66,"button",32),e.NdJ("click",function(r){e.CHM(y);const b=e.oxw();return e.KtG(b.onClickUpdatePassword(r))}),e._uU(67,"\u66f4\u65b0"),e.qZA(),e._UZ(68,"ng9-password-strength-bar",35),e.ALo(69,"async"),e.YNc(70,Ve,2,0,"div",19),e.YNc(71,Gt,3,2,"ng-container",0),e.qZA(),e.TgZ(72,"h3",36),e._uU(73,"\u30a2\u30ab\u30a6\u30f3\u30c8\u306e\u7d42\u4e86"),e.qZA(),e.TgZ(74,"div",37)(75,"button",38),e.NdJ("click",function(r){e.CHM(y);const b=e.oxw();return e.KtG(b.onClickDeleteAccount(r))}),e._uU(76,"\u30a2\u30ab\u30a6\u30f3\u30c8\u3092\u524a\u9664"),e.qZA()()()()(),e.BQk()}if(2&h){const y=g.ngIf,u=e.MAs(13),r=e.oxw();e.xp6(2),e.Q6J("formGroup",r.inputForm),e.xp6(12),e.Q6J("ngIf",y.photoURL)("ngIfElse",u),e.xp6(1),e.Q6J("ngIf",e.lcZ(16,35,r.profileTempImage$)),e.xp6(5),e.Q6J("disabled",r.userIconControl.invalid||!r.userIconControl.dirty),e.xp6(2),e.ekj("was-validated",r.nicknameControl.dirty||r.nicknameControl.touched),e.xp6(5),e.Q6J("disabled",r.nicknameControl.invalid||!r.nicknameControl.dirty),e.xp6(2),e.Q6J("ngIf",!r.nicknameControl.invalid),e.xp6(1),e.Q6J("ngIf",r.nicknameResult),e.xp6(1),e.Q6J("ngIf",r.nicknameControl.invalid),e.xp6(1),e.ekj("was-validated",r.aboutControl.dirty||r.aboutControl.touched),e.xp6(5),e.Q6J("disabled",r.aboutControl.invalid||!r.aboutControl.dirty),e.xp6(2),e.Q6J("ngIf",!r.aboutControl.invalid),e.xp6(1),e.Q6J("ngIf",r.aboutControl.invalid),e.xp6(1),e.Q6J("ngIf",r.auth.isDeveloper),e.xp6(3),e.Oqu(r.isOpenOther?"\u518d\u8a8d\u8a3c":"\u305d\u306e\u4ed6\u306e\u8a2d\u5b9a"),e.xp6(7),e.Q6J("value",y.displayName),e.xp6(1),e.ekj("was-validated",r.emailControl.dirty||r.emailControl.touched),e.xp6(5),e.Q6J("disabled",r.emailControl.invalid||!r.emailControl.dirty),e.xp6(2),e.Q6J("ngIf",!r.emailControl.invalid),e.xp6(1),e.Q6J("ngIf",r.emailControl.invalid),e.xp6(1),e.ekj("was-validated",r.passwordControl.dirty||r.passwordControl.touched),e.xp6(5),e.Q6J("disabled",!r.passwordControl.value||r.passwordControl.invalid||!r.passwordControl.dirty),e.xp6(2),e.Udp("display",""===r.passwordControl.value?"none":null),e.Q6J("passwordToCheck",e.lcZ(69,37,r.passwordControl.valueChanges))("barLabel","\u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u5f37\u5ea6(\u76ee\u5b89): ")("strengthLabels",e.DdM(39,Dt))("barColors",e.DdM(40,Ot)),e.xp6(2),e.Q6J("ngIf",!r.passwordControl.invalid),e.xp6(1),e.Q6J("ngIf",r.passwordControl.invalid)}}let Bt=(()=>{var h;class g{constructor(u,r,b,w,N,Me,Ke,lt){(0,c.Z)(this,"auth",void 0),(0,c.Z)(this,"storage",void 0),(0,c.Z)(this,"funcs",void 0),(0,c.Z)(this,"store",void 0),(0,c.Z)(this,"toastr",void 0),(0,c.Z)(this,"router",void 0),(0,c.Z)(this,"dialog",void 0),(0,c.Z)(this,"localSession",void 0),(0,c.Z)(this,"destroy$",new E.x),(0,c.Z)(this,"currentUser",void 0),(0,c.Z)(this,"currentUser$",void 0),(0,c.Z)(this,"userPublic",void 0),(0,c.Z)(this,"userPrivate$",new E.x),(0,c.Z)(this,"profileTempImage$",void 0),(0,c.Z)(this,"inputForm",void 0),(0,c.Z)(this,"notificationForm",void 0),(0,c.Z)(this,"isOpenOther",!1),(0,c.Z)(this,"nicknameResult",null),(0,c.Z)(this,"protectedSettings",void 0),(0,c.Z)(this,"imageBox",void 0),(0,c.Z)(this,"pubUser",void 0),(0,c.Z)(this,"privUser",void 0),(0,c.Z)(this,"nicknameIndex",void 0),this.auth=u,this.storage=r,this.funcs=b,this.store=w,this.toastr=N,this.router=Me,this.dialog=Ke,this.localSession=lt,this.pubUser=this.store.collection("/users/v1/public"),this.privUser=this.store.collection("/users/v1/protected"),this.nicknameIndex=this.store.collection("/index/users/usernick"),this.currentUser$=this.auth.clientSideUser$,this.currentUser$.pipe((0,S.R)(this.destroy$)).subscribe(he=>{this.currentUser=he})}ngOnInit(){this.inputForm=new i.cw({}),this.inputForm.addControl("userIcon",new i.NI("",[i.kI.required])),this.inputForm.addControl("email",new i.NI({value:"",disabled:!1},[i.kI.required])),this.inputForm.addControl("password",new i.NI("",[])),this.inputForm.addControl("nickname",new i.NI({value:"",disabled:!0},[i.kI.required])),this.inputForm.addControl("about",new i.NI({value:"",disabled:!0},[])),this.notificationForm=new i.cw({}),this.inputForm.addControl("messaging",this.notificationForm)}ngAfterViewInit(){const u=this.currentUser$.pipe((0,Q.q)(1),(0,A.h)(r=>!!r));u.pipe((0,ue.w)(r=>this.pubUser.doc(r.uid).valueChanges()),(0,S.R)(this.destroy$)).subscribe(r=>{this.userPublic=r,O(this.aboutControl,r.about),this.aboutControl.enable(),O(this.nicknameControl,r.nickname),this.nicknameControl.enable()}),u.pipe((0,ue.w)(r=>this.privUser.doc(r.uid).valueChanges()),(0,S.R)(this.destroy$)).subscribe(r=>{this.userPrivate$.next(r)}),u.pipe((0,S.R)(this.destroy$)).subscribe(r=>{this.emailControl.setValue(r.email)})}ngOnDestroy(){this.destroy$.next()}get emailControl(){return this.inputForm.get("email")}get passwordControl(){return this.inputForm.get("password")}get aboutControl(){return this.inputForm.get("about")}get nicknameControl(){return this.inputForm.get("nickname")}get userIconControl(){return this.inputForm.get("userIcon")}onClickDeleteAccount(u){this.dialog.createDefaultBuilder().prepareBody(Ee).setType(K.iR.Warn).setSize(K.PW.Default).setTitle("\u6700\u7d42\u78ba\u8a8d").okButton(()=>{this.doDeleteAccount()}).cancelButton(()=>{}).open()}doDeleteAccount(){var u=this;return(0,L.Z)(function*(){try{yield u.currentUser.delete(),(0,x.eM)("Account is deleted")}catch(b){(0,x.wb)("Error while delete account",b);const w=b instanceof Error?b.message:"Unknown error";return void u.toastr.error(`\u30a2\u30ab\u30a6\u30f3\u30c8\u3092\u524a\u9664\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002 ( ${w} )`)}u.localSession.unmarkLogin(),u.router.navigate(["/"])})()}updateError(u,r){(0,x.wb)(`Error while update tag:${u}`,r);const b=r instanceof Error?r.message:"Unknown error";this.toastr.error(`${u} \u306e\u66f4\u65b0\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002 ( ${b} )`)}updateSucceeded(u,r){this.toastr.success(`${u} \u3092 "${r}" \u306b\u66f4\u65b0\u3057\u307e\u3057\u305f\u3002`)}updateProfileImage(u){var r=this;return(0,L.Z)(function*(){if(""===u)return;const b="\u30d7\u30ed\u30d5\u30a3\u30fc\u30eb\u753b\u50cf";try{yield r.currentUser.updateProfile({photoURL:u});const N={photoURL:u,updatedAt:F.Z.firestore.FieldValue.serverTimestamp()};yield r.pubUser.doc(r.currentUser.uid).update(N),r.updateSucceeded(b,"Upload \u3057\u305f\u753b\u50cf"),r.getProfileRef("temp_profile").delete(),r.profileTempImage$=null,r.userIconControl.setValue(""),j(r.userIconControl)}catch(w){r.updateError(b,w)}})()}onClickUpdateNickname(u){var r=this;return(0,L.Z)(function*(){if(r.nicknameControl.invalid)return;const b=r.nicknameControl.value;if(b===r.userPublic.nickname)return;const w="\u30cb\u30c3\u30af\u30cd\u30fc\u30e0";try{const N={nickname:b};r.nicknameResult=yield r.funcs.call("updateNickname",N),r.updateSucceeded(w,b),j(r.nicknameControl)}catch(N){r.updateError(w,N)}})()}onClickUpdateAbout(u){var r=this;return(0,L.Z)(function*(){if(r.aboutControl.invalid)return;const b=r.aboutControl.value;if(b===r.userPublic.about)return;const w="\u81ea\u5df1\u7d39\u4ecb";try{const N={about:b};yield r.funcs.call("updateAbout",N),r.updateSucceeded(w,b),j(r.aboutControl)}catch(N){r.updateError(w,N)}})()}onClickUpdateEmail(u){var r=this;return(0,L.Z)(function*(){if(r.emailControl.invalid)return;const b=r.emailControl.value;b!==r.currentUser.email&&r.dialog.createSimpleBuilder().setType(K.iR.Warn).setSize(K.PW.Default).setMessage("\u767b\u9332\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u3092\u5909\u66f4\u3057\u307e\u3059\u3002\u3088\u308d\u3057\u3044\u3067\u3059\u304b\uff1f").setTitle("\u78ba\u8a8d").okButton(()=>{r.doChangeEmail(b)}).cancelButton(()=>{}).open()})()}doChangeEmail(u){var r=this;return(0,L.Z)(function*(){const b="Email";try{yield r.currentUser.updateEmail(u),yield r.currentUser.sendEmailVerification(),r.updateSucceeded(b,u),j(r.emailControl),r.toastr.info("\u78ba\u8a8d\u306e\u30e1\u30fc\u30eb\u3092\u9001\u4fe1\u3057\u307e\u3057\u305f\u3002")}catch(w){r.updateError(b,w)}})()}onClickUpdatePassword(u){var r=this;return(0,L.Z)(function*(){if(r.passwordControl.invalid)return;const b=r.passwordControl.value;if(""===b)return;const w="\u30d1\u30b9\u30ef\u30fc\u30c9";try{yield r.currentUser.updatePassword(b),r.updateSucceeded(w,"********"),j(r.passwordControl)}catch(N){r.updateError(w,N)}finally{r.passwordControl.setValue("")}})()}listProvider(){}ensureImageFile(){const u=this.imageBox.nativeElement;if(0===u.files.length)return this.toastr.error("\u30d5\u30a1\u30a4\u30eb\u3092\u9078\u629e\u3057\u3066\u304f\u3060\u3055\u3044\u3002"),null;const r=u.files[0];return r.size>=524288?(this.toastr.error("\u30d5\u30a1\u30a4\u30eb\u306e\u30b5\u30a4\u30ba\u304c\u5927\u304d\u3059\u304e\u307e\u3059\u3002(\u7d04 500kb \u307e\u3067)"),null):r}getProfileRef(u){return this.storage.ref(`/image/${this.currentUser.uid}/profile/${u}`)}onClickUploadImage(u){var r=this;return(0,L.Z)(function*(){const b=r.ensureImageFile();if(!b)return;const w=yield r.uploadProfileImage("temp_profile",b);r.profileTempImage$=w.ref.getDownloadURL()})()}uploadProfileImage(u,r){var b=this;return(0,L.Z)(function*(){return yield b.getProfileRef(u).put(r)})()}doChangePhoto(u){var r=this;return(0,L.Z)(function*(){const w=yield(yield r.uploadProfileImage("profile",u)).ref.getDownloadURL();r.updateProfileImage(w)})()}initializeReauth(u){u.currentUser=this.currentUser,u.reauthed.subscribe(()=>{new V.UO(this.protectedSettings.nativeElement).show(),this.isOpenOther=!0})}constructReauth(){return u=>{}}onClickImportant(u){(0,x.eM)("onClickImportant()"),this.dialog.createDefaultBuilder().prepareBody(M,b=>this.initializeReauth(b)).setupChild(this.constructReauth()).setType(K.iR.Info).setSize(K.PW.Default).setTitle("\u518d\u8a8d\u8a3c").cancelButton(()=>{}).closeButton(()=>{}).open()}onClickOkImage(u,r){const b=this.ensureImageFile();b&&this.dialog.createSimpleBuilder().setType(K.iR.Info).setSize(K.PW.Default).setMessage("\u753b\u50cf\u306f\u516c\u958b\u3055\u308c\u307e\u3059\u3002\u3088\u308d\u3057\u3044\u3067\u3059\u304b\uff1f").setTitle("\u78ba\u8a8d").okButton(()=>{this.doChangePhoto(b)}).cancelButton(()=>{}).open()}}return h=g,(0,c.Z)(g,"\u0275fac",function(u){return new(u||h)(e.Y36(Be.e),e.Y36(pe.Q1),e.Y36(He.c),e.Y36(ge.ST),e.Y36(I._W),e.Y36(Xe.Z),e.Y36(K.xA),e.Y36(be.m))}),(0,c.Z)(g,"\u0275cmp",e.Xpm({type:h,selectors:[["ng-component"]],viewQuery:function(u,r){if(1&u&&(e.Gf(gt,5),e.Gf(mt,5)),2&u){let b;e.iGM(b=e.CRH())&&(r.protectedSettings=b.first),e.iGM(b=e.CRH())&&(r.imageBox=b.first)}},decls:1,vars:1,consts:[[4,"ngIf"],[1,"container"],[3,"formGroup"],["configForm",""],[1,"mb-3"],["title","\u4e00\u822c\u516c\u958b\u3055\u308c\u308b\u60c5\u5831\u3092\u7de8\u96c6\u3067\u304d\u307e\u3059\u3002","src","/assets/octicons/question.svg",1,"m-3","octicon-info","help-icon"],[1,"my-2"],[1,"input-group","my-1"],[1,"visually-hidden"],["noPhoto",""],["class","user-settings-profile-image rounded","alt","Profile \u753b\u50cf",3,"src",4,"ngIf","ngIfElse"],[1,"input-group"],["id","appGitfireInputIconFileInput","name","userIcon","formControlName","userIcon","type","file","placeholder","\u30a2\u30a4\u30b3\u30f3\u3092\u9078\u629e","accept","image/*",1,"form-control"],["imageBox",""],[1,"btn","btn-primary",3,"disabled","click"],[1,"input-group","my-2"],[1,"input-group-text"],["title","\u30e1\u30c3\u30bb\u30fc\u30b8\u4e0a\u306b\u8868\u793a\u3055\u308c\u308b\u3042\u306a\u305f\u306e\u540d\u524d\u3067\u3059\u3002","src","/assets/octicons/question.svg",1,"m-1","octicon-info","help-icon"],["name","nickname","placeholder","\u4f8b: hogehoge1032","formControlName","nickname","autofocus","","type","text","maxlength","19","minlength","4","required","",1,"form-control"],["class","valid-feedback",4,"ngIf"],["title","\u30d5\u30ea\u30fc\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u3067\u3059\u3002","src","/assets/octicons/question.svg",1,"m-1","octicon-info","help-icon"],["name","about","placeholder","\u4f8b: Ingress: kagura2718 (RES) \u30dd\u30b1\u30e2\u30f3go: kagura271(\u8d64)","formControlName","about","maxlength","200","type","text",1,"form-control"],["type","button",1,"btn","btn-primary",3,"disabled","click"],["role","button","aria-expanded","false",1,"btn","btn-secondary","collapsed",3,"click"],["id","appGitfireUserSettingsSecretContainer",1,"collapse","m-3"],["protectedSettings",""],[1,"row","input-group","m-3"],[1,"col-2","text-md-end","col-form-label"],["title","\u8a8d\u8a3c\u30d7\u30ed\u30d0\u30a4\u30c0\u304b\u3089\u63d0\u4f9b\u3055\u308c\u305f\u540d\u524d\u3067\u3059\u3002(\u975e\u516c\u958b)","src","/assets/octicons/question.svg",1,"m-1","octicon-info","help-icon"],["name","displayname","placeholder","\u4f8b: hogehoge1032","type","text","disabled","",1,"col-10","form-control",3,"value"],["title","\u8a8d\u8a3c\u306b\u4f7f\u308f\u308c\u308b\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u3067\u3059\u3002(\u975e\u516c\u958b)","src","/assets/octicons/question.svg",1,"m-1","octicon-info","help-icon"],["name","email","placeholder","email@example.com","formControlName","email","autocomplete","email","type","email","required","","autofill","","maxlength","1024","minlength","5",1,"col-8","form-control"],[1,"btn","btn-primary","col-2",3,"disabled","click"],["title","\u30ed\u30b0\u30a4\u30f3\u6642\u306e\u30d1\u30b9\u30ef\u30fc\u30c9\u3067\u3059\u3002\u4ed6\u4eba\u306b\u63a8\u6e2c\u3055\u308c\u306a\u3044\u3082\u306e\u3092\u4f7f\u7528\u3057\u3066\u304f\u3060\u3055\u3044\u3002(\u975e\u516c\u958b)","src","/assets/octicons/question.svg",1,"m-1","octicon-info","help-icon"],["name","password","placeholder","\u5909\u66f4\u306a\u3057","formControlName","password","type","password","autocomplete","new-password","maxlength","256","minlength","6",1,"col-8","form-control"],[1,"col-lg-5","col-form-label",3,"passwordToCheck","barLabel","strengthLabels","barColors"],[1,"m-3"],[1,"input-group","m-3"],["tabindex","-1",1,"btn","btn-warning",3,"click"],["alt","Profile \u753b\u50cf",1,"user-settings-profile-image","rounded",3,"src"],[1,"p-3"],["alt","\u65b0\u3057\u3044 Profile \u753b\u50cf",1,"user-settings-profile-image","rounded",3,"src"],[1,"btn","btn-primary",3,"click"],[1,"valid-feedback"],["class","invalid-feedback",4,"ngIf"],[1,"invalid-feedback"],[3,"mainForm","userPrivStore$"]],template:function(u,r){1&u&&e.YNc(0,wt,77,41,"ng-container",0),2&u&&e.Q6J("ngIf",r.currentUser)},dependencies:[H.O5,i._Y,i.Fj,i.JJ,i.JL,i.Q7,i.wO,i.nD,i.sg,i.u,D.e,Nt,H.Ov],styles:[".user-settings-profile-image[_ngcontent-%COMP%]{width:80px;height:80px}.help-icon[_ngcontent-%COMP%]{width:20px;height:20px}"]})),g})();function Et(h,g){if(1&h&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&h){const y=e.oxw().$implicit;e.xp6(1),e.hij("URL: ",y.url,"")}}function l(h,g){if(1&h&&(e.TgZ(0,"div")(1,"div")(2,"div"),e._uU(3),e.qZA(),e.YNc(4,Et,2,1,"div",0),e.TgZ(5,"div"),e._uU(6),e.qZA(),e.TgZ(7,"div"),e._uU(8),e.ALo(9,"date"),e.qZA()(),e._UZ(10,"hr"),e.TgZ(11,"div"),e._uU(12),e.qZA()()),2&h){const y=g.$implicit;e.xp6(3),e.hij("Title: ",y.title,""),e.xp6(1),e.Q6J("ngIf",y.url),e.xp6(2),e.hij("Done: ",y.hasRead,""),e.xp6(2),e.hij("Date: ",e.xi3(9,5,y.createdAt.toDate(),"yyyy-MM-dd hh:mm:ss"),""),e.xp6(4),e.Oqu(y.body)}}let f=(()=>{var h;class g{constructor(u,r,b){(0,c.Z)(this,"auth",void 0),(0,c.Z)(this,"route",void 0),(0,c.Z)(this,"store",void 0),(0,c.Z)(this,"destroy$",new E.x),(0,c.Z)(this,"id$",void 0),(0,c.Z)(this,"trayStore",void 0),this.auth=u,this.route=r,this.store=b}ngOnDestroy(){this.destroy$.next()}ngOnInit(){(0,x.eM)("UserTrayMessageComponent.OnInit()",this.route.snapshot),this.id$=this.route.queryParams.pipe((0,A.h)(u=>"id"in u),(0,Ue.U)(u=>u.id)),this.id$.pipe((0,ue.w)(u=>(0,ze.a)((0,ke.of)(u),this.auth.clientSideUser$)),(0,A.h)(([u,r])=>null!==r),(0,ue.w)(([u,r])=>this.store.doc(`/users/v1/protected/${r.uid}/tray/${u}`).valueChanges({idField:"id"}).pipe((0,Q.q)(1))),(0,S.R)(this.destroy$)).subscribe(u=>{this.trayStore=u})}}return h=g,(0,c.Z)(g,"\u0275fac",function(u){return new(u||h)(e.Y36(Be.e),e.Y36(U.gz),e.Y36(ge.ST))}),(0,c.Z)(g,"\u0275cmp",e.Xpm({type:h,selectors:[["app-user-tray-message"]],decls:1,vars:1,consts:[[4,"ngIf"]],template:function(u,r){1&u&&e.YNc(0,l,13,8,"div",0),2&u&&e.Q6J("ngIf",r.trayStore)},dependencies:[H.O5,H.uU]})),g})(),Z=(()=>{var h;class g{constructor(u,r,b){(0,c.Z)(this,"auth",void 0),(0,c.Z)(this,"localSession",void 0),(0,c.Z)(this,"router",void 0),this.auth=u,this.localSession=r,this.router=b,(0,x.eM)("AuthGuard.constructor")}canActivate(u,r){return this.auth.clientSideUser$.pipe((0,Ue.U)(b=>{if((0,x.H_)("AuthGuard",b),b)return!0;const w={queryParams:{redirectPath:r.url}};return(0,x.eM)("auth.guard Prepare to redirect",w),this.router.createUrlTree(["/Gitfire/login"],w)}))}}return h=g,(0,c.Z)(g,"\u0275fac",function(u){return new(u||h)(e.LFG(Be.e),e.LFG(be.m),e.LFG(U.F0))}),(0,c.Z)(g,"\u0275prov",e.Yz7({token:h,factory:h.\u0275fac,providedIn:"root"})),g})(),B=(()=>{var h;class g{constructor(u,r,b){(0,c.Z)(this,"auth",void 0),(0,c.Z)(this,"localSession",void 0),(0,c.Z)(this,"router",void 0),this.auth=u,this.localSession=r,this.router=b}canActivate(u,r){return this.auth.authState.pipe((0,Ue.U)(b=>((0,x.H_)("LoginGuard",b),!b||this.router.createUrlTree(["/"]))))}}return h=g,(0,c.Z)(g,"\u0275fac",function(u){return new(u||h)(e.LFG(Ce.zQ),e.LFG(be.m),e.LFG(U.F0))}),(0,c.Z)(g,"\u0275prov",e.Yz7({token:h,factory:h.\u0275fac,providedIn:"root"})),g})();const z=[{path:"login.htm",loadChildren:()=>Promise.resolve().then(p.bind(p,3128)).then(h=>h.GitfireLoginModule),data:{mode:"login"},canActivate:[B]},{path:"login",redirectTo:"login.htm"},{path:"signup.htm",loadChildren:()=>Promise.resolve().then(p.bind(p,3128)).then(h=>h.GitfireLoginModule),data:{mode:"signup"},canActivate:[B]},{path:"signup",redirectTo:"signup.htm"},{path:"reset.htm",loadChildren:()=>Promise.resolve().then(p.bind(p,3128)).then(h=>h.GitfireLoginModule),data:{mode:"reset"}},{path:"reset",redirectTo:"reset.htm"},{path:"chat.htm",loadChildren:()=>Promise.all([p.e(592),p.e(918)]).then(p.bind(p,5918)).then(h=>h.GitfireChatModule),canActivate:[Z]},{path:"chat",redirectTo:"chat.htm"},{path:"post.htm",loadChildren:()=>p.e(284).then(p.bind(p,3284)).then(h=>h.GitfirePostModule),canActivate:[Z]},{path:"post",redirectTo:"post.htm"},{path:"settings.htm",component:Bt,canActivate:[Z]},{path:"settings",redirectTo:"settings.htm"},{path:"tray.htm",component:f,canActivate:[Z]},{path:"tray",redirectTo:"tray.htm"}];let a=(()=>{var h;class g{}return h=g,(0,c.Z)(g,"\u0275fac",function(u){return new(u||h)}),(0,c.Z)(g,"\u0275mod",e.oAB({type:h})),(0,c.Z)(g,"\u0275inj",e.cJS({imports:[U.Bz.forChild(z),U.Bz]})),g})();var m=p(3128),k=p(1134),$=p(6450),me=p(7910);let ae=(()=>{var h;class g{}return h=g,(0,c.Z)(g,"\u0275fac",function(u){return new(u||h)}),(0,c.Z)(g,"\u0275mod",e.oAB({type:h})),(0,c.Z)(g,"\u0275inj",e.cJS({providers:[me.K,$.F],imports:[H.ez,i.u5,i.UX,k.M]})),g})();var Y=p(5101);let Ge=(()=>{var h;class g{constructor(){(0,x.H_)("Dynamically loaded GitfireModule")}}return h=g,(0,c.Z)(g,"\u0275fac",function(u){return new(u||h)}),(0,c.Z)(g,"\u0275mod",e.oAB({type:h})),(0,c.Z)(g,"\u0275inj",e.cJS({providers:[I._W,Be.e,Z,B,He.c,{provide:re.Xz,useValue:x.NZ.FirebaseCloudFunctionsRegion},{provide:W,useValue:x.NZ.firebaseVapidKey}],imports:[H.ez,i.u5,i.UX,a,m.GitfireLoginModule,ae,D._,I.Rh.forRoot(x.NZ.toastrConfig),X.hO.initializeApp(x.NZ.firebaseConfig),ge.yb,Ce.ww,pe.TE,re.Qv,T,Y.R]})),g})()},3128:(Ut,De,p)=>{p.r(De),p.d(De,{GitfireLoginModule:()=>U});var c=p(1180),H=p(6814),i=p(5739),X=p(7217),re=p(5579),ge=p(434),Ce=p(2425),pe=p(5187),L=p(553),e=p(5879),Ne=p(8645),we=p(8337);let ke=(()=>{var E;class S{constructor(A){(0,c.Z)(this,"router",void 0),(0,c.Z)(this,"destroy$",new Ne.x),this.router=A}ngOnInit(){(0,L.eM)("LoginComponent.OnInit()")}ngOnDestroy(){this.destroy$.next()}}return E=S,(0,c.Z)(S,"\u0275fac",function(A){return new(A||E)(e.Y36(pe.F0))}),(0,c.Z)(S,"\u0275cmp",e.Xpm({type:E,selectors:[["gitfire-login"]],decls:12,vars:1,consts:[[1,"h3","mb-3","fw-normal"],[3,"isLogin"],["routerLink","/Gitfire/signup"],["routerLink","/Gitfire/reset"],["routerLink","/"]],template:function(A,x){1&A&&(e.TgZ(0,"h1",0),e._uU(1,"\u30ed\u30b0\u30a4\u30f3\u60c5\u5831"),e.qZA(),e._UZ(2,"gitfire-login-input-auth",1),e.TgZ(3,"div")(4,"a",2),e._uU(5,"\u30a2\u30ab\u30a6\u30f3\u30c8\u3092\u4f5c\u6210\u3059\u308b"),e.qZA()(),e.TgZ(6,"div")(7,"a",3),e._uU(8,"\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u5fd8\u308c\u305f\u5834\u5408"),e.qZA()(),e.TgZ(9,"div")(10,"a",4),e._uU(11,"Top"),e.qZA()()),2&A&&(e.xp6(2),e.Q6J("isLogin",!0))},dependencies:[pe.rH,we.InputAuthComponent]})),S})();var _e=p(3867);const Le=["app-cookie-confirm",""];function ce(E,S){if(1&E){const Q=e.EpF();e.TgZ(0,"button",4),e.NdJ("click",function(){e.CHM(Q);const x=e.oxw();return e.KtG(x.remove())}),e.TgZ(1,"span",5),e._uU(2,"\xd7"),e.qZA()()}}let le=(()=>{var E;class S extends Ce.FN{constructor(A,x,K){super(A,x),(0,c.Z)(this,"toastr",void 0),(0,c.Z)(this,"toastPackage",void 0),(0,c.Z)(this,"localSession",void 0),this.toastr=A,this.toastPackage=x,this.localSession=K}ngOnInit(){(0,L.eM)("CookieConfirmComponent.OnInit()")}onClickDeny(A){this.localSession.declineAccess(),this.remove()}onClickGrant(A){this.localSession.grantAccess(),this.remove()}}return E=S,(0,c.Z)(S,"\u0275fac",function(A){return new(A||E)(e.Y36(Ce._W),e.Y36(Ce.PR),e.Y36(_e.m))}),(0,c.Z)(S,"\u0275cmp",e.Xpm({type:E,selectors:[["","app-cookie-confirm",""]],features:[e.qOj],attrs:Le,decls:12,vars:4,consts:[["class","toast-close-button","aria-label","Close",3,"click",4,"ngIf"],["role","alertdialog","aria-live","polite"],["href","/terms.htm"],[1,"btn","btn-outline-primary",3,"click"],["aria-label","Close",1,"toast-close-button",3,"click"],["aria-hidden","true"]],template:function(A,x){1&A&&(e.YNc(0,ce,3,0,"button",0),e.TgZ(1,"div",1)(2,"p"),e._uU(3,"\u5f53\u30b5\u30a4\u30c8\u3067\u306f\u5229\u7528\u8005\u306e\u5229\u4fbf\u6027\u306e\u305f\u3081\u306b\u30af\u30c3\u30ad\u30fc (Cookies) \u3092\u4f7f\u7528\u3057\u307e\u3059\u3002\u8a73\u3057\u304f\u306f"),e.TgZ(4,"a",2),e._uU(5," [\u5229\u7528\u898f\u7d04] "),e.qZA(),e._uU(6,"\u3092\u3054\u89a7\u304f\u3060\u3055\u3044\u3002"),e.qZA(),e.TgZ(7,"div")(8,"button",3),e.NdJ("click",function(oe){return x.onClickGrant(oe)}),e._uU(9,"\u8a31\u53ef\u3059\u308b"),e.qZA(),e.TgZ(10,"button",3),e.NdJ("click",function(oe){return x.onClickDeny(oe)}),e._uU(11,"\u62d2\u5426\u3059\u308b"),e.qZA()()()),2&A&&(e.Q6J("ngIf",x.options.closeButton),e.xp6(1),e.Tol(x.options.messageClass),e.uIk("aria-label",x.message))},styles:["[_nghost-%COMP%]{background:#eefef0;width:100%;height:100%}a[_ngcontent-%COMP%]:link{color:red}a[_ngcontent-%COMP%]:visited{color:#a00}a[_ngcontent-%COMP%]:hover{color:red}a[_ngcontent-%COMP%]:active{color:#ff8000}"]})),S})(),de=(()=>{var E;class S{constructor(A,x){(0,c.Z)(this,"toastr",void 0),(0,c.Z)(this,"localSession",void 0),this.toastr=A,this.localSession=x}ngOnInit(){(0,L.eM)("SignupComponent.OnInit()")}ngAfterViewInit(){this.maybeConfirm()}maybeConfirm(){this.localSession.shouldConfirm()&&this.toastr.info(void 0,void 0,{toastComponent:le,disableTimeOut:!0,tapToDismiss:!1,preventDuplicates:!0})}}return E=S,(0,c.Z)(S,"\u0275fac",function(A){return new(A||E)(e.Y36(Ce._W),e.Y36(_e.m))}),(0,c.Z)(S,"\u0275cmp",e.Xpm({type:E,selectors:[["gitfire-signup"]],decls:9,vars:1,consts:[[1,"h3","mb-3","fw-normal"],[3,"isSignup"],["routerLink","/Gitfire/login"],["routerLink","/"]],template:function(A,x){1&A&&(e.TgZ(0,"h1",0),e._uU(1,"\u30a2\u30ab\u30a6\u30f3\u30c8\u306e\u4f5c\u6210"),e.qZA(),e._UZ(2,"gitfire-login-input-auth",1),e.TgZ(3,"div")(4,"a",2),e._uU(5,"\u30ed\u30b0\u30a4\u30f3"),e.qZA()(),e.TgZ(6,"div")(7,"a",3),e._uU(8,"Top"),e.qZA()()),2&A&&(e.xp6(2),e.Q6J("isSignup",!0))},dependencies:[pe.rH,we.InputAuthComponent]})),S})();var ue=p(5861),Ue=p(7319),te=p(103);const ne=["resetForm"];function Oe(E,S){1&E&&(e.TgZ(0,"div",11),e._uU(1,"E \u30e1\u30fc\u30eb\u306f\u5fc5\u9808\u3067\u3059\u3002"),e.qZA())}function Re(E,S){1&E&&(e.TgZ(0,"div",11),e._uU(1,"E \u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044\u3002"),e.qZA())}function ve(E,S){if(1&E&&(e.ynx(0),e.YNc(1,Oe,2,0,"div",10),e.YNc(2,Re,2,0,"div",10),e.BQk()),2&E){e.oxw();const Q=e.MAs(6);e.xp6(1),e.Q6J("ngIf",null==Q.errors?null:Q.errors.required),e.xp6(1),e.Q6J("ngIf",null==Q.errors?null:Q.errors.minlength)}}let F=(()=>{var E;class S{constructor(A,x,K){(0,c.Z)(this,"auth",void 0),(0,c.Z)(this,"dialog",void 0),(0,c.Z)(this,"toastr",void 0),(0,c.Z)(this,"emailInput",""),(0,c.Z)(this,"resetForm",void 0),this.auth=A,this.dialog=x,this.toastr=K}ngOnInit(){(0,L.eM)("ResetPasswordComponent.OnInit()")}onClickReset(A){this.dialog.createSimpleBuilder().setType(Ue.iR.Warn).setSize(Ue.PW.Default).setTitle("\u78ba\u8a8d").setMessage(`\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u306f\u6b63\u3057\u3044\u3067\u3059\u304b\uff1f ${this.emailInput}`).okButton(()=>{this.tryResetPassword(this.emailInput)}).cancelButton(()=>{}).open()}tryResetPassword(A){var x=this;return(0,ue.Z)(function*(){try{yield x.auth.sendPasswordResetEmail(A),x.toastr.info("\u30e1\u30fc\u30eb\u3092\u9001\u4fe1\u3057\u307e\u3057\u305f\u3002")}catch(K){(0,L.wb)("Error while sent reset mail",K),Error,x.toastr.error("\u5931\u6557\u3057\u307e\u3057\u305f\u3002( ${errmsg} )")}})()}}return E=S,(0,c.Z)(S,"\u0275fac",function(A){return new(A||E)(e.Y36(ge.zQ),e.Y36(te.xA),e.Y36(Ce._W))}),(0,c.Z)(S,"\u0275cmp",e.Xpm({type:E,selectors:[["gitfire-login-reset-password"]],viewQuery:function(A,x){if(1&A&&e.Gf(ne,5),2&A){let K;e.iGM(K=e.CRH())&&(x.resetForm=K.first)}},decls:19,vars:5,consts:[["resetForm",""],[1,"row","p-3"],[1,"visually-hidden"],["autofocus","","type","email","name","email","placeholder","Email address","required","","autofill","","maxlength","1024","minlength","5",1,"form-control","col-8",3,"ngModel","ngModelChange"],["email","ngModel"],[1,"btn","btn-warning",3,"disabled","click"],[4,"ngIf"],["routerLink","/"],["routerLink","/Gitfire/signup"],["routerLink","/Gitfire/login"],["class","invalid-feedback",4,"ngIf"],[1,"invalid-feedback"]],template:function(A,x){if(1&A&&(e.TgZ(0,"form",null,0)(2,"div",1)(3,"label",2),e._uU(4,"Email"),e.qZA(),e.TgZ(5,"input",3,4),e.NdJ("ngModelChange",function(oe){return x.emailInput=oe}),e.qZA(),e.TgZ(7,"button",5),e.NdJ("click",function(oe){return x.onClickReset(oe)}),e._uU(8,"\u30d1\u30b9\u30ef\u30fc\u30c9\u30ea\u30bb\u30c3\u30c8"),e.qZA(),e.YNc(9,ve,3,2,"ng-container",6),e.qZA()(),e.TgZ(10,"div")(11,"a",7),e._uU(12,"Top"),e.qZA()(),e.TgZ(13,"div")(14,"a",8),e._uU(15,"\u30a2\u30ab\u30a6\u30f3\u30c8\u3092\u4f5c\u6210\u3059\u308b"),e.qZA()(),e.TgZ(16,"div")(17,"a",9),e._uU(18,"\u30ed\u30b0\u30a4\u30f3"),e.qZA()()),2&A){const K=e.MAs(6);e.xp6(2),e.ekj("was-validated",K.dirty||K.touched),e.xp6(3),e.Q6J("ngModel",x.emailInput),e.xp6(2),e.Q6J("disabled",!K.valid),e.xp6(2),e.Q6J("ngIf",K.invalid)}},dependencies:[H.O5,i._Y,i.Fj,i.JJ,i.JL,i.Q7,i.wO,i.nD,i.On,i.F,pe.rH]})),S})();function P(E,S){1&E&&e._UZ(0,"gitfire-signup")}function W(E,S){1&E&&e._UZ(0,"gitfire-login")}function v(E,S){1&E&&e._UZ(0,"gitfire-login-reset-password")}const T=[{path:"",component:(()=>{var E;class S{constructor(A){(0,c.Z)(this,"route",void 0),(0,c.Z)(this,"mode",void 0),this.route=A,this.mode=A.snapshot.data.mode}ngOnInit(){(0,L.eM)("LoginRouterComponent.OnInit()")}}return E=S,(0,c.Z)(S,"\u0275fac",function(A){return new(A||E)(e.Y36(pe.gz))}),(0,c.Z)(S,"\u0275cmp",e.Xpm({type:E,selectors:[["ng-component"]],decls:4,vars:4,consts:[[3,"ngSwitch"],[4,"ngSwitchCase"]],template:function(A,x){1&A&&(e.ynx(0,0),e.YNc(1,P,1,0,"gitfire-signup",1),e.YNc(2,W,1,0,"gitfire-login",1),e.YNc(3,v,1,0,"gitfire-login-reset-password",1),e.BQk()),2&A&&(e.Q6J("ngSwitch",x.mode),e.xp6(1),e.Q6J("ngSwitchCase","signup"),e.xp6(1),e.Q6J("ngSwitchCase","login"),e.xp6(1),e.Q6J("ngSwitchCase","reset"))},dependencies:[H.RF,H.n9,ke,de,F]})),S})()}];let I=(()=>{var E;class S{}return E=S,(0,c.Z)(S,"\u0275fac",function(A){return new(A||E)}),(0,c.Z)(S,"\u0275mod",e.oAB({type:E})),(0,c.Z)(S,"\u0275inj",e.cJS({imports:[pe.Bz.forChild(T),pe.Bz]})),S})();var D=p(2589);let U=(()=>{var E;class S{}return E=S,(0,c.Z)(S,"\u0275fac",function(A){return new(A||E)}),(0,c.Z)(S,"\u0275mod",e.oAB({type:E})),(0,c.Z)(S,"\u0275inj",e.cJS({providers:[Ce._W],imports:[H.ez,i.u5,i.UX,I,Ce.Rh.forRoot(L.NZ.toastrConfig),X.hO.initializeApp(L.NZ.firebaseConfig),re.yb,ge.ww,D._]})),S})()},8337:(Ut,De,p)=>{p.r(De),p.d(De,{InputAuthComponent:()=>qe});var c=p(5861),H=p(1180),i=p(5879),X=p(5739),re=p(8645),ge=p(5619),Ce=p(2459),pe=p(9773),L=p(8180),e=p(7142),we=(p(752),p(553)),ke=p(434),_e=p(2425),Le=p(5187),ce=p(6814),le=p(2589),de=p(9240);const ue=["mainForm"],Ue=["confirmPasswordInput"];function te(G,ie){1&G&&(i.TgZ(0,"div",15),i._uU(1,"OK!"),i.qZA())}function ne(G,ie){1&G&&(i.TgZ(0,"div",17),i._uU(1,"E \u30e1\u30fc\u30eb\u306f\u5fc5\u9808\u3067\u3059\u3002"),i.qZA())}function Oe(G,ie){1&G&&(i.TgZ(0,"div",17),i._uU(1,"E \u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044\u3002"),i.qZA())}function Re(G,ie){if(1&G&&(i.ynx(0),i.YNc(1,ne,2,0,"div",16),i.YNc(2,Oe,2,0,"div",16),i.BQk()),2&G){const M=i.oxw();i.xp6(1),i.Q6J("ngIf",null==M.emailControl.errors?null:M.emailControl.errors.required),i.xp6(1),i.Q6J("ngIf",null==M.emailControl.errors?null:M.emailControl.errors.minlength)}}function ve(G,ie){1&G&&(i.TgZ(0,"div",15),i._uU(1,"\u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u5f37\u5ea6\u306f\u5145\u5206\u306b\u3057\u3066\u304f\u3060\u3055\u3044\u3002"),i.qZA())}function F(G,ie){1&G&&(i.TgZ(0,"div",17),i._uU(1,"\u30d1\u30b9\u30ef\u30fc\u30c9\u306f\u5fc5\u9808\u3067\u3059\u3002"),i.qZA())}function P(G,ie){1&G&&(i.TgZ(0,"div",17),i._uU(1,"\u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u9577\u3055\u304c\u8db3\u308a\u307e\u305b\u3093\u3002"),i.qZA())}function W(G,ie){if(1&G&&(i.ynx(0,18),i.YNc(1,F,2,0,"div",16),i.YNc(2,P,2,0,"div",16),i.BQk()),2&G){const M=i.oxw();i.xp6(1),i.Q6J("ngIf",null==M.passwordControl.errors?null:M.passwordControl.errors.required),i.xp6(1),i.Q6J("ngIf",null==M.passwordControl.errors?null:M.passwordControl.errors.minlength)}}const v=function(){return["(\u5371\u967a)","(\u5f31\u3044)","(\u666e\u901a)","(\u5f37\u3044)","(\u5145\u5206\u306b\u5b89\u5168)"]},C=function(){return["#DD2C00","#FF6D00","#FFD600","#AEEA00","#00C853"]};function T(G,ie){if(1&G&&(i._UZ(0,"ng9-password-strength-bar",19),i.ALo(1,"async")),2&G){const M=i.oxw();i.Q6J("passwordToCheck",i.lcZ(1,4,M.passwordControl.valueChanges))("barLabel","\u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u5f37\u5ea6(\u76ee\u5b89): ")("strengthLabels",i.DdM(6,v))("barColors",i.DdM(7,C))}}function I(G,ie){1&G&&(i.TgZ(0,"div",15),i._uU(1,"\u4e00\u81f4\u3057\u307e\u3057\u305f\uff01"),i.qZA())}function D(G,ie){1&G&&(i.TgZ(0,"div",17),i._uU(1,"\u30d1\u30b9\u30ef\u30fc\u30c9\u306f\u5fc5\u9808\u3067\u3059\u3002"),i.qZA())}function U(G,ie){1&G&&(i.TgZ(0,"div",17),i._uU(1,"\u30d1\u30b9\u30ef\u30fc\u30c9\u304c\u4e00\u81f4\u3057\u307e\u305b\u3093\u3002"),i.qZA())}function E(G,ie){if(1&G&&(i.ynx(0),i.YNc(1,D,2,0,"div",16),i.YNc(2,U,2,0,"div",16),i.BQk()),2&G){const M=i.oxw(2);i.xp6(1),i.Q6J("ngIf",null==M.confirmPasswordControl.errors?null:M.confirmPasswordControl.errors.required),i.xp6(1),i.Q6J("ngIf",null==M.confirmPasswordControl.errors?null:M.confirmPasswordControl.errors.passwordMisMatch)}}function S(G,ie){if(1&G&&(i.TgZ(0,"div",2)(1,"label",20),i._uU(2,"Confirm Password"),i.qZA(),i._UZ(3,"input",21,22),i.YNc(5,I,2,0,"div",5),i.YNc(6,E,3,2,"ng-container",6),i.qZA()),2&G){const M=i.oxw();i.ekj("was-validated",M.confirmPasswordControl.dirty||M.confirmPasswordControl.touched),i.xp6(3),i.Q6J("autocomplete",M.passwordAutocomplete),i.xp6(2),i.Q6J("ngIf",!M.confirmPasswordControl.invalid),i.xp6(1),i.Q6J("ngIf",M.confirmPasswordControl.invalid)}}function Q(G,ie){1&G&&(i.TgZ(0,"div",29),i._uU(1,"OK!"),i.qZA())}function A(G,ie){1&G&&(i.TgZ(0,"div",31),i._uU(1,"\u898f\u7d04\u306b\u540c\u610f\u3057\u3066\u3044\u305f\u3060\u304f\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002"),i.qZA())}function x(G,ie){if(1&G&&(i.ynx(0),i.YNc(1,A,2,0,"div",30),i.BQk()),2&G){const M=i.oxw(2);i.xp6(1),i.Q6J("ngIf",null==M.agreeTosControl.errors?null:M.agreeTosControl.errors.required)}}function K(G,ie){if(1&G&&(i.TgZ(0,"div",23)(1,"label",24),i._uU(2,"\u898f\u7d04\u306b\u540c\u610f\u3059\u308b"),i.qZA(),i._UZ(3,"input",25),i.TgZ(4,"a",26),i._uU(5," [\u5229\u7528\u898f\u7d04] "),i.qZA(),i.TgZ(6,"span",27),i._uU(7,"\u306b\u540c\u610f\u3057\u307e\u3059\u3002"),i.qZA(),i.YNc(8,Q,2,0,"div",28),i.YNc(9,x,2,1,"ng-container",6),i.qZA()),2&G){const M=i.oxw();i.ekj("was-validated",M.agreeTosControl.dirty||M.agreeTosControl.touched),i.xp6(8),i.Q6J("ngIf",!M.agreeTosControl.invalid),i.xp6(1),i.Q6J("ngIf",M.agreeTosControl.invalid)}}function oe(G,ie){if(1&G){const M=i.EpF();i.TgZ(0,"button",32),i.NdJ("click",function(O){i.CHM(M);const j=i.oxw();return i.KtG(j.onClickSignup(O))}),i._uU(1,"\u30a2\u30ab\u30a6\u30f3\u30c8\u4f5c\u6210"),i.qZA()}if(2&G){const M=i.oxw();i.Q6J("disabled",!M.inputAuthForm.valid)}}function Ee(G,ie){if(1&G){const M=i.EpF();i.TgZ(0,"button",32),i.NdJ("click",function(O){i.CHM(M);const j=i.oxw();return i.KtG(j.onClickLogin(O))}),i._UZ(1,"img",33),i._uU(2,"\u30ed\u30b0\u30a4\u30f3"),i.qZA()}if(2&G){const M=i.oxw();i.Q6J("disabled",!M.inputAuthForm.valid)}}function ye(G,ie){if(1&G){const M=i.EpF();i.TgZ(0,"button",32),i.NdJ("click",function(O){i.CHM(M);const j=i.oxw();return i.KtG(j.onClickReauth(O))}),i._UZ(1,"img",33),i._uU(2,"\u518d\u8a8d\u8a3c"),i.qZA()}if(2&G){const M=i.oxw();i.Q6J("disabled",!M.inputAuthForm.valid)}}function fe(G,ie){if(1&G){const M=i.EpF();i.TgZ(0,"app-oauth-federations",34),i.NdJ("loginSucceeded",function(){i.CHM(M);const O=i.oxw();return i.KtG(O.onOauthLoginSucceeded())})("loginFailed",function(O){i.CHM(M);const j=i.oxw();return i.KtG(j.onOauthLoginFailed(O))}),i.qZA()}}let qe=(()=>{var G;class ie{constructor(V,O,j,Be){(0,H.Z)(this,"auth",void 0),(0,H.Z)(this,"toastr",void 0),(0,H.Z)(this,"router",void 0),(0,H.Z)(this,"route",void 0),(0,H.Z)(this,"isLogin",!1),(0,H.Z)(this,"isReauth",!1),(0,H.Z)(this,"reauthUser",null),(0,H.Z)(this,"isSignup",!1),(0,H.Z)(this,"showFederations",!0),(0,H.Z)(this,"reauthed",new i.vpe),(0,H.Z)(this,"destroy$",new re.x),(0,H.Z)(this,"inputAuthForm",void 0),(0,H.Z)(this,"loginUser$",new ge.X(null)),(0,H.Z)(this,"passwordAutocomplete",void 0),(0,H.Z)(this,"mainForm",void 0),(0,H.Z)(this,"confirmPasswordInput",void 0),this.auth=V,this.toastr=O,this.router=j,this.route=Be}ngOnInit(){this.passwordAutocomplete=this.isSignup?"new-password":"current-password",this.inputAuthForm=new X.cw({}),this.inputAuthForm.addControl("email",new X.NI("")),this.inputAuthForm.addControl("password",new X.NI("")),this.isSignup&&(this.inputAuthForm.addControl("retypePassword",new X.NI("")),this.inputAuthForm.addControl("agreeTosCheck",new X.NI(!1)),this.inputAuthForm.setValidators([this.validateXFPassword.bind(this)])),this.inputAuthForm.disable(),this.initializeAuthForm()}ngOnDestroy(){this.destroy$.next()}ngAfterViewInit(){this.auth.authState.pipe((0,pe.R)(this.destroy$)).subscribe(V=>{this.loginUser$.next(V)})}navigateAfterSucceeded(){this.route.queryParams.pipe((0,pe.R)(this.destroy$),(0,L.q)(1)).subscribe(V=>{const O=V.redirectPath;this.router.navigate(O?[O]:["/"])})}erroredConnected(V){(0,we.wb)("error while connecting account",V);const O=V instanceof Error?V.message:"Unknown error";this.toastr.error(`Login \u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002 \n ( ${O} )`)}loginSucceeded(){this.toastr.success("Login \u3057\u307e\u3057\u305f\u3002"),this.navigateAfterSucceeded()}connectSucceeded(V){this.toastr.success("Sign-up \u3057\u307e\u3057\u305f\u3002"),this.navigateAfterSucceeded()}get emailControl(){return this.inputAuthForm.get("email")}get passwordControl(){return this.inputAuthForm.get("password")}get confirmPasswordControl(){return this.inputAuthForm.get("retypePassword")}get agreeTosControl(){return this.inputAuthForm.get("agreeTosCheck")}validateXFPassword(V){const O=V.get("password"),j=V.get("retypePassword");return O.value!==j.value?(j.setErrors({passwordMisMatch:!0}),this.confirmPasswordInput&&this.confirmPasswordInput.nativeElement.setCustomValidity("create error state"),null):(this.confirmPasswordInput&&this.confirmPasswordInput.nativeElement.setCustomValidity(""),j.setErrors(null),null)}validateAuthForm(){return this.inputAuthForm.markAllAsTouched(),!this.inputAuthForm.invalid||((0,we.wb)("Assert! Button should be disabled."),!1)}initializeAuthForm(){(0,Ce.D)(this.auth.setPersistence(e.Z.auth.Auth.Persistence.SESSION)).pipe((0,L.q)(1),(0,pe.R)(this.destroy$)).subscribe({next:()=>{this.inputAuthForm.enable()},error:V=>{this.toastr.error("\u8a8d\u8a3c Server \u3092\u521d\u671f\u5316\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002")}})}onClickSignup(V){var O=this;return(0,c.Z)(function*(){if(V.preventDefault(),O.validateAuthForm())try{const j=yield O.auth.createUserWithEmailAndPassword(O.emailControl.value,O.passwordControl.value);O.toastr.info("\u30a2\u30ab\u30a6\u30f3\u30c8\u3092\u4f5c\u6210\u3057\u307e\u3057\u305f\u3002\u30e1\u30fc\u30eb\u3092\u78ba\u8a8d\u3057\u3066\u304f\u3060\u3055\u3044\u3002"),yield j.user.sendEmailVerification(),O.navigateAfterSucceeded()}catch(j){(0,we.wb)("Error while reject",j);const Be=j instanceof Error?j.message:"Unknown error";O.toastr.error(`\u30a2\u30ab\u30a6\u30f3\u30c8\u306e\u4f5c\u6210\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002\u6700\u521d\u304b\u3089\u3084\u308a\u76f4\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n ( ${Be} )`)}})()}onClickLogin(V){var O=this;return(0,c.Z)(function*(){if(V.preventDefault(),O.validateAuthForm())try{yield O.auth.signInWithEmailAndPassword(O.emailControl.value,O.passwordControl.value),O.loginSucceeded()}catch(j){O.erroredConnected(j)}})()}onClickReauth(V){var O=this;return(0,c.Z)(function*(){if(V.preventDefault(),O.validateAuthForm())try{const j=e.Z.auth.EmailAuthProvider.credential(O.emailControl.value,O.passwordControl.value);yield O.reauthUser.reauthenticateWithCredential(j),O.reauthed.next()}catch(j){O.erroredConnected(j)}})()}onOauthLoginFailed(V){this.erroredConnected(V)}onOauthLoginSucceeded(){this.loginSucceeded()}}return G=ie,(0,H.Z)(ie,"\u0275fac",function(V){return new(V||G)(i.Y36(ke.zQ),i.Y36(_e._W),i.Y36(Le.F0),i.Y36(Le.gz))}),(0,H.Z)(ie,"\u0275cmp",i.Xpm({type:G,selectors:[["gitfire-login-input-auth"]],viewQuery:function(V,O){if(1&V&&(i.Gf(ue,5),i.Gf(Ue,5)),2&V){let j;i.iGM(j=i.CRH())&&(O.mainForm=j.first),i.iGM(j=i.CRH())&&(O.confirmPasswordInput=j.first)}},inputs:{isLogin:"isLogin",isReauth:"isReauth",reauthUser:"reauthUser",isSignup:"isSignup",showFederations:"showFederations"},outputs:{reauthed:"reauthed"},decls:22,vars:17,consts:[[3,"formGroup"],["mainForm",""],[1,"row","m-3"],["for","appGitfireLoginEmailInput",1,"visually-hidden"],["id","appGitfireLoginEmailInput","name","email","formControlName","email","placeholder","email@example.com","autocomplete","email","type","email","required","","autofill","","autofocus","","maxlength","1024","minlength","5",1,"form-control","col-12"],["class","valid-feedback",4,"ngIf"],[4,"ngIf"],["for","appGitfireLoginPasswordInput",1,"visually-hidden"],["id","appGitfireLoginPasswordInput","type","password","name","password","formControlName","password","placeholder","Password","required","","autofill","","maxlength","256","minlength","6",1,"form-control","col-12",3,"autocomplete"],["class"," ",4,"ngIf"],["class","col-12 m-3",3,"passwordToCheck","barLabel","strengthLabels","barColors",4,"ngIf"],["class","row m-3",3,"was-validated",4,"ngIf"],["class","row custom-control custom-checkbox m-5 text-center",3,"was-validated",4,"ngIf"],["class","btn btn-lg btn-primary btn-block",3,"disabled","click",4,"ngIf"],[3,"loginSucceeded","loginFailed",4,"ngIf"],[1,"valid-feedback"],["class","invalid-feedback",4,"ngIf"],[1,"invalid-feedback"],[1,""],[1,"col-12","m-3",3,"passwordToCheck","barLabel","strengthLabels","barColors"],["for","appGitfireSignupPasswordConfirmInput",1,"visually-hidden"],["id","appGitfireSignupPasswordConfirmInput","type","password","name","password_confirm","formControlName","retypePassword","placeholder","Confirm password","required","",1,"form-control","col-12",3,"autocomplete"],["confirmPasswordInput",""],[1,"row","custom-control","custom-checkbox","m-5","text-center"],["for","appGitfireAgreeTosCheck",1,"col-auto","visually-hidden"],["id","col-auto appGitfireAgreeTosCheck","formControlName","agreeTosCheck","type","checkbox","required","",1,"form-check-input"],["tabindex","-1","about","_blank","href","/terms.htm",1,"col-auto"],[1,"col-auto"],["class","valid-feedback col-auto",4,"ngIf"],[1,"valid-feedback","col-auto"],["class","invalid-feedback col-auto",4,"ngIf"],[1,"invalid-feedback","col-auto"],[1,"btn","btn-lg","btn-primary","btn-block",3,"disabled","click"],["src","/assets/octicons/sign-in.svg",1,"m-1","gitfire-link-icon","octicon-info"],[3,"loginSucceeded","loginFailed"]],template:function(V,O){1&V&&(i.TgZ(0,"form",0,1)(2,"div",2)(3,"label",3),i._uU(4,"Email"),i.qZA(),i._UZ(5,"input",4),i.YNc(6,te,2,0,"div",5),i.YNc(7,Re,3,2,"ng-container",6),i.qZA(),i.TgZ(8,"div",2)(9,"label",7),i._uU(10,"Password"),i.qZA(),i._UZ(11,"input",8),i.YNc(12,ve,2,0,"div",5),i.YNc(13,W,3,2,"ng-container",9),i.YNc(14,T,2,8,"ng9-password-strength-bar",10),i.qZA(),i.YNc(15,S,7,5,"div",11),i.YNc(16,K,10,4,"div",12),i.TgZ(17,"div",2),i.YNc(18,oe,2,1,"button",13),i.YNc(19,Ee,3,1,"button",13),i.YNc(20,ye,3,1,"button",13),i.qZA(),i.YNc(21,fe,1,0,"app-oauth-federations",14),i.qZA()),2&V&&(i.Q6J("formGroup",O.inputAuthForm),i.xp6(2),i.ekj("was-validated",O.emailControl.dirty||O.emailControl.touched),i.xp6(4),i.Q6J("ngIf",!O.emailControl.invalid),i.xp6(1),i.Q6J("ngIf",O.emailControl.invalid),i.xp6(1),i.ekj("was-validated",O.passwordControl.dirty||O.passwordControl.touched),i.xp6(3),i.Q6J("autocomplete",O.passwordAutocomplete),i.xp6(1),i.Q6J("ngIf",O.isSignup&&!O.passwordControl.invalid),i.xp6(1),i.Q6J("ngIf",O.passwordControl.invalid),i.xp6(1),i.Q6J("ngIf",O.isSignup),i.xp6(1),i.Q6J("ngIf",O.isSignup),i.xp6(1),i.Q6J("ngIf",O.isSignup),i.xp6(2),i.Q6J("ngIf",O.isSignup),i.xp6(1),i.Q6J("ngIf",O.isLogin),i.xp6(1),i.Q6J("ngIf",O.isReauth),i.xp6(1),i.Q6J("ngIf",O.showFederations))},dependencies:[ce.O5,X._Y,X.Fj,X.Wl,X.JJ,X.JL,X.Q7,X.wO,X.nD,X.Zs,X.sg,X.u,le.e,de.x,ce.Ov]})),ie})()},1134:(Ut,De,p)=>{p.d(De,{M:()=>X});var c=p(1180),H=p(6814),i=p(5879);let X=(()=>{var re;class ge{}return re=ge,(0,c.Z)(ge,"\u0275fac",function(pe){return new(pe||re)}),(0,c.Z)(ge,"\u0275mod",i.oAB({type:re})),(0,c.Z)(ge,"\u0275inj",i.cJS({imports:[H.ez]})),ge})()},2589:(Ut,De,p)=>{function re(v,C,T,I){var E,D=arguments.length,U=D<3?C:null===I?I=Object.getOwnPropertyDescriptor(C,T):I;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)U=Reflect.decorate(v,C,T,I);else for(var S=v.length-1;S>=0;S--)(E=v[S])&&(U=(D<3?E(U):D>3?E(C,T,U):E(C,T))||U);return D>3&&U&&Object.defineProperty(C,T,U),U}p.d(De,{e:()=>P,_:()=>W});var F,ve=p(5879);let P=F=class{constructor(){this.onStrengthChanged=new ve.vpe,this.defaultColors=["#F00","#F90","#FF0","#9F0","#0F0"],this.defaultThresholds=[90,70,40,20],this.defaultBaseColor="#DDD",this.colors=this.defaultColors,this.thresholds=this.defaultThresholds}static measureStrength(C){let T=0;const I={};for(let E=0;E<C.length;E++)I[C[E]]=(I[C[E]]||0)+1,T+=5/I[C[E]];const D={digits:/\d/.test(C),lower:/[a-z]/.test(C),upper:/[A-Z]/.test(C),nonWords:/\W/.test(C)};let U=0;for(let E in D)U+=D[E]?1:0;return T+=10*(U-1),Math.trunc(T)}checkBarColors(){this.colors=this.barColors&&5===this.barColors.length?this.barColors.slice():this.defaultColors,this.strengths=this.strengthLabels&&5===this.strengthLabels.length?this.strengthLabels.slice():null,this.setStrengthLabel(0),/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(this.baseColor)||(this.baseColor=this.defaultBaseColor)}checkThresholds(){this.thresholds=this.customThresholds&&4===this.customThresholds.length?this.customThresholds.slice():this.defaultThresholds}getColor(C){let T=0;return C>this.thresholds[0]?T=4:C>this.thresholds[1]?T=3:C>=this.thresholds[2]?T=2:C>=this.thresholds[3]&&(T=1),{idx:T+1,col:this.colors[T]}}getStrengthIndexAndColor(C){return this.getColor(F.measureStrength(C))}ngOnChanges(C){if(!C.passwordToCheck)return;const T=C.passwordToCheck.currentValue;this.checkBarColors(),this.checkThresholds(),this.setBarColors(5,this.baseColor);let I=0;if(T){const D=this.getStrengthIndexAndColor(T);I=D.idx-1,this.setStrengthLabel(I),this.setBarColors(D.idx,D.col)}this.onStrengthChanged.emit(I)}setBarColors(C,T){for(let I=0;I<C;I++)this["bar"+I]=T}setStrengthLabel(C){this.strengths&&(this.strengthLabel=this.strengths[C])}};re([(0,ve.IIB)()],P.prototype,"passwordToCheck",void 0),re([(0,ve.IIB)()],P.prototype,"barLabel",void 0),re([(0,ve.IIB)()],P.prototype,"barColors",void 0),re([(0,ve.IIB)()],P.prototype,"baseColor",void 0),re([(0,ve.IIB)()],P.prototype,"strengthLabels",void 0),re([(0,ve.IIB)()],P.prototype,"customThresholds",void 0),re([(0,ve.r_U)()],P.prototype,"onStrengthChanged",void 0),P=F=re([(0,ve.wA2)({selector:"ng9-password-strength-bar",template:'\n    <div id="strength" #strength>\n      <small>{{barLabel}}</small>\n      <ul id="strengthBar" class="strengthBar">\n        <li id="bar0" class="point" [style.background-color]="bar0"></li>\n        <li class="point" [style.background-color]="bar1"></li>\n        <li class="point" [style.background-color]="bar2"></li>\n        <li class="point" [style.background-color]="bar3"></li>\n        <li class="point" [style.background-color]="bar4"></li>\n      </ul>\n      <small [hidden]="!strengths" class="pre">  {{strengthLabel}}</small>\n    </div>\n  ',styles:["\n    .strengthBar {\n      display: inline;\n      list-style: none;\n      margin: 0 0 0 15px;\n      padding: 0;\n      vertical-align: 2px;\n    }\n\n    .strengthBar .point {\n      background: #DDD;\n      border-radius: 2px;\n      display: inline-block;\n      height: 5px;\n      margin-right: 1px;\n      width: 20px;\n    }\n\n    .strengthBar .point:last-child {\n      margin: 0;\n    }\n    .pre {\n      white-space: pre;\n    }\n  "]})],P);let W=(()=>{let v=class{};return v=re([(0,ve.LVF)({declarations:[P],imports:[],exports:[P]})],v),v})()},4186:(Ut,De,p)=>{p.d(De,{Q1:()=>Cn,TE:()=>so});var c=p(1180),H=p(8326),i=p(5592),X=p(2096),re=p(2459),ge=p(3620),Ce=p(7398),pe=p(4664),L=p(5879),e=p(7217),Ne=p(3106),we=p(5861),ke=p(6122),_e=p(9058),Le=p(4537);const ce="firebasestorage.googleapis.com",le="storageBucket";class te extends _e.ZR{constructor(t,o,s=0){super(Oe(t),`Firebase Storage: ${o} (${Oe(t)})`),this.status_=s,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,te.prototype)}get status(){return this.status_}set status(t){this.status_=t}_codeEquals(t){return Oe(t)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(t){this.customData.serverResponse=t,this.message=this.customData.serverResponse?`${this._baseMessage}\n${this.customData.serverResponse}`:this._baseMessage}}var ne=function(n){return n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment",n}(ne||{});function Oe(n){return"storage/"+n}function Re(){return new te(ne.UNKNOWN,"An unknown error occurred, please check the error payload for server response.")}function C(){return new te(ne.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function T(){return new te(ne.CANCELED,"User canceled the upload/download.")}function E(){return new te(ne.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function x(n){return new te(ne.INVALID_ARGUMENT,n)}function K(){return new te(ne.APP_DELETED,"The Firebase app was deleted.")}function oe(n){return new te(ne.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function Ee(n,t){return new te(ne.INVALID_FORMAT,"String does not match format '"+n+"': "+t)}function ye(n){throw new te(ne.INTERNAL_ERROR,"Internal error: "+n)}class fe{constructor(t,o){this.bucket=t,this.path_=o}get path(){return this.path_}get isRoot(){return 0===this.path.length}fullServerUrl(){const t=encodeURIComponent;return"/b/"+t(this.bucket)+"/o/"+t(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(t,o){let s;try{s=fe.makeFromUrl(t,o)}catch{return new fe(t,"")}if(""===s.path)return s;throw function D(n){return new te(ne.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}(t)}static makeFromUrl(t,o){let s=null;const d="([A-Za-z0-9.\\-_]+)",q=new RegExp("^gs://"+d+"(/(.*))?$","i");function ee($e){$e.path_=decodeURIComponent($e.path)}const Ie=o.replace(/[.]/g,"\\."),Qe=[{regex:q,indices:{bucket:1,path:3},postModify:function _($e){"/"===$e.path.charAt($e.path.length-1)&&($e.path_=$e.path_.slice(0,-1))}},{regex:new RegExp(`^https?://${Ie}/v[A-Za-z0-9_]+/b/${d}/o(/([^?#]*).*)?$`,"i"),indices:{bucket:1,path:3},postModify:ee},{regex:new RegExp(`^https?://${o===ce?"(?:storage.googleapis.com|storage.cloud.google.com)":o}/${d}/([^?#]*)`,"i"),indices:{bucket:1,path:2},postModify:ee}];for(let $e=0;$e<Qe.length;$e++){const Jt=Qe[$e],jt=Jt.regex.exec(t);if(jt){let Qt=jt[Jt.indices.path];Qt||(Qt=""),s=new fe(jt[Jt.indices.bucket],Qt),Jt.postModify(s);break}}if(null==s)throw function I(n){return new te(ne.INVALID_URL,"Invalid URL '"+n+"'.")}(t);return s}}class qe{constructor(t){this.promise_=Promise.reject(t)}getPromise(){return this.promise_}cancel(t=!1){}}function j(n){return"string"==typeof n||n instanceof String}function Be(n){return He()&&n instanceof Blob}function He(){return typeof Blob<"u"&&!(0,_e.UG)()}function Xe(n,t,o,s){if(s<t)throw x(`Invalid value for '${n}'. Expected ${t} or greater.`);if(s>o)throw x(`Invalid value for '${n}'. Expected ${o} or less.`)}function be(n,t,o){let s=t;return null==o&&(s=`https://${t}`),`${o}://${s}/v0${n}`}function ze(n){const t=encodeURIComponent;let o="?";for(const s in n)n.hasOwnProperty(s)&&(o=o+(t(s)+"=")+t(n[s])+"&");return o=o.slice(0,-1),o}var Je=function(n){return n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT",n}(Je||{});function it(n,t){const o=n>=500&&n<600,d=-1!==[408,429].indexOf(n),_=-1!==t.indexOf(n);return o||d||_}class dt{constructor(t,o,s,d,_,R,q,J,ee,se,Ie,Fe=!0){this.url_=t,this.method_=o,this.headers_=s,this.body_=d,this.successCodes_=_,this.additionalRetryCodes_=R,this.callback_=q,this.errorCallback_=J,this.timeout_=ee,this.progressCallback_=se,this.connectionFactory_=Ie,this.retry=Fe,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((xe,Ae)=>{this.resolve_=xe,this.reject_=Ae,this.start_()})}start_(){const o=(s,d)=>{const _=this.resolve_,R=this.reject_,q=d.connection;if(d.wasSuccessCode)try{const J=this.callback_(q,q.getResponse());!function M(n){return void 0!==n}(J)?_():_(J)}catch(J){R(J)}else if(null!==q){const J=Re();J.serverResponse=q.getErrorText(),R(this.errorCallback_?this.errorCallback_(q,J):J)}else R(d.canceled?this.appDelete_?K():T():C())};this.canceled_?o(0,new st(!1,null,!0)):this.backoffId_=function G(n,t,o){let s=1,d=null,_=null,R=!1,q=0;function J(){return 2===q}let ee=!1;function se(...Pe){ee||(ee=!0,t.apply(null,Pe))}function Ie(Pe){d=setTimeout(()=>{d=null,n(xe,J())},Pe)}function Fe(){_&&clearTimeout(_)}function xe(Pe,...kt){if(ee)return void Fe();if(Pe)return Fe(),void se.call(null,Pe,...kt);if(J()||R)return Fe(),void se.call(null,Pe,...kt);let Qe;s<64&&(s*=2),1===q?(q=2,Qe=0):Qe=1e3*(s+Math.random()),Ie(Qe)}let Ae=!1;function We(Pe){Ae||(Ae=!0,Fe(),!ee&&(null!==d?(Pe||(q=2),clearTimeout(d),Ie(0)):Pe||(q=1)))}return Ie(0),_=setTimeout(()=>{R=!0,We(!0)},o),We}((s,d)=>{if(d)return void s(!1,new st(!1,null,!0));const _=this.connectionFactory_();this.pendingConnection_=_;const R=q=>{null!==this.progressCallback_&&this.progressCallback_(q.loaded,q.lengthComputable?q.total:-1)};null!==this.progressCallback_&&_.addUploadProgressListener(R),_.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{null!==this.progressCallback_&&_.removeUploadProgressListener(R),this.pendingConnection_=null;const q=_.getErrorCode()===Je.NO_ERROR,J=_.getStatus();if(!q||it(J,this.additionalRetryCodes_)&&this.retry){const se=_.getErrorCode()===Je.ABORT;return void s(!1,new st(!1,null,se))}const ee=-1!==this.successCodes_.indexOf(J);s(!0,new st(ee,_))})},o,this.timeout_)}getPromise(){return this.promise_}cancel(t){this.canceled_=!0,this.appDelete_=t||!1,null!==this.backoffId_&&function ie(n){n(!1)}(this.backoffId_),null!==this.pendingConnection_&&this.pendingConnection_.abort()}}class st{constructor(t,o,s){this.wasSuccessCode=t,this.connection=o,this.canceled=!!s}}function Nt(...n){const t=function ft(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}();if(void 0!==t){const o=new t;for(let s=0;s<n.length;s++)o.append(n[s]);return o.getBlob()}if(He())return new Blob(n);throw new te(ne.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}const Se={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class Ye{constructor(t,o){this.data=t,this.contentType=o||null}}function et(n,t){switch(n){case Se.RAW:return new Ye(at(t));case Se.BASE64:case Se.BASE64URL:return new Ye(tt(n,t));case Se.DATA_URL:return new Ye(function nt(n){const t=new vt(n);return t.base64?tt(Se.BASE64,t.rest):function _t(n){let t;try{t=decodeURIComponent(n)}catch{throw Ee(Se.DATA_URL,"Malformed data URL.")}return at(t)}(t.rest)}(t),function Ft(n){return new vt(n).contentType}(t))}throw Re()}function at(n){const t=[];for(let o=0;o<n.length;o++){let s=n.charCodeAt(o);s<=127?t.push(s):s<=2047?t.push(192|s>>6,128|63&s):55296==(64512&s)?o<n.length-1&&56320==(64512&n.charCodeAt(o+1))?(s=65536|(1023&s)<<10|1023&n.charCodeAt(++o),t.push(240|s>>18,128|s>>12&63,128|s>>6&63,128|63&s)):t.push(239,191,189):56320==(64512&s)?t.push(239,191,189):t.push(224|s>>12,128|s>>6&63,128|63&s)}return new Uint8Array(t)}function tt(n,t){switch(n){case Se.BASE64:{const d=-1!==t.indexOf("-"),_=-1!==t.indexOf("_");if(d||_)throw Ee(n,"Invalid character '"+(d?"-":"_")+"' found: is it base64url encoded?");break}case Se.BASE64URL:{const d=-1!==t.indexOf("+"),_=-1!==t.indexOf("/");if(d||_)throw Ee(n,"Invalid character '"+(d?"+":"/")+"' found: is it base64 encoded?");t=t.replace(/-/g,"+").replace(/_/g,"/");break}}let o;try{o=function mt(n){if(typeof atob>"u")throw function A(n){return new te(ne.UNSUPPORTED_ENVIRONMENT,`${n} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}("base-64");return atob(n)}(t)}catch(d){throw d.message.includes("polyfill")?d:Ee(n,"Invalid character found")}const s=new Uint8Array(o.length);for(let d=0;d<o.length;d++)s[d]=o.charCodeAt(d);return s}class vt{constructor(t){this.base64=!1,this.contentType=null;const o=t.match(/^data:([^,]+)?,/);if(null===o)throw Ee(Se.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const s=o[1]||null;null!=s&&(this.base64=function Ct(n,t){return n.length>=t.length&&n.substring(n.length-t.length)===t}(s,";base64"),this.contentType=this.base64?s.substring(0,s.length-7):s),this.rest=t.substring(t.indexOf(",")+1)}}class je{constructor(t,o){let s=0,d="";Be(t)?(this.data_=t,s=t.size,d=t.type):t instanceof ArrayBuffer?(o?this.data_=new Uint8Array(t):(this.data_=new Uint8Array(t.byteLength),this.data_.set(new Uint8Array(t))),s=this.data_.length):t instanceof Uint8Array&&(o?this.data_=t:(this.data_=new Uint8Array(t.length),this.data_.set(t)),s=t.length),this.size_=s,this.type_=d}size(){return this.size_}type(){return this.type_}slice(t,o){if(Be(this.data_)){const d=function gt(n,t,o){return n.webkitSlice?n.webkitSlice(t,o):n.mozSlice?n.mozSlice(t,o):n.slice?n.slice(t,o):null}(this.data_,t,o);return null===d?null:new je(d)}{const s=new Uint8Array(this.data_.buffer,t,o-t);return new je(s,!0)}}static getBlob(...t){if(He()){const o=t.map(s=>s instanceof je?s.data_:s);return new je(Nt.apply(null,o))}{const o=t.map(R=>j(R)?et(Se.RAW,R).data:R.data_);let s=0;o.forEach(R=>{s+=R.byteLength});const d=new Uint8Array(s);let _=0;return o.forEach(R=>{for(let q=0;q<R.length;q++)d[_++]=R[q]}),new je(d,!0)}}uploadData(){return this.data_}}function yt(n){let t;try{t=JSON.parse(n)}catch{return null}return function O(n){return"object"==typeof n&&!Array.isArray(n)}(t)?t:null}function ot(n){const t=n.lastIndexOf("/",n.length-2);return-1===t?n:n.slice(t+1)}function Lt(n,t){return t}class Te{constructor(t,o,s,d){this.server=t,this.local=o||t,this.writable=!!s,this.xform=d||Lt}}let ut=null;function Ve(){if(ut)return ut;const n=[];n.push(new Te("bucket")),n.push(new Te("generation")),n.push(new Te("metageneration")),n.push(new Te("name","fullPath",!0));const o=new Te("name");o.xform=function t(_,R){return function ct(n){return!j(n)||n.length<2?n:ot(n)}(R)},n.push(o);const d=new Te("size");return d.xform=function s(_,R){return void 0!==R?Number(R):R},n.push(d),n.push(new Te("timeCreated")),n.push(new Te("updated")),n.push(new Te("md5Hash",null,!0)),n.push(new Te("cacheControl",null,!0)),n.push(new Te("contentDisposition",null,!0)),n.push(new Te("contentEncoding",null,!0)),n.push(new Te("contentLanguage",null,!0)),n.push(new Te("contentType",null,!0)),n.push(new Te("metadata","customMetadata",!0)),ut=n,ut}function Gt(n,t,o){const s=yt(t);return null===s?null:function At(n,t,o){const s={type:"file"},d=o.length;for(let _=0;_<d;_++){const R=o[_];s[R.local]=R.xform(s,t[R.server])}return function Tt(n,t){Object.defineProperty(n,"ref",{get:function o(){const _=new fe(n.bucket,n.fullPath);return t._makeStorageReference(_)}})}(s,n),s}(n,s,o)}function Ot(n,t){const o={},s=t.length;for(let d=0;d<s;d++){const _=t[d];_.writable&&(o[_.server]=n[_.local])}return JSON.stringify(o)}const wt="prefixes",Bt="items";class f{constructor(t,o,s,d){this.url=t,this.method=o,this.handler=s,this.timeout=d,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}function Z(n){if(!n)throw Re()}function B(n,t){return function o(s,d){const _=Gt(n,d,t);return Z(null!==_),_}}function m(n){return function t(o,s){let d;return d=401===o.getStatus()?o.getErrorText().includes("Firebase App Check token is invalid")?function W(){return new te(ne.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}():function P(){return new te(ne.UNAUTHENTICATED,"User is not authenticated, please authenticate using Firebase Authentication and try again.")}():402===o.getStatus()?function F(n){return new te(ne.QUOTA_EXCEEDED,"Quota for bucket '"+n+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}(n.bucket):403===o.getStatus()?function v(n){return new te(ne.UNAUTHORIZED,"User does not have permission to access '"+n+"'.")}(n.path):s,d.status=o.getStatus(),d.serverResponse=s.serverResponse,d}}function k(n){const t=m(n);return function o(s,d){let _=t(s,d);return 404===s.getStatus()&&(_=function ve(n){return new te(ne.OBJECT_NOT_FOUND,"Object '"+n+"' does not exist.")}(n.path)),_.serverResponse=d.serverResponse,_}}function $(n,t,o){const d=be(t.fullServerUrl(),n.host,n._protocol),R=n.maxOperationRetryTime,q=new f(d,"GET",B(n,o),R);return q.errorHandler=k(t),q}function me(n,t,o,s,d){const _={};_.prefix=t.isRoot?"":t.path+"/",o&&o.length>0&&(_.delimiter=o),s&&(_.pageToken=s),d&&(_.maxResults=d);const q=be(t.bucketOnlyServerUrl(),n.host,n._protocol),ee=n.maxOperationRetryTime,se=new f(q,"GET",function z(n,t){return function o(s,d){const _=function l(n,t,o){const s=yt(o);return null===s?null:function Et(n,t,o){const s={prefixes:[],items:[],nextPageToken:o.nextPageToken};if(o[wt])for(const d of o[wt]){const _=d.replace(/\/$/,""),R=n._makeStorageReference(new fe(t,_));s.prefixes.push(R)}if(o[Bt])for(const d of o[Bt]){const _=n._makeStorageReference(new fe(t,d.name));s.items.push(_)}return s}(n,t,s)}(n,t,d);return Z(null!==_),_}}(n,t.bucket),ee);return se.urlParams=_,se.errorHandler=m(t),se}function y(n,t,o){const s=Object.assign({},o);return s.fullPath=n.path,s.size=t.size(),s.contentType||(s.contentType=function g(n,t){return n&&n.contentType||t&&t.type()||"application/octet-stream"}(null,t)),s}class r{constructor(t,o,s,d){this.current=t,this.total=o,this.finalized=!!s,this.metadata=d||null}}function b(n,t){let o=null;try{o=n.getResponseHeader("X-Goog-Upload-Status")}catch{Z(!1)}return Z(!!o&&-1!==(t||["active"]).indexOf(o)),o}const lt={STATE_CHANGED:"state_changed"},he={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function $t(n){switch(n){case"running":case"pausing":case"canceling":return he.RUNNING;case"paused":return he.PAUSED;case"success":return he.SUCCESS;case"canceled":return he.CANCELED;default:return he.ERROR}}class Kt{constructor(t,o,s){if(function V(n){return"function"==typeof n}(t)||null!=o||null!=s)this.next=t,this.error=o??void 0,this.complete=s??void 0;else{const _=t;this.next=_.next,this.error=_.error,this.complete=_.complete}}}function Ze(n){return(...t)=>{Promise.resolve().then(()=>n(...t))}}let It=null;class Yt{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Je.NO_ERROR,this.sendPromise_=new Promise(t=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=Je.ABORT,t()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=Je.NETWORK_ERROR,t()}),this.xhr_.addEventListener("load",()=>{t()})})}send(t,o,s,d){if(this.sent_)throw ye("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(o,t,!0),void 0!==d)for(const _ in d)d.hasOwnProperty(_)&&this.xhr_.setRequestHeader(_,d[_].toString());return void 0!==s?this.xhr_.send(s):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw ye("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw ye("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw ye("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw ye("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(t){return this.xhr_.getResponseHeader(t)}addUploadProgressListener(t){null!=this.xhr_.upload&&this.xhr_.upload.addEventListener("progress",t)}removeUploadProgressListener(t){null!=this.xhr_.upload&&this.xhr_.upload.removeEventListener("progress",t)}}class yn extends Yt{initXhr(){this.xhr_.responseType="text"}}function rt(){return It?It():new yn}class tn{constructor(t,o,s=null){this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=t,this._blob=o,this._metadata=s,this._mappings=Ve(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=d=>{if(this._request=void 0,this._chunkMultiplier=1,d._codeEquals(ne.CANCELED))this._needToFetchStatus=!0,this.completeTransitions_();else{const _=this.isExponentialBackoffExpired();if(it(d.status,[])){if(!_)return this.sleepTime=Math.max(2*this.sleepTime,1e3),this._needToFetchStatus=!0,void this.completeTransitions_();d=C()}this._error=d,this._transition("error")}},this._metadataErrorHandler=d=>{this._request=void 0,d._codeEquals(ne.CANCELED)?this.completeTransitions_():(this._error=d,this._transition("error"))},this.sleepTime=0,this.maxSleepTime=this._ref.storage.maxUploadRetryTime,this._promise=new Promise((d,_)=>{this._resolve=d,this._reject=_,this._start()}),this._promise.then(null,()=>{})}isExponentialBackoffExpired(){return this.sleepTime>this.maxSleepTime}_makeProgressCallback(){const t=this._transferred;return o=>this._updateProgress(t+o)}_shouldDoResumable(t){return t.size()>262144}_start(){"running"===this._state&&void 0===this._request&&(this._resumable?void 0===this._uploadUrl?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this.pendingTimeout=setTimeout(()=>{this.pendingTimeout=void 0,this._continueUpload()},this.sleepTime):this._oneShotUpload())}_resolveToken(t){Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then(([o,s])=>{switch(this._state){case"running":t(o,s);break;case"canceling":this._transition("canceled");break;case"pausing":this._transition("paused")}})}_createResumable(){this._resolveToken((t,o)=>{const s=function w(n,t,o,s,d){const _=t.bucketOnlyServerUrl(),R=y(t,s,d),q={name:R.fullPath},J=be(_,n.host,n._protocol),se={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${s.size()}`,"X-Goog-Upload-Header-Content-Type":R.contentType,"Content-Type":"application/json; charset=utf-8"},Ie=Ot(R,o),Ae=new f(J,"POST",function xe(We){let Pe;b(We);try{Pe=We.getResponseHeader("X-Goog-Upload-URL")}catch{Z(!1)}return Z(j(Pe)),Pe},n.maxUploadRetryTime);return Ae.urlParams=q,Ae.headers=se,Ae.body=Ie,Ae.errorHandler=m(t),Ae}(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),d=this._ref.storage._makeRequest(s,rt,t,o);this._request=d,d.getPromise().then(_=>{this._request=void 0,this._uploadUrl=_,this._needToFetchStatus=!1,this.completeTransitions_()},this._errorHandler)})}_fetchStatus(){const t=this._uploadUrl;this._resolveToken((o,s)=>{const d=function N(n,t,o,s){const J=new f(o,"POST",function _(ee){const se=b(ee,["active","final"]);let Ie=null;try{Ie=ee.getResponseHeader("X-Goog-Upload-Size-Received")}catch{Z(!1)}Ie||Z(!1);const Fe=Number(Ie);return Z(!isNaN(Fe)),new r(Fe,s.size(),"final"===se)},n.maxUploadRetryTime);return J.headers={"X-Goog-Upload-Command":"query"},J.errorHandler=m(t),J}(this._ref.storage,this._ref._location,t,this._blob),_=this._ref.storage._makeRequest(d,rt,o,s);this._request=_,_.getPromise().then(R=>{this._request=void 0,this._updateProgress(R.current),this._needToFetchStatus=!1,R.finalized&&(this._needToFetchMetadata=!0),this.completeTransitions_()},this._errorHandler)})}_continueUpload(){const t=262144*this._chunkMultiplier,o=new r(this._transferred,this._blob.size()),s=this._uploadUrl;this._resolveToken((d,_)=>{let R;try{R=function Ke(n,t,o,s,d,_,R,q){const J=new r(0,0);if(R?(J.current=R.current,J.total=R.total):(J.current=0,J.total=s.size()),s.size()!==J.total)throw function S(){return new te(ne.SERVER_FILE_WRONG_SIZE,"Server recorded incorrect upload file size, please retry the upload.")}();const ee=J.total-J.current;let se=ee;d>0&&(se=Math.min(se,d));const Ie=J.current;let xe="";xe=0===se?"finalize":ee===se?"upload, finalize":"upload";const Ae={"X-Goog-Upload-Command":xe,"X-Goog-Upload-Offset":`${J.current}`},We=s.slice(Ie,Ie+se);if(null===We)throw E();const Qe=new f(o,"POST",function Pe($e,Jt){const jt=b($e,["active","final"]),Xt=J.current+se,Qt=s.size();let en;return en="final"===jt?B(t,_)($e,Jt):null,new r(Xt,Qt,"final"===jt,en)},t.maxUploadRetryTime);return Qe.headers=Ae,Qe.body=We.uploadData(),Qe.progressCallback=q||null,Qe.errorHandler=m(n),Qe}(this._ref._location,this._ref.storage,s,this._blob,t,this._mappings,o,this._makeProgressCallback())}catch(J){return this._error=J,void this._transition("error")}const q=this._ref.storage._makeRequest(R,rt,d,_,!1);this._request=q,q.getPromise().then(J=>{this._increaseMultiplier(),this._request=void 0,this._updateProgress(J.current),J.finalized?(this._metadata=J.metadata,this._transition("success")):this.completeTransitions_()},this._errorHandler)})}_increaseMultiplier(){262144*this._chunkMultiplier*2<33554432&&(this._chunkMultiplier*=2)}_fetchMetadata(){this._resolveToken((t,o)=>{const s=$(this._ref.storage,this._ref._location,this._mappings),d=this._ref.storage._makeRequest(s,rt,t,o);this._request=d,d.getPromise().then(_=>{this._request=void 0,this._metadata=_,this._transition("success")},this._metadataErrorHandler)})}_oneShotUpload(){this._resolveToken((t,o)=>{const s=function u(n,t,o,s,d){const _=t.bucketOnlyServerUrl(),R={"X-Goog-Upload-Protocol":"multipart"},J=function q(){let Qe="";for(let $e=0;$e<2;$e++)Qe+=Math.random().toString().slice(2);return Qe}();R["Content-Type"]="multipart/related; boundary="+J;const ee=y(t,s,d),se=Ot(ee,o),xe=je.getBlob("--"+J+"\r\nContent-Type: application/json; charset=utf-8\r\n\r\n"+se+"\r\n--"+J+"\r\nContent-Type: "+ee.contentType+"\r\n\r\n",s,"\r\n--"+J+"--");if(null===xe)throw E();const Ae={name:ee.fullPath},We=be(_,n.host,n._protocol),kt=n.maxUploadRetryTime,Rt=new f(We,"POST",B(n,o),kt);return Rt.urlParams=Ae,Rt.headers=R,Rt.body=xe.uploadData(),Rt.errorHandler=m(t),Rt}(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),d=this._ref.storage._makeRequest(s,rt,t,o);this._request=d,d.getPromise().then(_=>{this._request=void 0,this._metadata=_,this._updateProgress(this._blob.size()),this._transition("success")},this._errorHandler)})}_updateProgress(t){const o=this._transferred;this._transferred=t,this._transferred!==o&&this._notifyObservers()}_transition(t){if(this._state!==t)switch(t){case"canceling":case"pausing":this._state=t,void 0!==this._request?this._request.cancel():this.pendingTimeout&&(clearTimeout(this.pendingTimeout),this.pendingTimeout=void 0,this.completeTransitions_());break;case"running":const o="paused"===this._state;this._state=t,o&&(this._notifyObservers(),this._start());break;case"paused":case"error":case"success":this._state=t,this._notifyObservers();break;case"canceled":this._error=T(),this._state=t,this._notifyObservers()}}completeTransitions_(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start()}}get snapshot(){const t=$t(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:t,metadata:this._metadata,task:this,ref:this._ref}}on(t,o,s,d){const _=new Kt(o||void 0,s||void 0,d||void 0);return this._addObserver(_),()=>{this._removeObserver(_)}}then(t,o){return this._promise.then(t,o)}catch(t){return this.then(null,t)}_addObserver(t){this._observers.push(t),this._notifyObserver(t)}_removeObserver(t){const o=this._observers.indexOf(t);-1!==o&&this._observers.splice(o,1)}_notifyObservers(){this._finishPromise(),this._observers.slice().forEach(o=>{this._notifyObserver(o)})}_finishPromise(){if(void 0!==this._resolve){let t=!0;switch($t(this._state)){case he.SUCCESS:Ze(this._resolve.bind(null,this.snapshot))();break;case he.CANCELED:case he.ERROR:Ze(this._reject.bind(null,this._error))();break;default:t=!1}t&&(this._resolve=void 0,this._reject=void 0)}}_notifyObserver(t){switch($t(this._state)){case he.RUNNING:case he.PAUSED:t.next&&Ze(t.next.bind(t,this.snapshot))();break;case he.SUCCESS:t.complete&&Ze(t.complete.bind(t))();break;default:t.error&&Ze(t.error.bind(t,this._error))()}}resume(){const t="paused"===this._state||"pausing"===this._state;return t&&this._transition("running"),t}pause(){const t="running"===this._state;return t&&this._transition("pausing"),t}cancel(){const t="running"===this._state||"pausing"===this._state;return t&&this._transition("canceling"),t}}class qt{constructor(t,o){this._service=t,this._location=o instanceof fe?o:fe.makeFromUrl(o,t.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(t,o){return new qt(t,o)}get root(){const t=new fe(this._location.bucket,"");return this._newRef(this._service,t)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return ot(this._location.path)}get storage(){return this._service}get parent(){const t=function bt(n){if(0===n.length)return null;const t=n.lastIndexOf("/");return-1===t?"":n.slice(0,t)}(this._location.path);if(null===t)return null;const o=new fe(this._location.bucket,t);return new qt(this._service,o)}_throwIfRoot(t){if(""===this._location.path)throw oe(t)}}function on(n,t,o){return Vt.apply(this,arguments)}function Vt(){return(Vt=(0,we.Z)(function*(n,t,o){const d=yield rn(n,{pageToken:o});t.prefixes.push(...d.prefixes),t.items.push(...d.items),null!=d.nextPageToken&&(yield on(n,t,d.nextPageToken))})).apply(this,arguments)}function rn(n,t){null!=t&&"number"==typeof t.maxResults&&Xe("options.maxResults",1,1e3,t.maxResults);const o=t||{},s=me(n.storage,n._location,"/",o.pageToken,o.maxResults);return n.storage.makeRequestWithTokens(s,rt)}function Zn(n){n._throwIfRoot("getDownloadURL");const t=function Y(n,t,o){const d=be(t.fullServerUrl(),n.host,n._protocol),R=n.maxOperationRetryTime,q=new f(d,"GET",function a(n,t){return function o(s,d){const _=Gt(n,d,t);return Z(null!==_),function Dt(n,t,o,s){const d=yt(t);if(null===d||!j(d.downloadTokens))return null;const _=d.downloadTokens;if(0===_.length)return null;const R=encodeURIComponent;return _.split(",").map(ee=>{const Ie=n.fullPath;return be("/b/"+R(n.bucket)+"/o/"+R(Ie),o,s)+ze({alt:"media",token:ee})})[0]}(_,d,n.host,n._protocol)}}(n,o),R);return q.errorHandler=k(t),q}(n.storage,n._location,Ve());return n.storage.makeRequestWithTokens(t,rt).then(o=>{if(null===o)throw function Q(){return new te(ne.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}();return o})}function sn(n,t){const o=function Pt(n,t){const o=t.split("/").filter(s=>s.length>0).join("/");return 0===n.length?o:n+"/"+o}(n._location.path,t),s=new fe(n._location.bucket,o);return new qt(n.storage,s)}function an(n,t){if(n instanceof zt){const o=n;if(null==o._bucket)throw function U(){return new te(ne.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+le+"' property when initializing the app?")}();const s=new qt(o,o._bucket);return null!=t?an(s,t):s}return void 0!==t?sn(n,t):n}function On(n,t){if(t&&function Pn(n){return/^[A-Za-z]+:\/\//.test(n)}(t)){if(n instanceof zt)return function Dn(n,t){return new qt(n,t)}(n,t);throw x("To use ref(service, url), the first argument must be a Storage instance.")}return an(n,t)}function un(n,t){const o=t?.[le];return null==o?null:fe.makeFromBucketSpec(o,n)}class zt{constructor(t,o,s,d,_){this.app=t,this._authProvider=o,this._appCheckProvider=s,this._url=d,this._firebaseVersion=_,this._bucket=null,this._host=ce,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=12e4,this._maxUploadRetryTime=6e5,this._requests=new Set,this._bucket=null!=d?fe.makeFromBucketSpec(d,this._host):un(this._host,this.app.options)}get host(){return this._host}set host(t){this._host=t,this._bucket=null!=this._url?fe.makeFromBucketSpec(this._url,t):un(t,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(t){Xe("time",0,Number.POSITIVE_INFINITY,t),this._maxUploadRetryTime=t}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(t){Xe("time",0,Number.POSITIVE_INFINITY,t),this._maxOperationRetryTime=t}_getAuthToken(){var t=this;return(0,we.Z)(function*(){if(t._overrideAuthToken)return t._overrideAuthToken;const o=t._authProvider.getImmediate({optional:!0});if(o){const s=yield o.getToken();if(null!==s)return s.accessToken}return null})()}_getAppCheckToken(){var t=this;return(0,we.Z)(function*(){const o=t._appCheckProvider.getImmediate({optional:!0});return o?(yield o.getToken()).token:null})()}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(t=>t.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(t){return new qt(this,t)}_makeRequest(t,o,s,d,_=!0){if(this._deleted)return new qe(K());{const R=function Zt(n,t,o,s,d,_,R=!0){const q=ze(n.urlParams),J=n.url+q,ee=Object.assign({},n.headers);return function Mt(n,t){t&&(n["X-Firebase-GMPID"]=t)}(ee,t),function St(n,t){null!==t&&t.length>0&&(n.Authorization="Firebase "+t)}(ee,o),function ht(n,t){n["X-Firebase-Storage-Version"]="webjs/"+(t??"AppManager")}(ee,_),function pt(n,t){null!==t&&(n["X-Firebase-AppCheck"]=t)}(ee,s),new dt(J,n.method,ee,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,d,R)}(t,this._appId,s,d,o,this._firebaseVersion,_);return this._requests.add(R),R.getPromise().then(()=>this._requests.delete(R),()=>this._requests.delete(R)),R}}makeRequestWithTokens(t,o){var s=this;return(0,we.Z)(function*(){const[d,_]=yield Promise.all([s._getAuthToken(),s._getAppCheckToken()]);return s._makeRequest(t,o,d,_).getPromise()})()}}const cn="@firebase/storage";function hn(n,t){return On(n=(0,_e.m9)(n),t)}function Qn(n,{instanceIdentifier:t}){const o=n.getProvider("app").getImmediate(),s=n.getProvider("auth-internal"),d=n.getProvider("app-check-internal");return new zt(o,s,d,t,ke.SDK_VERSION)}!function Hn(){(0,ke._registerComponent)(new Le.wA("storage",Qn,"PUBLIC").setMultipleInstances(!0)),(0,ke.registerVersion)(cn,"0.11.2",""),(0,ke.registerVersion)(cn,"0.11.2","esm2017")}();class Ht{constructor(t,o,s){this._delegate=t,this.task=o,this.ref=s}get bytesTransferred(){return this._delegate.bytesTransferred}get metadata(){return this._delegate.metadata}get state(){return this._delegate.state}get totalBytes(){return this._delegate.totalBytes}}class fn{constructor(t,o){this._delegate=t,this._ref=o,this.cancel=this._delegate.cancel.bind(this._delegate),this.catch=this._delegate.catch.bind(this._delegate),this.pause=this._delegate.pause.bind(this._delegate),this.resume=this._delegate.resume.bind(this._delegate)}get snapshot(){return new Ht(this._delegate.snapshot,this,this._ref)}then(t,o){return this._delegate.then(s=>{if(t)return t(new Ht(s,this,this._ref))},o)}on(t,o,s,d){let _;return o&&(_="function"==typeof o?R=>o(new Ht(R,this,this._ref)):{next:o.next?R=>o.next(new Ht(R,this,this._ref)):void 0,complete:o.complete||void 0,error:o.error||void 0}),this._delegate.on(t,_,s||void 0,d||void 0)}}class gn{constructor(t,o){this._delegate=t,this._service=o}get prefixes(){return this._delegate.prefixes.map(t=>new xt(t,this._service))}get items(){return this._delegate.items.map(t=>new xt(t,this._service))}get nextPageToken(){return this._delegate.nextPageToken||null}}class xt{constructor(t,o){this._delegate=t,this.storage=o}get name(){return this._delegate.name}get bucket(){return this._delegate.bucket}get fullPath(){return this._delegate.fullPath}toString(){return this._delegate.toString()}child(t){const o=function jn(n,t){return sn(n,t)}(this._delegate,t);return new xt(o,this.storage)}get root(){return new xt(this._delegate.root,this.storage)}get parent(){const t=this._delegate.parent;return null==t?null:new xt(t,this.storage)}put(t,o){return this._throwIfRoot("put"),new fn(function Mn(n,t,o){return function xn(n,t,o){return n._throwIfRoot("uploadBytesResumable"),new tn(n,new je(t),o)}(n=(0,_e.m9)(n),t,o)}(this._delegate,t,o),this)}putString(t,o=Se.RAW,s){this._throwIfRoot("putString");const d=et(o,t),_=Object.assign({},s);return null==_.contentType&&null!=d.contentType&&(_.contentType=d.contentType),new fn(new tn(this._delegate,new je(d.data,!0),_),this)}listAll(){return function $n(n){return function Rn(n){const t={prefixes:[],items:[]};return on(n,t).then(()=>t)}(n=(0,_e.m9)(n))}(this._delegate).then(t=>new gn(t,this.storage))}list(t){return function Gn(n,t){return rn(n=(0,_e.m9)(n),t)}(this._delegate,t||void 0).then(o=>new gn(o,this.storage))}getMetadata(){return function Nn(n){return function Un(n){n._throwIfRoot("getMetadata");const t=$(n.storage,n._location,Ve());return n.storage.makeRequestWithTokens(t,rt)}(n=(0,_e.m9)(n))}(this._delegate)}updateMetadata(t){return function Ln(n,t){return function Sn(n,t){n._throwIfRoot("updateMetadata");const o=function Ge(n,t,o,s){const _=be(t.fullServerUrl(),n.host,n._protocol),q=Ot(o,s),ee=n.maxOperationRetryTime,se=new f(_,"PATCH",B(n,s),ee);return se.headers={"Content-Type":"application/json; charset=utf-8"},se.body=q,se.errorHandler=k(t),se}(n.storage,n._location,t,Ve());return n.storage.makeRequestWithTokens(o,rt)}(n=(0,_e.m9)(n),t)}(this._delegate,t)}getDownloadURL(){return function qn(n){return Zn(n=(0,_e.m9)(n))}(this._delegate)}delete(){return this._throwIfRoot("delete"),function Jn(n){return function Fn(n){n._throwIfRoot("deleteObject");const t=function h(n,t){const s=be(t.fullServerUrl(),n.host,n._protocol),q=new f(s,"DELETE",function R(J,ee){},n.maxOperationRetryTime);return q.successCodes=[200,204],q.errorHandler=k(t),q}(n.storage,n._location);return n.storage.makeRequestWithTokens(t,rt)}(n=(0,_e.m9)(n))}(this._delegate)}_throwIfRoot(t){if(""===this._delegate._location.path)throw oe(t)}}class mn{constructor(t,o){this.app=t,this._delegate=o}get maxOperationRetryTime(){return this._delegate.maxOperationRetryTime}get maxUploadRetryTime(){return this._delegate.maxUploadRetryTime}ref(t){if(_n(t))throw x("ref() expected a child path but got a URL, use refFromURL instead.");return new xt(hn(this._delegate,t),this)}refFromURL(t){if(!_n(t))throw x("refFromURL() expected a full URL but got a child path, use ref() instead.");try{fe.makeFromUrl(t,this._delegate.host)}catch{throw x("refFromUrl() expected a valid full URL but got an invalid one.")}return new xt(hn(this._delegate,t),this)}setMaxUploadRetryTime(t){this._delegate.maxUploadRetryTime=t}setMaxOperationRetryTime(t){this._delegate.maxOperationRetryTime=t}useEmulator(t,o,s={}){!function pn(n,t,o,s={}){!function Bn(n,t,o,s={}){n.host=`${t}:${o}`,n._protocol="http";const{mockUserToken:d}=s;d&&(n._overrideAuthToken="string"==typeof d?d:(0,_e.Sg)(d,n.app.options.projectId))}(n,t,o,s)}(this._delegate,t,o,s)}}function _n(n){return/^[A-Za-z]+:\/\//.test(n)}function Vn(n,{instanceIdentifier:t}){const o=n.getProvider("app-compat").getImmediate(),s=n.getProvider("storage").getImmediate({identifier:t});return new mn(o,s)}!function zn(n){const t={TaskState:he,TaskEvent:lt,StringFormat:Se,Storage:mn,Reference:xt};n.INTERNAL.registerComponent(new Le.wA("storage-compat",Vn,"PUBLIC").setServiceProps(t).setMultipleInstances(!0)),n.registerVersion("@firebase/storage-compat","0.3.2")}(Ne.Z);var Xn=p(7142);function vn(n){const t=function eo(n){return new i.y(t=>{const o=R=>t.next(R);o(n.snapshot);const _=n.on("state_changed",o);return n.then(R=>{o(R),t.complete()},R=>{o(n.snapshot),(R=>{t.error(R)})(R)}),function(){_()}}).pipe((0,ge.b)(0))}(n);return{task:n,then:n.then.bind(n),catch:n.catch.bind(n),pause:n.pause.bind(n),cancel:n.cancel.bind(n),resume:n.resume.bind(n),snapshotChanges:()=>t,percentageChanges:()=>t.pipe((0,Ce.U)(o=>o.bytesTransferred/o.totalBytes*100))}}function Wt(n){return{getDownloadURL:()=>(0,X.of)(void 0).pipe(H.fc,(0,pe.w)(()=>n.getDownloadURL()),H.iC),getMetadata:()=>(0,X.of)(void 0).pipe(H.fc,(0,pe.w)(()=>n.getMetadata()),H.iC),delete:()=>(0,re.D)(n.delete()),child:t=>Wt(n.child(t)),updateMetadata:t=>(0,re.D)(n.updateMetadata(t)),put:(t,o)=>vn(n.put(t,o)),putString:(t,o,s)=>vn(n.putString(t,o,s)),list:t=>(0,re.D)(n.list(t)),listAll:()=>(0,re.D)(n.listAll())}}const to=new L.OlP("angularfire2.storageBucket"),no=new L.OlP("angularfire2.storage.maxUploadRetryTime"),oo=new L.OlP("angularfire2.storage.maxOperationRetryTime"),ro=new L.OlP("angularfire2.storage.use-emulator");let Cn=(()=>{var n;class t{constructor(s,d,_,R,q,J,ee,se,Ie,Fe){(0,c.Z)(this,"storage",void 0);const xe=(0,e.on)(s,q,d);this.storage=(0,e.cc)(`${xe.name}.storage.${_}`,"AngularFireStorage",xe.name,()=>{const Ae=q.runOutsideAngular(()=>xe.storage(_||void 0)),We=Ie;return We&&Ae.useEmulator(...We),ee&&Ae.setMaxUploadRetryTime(ee),se&&Ae.setMaxOperationRetryTime(se),Ae},[ee,se])}ref(s){return Wt(this.storage.ref(s))}refFromURL(s){return Wt(this.storage.refFromURL(s))}upload(s,d,_){return Wt(this.storage.ref(s)).put(d,_)}}return n=t,(0,c.Z)(t,"\u0275fac",function(s){return new(s||n)(L.LFG(e.Dh),L.LFG(e.xv,8),L.LFG(to,8),L.LFG(L.Lbi),L.LFG(L.R0b),L.LFG(H.HU),L.LFG(no,8),L.LFG(oo,8),L.LFG(ro,8),L.LFG(H.Rf,8))}),(0,c.Z)(t,"\u0275prov",L.Yz7({token:n,factory:n.\u0275fac,providedIn:"any"})),t})(),io=(()=>{var n;class t{}return n=t,(0,c.Z)(t,"\u0275fac",function(s){return new(s||n)}),(0,c.Z)(t,"\u0275mod",L.oAB({type:n})),(0,c.Z)(t,"\u0275inj",L.cJS({})),t})(),so=(()=>{var n;class t{constructor(){Xn.Z.registerVersion("angularfire",H.q4.full,"gcs-compat")}}return n=t,(0,c.Z)(t,"\u0275fac",function(s){return new(s||n)}),(0,c.Z)(t,"\u0275mod",L.oAB({type:n})),(0,c.Z)(t,"\u0275inj",L.cJS({providers:[Cn],imports:[io]})),t})()},8812:(Ut,De,p)=>{var c=p(5861),H=p(6122),i=p(4537),X=p(9058),re=p(1878);const ge="@firebase/installations",Ce="0.6.4",pe=1e4,L=`w:${Ce}`,e="FIS_v2",Ne="https://firebaseinstallations.googleapis.com/v1",we=36e5,ce=new X.LL("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function le(a){return a instanceof X.ZR&&a.code.includes("request-failed")}function de({projectId:a}){return`${Ne}/projects/${a}/installations`}function ue(a){return{token:a.token,requestStatus:2,expiresIn:F(a.expiresIn),creationTime:Date.now()}}function Ue(a,m){return te.apply(this,arguments)}function te(){return(te=(0,c.Z)(function*(a,m){const $=(yield m.json()).error;return ce.create("request-failed",{requestName:a,serverCode:$.code,serverMessage:$.message,serverStatus:$.status})})).apply(this,arguments)}function ne({apiKey:a}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":a})}function Re(a){return ve.apply(this,arguments)}function ve(){return(ve=(0,c.Z)(function*(a){const m=yield a();return m.status>=500&&m.status<600?a():m})).apply(this,arguments)}function F(a){return Number(a.replace("s","000"))}function v(){return(v=(0,c.Z)(function*({appConfig:a,heartbeatServiceProvider:m},{fid:k}){const $=de(a),me=ne(a),ae=m.getImmediate({optional:!0});if(ae){const g=yield ae.getHeartbeatsHeader();g&&me.append("x-firebase-client",g)}const Ge={method:"POST",headers:me,body:JSON.stringify({fid:k,authVersion:e,appId:a.appId,sdkVersion:L})},h=yield Re(()=>fetch($,Ge));if(h.ok){const g=yield h.json();return{fid:g.fid||k,registrationStatus:2,refreshToken:g.refreshToken,authToken:ue(g.authToken)}}throw yield Ue("Create Installation",h)})).apply(this,arguments)}function C(a){return new Promise(m=>{setTimeout(m,a)})}const I=/^[cdef][\w-]{21}$/,D="";function U(){try{const a=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(a),a[0]=112+a[0]%16;const k=function E(a){return function T(a){return btoa(String.fromCharCode(...a)).replace(/\+/g,"-").replace(/\//g,"_")}(a).substr(0,22)}(a);return I.test(k)?k:D}catch{return D}}function S(a){return`${a.appName}!${a.appId}`}const Q=new Map;function A(a,m){const k=S(a);oe(k,m),function Ee(a,m){const k=function fe(){return!ye&&"BroadcastChannel"in self&&(ye=new BroadcastChannel("[Firebase] FID Change"),ye.onmessage=a=>{oe(a.data.key,a.data.fid)}),ye}();k&&k.postMessage({key:a,fid:m}),function qe(){0===Q.size&&ye&&(ye.close(),ye=null)}()}(k,m)}function oe(a,m){const k=Q.get(a);if(k)for(const $ of k)$(m)}let ye=null;const G="firebase-installations-database",ie=1,M="firebase-installations-store";let V=null;function O(){return V||(V=(0,re.X3)(G,ie,{upgrade:(a,m)=>{0===m&&a.createObjectStore(M)}})),V}function j(a,m){return Be.apply(this,arguments)}function Be(){return(Be=(0,c.Z)(function*(a,m){const k=S(a),me=(yield O()).transaction(M,"readwrite"),ae=me.objectStore(M),Y=yield ae.get(k);return yield ae.put(m,k),yield me.done,(!Y||Y.fid!==m.fid)&&A(a,m.fid),m})).apply(this,arguments)}function He(a){return Xe.apply(this,arguments)}function Xe(){return(Xe=(0,c.Z)(function*(a){const m=S(a),$=(yield O()).transaction(M,"readwrite");yield $.objectStore(M).delete(m),yield $.done})).apply(this,arguments)}function be(a,m){return ze.apply(this,arguments)}function ze(){return(ze=(0,c.Z)(function*(a,m){const k=S(a),me=(yield O()).transaction(M,"readwrite"),ae=me.objectStore(M),Y=yield ae.get(k),Ge=m(Y);return void 0===Ge?yield ae.delete(k):yield ae.put(Ge,k),yield me.done,Ge&&(!Y||Y.fid!==Ge.fid)&&A(a,Ge.fid),Ge})).apply(this,arguments)}function Je(a){return it.apply(this,arguments)}function it(){return it=(0,c.Z)(function*(a){let m;const k=yield be(a.appConfig,$=>{const me=function dt(a){return ft(a||{fid:U(),registrationStatus:0})}($),ae=function st(a,m){if(0===m.registrationStatus){if(!navigator.onLine)return{installationEntry:m,registrationPromise:Promise.reject(ce.create("app-offline"))};const k={fid:m.fid,registrationStatus:1,registrationTime:Date.now()},$=function St(a,m){return ht.apply(this,arguments)}(a,k);return{installationEntry:k,registrationPromise:$}}return 1===m.registrationStatus?{installationEntry:m,registrationPromise:Mt(a)}:{installationEntry:m}}(a,me);return m=ae.registrationPromise,ae.installationEntry});return k.fid===D?{installationEntry:yield m}:{installationEntry:k,registrationPromise:m}}),it.apply(this,arguments)}function ht(){return ht=(0,c.Z)(function*(a,m){try{const k=yield function W(a,m){return v.apply(this,arguments)}(a,m);return j(a.appConfig,k)}catch(k){throw le(k)&&409===k.customData.serverCode?yield He(a.appConfig):yield j(a.appConfig,{fid:m.fid,registrationStatus:0}),k}}),ht.apply(this,arguments)}function Mt(a){return pt.apply(this,arguments)}function pt(){return(pt=(0,c.Z)(function*(a){let m=yield Zt(a.appConfig);for(;1===m.registrationStatus;)yield C(100),m=yield Zt(a.appConfig);if(0===m.registrationStatus){const{installationEntry:k,registrationPromise:$}=yield Je(a);return $||k}return m})).apply(this,arguments)}function Zt(a){return be(a,m=>{if(!m)throw ce.create("installation-not-found");return ft(m)})}function ft(a){return function Nt(a){return 1===a.registrationStatus&&a.registrationTime+pe<Date.now()}(a)?{fid:a.fid,registrationStatus:0}:a}function mt(){return(mt=(0,c.Z)(function*({appConfig:a,heartbeatServiceProvider:m},k){const $=function Se(a,{fid:m}){return`${de(a)}/${m}/authTokens:generate`}(a,k),me=function Oe(a,{refreshToken:m}){const k=ne(a);return k.append("Authorization",function P(a){return`${e} ${a}`}(m)),k}(a,k),ae=m.getImmediate({optional:!0});if(ae){const g=yield ae.getHeartbeatsHeader();g&&me.append("x-firebase-client",g)}const Ge={method:"POST",headers:me,body:JSON.stringify({installation:{sdkVersion:L,appId:a.appId}})},h=yield Re(()=>fetch($,Ge));if(h.ok)return ue(yield h.json());throw yield Ue("Generate Auth Token",h)})).apply(this,arguments)}function Ye(a){return et.apply(this,arguments)}function et(){return et=(0,c.Z)(function*(a,m=!1){let k;const $=yield be(a.appConfig,ae=>{if(!Ft(ae))throw ce.create("not-registered");const Y=ae.authToken;if(!m&&function Ct(a){return 2===a.requestStatus&&!function je(a){const m=Date.now();return m<a.creationTime||a.creationTime+a.expiresIn<m+we}(a)}(Y))return ae;if(1===Y.requestStatus)return k=function at(a,m){return _t.apply(this,arguments)}(a,m),ae;{if(!navigator.onLine)throw ce.create("app-offline");const Ge=function yt(a){const m={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},a),{authToken:m})}(ae);return k=function vt(a,m){return nt.apply(this,arguments)}(a,Ge),Ge}});return k?yield k:$.authToken}),et.apply(this,arguments)}function _t(){return(_t=(0,c.Z)(function*(a,m){let k=yield tt(a.appConfig);for(;1===k.authToken.requestStatus;)yield C(100),k=yield tt(a.appConfig);const $=k.authToken;return 0===$.requestStatus?Ye(a,m):$})).apply(this,arguments)}function tt(a){return be(a,m=>{if(!Ft(m))throw ce.create("not-registered");return function bt(a){return 1===a.requestStatus&&a.requestTime+pe<Date.now()}(m.authToken)?Object.assign(Object.assign({},m),{authToken:{requestStatus:0}}):m})}function nt(){return nt=(0,c.Z)(function*(a,m){try{const k=yield function gt(a,m){return mt.apply(this,arguments)}(a,m),$=Object.assign(Object.assign({},m),{authToken:k});return yield j(a.appConfig,$),k}catch(k){if(!le(k)||401!==k.customData.serverCode&&404!==k.customData.serverCode){const $=Object.assign(Object.assign({},m),{authToken:{requestStatus:0}});yield j(a.appConfig,$)}else yield He(a.appConfig);throw k}}),nt.apply(this,arguments)}function Ft(a){return void 0!==a&&2===a.registrationStatus}function ot(){return(ot=(0,c.Z)(function*(a){const m=a,{installationEntry:k,registrationPromise:$}=yield Je(m);return $?$.catch(console.error):Ye(m).catch(console.error),k.fid})).apply(this,arguments)}function Te(){return Te=(0,c.Z)(function*(a,m=!1){const k=a;return yield function ut(a){return ct.apply(this,arguments)}(k),(yield Ye(k,m)).token}),Te.apply(this,arguments)}function ct(){return(ct=(0,c.Z)(function*(a){const{registrationPromise:m}=yield Je(a);m&&(yield m)})).apply(this,arguments)}function Et(a){return ce.create("missing-app-config-values",{valueName:a})}const l="installations",Z=a=>{const m=a.getProvider("app").getImmediate(),k=function Bt(a){if(!a||!a.options)throw Et("App Configuration");if(!a.name)throw Et("App Name");const m=["projectId","apiKey","appId"];for(const k of m)if(!a.options[k])throw Et(k);return{appName:a.name,projectId:a.options.projectId,apiKey:a.options.apiKey,appId:a.options.appId}}(m);return{app:m,appConfig:k,heartbeatServiceProvider:(0,H._getProvider)(m,"heartbeat"),_delete:()=>Promise.resolve()}},B=a=>{const m=a.getProvider("app").getImmediate(),k=(0,H._getProvider)(m,l).getImmediate();return{getId:()=>function Pt(a){return ot.apply(this,arguments)}(k),getToken:me=>function Lt(a){return Te.apply(this,arguments)}(k,me)}};(function z(){(0,H._registerComponent)(new i.wA(l,Z,"PUBLIC")),(0,H._registerComponent)(new i.wA("installations-internal",B,"PRIVATE"))})(),(0,H.registerVersion)(ge,Ce),(0,H.registerVersion)(ge,Ce,"esm2017")},2650:(Ut,De,p)=>{p.d(De,{Gb:()=>ct,LP:()=>Ot,pQ:()=>Bt,ps:()=>Et});var c=p(5861),i=(p(8812),p(4537)),X=p(1878),re=p(9058),ge=p(6122);const Ce="/firebase-messaging-sw.js",pe="/firebase-cloud-messaging-push-scope",L="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",e="https://fcmregistrations.googleapis.com/v1",Ne="google.c.a.c_id",we="google.c.a.c_l",ke="google.c.a.ts";var ce=function(l){return l.PUSH_RECEIVED="push-received",l.NOTIFICATION_CLICKED="notification-clicked",l}(ce||{});function le(l){const f=new Uint8Array(l);return btoa(String.fromCharCode(...f)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function de(l){const Z=(l+"=".repeat((4-l.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),B=atob(Z),z=new Uint8Array(B.length);for(let a=0;a<B.length;++a)z[a]=B.charCodeAt(a);return z}const ue="fcm_token_details_db",Ue=5,te="fcm_token_object_Store";function Oe(){return Oe=(0,c.Z)(function*(l){if("databases"in indexedDB&&!(yield indexedDB.databases()).map(a=>a.name).includes(ue))return null;let f=null;return(yield(0,X.X3)(ue,Ue,{upgrade:(B=(0,c.Z)(function*(z,a,m,k){var $;if(a<2||!z.objectStoreNames.contains(te))return;const me=k.objectStore(te),ae=yield me.index("fcmSenderId").get(l);if(yield me.clear(),ae)if(2===a){const Y=ae;if(!Y.auth||!Y.p256dh||!Y.endpoint)return;f={token:Y.fcmToken,createTime:null!==($=Y.createTime)&&void 0!==$?$:Date.now(),subscriptionOptions:{auth:Y.auth,p256dh:Y.p256dh,endpoint:Y.endpoint,swScope:Y.swScope,vapidKey:"string"==typeof Y.vapidKey?Y.vapidKey:le(Y.vapidKey)}}}else if(3===a){const Y=ae;f={token:Y.fcmToken,createTime:Y.createTime,subscriptionOptions:{auth:le(Y.auth),p256dh:le(Y.p256dh),endpoint:Y.endpoint,swScope:Y.swScope,vapidKey:le(Y.vapidKey)}}}else if(4===a){const Y=ae;f={token:Y.fcmToken,createTime:Y.createTime,subscriptionOptions:{auth:le(Y.auth),p256dh:le(Y.p256dh),endpoint:Y.endpoint,swScope:Y.swScope,vapidKey:le(Y.vapidKey)}}}}),function(a,m,k,$){return B.apply(this,arguments)})})).close(),yield(0,X.Lj)(ue),yield(0,X.Lj)("fcm_vapid_details_db"),yield(0,X.Lj)("undefined"),function Re(l){if(!l||!l.subscriptionOptions)return!1;const{subscriptionOptions:f}=l;return"number"==typeof l.createTime&&l.createTime>0&&"string"==typeof l.token&&l.token.length>0&&"string"==typeof f.auth&&f.auth.length>0&&"string"==typeof f.p256dh&&f.p256dh.length>0&&"string"==typeof f.endpoint&&f.endpoint.length>0&&"string"==typeof f.swScope&&f.swScope.length>0&&"string"==typeof f.vapidKey&&f.vapidKey.length>0}(f)?f:null;var B}),Oe.apply(this,arguments)}const ve="firebase-messaging-database",F=1,P="firebase-messaging-store";let W=null;function v(){return W||(W=(0,X.X3)(ve,F,{upgrade:(l,f)=>{0===f&&l.createObjectStore(P)}})),W}function C(l){return T.apply(this,arguments)}function T(){return T=(0,c.Z)(function*(l){const f=S(l),B=yield(yield v()).transaction(P).objectStore(P).get(f);if(B)return B;{const z=yield function ne(l){return Oe.apply(this,arguments)}(l.appConfig.senderId);if(z)return yield I(l,z),z}}),T.apply(this,arguments)}function I(l,f){return D.apply(this,arguments)}function D(){return(D=(0,c.Z)(function*(l,f){const Z=S(l),z=(yield v()).transaction(P,"readwrite");return yield z.objectStore(P).put(f,Z),yield z.done,f})).apply(this,arguments)}function E(){return(E=(0,c.Z)(function*(l){const f=S(l),B=(yield v()).transaction(P,"readwrite");yield B.objectStore(P).delete(f),yield B.done})).apply(this,arguments)}function S({appConfig:l}){return l.appId}const A=new re.LL("messaging","Messaging",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."});function x(l,f){return K.apply(this,arguments)}function K(){return(K=(0,c.Z)(function*(l,f){const Z=yield G(l),B=M(f),z={method:"POST",headers:Z,body:JSON.stringify(B)};let a;try{a=yield(yield fetch(qe(l.appConfig),z)).json()}catch(m){throw A.create("token-subscribe-failed",{errorInfo:m?.toString()})}if(a.error)throw A.create("token-subscribe-failed",{errorInfo:a.error.message});if(!a.token)throw A.create("token-subscribe-no-token");return a.token})).apply(this,arguments)}function Ee(){return(Ee=(0,c.Z)(function*(l,f){const Z=yield G(l),B=M(f.subscriptionOptions),z={method:"PATCH",headers:Z,body:JSON.stringify(B)};let a;try{a=yield(yield fetch(`${qe(l.appConfig)}/${f.token}`,z)).json()}catch(m){throw A.create("token-update-failed",{errorInfo:m?.toString()})}if(a.error)throw A.create("token-update-failed",{errorInfo:a.error.message});if(!a.token)throw A.create("token-update-no-token");return a.token})).apply(this,arguments)}function ye(l,f){return fe.apply(this,arguments)}function fe(){return(fe=(0,c.Z)(function*(l,f){const B={method:"DELETE",headers:yield G(l)};try{const a=yield(yield fetch(`${qe(l.appConfig)}/${f}`,B)).json();if(a.error)throw A.create("token-unsubscribe-failed",{errorInfo:a.error.message})}catch(z){throw A.create("token-unsubscribe-failed",{errorInfo:z?.toString()})}})).apply(this,arguments)}function qe({projectId:l}){return`${e}/projects/${l}/registrations`}function G(l){return ie.apply(this,arguments)}function ie(){return(ie=(0,c.Z)(function*({appConfig:l,installations:f}){const Z=yield f.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":l.apiKey,"x-goog-firebase-installations-auth":`FIS ${Z}`})})).apply(this,arguments)}function M({p256dh:l,auth:f,endpoint:Z,vapidKey:B}){const z={web:{endpoint:Z,auth:f,p256dh:l}};return B!==L&&(z.web.applicationPubKey=B),z}const V=6048e5;function j(){return j=(0,c.Z)(function*(l){const f=yield function it(l,f){return dt.apply(this,arguments)}(l.swRegistration,l.vapidKey),Z={vapidKey:l.vapidKey,swScope:l.swRegistration.scope,endpoint:f.endpoint,auth:le(f.getKey("auth")),p256dh:le(f.getKey("p256dh"))},B=yield C(l.firebaseDependencies);if(B){if(function st(l,f){return f.vapidKey===l.vapidKey&&f.endpoint===l.endpoint&&f.auth===l.auth&&f.p256dh===l.p256dh}(B.subscriptionOptions,Z))return Date.now()>=B.createTime+V?function Xe(l,f){return be.apply(this,arguments)}(l,{token:B.token,createTime:Date.now(),subscriptionOptions:Z}):B.token;try{yield ye(l.firebaseDependencies,B.token)}catch(z){console.warn(z)}return ze(l.firebaseDependencies,Z)}return ze(l.firebaseDependencies,Z)}),j.apply(this,arguments)}function Be(l){return He.apply(this,arguments)}function He(){return He=(0,c.Z)(function*(l){const f=yield C(l.firebaseDependencies);f&&(yield ye(l.firebaseDependencies,f.token),yield function U(l){return E.apply(this,arguments)}(l.firebaseDependencies));const Z=yield l.swRegistration.pushManager.getSubscription();return!Z||Z.unsubscribe()}),He.apply(this,arguments)}function be(){return be=(0,c.Z)(function*(l,f){try{const Z=yield function oe(l,f){return Ee.apply(this,arguments)}(l.firebaseDependencies,f),B=Object.assign(Object.assign({},f),{token:Z,createTime:Date.now()});return yield I(l.firebaseDependencies,B),Z}catch(Z){throw yield Be(l),Z}}),be.apply(this,arguments)}function ze(l,f){return Je.apply(this,arguments)}function Je(){return(Je=(0,c.Z)(function*(l,f){const B={token:yield x(l,f),createTime:Date.now(),subscriptionOptions:f};return yield I(l,B),B.token})).apply(this,arguments)}function dt(){return(dt=(0,c.Z)(function*(l,f){return(yield l.pushManager.getSubscription())||l.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:de(f)})})).apply(this,arguments)}function St(l){const f={from:l.from,collapseKey:l.collapse_key,messageId:l.fcmMessageId};return function ht(l,f){if(!f.notification)return;l.notification={};const Z=f.notification.title;Z&&(l.notification.title=Z);const B=f.notification.body;B&&(l.notification.body=B);const z=f.notification.image;z&&(l.notification.image=z);const a=f.notification.icon;a&&(l.notification.icon=a)}(f,l),function Mt(l,f){f.data&&(l.data=f.data)}(f,l),function pt(l,f){var Z,B,z,a,m;if(!(f.fcmOptions||null!==(Z=f.notification)&&void 0!==Z&&Z.click_action))return;l.fcmOptions={};const k=null!==(z=null===(B=f.fcmOptions)||void 0===B?void 0:B.link)&&void 0!==z?z:null===(a=f.notification)||void 0===a?void 0:a.click_action;k&&(l.fcmOptions.link=k);const $=null===(m=f.fcmOptions)||void 0===m?void 0:m.analytics_label;$&&(l.fcmOptions.analyticsLabel=$)}(f,l),f}function ft(l,f){const Z=[];for(let B=0;B<l.length;B++)Z.push(l.charAt(B)),B<f.length&&Z.push(f.charAt(B));return Z.join("")}function gt(l){return A.create("missing-app-config-values",{valueName:l})}ft("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),ft("AzSCbw63g1R0nCw85jG8","Iaya3yLKwmgvh7cF0q4");class mt{constructor(f,Z,B){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const z=function Nt(l){if(!l||!l.options)throw gt("App Configuration Object");if(!l.name)throw gt("App Name");const f=["projectId","apiKey","appId","messagingSenderId"],{options:Z}=l;for(const B of f)if(!Z[B])throw gt(B);return{appName:l.name,projectId:Z.projectId,apiKey:Z.apiKey,appId:Z.appId,senderId:Z.messagingSenderId}}(f);this.firebaseDependencies={app:f,appConfig:z,installations:Z,analyticsProvider:B}}_delete(){return Promise.resolve()}}function Se(l){return Ye.apply(this,arguments)}function Ye(){return(Ye=(0,c.Z)(function*(l){try{l.swRegistration=yield navigator.serviceWorker.register(Ce,{scope:pe}),l.swRegistration.update().catch(()=>{})}catch(f){throw A.create("failed-service-worker-registration",{browserErrorMessage:f?.message})}})).apply(this,arguments)}function at(){return(at=(0,c.Z)(function*(l,f){if(!f&&!l.swRegistration&&(yield Se(l)),f||!l.swRegistration){if(!(f instanceof ServiceWorkerRegistration))throw A.create("invalid-sw-registration");l.swRegistration=f}})).apply(this,arguments)}function tt(){return(tt=(0,c.Z)(function*(l,f){f?l.vapidKey=f:l.vapidKey||(l.vapidKey=L)})).apply(this,arguments)}function vt(l,f){return nt.apply(this,arguments)}function nt(){return nt=(0,c.Z)(function*(l,f){if(!navigator)throw A.create("only-available-in-window");if("default"===Notification.permission&&(yield Notification.requestPermission()),"granted"!==Notification.permission)throw A.create("permission-blocked");return yield function _t(l,f){return tt.apply(this,arguments)}(l,f?.vapidKey),yield function et(l,f){return at.apply(this,arguments)}(l,f?.serviceWorkerRegistration),function O(l){return j.apply(this,arguments)}(l)}),nt.apply(this,arguments)}function Ct(){return(Ct=(0,c.Z)(function*(l,f,Z){const B=function je(l){switch(l){case ce.NOTIFICATION_CLICKED:return"notification_open";case ce.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}(f);(yield l.firebaseDependencies.analyticsProvider.get()).logEvent(B,{message_id:Z[Ne],message_name:Z[we],message_time:Z[ke],message_device_time:Math.floor(Date.now()/1e3)})})).apply(this,arguments)}function bt(){return bt=(0,c.Z)(function*(l,f){const Z=f.data;if(!Z.isFirebaseMessaging)return;l.onMessageHandler&&Z.messageType===ce.PUSH_RECEIVED&&("function"==typeof l.onMessageHandler?l.onMessageHandler(St(Z)):l.onMessageHandler.next(St(Z)));const B=Z.data;(function Zt(l){return"object"==typeof l&&!!l&&Ne in l})(B)&&"1"===B["google.c.a.e"]&&(yield function Ft(l,f,Z){return Ct.apply(this,arguments)}(l,Z.messageType,B))}),bt.apply(this,arguments)}const Pt="@firebase/messaging",Lt=l=>{const f=new mt(l.getProvider("app").getImmediate(),l.getProvider("installations-internal").getImmediate(),l.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",Z=>function yt(l,f){return bt.apply(this,arguments)}(f,Z)),f},Te=l=>{const f=l.getProvider("messaging").getImmediate();return{getToken:B=>vt(f,B)}};function ct(){return Ve.apply(this,arguments)}function Ve(){return(Ve=(0,c.Z)(function*(){try{yield(0,re.eu)()}catch{return!1}return typeof window<"u"&&(0,re.hl)()&&(0,re.zI)()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")})).apply(this,arguments)}function At(){return(At=(0,c.Z)(function*(l){if(!navigator)throw A.create("only-available-in-window");return l.swRegistration||(yield Se(l)),Be(l)})).apply(this,arguments)}function Ot(l,f){return wt.apply(this,arguments)}function wt(){return(wt=(0,c.Z)(function*(l,f){return vt(l=(0,re.m9)(l),f)})).apply(this,arguments)}function Bt(l){return function Tt(l){return At.apply(this,arguments)}(l=(0,re.m9)(l))}function Et(l,f){return function Gt(l,f){if(!navigator)throw A.create("only-available-in-window");return l.onMessageHandler=f,()=>{l.onMessageHandler=null}}(l=(0,re.m9)(l),f)}!function ut(){(0,ge._registerComponent)(new i.wA("messaging",Lt,"PUBLIC")),(0,ge._registerComponent)(new i.wA("messaging-internal",Te,"PRIVATE")),(0,ge.registerVersion)(Pt,"0.12.4"),(0,ge.registerVersion)(Pt,"0.12.4","esm2017")}()},1878:(Ut,De,p)=>{p.d(De,{Lj:()=>te,X3:()=>Ue});var c=p(5861);const H=(F,P)=>P.some(W=>F instanceof W);let i,X;const Ce=new WeakMap,pe=new WeakMap,L=new WeakMap,e=new WeakMap,Ne=new WeakMap;let _e={get(F,P,W){if(F instanceof IDBTransaction){if("done"===P)return pe.get(F);if("objectStoreNames"===P)return F.objectStoreNames||L.get(F);if("store"===P)return W.objectStoreNames[1]?void 0:W.objectStore(W.objectStoreNames[0])}return de(F[P])},set:(F,P,W)=>(F[P]=W,!0),has:(F,P)=>F instanceof IDBTransaction&&("done"===P||"store"===P)||P in F};function le(F){return"function"==typeof F?function ce(F){return F!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?function ge(){return X||(X=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}().includes(F)?function(...P){return F.apply(ue(this),P),de(Ce.get(this))}:function(...P){return de(F.apply(ue(this),P))}:function(P,...W){const v=F.call(ue(this),P,...W);return L.set(v,P.sort?P.sort():[P]),de(v)}}(F):(F instanceof IDBTransaction&&function ke(F){if(pe.has(F))return;const P=new Promise((W,v)=>{const C=()=>{F.removeEventListener("complete",T),F.removeEventListener("error",I),F.removeEventListener("abort",I)},T=()=>{W(),C()},I=()=>{v(F.error||new DOMException("AbortError","AbortError")),C()};F.addEventListener("complete",T),F.addEventListener("error",I),F.addEventListener("abort",I)});pe.set(F,P)}(F),H(F,function re(){return i||(i=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}())?new Proxy(F,_e):F)}function de(F){if(F instanceof IDBRequest)return function we(F){const P=new Promise((W,v)=>{const C=()=>{F.removeEventListener("success",T),F.removeEventListener("error",I)},T=()=>{W(de(F.result)),C()},I=()=>{v(F.error),C()};F.addEventListener("success",T),F.addEventListener("error",I)});return P.then(W=>{W instanceof IDBCursor&&Ce.set(W,F)}).catch(()=>{}),Ne.set(P,F),P}(F);if(e.has(F))return e.get(F);const P=le(F);return P!==F&&(e.set(F,P),Ne.set(P,F)),P}const ue=F=>Ne.get(F);function Ue(F,P,{blocked:W,upgrade:v,blocking:C,terminated:T}={}){const I=indexedDB.open(F,P),D=de(I);return v&&I.addEventListener("upgradeneeded",U=>{v(de(I.result),U.oldVersion,U.newVersion,de(I.transaction))}),W&&I.addEventListener("blocked",()=>W()),D.then(U=>{T&&U.addEventListener("close",()=>T()),C&&U.addEventListener("versionchange",()=>C())}).catch(()=>{}),D}function te(F,{blocked:P}={}){const W=indexedDB.deleteDatabase(F);return P&&W.addEventListener("blocked",()=>P()),de(W).then(()=>{})}const ne=["get","getKey","getAll","getAllKeys","count"],Oe=["put","add","delete","clear"],Re=new Map;function ve(F,P){if(!(F instanceof IDBDatabase)||P in F||"string"!=typeof P)return;if(Re.get(P))return Re.get(P);const W=P.replace(/FromIndex$/,""),v=P!==W,C=Oe.includes(W);if(!(W in(v?IDBIndex:IDBObjectStore).prototype)||!C&&!ne.includes(W))return;const T=function(){var I=(0,c.Z)(function*(D,...U){const E=this.transaction(D,C?"readwrite":"readonly");let S=E.store;return v&&(S=S.index(U.shift())),(yield Promise.all([S[W](...U),C&&E.done]))[0]});return function(U){return I.apply(this,arguments)}}();return Re.set(P,T),T}!function Le(F){_e=F(_e)}(F=>({...F,get:(P,W,v)=>ve(P,W)||F.get(P,W,v),has:(P,W)=>!!ve(P,W)||F.has(P,W)}))}}]);