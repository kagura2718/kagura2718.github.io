"use strict";(self.webpackChunkKaguraGithubPages=self.webpackChunkKaguraGithubPages||[]).push([[664],{664:(Q,g,a)=>{a.r(g),a.d(g,{EvolutionRadarModule:()=>Y});var f=a(1368),S=a(9719),A=a(4192),F=a(8072),R=a(2668),P=a(6716),p=a(5657),c=a(6700),C=a(6040),v=a(3616),h=a(4704),V=a(3412),E=a(1496),k=a(2700),y=a(8960),T=a(9900),L=a(2392),b=a(632),O=a(4680),I=a(7368),x=a(8800),$=a(8152),M=a(2332),i=a(4496),G=a(9568),B=a(6148),H=a(9072),w=a(2984),D=a(5928);const N=["statusChart"],U=[{path:"",redirectTo:"index.htm"},{path:"index.htm",component:(()=>{class r{master;dom;HUE_COLORS=["#FF0000AA","#FFFF00AA","#00FF00AA","#00FFFFAA","#0000FFAA","#FF00FFAA","#FF4000AA","#BFFF00AA","#00FF40AA","#00BFFFAA","#4000FFAA","#FF00BFAA","#FF8000AA","#80FF00AA","#00FF80AA","#0080FFAA","#8000FFAA","#FF0080AA","#FFBF00AA","#40FF00AA","#00FFBFAA","#0040FFAA","#BF00FFAA","#FF0040AA"];basicPokemonId$=new p.E;isValidPokemonTree$;inputHasError;inputPL=20;inputIV={AP:15,DP:15,HP:15};evolutionNodeSelected$=new p.E;evolutionRootCleared$=new c.g(void 0);currentStatus$=new c.g(null);computePLValidator$=new p.E;initializeVisibleStatus$=new p.E;inputPL$=new c.g(this.inputPL);inputStatus$=new p.E;inputFormChanged$=new c.g(void 0);pokemonForm$=new p.E;pokemonIV$=new c.g(this.inputIV);destroy$=new p.E;evolutionRoot$;evolutionRootTree$;statusChart;constructor(o,s){this.master=o,this.dom=s}ngAfterViewInit(){}ngOnInit(){this.dom.setTitle("Evoution status radar (Junk)"),(0,C.E)([this.master.level$,this.pokemonForm$,this.pokemonIV$,this.inputStatus$]).pipe((0,v.a)(this.destroy$)).subscribe(([t,e,n,m])=>{this.maybeComputePL(t,e,n,m)});const o=new R.s(this.master);this.evolutionRoot$=this.pokemonForm$.pipe((0,O.o)(500),(0,I.G)(t=>o.fetchEvolutionRoot$(t))),this.evolutionRootTree$=this.evolutionRoot$.pipe((0,h.k)(t=>o.buildEvolutionTree(t))),(0,C.E)([this.pokemonIV$,this.inputPL$]).pipe((0,h.k)(()=>{})),this.prepareChartStream(),this.isValidPokemonTree$=(0,V.U)(this.basicPokemonId$.pipe((0,h.k)(()=>!0)),this.evolutionRootCleared$.pipe((0,h.k)(()=>!1))).pipe()}prepareChartStream(){(0,E.I)(500).pipe((0,v.a)(this.destroy$)).subscribe(t=>{});const o=(0,C.E)([(0,k.of)(0),this.evolutionRootTree$]).pipe((0,I.G)(t=>(0,k.of)(t)),(0,x.w)(([t,e])=>e.children$?e.children$.pipe((0,$.O)(n=>(0,T.Q)(n)),(0,h.k)(n=>[t+1,n])):y.k),(0,$.O)(([t,e])=>this.master.level$.pipe((0,h.k)(n=>{const m=new M.PokemonForm(n,e.formJson),l={};e.form.megaBranch&&(l.megaBranch=e.form.megaBranch);const u=m.getPokemonId(l),d={depth:t,settings:m,nodeId:u,label:u};return e.form.megaBranch&&(d.megaBranch=e.form.megaBranch),d}))),(0,$.O)(t=>this.master.readPokemonName(t.label).pipe((0,h.k)(e=>(t.label=e,t))))),s=(0,L.E)([o,(0,b.i)(1,999999)]).pipe((0,h.k)(([t,e])=>{const n=t;return n.pseudoId=e,n.colorHex=this.HUE_COLORS[e%this.HUE_COLORS.length],n}));this.inputFormChanged$.pipe((0,v.a)(this.destroy$)).subscribe(t=>{this.initializeVisibleStatus$.next(),this.currentStatus$.next(null),this.statusChartDataset=[],this.chartMap={},this.chartUpdated$.next()}),s.pipe((0,v.a)(this.destroy$)).subscribe(t=>{let e=this.chartMap[t.nodeId];if(!e){const n={backgroundColor:t.colorHex,fill:!0,data:[],label:t.label};this.statusChartDataset.push(n),e={model:t,statusView:n},this.chartMap[t.nodeId]=e}this.chartUpdated$.next()}),(0,C.E)([this.pokemonIV$,this.inputPL$,this.chartUpdated$]).pipe((0,v.a)(this.destroy$)).subscribe(([t,e,n])=>{for(const m in this.chartMap){const l=this.chartMap[m],d=l.model.settings.computeStatus(t,e,{megaBranch:l.model.megaBranch});l.statusView.data=[d.AP,d.DP,d.HP]}this.statusChart.update()})}chartMap={};statusChartDataset=[];chartUpdated$=new p.E;tooltipEvolutionItem(o){let s="";for(const t of o)s+=`Name: ${t.dataset.label}\n`,s+=`CP: ${t.parsed.y}\n`;return s}statusChartOptions={responsive:!0,scales:{r:{min:0,ticks:{stepSize:50}}},plugins:{legend:{position:"top"}},elements:{point:{radius:5,hoverRadius:10}}};statusChartLabels=["Attack","Defence","Stamina"];statusChartLegend=!0;statusChartClick({event:o,active:s}){(0,P.qe)("MainComponent.statusChartClick()",o,s),this.clickChartItem(o,s)}clickChartItem(o,s){if(!s||0===s.length||!o)return;const m=o.chart.data.datasets[s[0].datasetIndex];for(const l in this.chartMap){const u=this.chartMap[l];if(u.statusView===m)return void this.evolutionNodeSelected$.next(u.model)}}statusChartHover(o){}onChangePL(o){this.inputPL$.next(o)}onChangeIV(o){this.inputIV=o,this.pokemonIV$.next(this.inputIV)}evolveForms$;ngOnDestroy(){this.destroy$.next()}maybeComputePL(o,s,t,e){if(!e.CP)return;const n=e.HP,m=e.CP;try{const u=new M.PokemonForm(o,s).computeMatchingLevel(m,n,t);this.currentStatus$.next(u),this.computePLValidator$.next(!0)}catch(l){(0,P.sJ)("Seems compution failed. This message should be hidden.",l),this.computePLValidator$.next(!1)}}onValidatedPokemonName(o){this.basicPokemonId$.next(o)}onSelectedPokemonForm(o){this.evolutionNodeSelected$.next({settings:o})}onFormValueChanged(){this.inputFormChanged$.next()}onSelectedRawForm(o){this.pokemonForm$.next(o)}onClearedPokemonId(){this.evolutionRootCleared$.next()}onClickShowGrowUpStatus(){}onChangeVisibleStatus(o){this.inputStatus$.next(o)}static \u0275fac=function(s){return new(s||r)(i.GI1(G.G),i.GI1(B.O))};static \u0275cmp=i.In1({type:r,selectors:[["app-evolution-radar"]],viewQuery:function(s,t){if(1&s&&i.CC$(N,5,F.YR),2&s){let e;i.wto(e=i.Gqi())&&(t.statusChart=e.first)}},decls:8,vars:9,consts:[[1,"toolInputGroup"],[3,"validatedName","selectedForm","selectedRawForm","valueChanged","valueCleared"],[1,"m-2","toolInputGroup",3,"valueChanged"],[1,"toolInputGroup","m-2",2,"display","block",3,"validatorResult","initialize","disabled","currentStatus$","valueChanged"],[2,"display","block"],["baseChart","","type","radar",3,"datasets","labels","options","chartHover","chartClick"],["statusChart",""]],template:function(s,t){1&s&&(i.I0R(0,"div",0)(1,"app-pokemon-form",1),i.qCj("validatedName",function(n){return t.onValidatedPokemonName(n)})("selectedForm",function(n){return t.onSelectedPokemonForm(n)})("selectedRawForm",function(n){return t.onSelectedRawForm(n)})("valueChanged",function(){return t.onFormValueChanged()})("valueCleared",function(){return t.onClearedPokemonId()}),i.C$Y(),i.I0R(2,"app-pokemon-iv",2),i.qCj("valueChanged",function(n){return t.onChangeIV(n)}),i.C$Y(),i.I0R(3,"app-pokemon-visible-status",3),i.qCj("valueChanged",function(n){return t.onChangeVisibleStatus(n)}),i.wVc(4,"async"),i.C$Y()(),i.I0R(5,"div",4)(6,"canvas",5,6),i.qCj("chartHover",function(n){return t.statusChartHover(n)})("chartClick",function(n){return t.statusChartClick(n)}),i.C$Y()()),2&s&&(i.yG2(3),i.E7m("validatorResult",t.computePLValidator$)("initialize",t.initializeVisibleStatus$)("disabled",!i.kDX(4,7,t.isValidPokemonTree$))("currentStatus$",t.currentStatus$),i.yG2(3),i.E7m("datasets",t.statusChartDataset)("labels",t.statusChartLabels)("options",t.statusChartOptions))},dependencies:[F.YR,H.u,w.Y,D.Q,f.a],styles:[".toolInputGroup[_ngcontent-%COMP%]{border:solid #eeeeee;border-radius:5px}.toolSmallText[_ngcontent-%COMP%]{font-size:.8em}.toolExtraSmallText[_ngcontent-%COMP%]{font-size:.5em}.appPokemonThumb[_ngcontent-%COMP%]{max-width:40px;max-height:40px}"]})}return r})(),data:{gitweeTitle:"TITLE_POKEMON_RADAR_CHART"}}];let z=(()=>{class r{static \u0275fac=function(s){return new(s||r)};static \u0275mod=i.a4G({type:r});static \u0275inj=i.s3X({imports:[A.qQ.forChild(U),A.qQ]})}return r})();var j=a(7976);let Y=(()=>{class r{static \u0275fac=function(s){return new(s||r)};static \u0275mod=i.a4G({type:r});static \u0275inj=i.s3X({providers:[{provide:j.k1,useValue:"app/tools/pokemongo/evolution-radar/evolution-radar/"}],imports:[f.MD,F.eq,S.W,z]})}return r})()}}]);