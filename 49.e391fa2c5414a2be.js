"use strict";(self.webpackChunkKaguraGithubPages=self.webpackChunkKaguraGithubPages||[]).push([[49],{9049:(Jt,De,g)=>{g.r(De),g.d(De,{GitfireModule:()=>xt});var F=g(6814),r=g(5739),K=g(7217),de=g(5070),ne=g(5579),me=g(434),pe=g(8024),L=g(5861),e=g(9212),Xe=g(8326),we=g(3338),Ee=g(2096),he=g(6232),Pe=g(5592),We=g(5211),le=g(5137),ue=g(3093),fe=g(4664),Se=g(7398),z=g(304),Q=g(4867),Ne=g(6306),Oe=g(9769),ct=g(3572),_e=g(7142);const ee=new e.OlP("angularfire2.messaging.vapid-key"),Le=new e.OlP("angularfire2.messaging.service-worker-registeration");let T=(()=>{class d{requestPermission;getToken;tokenChanges;messages;requestToken;deleteToken;constructor(i,s,l,y,E,ae,ze){const Ke=ze,Ge=(0,Ee.of)(void 0).pipe((0,le.R)(E.outsideAngular),(0,ue.Q)(E.insideAngular),(0,fe.w)(we.Gb),(0,fe.w)(Fe=>Fe?g.e(490).then(g.bind(g,2490)):he.E),(0,Se.U)(()=>(0,K.on)(i,y,s)),(0,fe.w)(Fe=>(0,K.cc)(`${Fe.name}.messaging`,"AngularFireMessaging",Fe.name,()=>(0,Ee.of)(Fe.messaging()),[])),(0,z.d)({bufferSize:1,refCount:!1}));this.requestPermission=Ge.pipe((0,le.R)(E.outsideAngular),(0,ue.Q)(E.insideAngular),(0,fe.w)(()=>Notification.requestPermission())),this.getToken=Ge.pipe((0,le.R)(E.outsideAngular),(0,ue.Q)(E.insideAngular),(0,fe.w)(function(){var Fe=(0,L.Z)(function*(kt){if("granted"===Notification.permission){const Rt=Ke?yield Ke:null;return yield kt.getToken({vapidKey:ae,serviceWorkerRegistration:Rt})}return null});return function(kt){return Fe.apply(this,arguments)}}()));const mt=new Pe.y(Fe=>{navigator.permissions.query({name:"notifications"}).then(kt=>{kt.onchange=()=>Fe.next()})}),Te=Ge.pipe((0,le.R)(E.outsideAngular),(0,ue.Q)(E.insideAngular),(0,Q.c)(mt),(0,Q.c)(this.getToken));return this.tokenChanges=Ge.pipe((0,le.R)(E.outsideAngular),(0,ue.Q)(E.insideAngular),(0,fe.w)(()=>(0,We.z)(this.getToken,Te))),this.messages=Ge.pipe((0,le.R)(E.outsideAngular),(0,ue.Q)(E.insideAngular),(0,fe.w)(Fe=>new Pe.y(kt=>Fe.onMessage(kt)))),this.requestToken=Ge.pipe((0,le.R)(E.outsideAngular),(0,ue.Q)(E.insideAngular),(0,fe.w)(()=>this.requestPermission),(0,Ne.K)(()=>(0,Ee.of)(null)),(0,Oe.z)(()=>this.tokenChanges)),this.deleteToken=()=>Ge.pipe((0,le.R)(E.outsideAngular),(0,ue.Q)(E.insideAngular),(0,fe.w)(Fe=>Fe.deleteToken()),(0,ct.d)(!1)),(0,K.pX)(this,Ge,y)}static \u0275fac=function(s){return new(s||d)(e.LFG(K.Dh),e.LFG(K.xv,8),e.LFG(e.Lbi),e.LFG(e.R0b),e.LFG(Xe.HU),e.LFG(ee,8),e.LFG(Le,8))};static \u0275prov=e.Yz7({token:d,factory:d.\u0275fac,providedIn:"any"})}return d})(),A=(()=>{class d{constructor(){_e.Z.registerVersion("angularfire",Xe.q4.full,"fcm-compat")}static \u0275fac=function(s){return new(s||d)};static \u0275mod=e.oAB({type:d});static \u0275inj=e.cJS({providers:[T]})}return d})();var b=g(2425),I=g(2589),U=g(5187),_=g(8645),S=g(9773),R=g(8180),P=g(2181),m=g(553),q=g(103),ce=g(1248);let te=(()=>{class d extends ce.W{constructor(){super()}ngOnInit(){(0,m.eM)("DeleteConfirmComponent.OnInit()")}static \u0275fac=function(s){return new(s||d)};static \u0275cmp=e.Xpm({type:d,selectors:[["gitfire-delete-confirm"]],features:[e.qOj],decls:10,vars:0,consts:[[1,"m-3"]],template:function(s,l){1&s&&(e.TgZ(0,"div",0)(1,"div"),e._uU(2,"\u672c\u5f53\u306b\u524a\u9664\u3057\u307e\u3059\u304b\uff1f"),e.qZA(),e.TgZ(3,"ul")(4,"li"),e._uU(5,"Google / Twitter \u306a\u3069\u306e\u30a2\u30ab\u30a6\u30f3\u30c8\u60c5\u5831\u306f\u524a\u9664\u3055\u308c\u307e\u305b\u3093\u3002"),e.qZA(),e.TgZ(6,"li"),e._uU(7,"\u516c\u958b\u3055\u308c\u305f\u6295\u7a3f\u306f\u524a\u9664\u3055\u308c\u307e\u305b\u3093\u3002"),e.qZA(),e.TgZ(8,"li"),e._uU(9,"\u53d6\u308a\u6d88\u3057\u306f\u3067\u304d\u307e\u305b\u3093\u3002"),e.qZA()()())}})}return d})();g(4015);var oe=g(353);const Qe=["specialAuthContainer"];function O(d,M){if(1&d){const i=e.EpF();e.TgZ(0,"a",7),e.NdJ("click",function(l){const E=e.CHM(i).$implicit,ae=e.oxw();return e.KtG(ae.onClickReauthProvider(l,E))}),e._uU(1),e.qZA()}if(2&d){const i=M.$implicit;e.xp6(),e.Oqu(i.providerId)}}class W extends ce.W{loader;toastr;static SUPPORTED_PROVIDERS={};static SupportedOauthProviderIds=[];destroy$=new _.x;get providers(){return this.currentUser.providerData}currentUser;reauthed=new e.vpe;specialAuthContainer;static#e=(()=>{const M=W.SUPPORTED_PROVIDERS,i=_e.Z.auth;M[i.EmailAuthProvider.PROVIDER_ID]=i.EmailAuthProvider,M[i.TwitterAuthProvider.PROVIDER_ID]=i.TwitterAuthProvider,M[i.GoogleAuthProvider.PROVIDER_ID]=i.GoogleAuthProvider,M[i.GithubAuthProvider.PROVIDER_ID]=i.GithubAuthProvider;const s=W.SupportedOauthProviderIds;s.push(i.TwitterAuthProvider.PROVIDER_ID),s.push(i.GoogleAuthProvider.PROVIDER_ID),s.push(i.GithubAuthProvider.PROVIDER_ID)})();constructor(M,i){super(),this.loader=M,this.toastr=i}ngOnDestroy(){this.destroy$.next()}isOAuthProvider(M){return!!W.SupportedOauthProviderIds.includes(M)}onClickReauthProvider(M,i){var s=()=>super.close,l=this;return(0,L.Z)(function*(){(0,m.eM)("onClickReauthProvider()",M,i),M.preventDefault();const E=new(0,W.SUPPORTED_PROVIDERS[i.providerId]);if(l.specialAuthContainer.clear(),l.isOAuthProvider(i.providerId)){try{yield l.currentUser.reauthenticateWithPopup(E)}catch(ae){(0,m.wb)("Error while reauth",ae);const ze=ae instanceof Error?ae.message:"Unknown error";return void l.toastr.error(`\u518d\u8a8d\u8a3c\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002 ( ${ze} )`)}(0,m.eM)("Reanthenticated via OAuth provider")}else{const{GitfireLoginModule:ae}=yield Promise.resolve().then(g.bind(g,3128)),{InputAuthComponent:ze}=yield Promise.resolve().then(g.bind(g,8337)),Ke=l.loader.appendComponent(l.specialAuthContainer,ae,ze);Ke.isReauth=!0,Ke.reauthUser=l.currentUser,Ke.showFederations=!1;const Ge=Ke.reauthed.pipe((0,R.q)(1));try{yield Ge.toPromise()}catch(mt){(0,m.wb)("Error while reauth done",mt);const Te=mt instanceof Error?mt.message:"Unknown error";return void l.toastr.error(`\u518d\u8a8d\u8a3c\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002 ( ${Te} )`)}(0,m.eM)("Reanthenticated via password")}l.reauthed.next(),s().call(l)})()}static \u0275fac=function(i){return new(i||W)(e.Y36(oe.j),e.Y36(b._W))};static \u0275cmp=e.Xpm({type:W,selectors:[["gitfire-reauth-box"]],viewQuery:function(i,s){if(1&i&&e.Gf(Qe,5,e.s_b),2&i){let l;e.iGM(l=e.CRH())&&(s.specialAuthContainer=l.first)}},inputs:{currentUser:"currentUser"},outputs:{reauthed:"reauthed"},features:[e.qOj],decls:10,vars:1,consts:[[1,"m-3"],[1,"btn-group"],["type","button","data-bs-toggle","dropdown","aria-haspopup","true","aria-expanded","false",1,"btn","btn-primary","dropdown-toggle"],[1,"visually-hidden"],[1,"dropdown-menu"],["class","dropdown-item","href","#",3,"click",4,"ngFor","ngForOf"],["specialAuthContainer",""],["href","#",1,"dropdown-item",3,"click"]],template:function(i,s){1&i&&(e.TgZ(0,"div",0)(1,"div",1)(2,"button",2)(3,"span",3),e._uU(4,"Toggle Dropdown"),e.qZA(),e._uU(5,"\u8a8d\u8a3c\u65b9\u6cd5"),e.qZA(),e.TgZ(6,"div",4),e.YNc(7,O,2,1,"a",5),e.qZA()(),e._UZ(8,"div",null,6),e.qZA()),2&i&&(e.xp6(7),e.Q6J("ngForOf",s.providers))},dependencies:[F.sg]})}var x=g(1748);function $(d,M){if(d.value!==M){if(d.dirty)return void(0,m.wb)(`Upstream value has been changed to ${d.value} -> ${M} but sillengly ignore the value.`);d.setErrors(null),d.setValue(M)}}function D(d){d.markAsPristine(),d.markAsUntouched()}var re=g(9782),nt=g(2413),ot=g(9339),Ve=g(3867),$e=g(2572),_t=g(3997),He=g(9397),vt=g(7319);let jt=(()=>{class d{controlLabel;formName;tooltipText;parentForm;checkChanged=new e.vpe;autoGeneratedId;constructor(){const i=Math.random().toString(36).substring(2);this.autoGeneratedId=`appViewInput-${i}`}ngOnInit(){(0,m.eM)("SwitchComponent.OnInit()")}onChangeBox(i){(0,m.eM)("SwitchComponent.onChangeBox()",this.parentForm),this.checkChanged.emit(i)}static \u0275fac=function(s){return new(s||d)};static \u0275cmp=e.Xpm({type:d,selectors:[["app-switch"]],inputs:{controlLabel:"controlLabel",formName:"formName",tooltipText:"tooltipText",parentForm:"parentForm"},outputs:{checkChanged:"checkChanged"},decls:4,vars:7,consts:[[1,"custom-control","custom-switch",3,"formGroup","title"],["type","checkbox",1,"custom-control-input",3,"id","name","formControlName","change"],[1,"custom-control-label",3,"for"]],template:function(s,l){1&s&&(e.TgZ(0,"span",0)(1,"input",1),e.NdJ("change",function(E){return l.onChangeBox(E)}),e.qZA(),e.TgZ(2,"label",2),e._uU(3),e.qZA()()),2&s&&(e.s9C("title",l.tooltipText),e.Q6J("formGroup",l.parentForm),e.xp6(),e.s9C("id",l.autoGeneratedId),e.s9C("name",l.formName),e.s9C("formControlName",l.formName),e.xp6(),e.s9C("for",l.autoGeneratedId),e.xp6(),e.Oqu(l.controlLabel))},dependencies:[r.Wl,r.JJ,r.JL,r.sg,r.u]})}return d})();function Be(d,M){if(1&d){const i=e.EpF();e.TgZ(0,"button",22),e.NdJ("click",function(l){e.CHM(i);const y=e.oxw().$implicit,E=e.oxw();return e.KtG(E.onClickDeleteDevice(l,y))}),e._uU(1,"\u524a\u9664"),e.qZA()}}function rt(d,M){if(1&d){const i=e.EpF();e.TgZ(0,"div",19)(1,"app-switch",20),e.NdJ("checkChanged",function(l){const E=e.CHM(i).$implicit,ae=e.oxw();return e.KtG(ae.onToggleDevice(l,E))}),e.ALo(2,"date"),e.qZA(),e.YNc(3,Be,2,0,"button",21),e.qZA()}if(2&d){const i=M.$implicit,s=e.oxw();e.xp6(),e.cQ8("controlLabel","",i.name||"No Name"," ",i.id===s.registeredDeviceId?"[\u3053\u306e\u7aef\u672b]":null," (\u767b\u9332\u65e5: ",e.xi3(2,6,i.createdAt.toDate(),"yyyy-MM-dd"),")"),e.MGl("formName","device-",i.id,""),e.Q6J("parentForm",s.deviceForm),e.xp6(2),e.Q6J("ngIf",i.id!==s.registeredDeviceId)}}function Ut(d,M){if(1&d&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&d){const i=M.$implicit,s=M.index;e.xp6(),e.AsE("",s,": ",i,"")}}function Qt(d,M){if(1&d&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&d){const i=M.$implicit,s=M.index;e.xp6(),e.AsE("",s,": ",i,"")}}function Ht(d,M){if(1&d&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&d){const i=M.$implicit,s=M.index;e.xp6(),e.AsE("",s,": ",i,"")}}function Lt(d,M){if(1&d&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"json"),e.qZA()),2&d){const i=M.$implicit;e.xp6(),e.Oqu(e.lcZ(2,1,i))}}let Kt=(()=>{class d{auth;dialog;toastr;store;funcs;messaging;destroy$=new _.x;mainForm;userPrivStore$;deviceForm;messagingTypeArray;configArray;currentUser$;registeredDeviceId;registeredToken;debugObservable={};devices;tokenReceived=new _.x;tokenReceived$;privUser;constructor(i,s,l,y,E,ae){this.auth=i,this.dialog=s,this.toastr=l,this.store=y,this.funcs=E,this.messaging=ae,this.privUser=this.store.collection("/users/v1/protected"),this.currentUser$=this.auth.clientSideUser$.pipe((0,P.h)(ze=>!!ze))}onToggleDevice(i,s){(0,m.eM)("onToggleDevice()");const l=this.getDeviceControl(s),y={deviceId:s.id,off:!l.value};try{this.funcs.call("toggleSuspendDevice",y),this.toastr.success("\u7aef\u672b\u306e\u8a2d\u5b9a\u3092\u66f4\u65b0\u3057\u307e\u3057\u305f\u3002")}catch{this.toastr.error("\u7aef\u672b\u306e\u8a2d\u5b9a\u304c\u66f4\u65b0\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002")}}onClickDeleteDevice(i,s){var E,l=this;(0,m.eM)("onClickDeleteDevice()"),this.messaging.deleteToken(s.token).pipe((0,S.R)(this.destroy$)).subscribe({next:(E=(0,L.Z)(function*(ae){(0,m.H_)(`deleteToken() result ${ae}`),l.toastr.success("\u7aef\u672b\u306e\u901a\u77e5\u3092\u89e3\u9664\u3057\u307e\u3057\u305f\u3002")}),function(ze){return E.apply(this,arguments)}),error:E=>{(0,m.wb)(`Failed to delete token token: ${s.token}`,E),this.toastr.error("\u7aef\u672b\u306e\u901a\u77e5\u3092\u89e3\u9664\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002\u65e2\u306b\u5931\u52b9\u3057\u3066\u3044\u308b\u53ef\u80fd\u6027\u304c\u3042\u308a\u307e\u3059\u3002")}});const y={deviceId:s.id};try{this.funcs.call("revokeDevice",y),this.toastr.success("\u30b7\u30b9\u30c6\u30e0\u4e0a\u304b\u3089\u7aef\u672b\u306e\u901a\u77e5\u3092\u89e3\u9664\u3057\u307e\u3057\u305f\u3002")}catch{this.toastr.error("\u30b7\u30b9\u30c6\u30e0\u4e0a\u306e\u7aef\u672b\u306e\u901a\u77e5\u3092\u89e3\u9664\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002")}}ngOnInit(){var i=this;const l=this.currentUser$.pipe((0,R.q)(1),(0,P.h)(y=>!!y)).pipe((0,fe.w)(y=>this.store.collection(`users/v1/protected/${y.uid}/fcm`).valueChanges({idField:"id"})),(0,z.d)(1));l.pipe((0,S.R)(this.destroy$)).subscribe(y=>{this.devices=y;for(const E in this.deviceForm.controls)this.deviceForm.removeControl(E);for(const E of this.devices)this.addDeviceControl(E);this.triggerTokenRefresh()}),this.mainForm.addControl("messagingOn",new r.NI(!1,[])),this.deviceForm=new r.cw({}),this.mainForm.addControl("devices",this.deviceForm),this.mainForm.addControl("messagingSystemCheck",new r.NI(!1,[])),this.mainForm.addControl("messagingTrivialCheck",new r.NI(!1,[])),this.mainForm.addControl("messagingMentionCheck",new r.NI(!1,[])),this.mainForm.addControl("messagingAdminCheck",new r.NI(!1,[])),this.messagingTypeArray=new r.Oe([this.typeSystemControl,this.typeMentionControl,this.typeAdminControl]),this.configArray=new r.Oe([this.typeTrivialControl,this.messagingTypeArray]),this.userPrivStore$.pipe((0,S.R)(this.destroy$)).subscribe(y=>{(0,m.H_)("this.userPrivStore$.subscribe()",y);const E=y.messagingTypes||["mention","admin"];$(this.typeSystemControl,E.includes("system")),$(this.typeMentionControl,E.includes("mention")),$(this.typeAdminControl,E.includes("admin")),$(this.typeTrivialControl,y.isWatchTrivial)}),this.tokenReceived$=this.tokenReceived.pipe((0,P.h)(y=>null!==y),(0,_t.x)()),(0,$e.a)(this.tokenReceived$,l).pipe((0,S.R)(this.destroy$)).subscribe(function(){var y=(0,L.Z)(function*([E,ae]){if((0,m.eM)("this.messaging.tokenReceived subscribe()",E,ae),i.debugObservable.registeredToken=E,i.registeredToken=E,E){const Ke=i.findDeviceId(E,ae);i.registeredDeviceId=Ke}$(i.messagingOnControl,!!i.registeredDeviceId)});return function(E){return y.apply(this,arguments)}}()),this.triggerTokenRefresh(),this.debugObservable.messages=[],this.messaging.messages.pipe((0,S.R)(this.destroy$)).subscribe(y=>{(0,m.H_)("message received from messaging",y),this.debugObservable.messages.push(y)}),this.debugObservable.getToken$=this.messaging.getToken,this.debugObservable.getToken=[],this.debugObservable.getToken$.subscribe({next:y=>this.debugObservable.getToken.push(y),complete:()=>(0,m.H_)("Complete getToken()")}),this.debugObservable.tokenChanges$=this.messaging.tokenChanges,this.debugObservable.tokenChanges=[],this.debugObservable.tokenChanges$.subscribe({next:y=>this.debugObservable.tokenChanges.push(y),complete:()=>(0,m.H_)("Complete tokenChanges()")}),this.debugObservable.tokenReceived=[]}findDeviceId(i,s){for(const l of s)if(l.token===i)return l.id;return null}ngOnDestroy(){this.destroy$.next()}triggerTokenRefresh(){this.messaging.getToken.pipe((0,R.q)(1),(0,S.R)(this.destroy$)).subscribe({next:i=>this.tokenReceived.next(i),complete:()=>(0,m.eM)("Completed getToken")})}get messagingOnControl(){return this.mainForm.get("messagingOn")}getDeviceControl(i){return this.deviceForm.get(`device-${i.id}`)}addDeviceControl(i){const s=new r.NI(!i.isSuspend,[]);this.deviceForm.addControl(`device-${i.id}`,s)}get typeTrivialControl(){return this.mainForm.get("messagingTrivialCheck")}get typeSystemControl(){return this.mainForm.get("messagingSystemCheck")}get typeMentionControl(){return this.mainForm.get("messagingMentionCheck")}get typeAdminControl(){return this.mainForm.get("messagingAdminCheck")}revokeNotification(){var i=this;return(0,L.Z)(function*(){if(!i.registeredDeviceId)return(0,m.wb)("Unexpectedly no deviceId is found."),void i.toastr.error("\u30c7\u30d0\u30a4\u30b9\u60c5\u5831\u3092\u7121\u52b9\u306b\u3067\u304d\u307e\u305b\u3093\u3002");try{i.funcs.call("revokeDevice",{deviceId:i.registeredDeviceId}),i.toastr.info("\u30b7\u30b9\u30c6\u30e0\u304b\u3089\u901a\u77e5\u60c5\u5831\u3092\u524a\u9664\u3057\u307e\u3057\u305f\u3002")}catch(s){return(0,m.wb)("Error while deleting token via Functions",s),i.messagingOnControl.setValue(!0),D(i.messagingOnControl),void i.toastr.error("\u30b7\u30b9\u30c6\u30e0\u306e\u901a\u77e5\u60c5\u5831\u3092\u524a\u9664\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002")}i.messaging.getToken.pipe((0,He.b)(s=>(0,m.eM)(`getToken before deleteToken ${s}`)),(0,Oe.z)(s=>i.messaging.deleteToken(s)),(0,R.q)(1),(0,S.R)(i.destroy$)).subscribe({next:s=>{(0,m.H_)(`Deleted result: ${s} on FCM.`),D(i.messagingOnControl),i.toastr.success("\u901a\u77e5\u60c5\u5831\u3092\u524a\u9664\u3057\u307e\u3057\u305f\u3002")},error:s=>{(0,m.wb)("Error while deleting token on FCM",s),i.toastr.error("\u901a\u77e5\u60c5\u5831\u304c\u524a\u9664\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002")}})})()}onToggleMessaging(i){var s=this;return(0,L.Z)(function*(){if((0,m.eM)("UserSettingsComponent.onToggleMessaging()"),s.messagingOnControl.value){if(!s.registeredDeviceId&&s.devices&&s.devices.length>=m.NZ.FCMDeviceMaxCount)return void s.toastr.error("\u767b\u9332\u3055\u308c\u305f\u30c7\u30d0\u30a4\u30b9\u304c\u591a\u3059\u304e\u307e\u3059\u3002\u524a\u9664\u3057\u3066\u304b\u3089\u3084\u308a\u76f4\u3057\u3066\u304f\u3060\u3055\u3044\u3002");yield s.updateRequestToken()}else{const y=s.dialog.createHtmlBuilder(),E=new vt.ww("\n<div>\n\u767b\u9332\u3092\u89e3\u9664\u3059\u308b\u3068\u3059\u3079\u3066\u306e\u901a\u77e5\u306f\u505c\u6b62\u3057\u307e\u3059\u3002\u3088\u308d\u3057\u3044\u3067\u3059\u304b\uff1f\n</div>\n");y.setMessage(E).setType(q.iR.Warn).setSize(q.PW.Default).setTitle("\u78ba\u8a8d").okButton((0,L.Z)(function*(){yield s.revokeNotification()})).cancelButton(()=>{s.messagingOnControl.setValue(!0),D(s.messagingOnControl)}).open()}})()}getMessagingTypes(){const i=[];return this.typeSystemControl.value&&i.push("system"),this.typeMentionControl.value&&i.push("mention"),this.typeAdminControl.value&&i.push("admin"),i}updateRequestToken(){var i=this;return(0,L.Z)(function*(){var s;i.messaging.requestToken.pipe((0,R.q)(1),(0,S.R)(i.destroy$)).subscribe({next:(s=(0,L.Z)(function*(l){if(i.tokenReceived.next(l),i.debugObservable.tokenReceived.push(l),!l)return(0,m.wb)("No token returned from requestToken"),i.messagingOnControl.setValue(!1),D(i.messagingOnControl),void i.toastr.error("\u901a\u77e5\u60c5\u5831\u3092\u53d6\u5f97\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002");try{(0,m.eM)(`Updated token with ${l}`);const y={token:l,deviceId:i.registeredDeviceId};i.registeredToken=l,i.registeredDeviceId=yield i.funcs.call("saveDeviceToken",y),i.toastr.success("\u901a\u77e5\u60c5\u5831\u3092\u4fdd\u5b58\u3057\u307e\u3057\u305f\u3002"),D(i.messagingOnControl)}catch(y){(0,m.wb)("Error while save token to Firestore",y),i.messagingOnControl.setValue(!1),D(i.messagingOnControl),i.toastr.error("\u901a\u77e5\u60c5\u5831\u3092\u4fdd\u5b58\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002")}}),function(y){return s.apply(this,arguments)}),error:s=>{(0,m.wb)("Error while request Token",s),i.messagingOnControl.setValue(!1),D(i.messagingOnControl),i.toastr.error("\u901a\u77e5\u3092\u6709\u52b9\u306b\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002\u30d6\u30e9\u30a6\u30b6\u306e\u8a2d\u5b9a\u3092\u78ba\u8a8d\u3057\u3066\u304f\u3060\u3055\u3044\u3002")}})})()}onClickUpdateMessaging(i){var s=this;return(0,L.Z)(function*(){(0,m.eM)("UserSettingsComponent.onClickUpdateMessaging()");try{const l={messageTypes:s.getMessagingTypes(),token:s.registeredToken,isWatchTrivial:s.typeTrivialControl.value};yield s.funcs.call("setNotifications",l),D(s.configArray),s.toastr.success("\u8a2d\u5b9a\u3092\u4fdd\u5b58\u3057\u307e\u3057\u305f\u3002")}catch(l){(0,m.wb)("Failed to save configuration",l),s.toastr.error("\u8a2d\u5b9a\u304c\u4fdd\u5b58\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002")}})()}onClickSubscribeTopic(i){var s=this;return(0,L.Z)(function*(){if(!s.debugObservable.topicText)return void alert("Not set");const l={topic:s.debugObservable.topicText,token:s.registeredToken},y=yield s.funcs.call("subscribeTopicTest",l);(0,m.H_)("subscribeTopicTest ->",y),s.toastr.success(`done subscribe ${y}`)})()}onClickUnsubscribeTopic(i){var s=this;return(0,L.Z)(function*(){if(!s.debugObservable.topicText)return void alert("Not set");const l={topic:s.debugObservable.topicText,token:s.registeredToken},y=yield s.funcs.call("unsubscribeTopicTest",l);(0,m.H_)("unsubscribeTopicTest ->",y),s.toastr.success(`done unsubscribe ${y}`)})()}onClickPostToTopic(i){var s=this;return(0,L.Z)(function*(){if(!s.debugObservable.topicText||!s.debugObservable.topicPostText)return void alert("Not set");const l={topic:s.debugObservable.topicText,title:s.debugObservable.topicPostText},y=yield s.funcs.call("postTopicTest",l);(0,m.H_)("postTopicTest ->",y),s.toastr.success(`done post ${y}`)})()}onClickConditionPostToTopic(i){var s=this;return(0,L.Z)(function*(){if(!s.debugObservable.conditionTopicPostText||!s.debugObservable.conditionTopicPostText)return void alert("Not set");const l={topic:s.debugObservable.conditionTopicPostText,title:s.debugObservable.topicPostText},y=yield s.funcs.call("postConditionTopicTest",l);(0,m.H_)("postConditionTopicTest ->",y),s.toastr.success(`done post ${y}`)})()}onClickClearMessages(i){this.debugObservable.messages=[]}static \u0275fac=function(s){return new(s||d)(e.Y36(re.e),e.Y36(q.xA),e.Y36(b._W),e.Y36(ne.ST),e.Y36(nt.c),e.Y36(T))};static \u0275cmp=e.Xpm({type:d,selectors:[["gitfire-user-notification"]],inputs:{mainForm:"mainForm",userPrivStore$:"userPrivStore$"},decls:69,vars:16,consts:[[1,"m-2"],["title","\u3053\u306e\u6a5f\u80fd\u306f\u30c6\u30b9\u30c8\u4e2d\u306e\u305f\u3081\u5909\u66f4\u3055\u308c\u308b\u3053\u3068\u3084\u3001\u60f3\u5b9a\u5916\u306e\u6319\u52d5\u3092\u3059\u308b\u5834\u5408\u304c\u3042\u308a\u307e\u3059\u3002\u30d6\u30e9\u30a6\u30b6\u304b\u3089\u306e\u901a\u77e5\u3092\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u3057\u307e\u3059\u3002\u8a2d\u5b9a\u304c\u3046\u307e\u304f\u3044\u304b\u306a\u3044\u5834\u5408\u306f\u30d6\u30e9\u30a6\u30b6\u304b\u3089\u5f53\u30b5\u30a4\u30c8\u306e\u901a\u77e5 on/off \u3092\u3057\u305f\u308a\u3001\u300e\u7aef\u672b\u306e\u524a\u9664\u300f\u3092\u304a\u8a66\u3057\u304f\u3060\u3055\u3044\u3002","src","/assets/octicons/question.svg",1,"m-3","octicon-info","help-icon"],[1,"m-2",3,"formGroup"],[1,"row","p-1"],[1,"d-flex","align-content-start","flex-wrap","p-1"],["controlLabel","\u901a\u77e5\u3092\u53d7\u3051\u53d6\u308b","formName","messagingOn","tooltipText","\u30d6\u30e9\u30a6\u30b6\u304b\u3089\u306e\u901a\u77e5\u3092\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u3057\u307e\u3059\u3002",1,"p-2",3,"parentForm","checkChanged"],[1,"d-flex","align-content-start","flex-wrap","p-3"],["class","m-1 input-group",4,"ngFor","ngForOf"],[1,"row","m-2"],["controlLabel","\u3061\u3087\u3063\u3068\u3057\u305f\u901a\u77e5","formName","messagingTrivialCheck","tooltipText","\u3061\u3087\u3063\u3068\u3057\u305f\u901a\u77e5\u3082\u53d7\u3051\u53d6\u308b\u304b\u3069\u3046\u304b\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\u901a\u5e38\u306f\u4e0d\u8981\u3067\u3059\u3002",1,"p-2",3,"parentForm"],["controlLabel","\u30b7\u30b9\u30c6\u30e0","formName","messagingSystemCheck","tooltipText","\u30b7\u30b9\u30c6\u30e0\u304b\u3089\u306e\u901a\u77e5\u3092\u9001\u308b\u304b\u3069\u3046\u304b\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002",1,"p-2",3,"parentForm"],["controlLabel","\u3042\u306a\u305f\u3078\u306e\u8a00\u53ca","formName","messagingMentionCheck","tooltipText","\u30b7\u30b9\u30c6\u30e0\u306e\u30e1\u30c3\u30bb\u30fc\u30b8\u30b7\u30b9\u30c6\u30e0\u3067\u3042\u306a\u305f\u306b\u8a00\u53ca\u3055\u308c\u305f\u5834\u5408\u306b\u901a\u77e5\u3092\u9001\u308b\u304b\u3069\u3046\u304b\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002",1,"p-2",3,"parentForm"],["controlLabel","\u7ba1\u7406\u4eba\u304b\u3089","formName","messagingAdminCheck","tooltipText","\u7ba1\u7406\u4eba\u304c\u624b\u52d5\u3067\u3042\u306a\u305f\u306b\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u9001\u3063\u305f\u5834\u5408\u306b\u901a\u77e5\u3092\u9001\u308b\u304b\u3069\u3046\u304b\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002",1,"p-2",3,"parentForm"],[1,"btn","btn-primary",3,"disabled","click"],[2,"width","100%","overflow-wrap","break-word"],[4,"ngFor","ngForOf"],["type","text",3,"ngModel","ngModelChange"],[1,"btn","btn-primary",3,"click"],[1,"btn","btn-warning",3,"click"],[1,"m-1","input-group"],["tooltipText","\u767b\u9332\u3055\u308c\u305f Device \u306e\u901a\u77e5\u3092\u4e00\u6642\u7684\u306b\u505c\u6b62\u3057\u307e\u3059\u3002",1,"m-2",3,"parentForm","controlLabel","formName","checkChanged"],["class","btn btn-warning","title","\u767b\u9332\u60c5\u5831\u3092\u524a\u9664\u3057\u3066\u3001\u3053\u306e\u7aef\u672b\u3078\u306e\u901a\u77e5\u3092\u89e3\u9664\u3057\u307e\u3059\u3002",3,"click",4,"ngIf"],["title","\u767b\u9332\u60c5\u5831\u3092\u524a\u9664\u3057\u3066\u3001\u3053\u306e\u7aef\u672b\u3078\u306e\u901a\u77e5\u3092\u89e3\u9664\u3057\u307e\u3059\u3002",1,"btn","btn-warning",3,"click"]],template:function(s,l){1&s&&(e.TgZ(0,"h2",0),e._uU(1,"\u901a\u77e5\u8a2d\u5b9a (\u30c6\u30b9\u30c8\u4e2d)"),e._UZ(2,"img",1),e.qZA(),e.TgZ(3,"div",2)(4,"div",3)(5,"div",4)(6,"app-switch",5),e.NdJ("checkChanged",function(E){return l.onToggleMessaging(E)}),e.qZA()()(),e.TgZ(7,"div",0)(8,"h3"),e._uU(9,"\u767b\u9332\u3055\u308c\u305f\u30c7\u30d0\u30a4\u30b9"),e.qZA(),e.TgZ(10,"div",6),e.YNc(11,rt,4,9,"div",7),e.qZA()(),e.TgZ(12,"div")(13,"div",8)(14,"h3"),e._uU(15,"\u91cd\u8981\u5ea6"),e.qZA(),e.TgZ(16,"div",4),e._UZ(17,"app-switch",9),e.qZA()(),e.TgZ(18,"div",8)(19,"h3"),e._uU(20,"\u7a2e\u985e"),e.qZA(),e.TgZ(21,"div",4),e._UZ(22,"app-switch",10)(23,"app-switch",11)(24,"app-switch",12),e.qZA()(),e.TgZ(25,"div",8)(26,"button",13),e.NdJ("click",function(E){return l.onClickUpdateMessaging(E)}),e._uU(27,"\u66f4\u65b0"),e.qZA()()()(),e.TgZ(28,"div",14)(29,"div"),e._uU(30,"Token: "),e.TgZ(31,"div"),e._uU(32),e.qZA()(),e.TgZ(33,"div"),e._uU(34,"GetToken: "),e.YNc(35,Ut,2,2,"div",15),e.qZA(),e.TgZ(36,"div"),e._uU(37,"TokenChanges: "),e.YNc(38,Qt,2,2,"div",15),e.qZA(),e.TgZ(39,"div"),e._uU(40,"TokenReceived: "),e.YNc(41,Ht,2,2,"div",15),e.qZA(),e.TgZ(42,"div")(43,"div")(44,"label"),e._uU(45,"Topic: "),e.TgZ(46,"input",16),e.NdJ("ngModelChange",function(E){return l.debugObservable.topicText=E}),e.qZA()(),e.TgZ(47,"button",17),e.NdJ("click",function(E){return l.onClickSubscribeTopic(E)}),e._uU(48,"subscribe"),e.qZA(),e.TgZ(49,"button",17),e.NdJ("click",function(E){return l.onClickUnsubscribeTopic(E)}),e._uU(50,"unsubscribe"),e.qZA()(),e.TgZ(51,"div")(52,"label"),e._uU(53,"Post Title: "),e.TgZ(54,"input",16),e.NdJ("ngModelChange",function(E){return l.debugObservable.topicPostText=E}),e.qZA()(),e.TgZ(55,"button",17),e.NdJ("click",function(E){return l.onClickPostToTopic(E)}),e._uU(56,"Post"),e.qZA()(),e.TgZ(57,"div")(58,"label"),e._uU(59,"Condition Topic Post: "),e.TgZ(60,"input",16),e.NdJ("ngModelChange",function(E){return l.debugObservable.conditionTopicPostText=E}),e.qZA()(),e.TgZ(61,"button",17),e.NdJ("click",function(E){return l.onClickConditionPostToTopic(E)}),e._uU(62,"CondPost"),e.qZA()()()(),e.TgZ(63,"div")(64,"button",18),e.NdJ("click",function(E){return l.onClickClearMessages(E)}),e._uU(65,"Clear"),e.qZA(),e.TgZ(66,"div"),e._uU(67,"Messages: "),e.YNc(68,Lt,3,3,"div",15),e.qZA()()),2&s&&(e.xp6(3),e.Q6J("formGroup",l.mainForm),e.xp6(3),e.Q6J("parentForm",l.mainForm),e.xp6(5),e.Q6J("ngForOf",l.devices),e.xp6(6),e.Q6J("parentForm",l.mainForm),e.xp6(5),e.Q6J("parentForm",l.mainForm),e.xp6(),e.Q6J("parentForm",l.mainForm),e.xp6(),e.Q6J("parentForm",l.mainForm),e.xp6(2),e.Q6J("disabled",l.configArray.invalid||!l.configArray.dirty),e.xp6(6),e.Oqu(l.debugObservable.registeredToken),e.xp6(3),e.Q6J("ngForOf",l.debugObservable.getToken),e.xp6(3),e.Q6J("ngForOf",l.debugObservable.tokenChanges),e.xp6(3),e.Q6J("ngForOf",l.debugObservable.tokenReceived),e.xp6(5),e.Q6J("ngModel",l.debugObservable.topicText),e.xp6(8),e.Q6J("ngModel",l.debugObservable.topicPostText),e.xp6(6),e.Q6J("ngModel",l.debugObservable.conditionTopicPostText),e.xp6(8),e.Q6J("ngForOf",l.debugObservable.messages))},dependencies:[F.sg,F.O5,r.Fj,r.JJ,r.JL,r.On,r.sg,jt,F.Ts,F.uU]})}return d})();const Ye=["protectedSettings"],$t=["imageBox"];function Ct(d,M){1&d&&e._uU(0,"\u753b\u50cf\u304c\u3042\u308a\u307e\u305b\u3093")}function Ue(d,M){if(1&d&&e._UZ(0,"img",39),2&d){const i=e.oxw().ngIf;e.s9C("src",i.photoURL,e.LSH)}}function yt(d,M){if(1&d){const i=e.EpF();e.ynx(0),e.TgZ(1,"span",40),e._uU(2," -> "),e.qZA(),e.TgZ(3,"label",8),e._uU(4,"\u65b0\u3057\u3044\u753b\u50cf"),e.qZA(),e._UZ(5,"img",41),e.TgZ(6,"button",42),e.NdJ("click",function(l){const E=e.CHM(i).ngIf,ae=e.oxw(2);return e.KtG(ae.onClickOkImage(l,E))}),e._uU(7,"\u78ba\u5b9a"),e.qZA(),e.BQk()}if(2&d){const i=M.ngIf;e.xp6(5),e.s9C("src",i,e.LSH)}}function Ze(d,M){1&d&&e._UZ(0,"div",43)}function bt(d,M){if(1&d&&(e.TgZ(0,"div",43),e._uU(1),e.qZA()),2&d){const i=e.oxw(3);e.xp6(),e.hij("\u6b8b\u308a ",i.nicknameResult.changesRemain," \u56de \u5909\u66f4\u3067\u304d\u307e\u3059\u3002")}}function lt(d,M){1&d&&(e.TgZ(0,"div",45),e._uU(1,"\u3053\u308c\u4ee5\u4e0a\u306f\u5909\u66f4\u3067\u304d\u307e\u305b\u3093\u3002"),e.qZA())}function dt(d,M){if(1&d&&(e.ynx(0),e.YNc(1,bt,2,1,"div",19)(2,lt,2,0,"div",44),e.BQk()),2&d){const i=e.oxw(2);e.xp6(),e.Q6J("ngIf",i.nicknameResult.changesRemain>0),e.xp6(),e.Q6J("ngIf",0===i.nicknameResult.changesRemain)}}function it(d,M){1&d&&(e.TgZ(0,"div",45),e._uU(1,"\u5165\u529b\u5fc5\u9808\u3067\u3059\u3002"),e.qZA())}function Tt(d,M){1&d&&(e.TgZ(0,"div",45),e._uU(1,"\u9577\u3059\u304e\u307e\u3059\u3002"),e.qZA())}function pt(d,M){1&d&&(e.TgZ(0,"div",45),e._uU(1,"\u77ed\u3059\u304e\u307e\u3059\u3002"),e.qZA())}function ht(d,M){if(1&d&&(e.ynx(0),e.YNc(1,it,2,0,"div",44)(2,Tt,2,0,"div",44)(3,pt,2,0,"div",44),e.BQk()),2&d){const i=e.oxw(2);e.xp6(),e.Q6J("ngIf",null==i.nicknameControl.errors?null:i.nicknameControl.errors.required),e.xp6(),e.Q6J("ngIf",null==i.nicknameControl.errors?null:i.nicknameControl.errors.maxlength),e.xp6(),e.Q6J("ngIf",null==i.nicknameControl.errors?null:i.nicknameControl.errors.minlength)}}function ke(d,M){1&d&&e._UZ(0,"div",43)}function ft(d,M){1&d&&(e.TgZ(0,"div",45),e._uU(1,"\u9577\u3059\u304e\u307e\u3059\u3002"),e.qZA())}function Ft(d,M){if(1&d&&(e.ynx(0),e.YNc(1,ft,2,0,"div",44),e.BQk()),2&d){const i=e.oxw(2);e.xp6(),e.Q6J("ngIf",null==i.aboutControl.errors?null:i.aboutControl.errors.maxlength)}}function St(d,M){if(1&d&&(e.ynx(0),e._UZ(1,"hr")(2,"gitfire-user-notification",46),e.BQk()),2&d){const i=e.oxw(2);e.xp6(2),e.Q6J("mainForm",i.notificationForm)("userPrivStore$",i.userPrivate$)}}function Dt(d,M){1&d&&e._UZ(0,"div",43)}function Gt(d,M){1&d&&(e.TgZ(0,"div",45),e._uU(1,"E \u30e1\u30fc\u30eb\u306f\u5fc5\u9808\u3067\u3059\u3002"),e.qZA())}function ve(d,M){1&d&&(e.TgZ(0,"div",45),e._uU(1,"E \u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044\u3002"),e.qZA())}function At(d,M){if(1&d&&(e.ynx(0),e.YNc(1,Gt,2,0,"div",44)(2,ve,2,0,"div",44),e.BQk()),2&d){const i=e.oxw(2);e.xp6(),e.Q6J("ngIf",null==i.emailControl.errors?null:i.emailControl.errors.required),e.xp6(),e.Q6J("ngIf",(null==i.emailControl.errors?null:i.emailControl.errors.minlength)||(null==i.emailControl.errors?null:i.emailControl.errors.maxlength))}}function Pt(d,M){1&d&&(e.TgZ(0,"div",43),e._uU(1,"\u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u5f37\u5ea6\u306f\u5145\u5206\u306b\u3057\u3066\u304f\u3060\u3055\u3044\u3002"),e.qZA())}function et(d,M){1&d&&(e.TgZ(0,"div",45),e._uU(1,"\u30d1\u30b9\u30ef\u30fc\u30c9\u306f\u5fc5\u9808\u3067\u3059\u3002"),e.qZA())}function wt(d,M){1&d&&(e.TgZ(0,"div",45),e._uU(1,"\u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u9577\u3055\u304c\u8db3\u308a\u307e\u305b\u3093\u3002"),e.qZA())}function Wt(d,M){if(1&d&&(e.ynx(0),e.YNc(1,et,2,0,"div",44)(2,wt,2,0,"div",44),e.BQk()),2&d){const i=e.oxw(2);e.xp6(),e.Q6J("ngIf",null==i.passwordControl.errors?null:i.passwordControl.errors.required),e.xp6(),e.Q6J("ngIf",null==i.passwordControl.errors?null:i.passwordControl.errors.minlength)}}const Et=()=>["(\u5371\u967a)","(\u5f31\u3044)","(\u666e\u901a)","(\u5f37\u3044)","(\u5145\u5206\u306b\u5b89\u5168)"],Ot=()=>["#DD2C00","#FF6D00","#FFD600","#AEEA00","#00C853"];function qt(d,M){if(1&d){const i=e.EpF();e.ynx(0),e.TgZ(1,"div",1)(2,"form",2,3)(4,"h2",4),e._uU(5,"\u516c\u958b\u8a2d\u5b9a"),e._UZ(6,"img",5),e.qZA(),e.TgZ(7,"div")(8,"div",6)(9,"div",7)(10,"label",8),e._uU(11,"\u73fe\u5728\u306e\u753b\u50cf"),e.qZA(),e.YNc(12,Ct,1,0,"ng-template",null,9,e.W1O)(14,Ue,1,1,"img",10)(15,yt,8,1,"ng-container",0),e.ALo(16,"async"),e.qZA(),e.TgZ(17,"div",11),e._UZ(18,"input",12,13),e.TgZ(20,"button",14),e.NdJ("click",function(l){e.CHM(i);const y=e.oxw();return e.KtG(y.onClickUploadImage(l))}),e._uU(21,"Upload"),e.qZA()()(),e.TgZ(22,"div",15)(23,"label",16),e._uU(24,"\u30cb\u30c3\u30af\u30cd\u30fc\u30e0"),e._UZ(25,"img",17),e.qZA(),e._UZ(26,"input",18),e.TgZ(27,"button",14),e.NdJ("click",function(l){e.CHM(i);const y=e.oxw();return e.KtG(y.onClickUpdateNickname(l))}),e._uU(28,"\u66f4\u65b0"),e.qZA()(),e.YNc(29,Ze,1,0,"div",19)(30,dt,3,2,"ng-container",0)(31,ht,4,3,"ng-container",0),e.TgZ(32,"div",15)(33,"label",16),e._uU(34,"\u81ea\u5df1\u7d39\u4ecb"),e._UZ(35,"img",20),e.qZA(),e._UZ(36,"textarea",21),e.TgZ(37,"button",22),e.NdJ("click",function(l){e.CHM(i);const y=e.oxw();return e.KtG(y.onClickUpdateAbout(l))}),e._uU(38,"\u66f4\u65b0"),e.qZA()()(),e.YNc(39,ke,1,0,"div",19)(40,Ft,2,1,"ng-container",0)(41,St,3,2,"ng-container",0),e._UZ(42,"hr"),e.TgZ(43,"a",23),e.NdJ("click",function(l){e.CHM(i);const y=e.oxw();return e.KtG(y.onClickImportant(l))}),e._uU(44),e.qZA(),e.TgZ(45,"div",24,25)(47,"div",26)(48,"label",27),e._uU(49,"\u540d\u524d"),e._UZ(50,"img",28),e.qZA(),e._UZ(51,"input",29),e.qZA(),e.TgZ(52,"div",26)(53,"label",27),e._uU(54,"Email"),e._UZ(55,"img",30),e.qZA(),e._UZ(56,"input",31),e.TgZ(57,"button",32),e.NdJ("click",function(l){e.CHM(i);const y=e.oxw();return e.KtG(y.onClickUpdateEmail(l))}),e._uU(58,"\u66f4\u65b0"),e.qZA(),e.YNc(59,Dt,1,0,"div",19)(60,At,3,2,"ng-container",0),e.qZA(),e.TgZ(61,"div",26)(62,"label",27),e._uU(63,"Password"),e._UZ(64,"img",33),e.qZA(),e._UZ(65,"input",34),e.TgZ(66,"button",32),e.NdJ("click",function(l){e.CHM(i);const y=e.oxw();return e.KtG(y.onClickUpdatePassword(l))}),e._uU(67,"\u66f4\u65b0"),e.qZA(),e._UZ(68,"ng9-password-strength-bar",35),e.ALo(69,"async"),e.YNc(70,Pt,2,0,"div",19)(71,Wt,3,2,"ng-container",0),e.qZA(),e.TgZ(72,"h3",36),e._uU(73,"\u30a2\u30ab\u30a6\u30f3\u30c8\u306e\u7d42\u4e86"),e.qZA(),e.TgZ(74,"div",37)(75,"button",38),e.NdJ("click",function(l){e.CHM(i);const y=e.oxw();return e.KtG(y.onClickDeleteAccount(l))}),e._uU(76,"\u30a2\u30ab\u30a6\u30f3\u30c8\u3092\u524a\u9664"),e.qZA()()()()(),e.BQk()}if(2&d){const i=M.ngIf,s=e.MAs(13),l=e.oxw();e.xp6(2),e.Q6J("formGroup",l.inputForm),e.xp6(12),e.Q6J("ngIf",i.photoURL)("ngIfElse",s),e.xp6(),e.Q6J("ngIf",e.lcZ(16,35,l.profileTempImage$)),e.xp6(5),e.Q6J("disabled",l.userIconControl.invalid||!l.userIconControl.dirty),e.xp6(2),e.ekj("was-validated",l.nicknameControl.dirty||l.nicknameControl.touched),e.xp6(5),e.Q6J("disabled",l.nicknameControl.invalid||!l.nicknameControl.dirty),e.xp6(2),e.Q6J("ngIf",!l.nicknameControl.invalid),e.xp6(),e.Q6J("ngIf",l.nicknameResult),e.xp6(),e.Q6J("ngIf",l.nicknameControl.invalid),e.xp6(),e.ekj("was-validated",l.aboutControl.dirty||l.aboutControl.touched),e.xp6(5),e.Q6J("disabled",l.aboutControl.invalid||!l.aboutControl.dirty),e.xp6(2),e.Q6J("ngIf",!l.aboutControl.invalid),e.xp6(),e.Q6J("ngIf",l.aboutControl.invalid),e.xp6(),e.Q6J("ngIf",l.auth.isDeveloper),e.xp6(3),e.Oqu(l.isOpenOther?"\u518d\u8a8d\u8a3c":"\u305d\u306e\u4ed6\u306e\u8a2d\u5b9a"),e.xp6(7),e.Q6J("value",i.displayName),e.xp6(),e.ekj("was-validated",l.emailControl.dirty||l.emailControl.touched),e.xp6(5),e.Q6J("disabled",l.emailControl.invalid||!l.emailControl.dirty),e.xp6(2),e.Q6J("ngIf",!l.emailControl.invalid),e.xp6(),e.Q6J("ngIf",l.emailControl.invalid),e.xp6(),e.ekj("was-validated",l.passwordControl.dirty||l.passwordControl.touched),e.xp6(5),e.Q6J("disabled",!l.passwordControl.value||l.passwordControl.invalid||!l.passwordControl.dirty),e.xp6(2),e.Udp("display",""===l.passwordControl.value?"none":null),e.Q6J("passwordToCheck",e.lcZ(69,37,l.passwordControl.valueChanges))("barLabel","\u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u5f37\u5ea6(\u76ee\u5b89): ")("strengthLabels",e.DdM(39,Et))("barColors",e.DdM(40,Ot)),e.xp6(2),e.Q6J("ngIf",!l.passwordControl.invalid),e.xp6(),e.Q6J("ngIf",l.passwordControl.invalid)}}let It=(()=>{class d{auth;storage;funcs;store;toastr;router;dialog;localSession;destroy$=new _.x;currentUser;currentUser$;userPublic;userPrivate$=new _.x;profileTempImage$;inputForm;notificationForm;isOpenOther=!1;nicknameResult=null;protectedSettings;imageBox;pubUser;privUser;nicknameIndex;constructor(i,s,l,y,E,ae,ze,Ke){this.auth=i,this.storage=s,this.funcs=l,this.store=y,this.toastr=E,this.router=ae,this.dialog=ze,this.localSession=Ke,this.pubUser=this.store.collection("/users/v1/public"),this.privUser=this.store.collection("/users/v1/protected"),this.nicknameIndex=this.store.collection("/index/users/usernick"),this.currentUser$=this.auth.clientSideUser$,this.currentUser$.pipe((0,S.R)(this.destroy$)).subscribe(Ge=>{this.currentUser=Ge})}ngOnInit(){this.inputForm=new r.cw({}),this.inputForm.addControl("userIcon",new r.NI("",[r.kI.required])),this.inputForm.addControl("email",new r.NI({value:"",disabled:!1},[r.kI.required])),this.inputForm.addControl("password",new r.NI("",[])),this.inputForm.addControl("nickname",new r.NI({value:"",disabled:!0},[r.kI.required])),this.inputForm.addControl("about",new r.NI({value:"",disabled:!0},[])),this.notificationForm=new r.cw({}),this.inputForm.addControl("messaging",this.notificationForm)}ngAfterViewInit(){const i=this.currentUser$.pipe((0,R.q)(1),(0,P.h)(s=>!!s));i.pipe((0,fe.w)(s=>this.pubUser.doc(s.uid).valueChanges()),(0,S.R)(this.destroy$)).subscribe(s=>{this.userPublic=s,$(this.aboutControl,s.about),this.aboutControl.enable(),$(this.nicknameControl,s.nickname),this.nicknameControl.enable()}),i.pipe((0,fe.w)(s=>this.privUser.doc(s.uid).valueChanges()),(0,S.R)(this.destroy$)).subscribe(s=>{this.userPrivate$.next(s)}),i.pipe((0,S.R)(this.destroy$)).subscribe(s=>{this.emailControl.setValue(s.email)})}ngOnDestroy(){this.destroy$.next()}get emailControl(){return this.inputForm.get("email")}get passwordControl(){return this.inputForm.get("password")}get aboutControl(){return this.inputForm.get("about")}get nicknameControl(){return this.inputForm.get("nickname")}get userIconControl(){return this.inputForm.get("userIcon")}onClickDeleteAccount(i){this.dialog.createDefaultBuilder().prepareBody(te).setType(q.iR.Warn).setSize(q.PW.Default).setTitle("\u6700\u7d42\u78ba\u8a8d").okButton(()=>{this.doDeleteAccount()}).cancelButton(()=>{}).open()}doDeleteAccount(){var i=this;return(0,L.Z)(function*(){try{yield i.currentUser.delete(),(0,m.eM)("Account is deleted")}catch(l){(0,m.wb)("Error while delete account",l);const y=l instanceof Error?l.message:"Unknown error";return void i.toastr.error(`\u30a2\u30ab\u30a6\u30f3\u30c8\u3092\u524a\u9664\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002 ( ${y} )`)}i.localSession.unmarkLogin(),i.router.navigate(["/"])})()}updateError(i,s){(0,m.wb)(`Error while update tag:${i}`,s);const l=s instanceof Error?s.message:"Unknown error";this.toastr.error(`${i} \u306e\u66f4\u65b0\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002 ( ${l} )`)}updateSucceeded(i,s){this.toastr.success(`${i} \u3092 "${s}" \u306b\u66f4\u65b0\u3057\u307e\u3057\u305f\u3002`)}updateProfileImage(i){var s=this;return(0,L.Z)(function*(){if(""===i)return;const l="\u30d7\u30ed\u30d5\u30a3\u30fc\u30eb\u753b\u50cf";try{yield s.currentUser.updateProfile({photoURL:i});const E={photoURL:i,updatedAt:_e.Z.firestore.FieldValue.serverTimestamp()};yield s.pubUser.doc(s.currentUser.uid).update(E),s.updateSucceeded(l,"Upload \u3057\u305f\u753b\u50cf"),s.getProfileRef("temp_profile").delete(),s.profileTempImage$=null,s.userIconControl.setValue(""),D(s.userIconControl)}catch(y){s.updateError(l,y)}})()}onClickUpdateNickname(i){var s=this;return(0,L.Z)(function*(){if(s.nicknameControl.invalid)return;const l=s.nicknameControl.value;if(l===s.userPublic.nickname)return;const y="\u30cb\u30c3\u30af\u30cd\u30fc\u30e0";try{const E={nickname:l};s.nicknameResult=yield s.funcs.call("updateNickname",E),s.updateSucceeded(y,l),D(s.nicknameControl)}catch(E){s.updateError(y,E)}})()}onClickUpdateAbout(i){var s=this;return(0,L.Z)(function*(){if(s.aboutControl.invalid)return;const l=s.aboutControl.value;if(l===s.userPublic.about)return;const y="\u81ea\u5df1\u7d39\u4ecb";try{const E={about:l};yield s.funcs.call("updateAbout",E),s.updateSucceeded(y,l),D(s.aboutControl)}catch(E){s.updateError(y,E)}})()}onClickUpdateEmail(i){var s=this;return(0,L.Z)(function*(){if(s.emailControl.invalid)return;const l=s.emailControl.value;l!==s.currentUser.email&&s.dialog.createSimpleBuilder().setType(q.iR.Warn).setSize(q.PW.Default).setMessage("\u767b\u9332\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u3092\u5909\u66f4\u3057\u307e\u3059\u3002\u3088\u308d\u3057\u3044\u3067\u3059\u304b\uff1f").setTitle("\u78ba\u8a8d").okButton(()=>{s.doChangeEmail(l)}).cancelButton(()=>{}).open()})()}doChangeEmail(i){var s=this;return(0,L.Z)(function*(){const l="Email";try{yield s.currentUser.updateEmail(i),yield s.currentUser.sendEmailVerification(),s.updateSucceeded(l,i),D(s.emailControl),s.toastr.info("\u78ba\u8a8d\u306e\u30e1\u30fc\u30eb\u3092\u9001\u4fe1\u3057\u307e\u3057\u305f\u3002")}catch(y){s.updateError(l,y)}})()}onClickUpdatePassword(i){var s=this;return(0,L.Z)(function*(){if(s.passwordControl.invalid)return;const l=s.passwordControl.value;if(""===l)return;const y="\u30d1\u30b9\u30ef\u30fc\u30c9";try{yield s.currentUser.updatePassword(l),s.updateSucceeded(y,"********"),D(s.passwordControl)}catch(E){s.updateError(y,E)}finally{s.passwordControl.setValue("")}})()}listProvider(){}ensureImageFile(){const i=this.imageBox.nativeElement;if(0===i.files.length)return this.toastr.error("\u30d5\u30a1\u30a4\u30eb\u3092\u9078\u629e\u3057\u3066\u304f\u3060\u3055\u3044\u3002"),null;const s=i.files[0];return s.size>=524288?(this.toastr.error("\u30d5\u30a1\u30a4\u30eb\u306e\u30b5\u30a4\u30ba\u304c\u5927\u304d\u3059\u304e\u307e\u3059\u3002(\u7d04 500kb \u307e\u3067)"),null):s}getProfileRef(i){return this.storage.ref(`/image/${this.currentUser.uid}/profile/${i}`)}onClickUploadImage(i){var s=this;return(0,L.Z)(function*(){const l=s.ensureImageFile();if(!l)return;const y=yield s.uploadProfileImage("temp_profile",l);s.profileTempImage$=y.ref.getDownloadURL()})()}uploadProfileImage(i,s){var l=this;return(0,L.Z)(function*(){return yield l.getProfileRef(i).put(s)})()}doChangePhoto(i){var s=this;return(0,L.Z)(function*(){const y=yield(yield s.uploadProfileImage("profile",i)).ref.getDownloadURL();s.updateProfileImage(y)})()}initializeReauth(i){i.currentUser=this.currentUser,i.reauthed.subscribe(()=>{new x.UO(this.protectedSettings.nativeElement).show(),this.isOpenOther=!0})}constructReauth(){return i=>{}}onClickImportant(i){(0,m.eM)("onClickImportant()"),this.dialog.createDefaultBuilder().prepareBody(W,l=>this.initializeReauth(l)).setupChild(this.constructReauth()).setType(q.iR.Info).setSize(q.PW.Default).setTitle("\u518d\u8a8d\u8a3c").cancelButton(()=>{}).closeButton(()=>{}).open()}onClickOkImage(i,s){const l=this.ensureImageFile();l&&this.dialog.createSimpleBuilder().setType(q.iR.Info).setSize(q.PW.Default).setMessage("\u753b\u50cf\u306f\u516c\u958b\u3055\u308c\u307e\u3059\u3002\u3088\u308d\u3057\u3044\u3067\u3059\u304b\uff1f").setTitle("\u78ba\u8a8d").okButton(()=>{this.doChangePhoto(l)}).cancelButton(()=>{}).open()}static \u0275fac=function(s){return new(s||d)(e.Y36(re.e),e.Y36(pe.Q1),e.Y36(nt.c),e.Y36(ne.ST),e.Y36(b._W),e.Y36(ot.Z),e.Y36(q.xA),e.Y36(Ve.m))};static \u0275cmp=e.Xpm({type:d,selectors:[["ng-component"]],viewQuery:function(s,l){if(1&s&&(e.Gf(Ye,5),e.Gf($t,5)),2&s){let y;e.iGM(y=e.CRH())&&(l.protectedSettings=y.first),e.iGM(y=e.CRH())&&(l.imageBox=y.first)}},decls:1,vars:1,consts:[[4,"ngIf"],[1,"container"],[3,"formGroup"],["configForm",""],[1,"mb-3"],["title","\u4e00\u822c\u516c\u958b\u3055\u308c\u308b\u60c5\u5831\u3092\u7de8\u96c6\u3067\u304d\u307e\u3059\u3002","src","/assets/octicons/question.svg",1,"m-3","octicon-info","help-icon"],[1,"my-2"],[1,"input-group","my-1"],[1,"visually-hidden"],["noPhoto",""],["class","user-settings-profile-image rounded","alt","Profile \u753b\u50cf",3,"src",4,"ngIf","ngIfElse"],[1,"input-group"],["id","appGitfireInputIconFileInput","name","userIcon","formControlName","userIcon","type","file","placeholder","\u30a2\u30a4\u30b3\u30f3\u3092\u9078\u629e","accept","image/*",1,"form-control"],["imageBox",""],[1,"btn","btn-primary",3,"disabled","click"],[1,"input-group","my-2"],[1,"input-group-text"],["title","\u30e1\u30c3\u30bb\u30fc\u30b8\u4e0a\u306b\u8868\u793a\u3055\u308c\u308b\u3042\u306a\u305f\u306e\u540d\u524d\u3067\u3059\u3002","src","/assets/octicons/question.svg",1,"m-1","octicon-info","help-icon"],["name","nickname","placeholder","\u4f8b: hogehoge1032","formControlName","nickname","autofocus","","type","text","maxlength","19","minlength","4","required","",1,"form-control"],["class","valid-feedback",4,"ngIf"],["title","\u30d5\u30ea\u30fc\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u3067\u3059\u3002","src","/assets/octicons/question.svg",1,"m-1","octicon-info","help-icon"],["name","about","placeholder","\u4f8b: Ingress: kagura2718 (RES) \u30dd\u30b1\u30e2\u30f3go: kagura271(\u8d64)","formControlName","about","maxlength","200","type","text",1,"form-control"],["type","button",1,"btn","btn-primary",3,"disabled","click"],["role","button","aria-expanded","false",1,"btn","btn-secondary","collapsed",3,"click"],["id","appGitfireUserSettingsSecretContainer",1,"collapse","m-3"],["protectedSettings",""],[1,"row","input-group","m-3"],[1,"col-2","text-md-end","col-form-label"],["title","\u8a8d\u8a3c\u30d7\u30ed\u30d0\u30a4\u30c0\u304b\u3089\u63d0\u4f9b\u3055\u308c\u305f\u540d\u524d\u3067\u3059\u3002(\u975e\u516c\u958b)","src","/assets/octicons/question.svg",1,"m-1","octicon-info","help-icon"],["name","displayname","placeholder","\u4f8b: hogehoge1032","type","text","disabled","",1,"col-10","form-control",3,"value"],["title","\u8a8d\u8a3c\u306b\u4f7f\u308f\u308c\u308b\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u3067\u3059\u3002(\u975e\u516c\u958b)","src","/assets/octicons/question.svg",1,"m-1","octicon-info","help-icon"],["name","email","placeholder","email@example.com","formControlName","email","autocomplete","email","type","email","required","","autofill","","maxlength","1024","minlength","5",1,"col-8","form-control"],[1,"btn","btn-primary","col-2",3,"disabled","click"],["title","\u30ed\u30b0\u30a4\u30f3\u6642\u306e\u30d1\u30b9\u30ef\u30fc\u30c9\u3067\u3059\u3002\u4ed6\u4eba\u306b\u63a8\u6e2c\u3055\u308c\u306a\u3044\u3082\u306e\u3092\u4f7f\u7528\u3057\u3066\u304f\u3060\u3055\u3044\u3002(\u975e\u516c\u958b)","src","/assets/octicons/question.svg",1,"m-1","octicon-info","help-icon"],["name","password","placeholder","\u5909\u66f4\u306a\u3057","formControlName","password","type","password","autocomplete","new-password","maxlength","256","minlength","6",1,"col-8","form-control"],[1,"col-lg-5","col-form-label",3,"passwordToCheck","barLabel","strengthLabels","barColors"],[1,"m-3"],[1,"input-group","m-3"],["tabindex","-1",1,"btn","btn-warning",3,"click"],["alt","Profile \u753b\u50cf",1,"user-settings-profile-image","rounded",3,"src"],[1,"p-3"],["alt","\u65b0\u3057\u3044 Profile \u753b\u50cf",1,"user-settings-profile-image","rounded",3,"src"],[1,"btn","btn-primary",3,"click"],[1,"valid-feedback"],["class","invalid-feedback",4,"ngIf"],[1,"invalid-feedback"],[3,"mainForm","userPrivStore$"]],template:function(s,l){1&s&&e.YNc(0,qt,77,41,"ng-container",0),2&s&&e.Q6J("ngIf",l.currentUser)},dependencies:[F.O5,r._Y,r.Fj,r.JJ,r.JL,r.Q7,r.wO,r.nD,r.sg,r.u,I.e,Kt,F.Ov],styles:[".user-settings-profile-image[_ngcontent-%COMP%]{width:80px;height:80px}.help-icon[_ngcontent-%COMP%]{width:20px;height:20px}"]})}return d})();function st(d,M){if(1&d&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&d){const i=e.oxw().$implicit;e.xp6(),e.hij("URL: ",i.url,"")}}function Vt(d,M){if(1&d&&(e.TgZ(0,"div")(1,"div")(2,"div"),e._uU(3),e.qZA(),e.YNc(4,st,2,1,"div",0),e.TgZ(5,"div"),e._uU(6),e.qZA(),e.TgZ(7,"div"),e._uU(8),e.ALo(9,"date"),e.qZA()(),e._UZ(10,"hr"),e.TgZ(11,"div"),e._uU(12),e.qZA()()),2&d){const i=M.$implicit;e.xp6(3),e.hij("Title: ",i.title,""),e.xp6(),e.Q6J("ngIf",i.url),e.xp6(2),e.hij("Done: ",i.hasRead,""),e.xp6(2),e.hij("Date: ",e.xi3(9,5,i.createdAt.toDate(),"yyyy-MM-dd hh:mm:ss"),""),e.xp6(4),e.Oqu(i.body)}}let Bt=(()=>{class d{auth;route;store;destroy$=new _.x;id$;trayStore;constructor(i,s,l){this.auth=i,this.route=s,this.store=l}ngOnDestroy(){this.destroy$.next()}ngOnInit(){(0,m.eM)("UserTrayMessageComponent.OnInit()",this.route.snapshot),this.id$=this.route.queryParams.pipe((0,P.h)(i=>"id"in i),(0,Se.U)(i=>i.id)),this.id$.pipe((0,fe.w)(i=>(0,$e.a)((0,Ee.of)(i),this.auth.clientSideUser$)),(0,P.h)(([i,s])=>null!==s),(0,fe.w)(([i,s])=>this.store.doc(`/users/v1/protected/${s.uid}/tray/${i}`).valueChanges({idField:"id"}).pipe((0,R.q)(1))),(0,S.R)(this.destroy$)).subscribe(i=>{this.trayStore=i})}static \u0275fac=function(s){return new(s||d)(e.Y36(re.e),e.Y36(U.gz),e.Y36(ne.ST))};static \u0275cmp=e.Xpm({type:d,selectors:[["app-user-tray-message"]],decls:1,vars:1,consts:[[4,"ngIf"]],template:function(s,l){1&s&&e.YNc(0,Vt,13,8,"div",0),2&s&&e.Q6J("ngIf",l.trayStore)},dependencies:[F.O5,F.uU]})}return d})(),c=(()=>{class d{auth;localSession;router;constructor(i,s,l){this.auth=i,this.localSession=s,this.router=l,(0,m.eM)("AuthGuard.constructor")}canActivate(i,s){return this.auth.clientSideUser$.pipe((0,Se.U)(l=>{if((0,m.H_)("AuthGuard",l),l)return!0;const y={queryParams:{redirectPath:s.url}};return(0,m.eM)("auth.guard Prepare to redirect",y),this.router.createUrlTree(["/Gitfire/login"],y)}))}static \u0275fac=function(s){return new(s||d)(e.LFG(re.e),e.LFG(Ve.m),e.LFG(U.F0))};static \u0275prov=e.Yz7({token:d,factory:d.\u0275fac,providedIn:"root"})}return d})(),f=(()=>{class d{auth;localSession;router;constructor(i,s,l){this.auth=i,this.localSession=s,this.router=l}canActivate(i,s){return this.auth.authState.pipe((0,Se.U)(l=>((0,m.H_)("LoginGuard",l),!l||this.router.createUrlTree(["/"]))))}static \u0275fac=function(s){return new(s||d)(e.LFG(me.zQ),e.LFG(Ve.m),e.LFG(U.F0))};static \u0275prov=e.Yz7({token:d,factory:d.\u0275fac,providedIn:"root"})}return d})();const k=[{path:"login.htm",loadChildren:()=>Promise.resolve().then(g.bind(g,3128)).then(d=>d.GitfireLoginModule),data:{mode:"login"},canActivate:[f]},{path:"login",redirectTo:"login.htm"},{path:"signup.htm",loadChildren:()=>Promise.resolve().then(g.bind(g,3128)).then(d=>d.GitfireLoginModule),data:{mode:"signup"},canActivate:[f]},{path:"signup",redirectTo:"signup.htm"},{path:"reset.htm",loadChildren:()=>Promise.resolve().then(g.bind(g,3128)).then(d=>d.GitfireLoginModule),data:{mode:"reset"}},{path:"reset",redirectTo:"reset.htm"},{path:"chat.htm",loadChildren:()=>Promise.all([g.e(592),g.e(918)]).then(g.bind(g,5918)).then(d=>d.GitfireChatModule),canActivate:[c]},{path:"chat",redirectTo:"chat.htm"},{path:"post.htm",loadChildren:()=>g.e(284).then(g.bind(g,3284)).then(d=>d.GitfirePostModule),canActivate:[c]},{path:"post",redirectTo:"post.htm"},{path:"settings.htm",component:It,canActivate:[c]},{path:"settings",redirectTo:"settings.htm"},{path:"tray.htm",component:Bt,canActivate:[c]},{path:"tray",redirectTo:"tray.htm"}];let B=(()=>{class d{static \u0275fac=function(s){return new(s||d)};static \u0275mod=e.oAB({type:d});static \u0275inj=e.cJS({imports:[U.Bz.forChild(k),U.Bz]})}return d})();var j=g(3128),J=g(1134),ie=g(6450),at=g(7910);let tt=(()=>{class d{static \u0275fac=function(s){return new(s||d)};static \u0275mod=e.oAB({type:d});static \u0275inj=e.cJS({providers:[at.K,ie.F],imports:[F.ez,r.u5,r.UX,J.M]})}return d})();var gt=g(5101);let xt=(()=>{class d{constructor(){(0,m.H_)("Dynamically loaded GitfireModule")}static \u0275fac=function(s){return new(s||d)};static \u0275mod=e.oAB({type:d});static \u0275inj=e.cJS({providers:[b._W,re.e,c,f,nt.c,{provide:de.Xz,useValue:m.NZ.FirebaseCloudFunctionsRegion},{provide:ee,useValue:m.NZ.firebaseVapidKey}],imports:[F.ez,r.u5,r.UX,B,j.GitfireLoginModule,tt,I._,b.Rh.forRoot(m.NZ.toastrConfig),K.hO.initializeApp(m.NZ.firebaseConfig),ne.yb,me.ww,pe.TE,de.Qv,A,gt.R]})}return d})()},3128:(Jt,De,g)=>{g.r(De),g.d(De,{GitfireLoginModule:()=>U});var F=g(6814),r=g(5739),K=g(7217),de=g(5579),ne=g(434),me=g(2425),pe=g(5187),L=g(553),e=g(9212),Xe=g(8645),we=g(8337);let Ee=(()=>{class _{router;destroy$=new Xe.x;constructor(R){this.router=R}ngOnInit(){(0,L.eM)("LoginComponent.OnInit()")}ngOnDestroy(){this.destroy$.next()}static \u0275fac=function(P){return new(P||_)(e.Y36(pe.F0))};static \u0275cmp=e.Xpm({type:_,selectors:[["gitfire-login"]],decls:12,vars:1,consts:[[1,"h3","mb-3","fw-normal"],[3,"isLogin"],["routerLink","/Gitfire/signup"],["routerLink","/Gitfire/reset"],["routerLink","/"]],template:function(P,m){1&P&&(e.TgZ(0,"h1",0),e._uU(1,"\u30ed\u30b0\u30a4\u30f3\u60c5\u5831"),e.qZA(),e._UZ(2,"gitfire-login-input-auth",1),e.TgZ(3,"div")(4,"a",2),e._uU(5,"\u30a2\u30ab\u30a6\u30f3\u30c8\u3092\u4f5c\u6210\u3059\u308b"),e.qZA()(),e.TgZ(6,"div")(7,"a",3),e._uU(8,"\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u5fd8\u308c\u305f\u5834\u5408"),e.qZA()(),e.TgZ(9,"div")(10,"a",4),e._uU(11,"Top"),e.qZA()()),2&P&&(e.xp6(2),e.Q6J("isLogin",!0))},dependencies:[pe.rH,we.InputAuthComponent]})}return _})();var he=g(3867);const Pe=["app-cookie-confirm",""];function We(_,S){if(1&_){const R=e.EpF();e.TgZ(0,"button",4),e.NdJ("click",function(){e.CHM(R);const m=e.oxw();return e.KtG(m.remove())}),e.TgZ(1,"span",5),e._uU(2,"\xd7"),e.qZA()()}}let le=(()=>{class _ extends me.FN{toastr;toastPackage;localSession;constructor(R,P,m){super(R,P),this.toastr=R,this.toastPackage=P,this.localSession=m}ngOnInit(){(0,L.eM)("CookieConfirmComponent.OnInit()")}onClickDeny(R){this.localSession.declineAccess(),this.remove()}onClickGrant(R){this.localSession.grantAccess(),this.remove()}static \u0275fac=function(P){return new(P||_)(e.Y36(me._W),e.Y36(me.PR),e.Y36(he.m))};static \u0275cmp=e.Xpm({type:_,selectors:[["","app-cookie-confirm",""]],features:[e.qOj],attrs:Pe,decls:12,vars:4,consts:[["class","toast-close-button","aria-label","Close",3,"click",4,"ngIf"],["role","alertdialog","aria-live","polite"],["href","/terms.htm"],[1,"btn","btn-outline-primary",3,"click"],["aria-label","Close",1,"toast-close-button",3,"click"],["aria-hidden","true"]],template:function(P,m){1&P&&(e.YNc(0,We,3,0,"button",0),e.TgZ(1,"div",1)(2,"p"),e._uU(3,"\u5f53\u30b5\u30a4\u30c8\u3067\u306f\u5229\u7528\u8005\u306e\u5229\u4fbf\u6027\u306e\u305f\u3081\u306b\u30af\u30c3\u30ad\u30fc (Cookies) \u3092\u4f7f\u7528\u3057\u307e\u3059\u3002\u8a73\u3057\u304f\u306f"),e.TgZ(4,"a",2),e._uU(5," [\u5229\u7528\u898f\u7d04] "),e.qZA(),e._uU(6,"\u3092\u3054\u89a7\u304f\u3060\u3055\u3044\u3002"),e.qZA(),e.TgZ(7,"div")(8,"button",3),e.NdJ("click",function(ce){return m.onClickGrant(ce)}),e._uU(9,"\u8a31\u53ef\u3059\u308b"),e.qZA(),e.TgZ(10,"button",3),e.NdJ("click",function(ce){return m.onClickDeny(ce)}),e._uU(11,"\u62d2\u5426\u3059\u308b"),e.qZA()()()),2&P&&(e.Q6J("ngIf",m.options.closeButton),e.xp6(),e.Tol(m.options.messageClass),e.uIk("aria-label",m.message))},styles:["[_nghost-%COMP%]{background:#eefef0;width:100%;height:100%}a[_ngcontent-%COMP%]:link{color:red}a[_ngcontent-%COMP%]:visited{color:#a00}a[_ngcontent-%COMP%]:hover{color:red}a[_ngcontent-%COMP%]:active{color:#ff8000}"]})}return _})(),ue=(()=>{class _{toastr;localSession;constructor(R,P){this.toastr=R,this.localSession=P}ngOnInit(){(0,L.eM)("SignupComponent.OnInit()")}ngAfterViewInit(){this.maybeConfirm()}maybeConfirm(){this.localSession.shouldConfirm()&&this.toastr.info(void 0,void 0,{toastComponent:le,disableTimeOut:!0,tapToDismiss:!1,preventDuplicates:!0})}static \u0275fac=function(P){return new(P||_)(e.Y36(me._W),e.Y36(he.m))};static \u0275cmp=e.Xpm({type:_,selectors:[["gitfire-signup"]],decls:9,vars:1,consts:[[1,"h3","mb-3","fw-normal"],[3,"isSignup"],["routerLink","/Gitfire/login"],["routerLink","/"]],template:function(P,m){1&P&&(e.TgZ(0,"h1",0),e._uU(1,"\u30a2\u30ab\u30a6\u30f3\u30c8\u306e\u4f5c\u6210"),e.qZA(),e._UZ(2,"gitfire-login-input-auth",1),e.TgZ(3,"div")(4,"a",2),e._uU(5,"\u30ed\u30b0\u30a4\u30f3"),e.qZA()(),e.TgZ(6,"div")(7,"a",3),e._uU(8,"Top"),e.qZA()()),2&P&&(e.xp6(2),e.Q6J("isSignup",!0))},dependencies:[pe.rH,we.InputAuthComponent]})}return _})();var fe=g(5861),Se=g(7319),z=g(103);const Q=["resetForm"];function Ne(_,S){1&_&&(e.TgZ(0,"div",11),e._uU(1,"E \u30e1\u30fc\u30eb\u306f\u5fc5\u9808\u3067\u3059\u3002"),e.qZA())}function Oe(_,S){1&_&&(e.TgZ(0,"div",11),e._uU(1,"E \u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044\u3002"),e.qZA())}function ct(_,S){if(1&_&&(e.ynx(0),e.YNc(1,Ne,2,0,"div",10)(2,Oe,2,0,"div",10),e.BQk()),2&_){e.oxw();const R=e.MAs(6);e.xp6(),e.Q6J("ngIf",null==R.errors?null:R.errors.required),e.xp6(),e.Q6J("ngIf",null==R.errors?null:R.errors.minlength)}}let _e=(()=>{class _{auth;dialog;toastr;emailInput="";resetForm;constructor(R,P,m){this.auth=R,this.dialog=P,this.toastr=m}ngOnInit(){(0,L.eM)("ResetPasswordComponent.OnInit()")}onClickReset(R){this.dialog.createSimpleBuilder().setType(Se.iR.Warn).setSize(Se.PW.Default).setTitle("\u78ba\u8a8d").setMessage(`\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u306f\u6b63\u3057\u3044\u3067\u3059\u304b\uff1f ${this.emailInput}`).okButton(()=>{this.tryResetPassword(this.emailInput)}).cancelButton(()=>{}).open()}tryResetPassword(R){var P=this;return(0,fe.Z)(function*(){try{yield P.auth.sendPasswordResetEmail(R),P.toastr.info("\u30e1\u30fc\u30eb\u3092\u9001\u4fe1\u3057\u307e\u3057\u305f\u3002")}catch(m){(0,L.wb)("Error while sent reset mail",m),Error,P.toastr.error("\u5931\u6557\u3057\u307e\u3057\u305f\u3002( ${errmsg} )")}})()}static \u0275fac=function(P){return new(P||_)(e.Y36(ne.zQ),e.Y36(z.xA),e.Y36(me._W))};static \u0275cmp=e.Xpm({type:_,selectors:[["gitfire-login-reset-password"]],viewQuery:function(P,m){if(1&P&&e.Gf(Q,5),2&P){let q;e.iGM(q=e.CRH())&&(m.resetForm=q.first)}},decls:19,vars:5,consts:[["resetForm",""],[1,"row","p-3"],[1,"visually-hidden"],["autofocus","","type","email","name","email","placeholder","Email address","required","","autofill","","maxlength","1024","minlength","5",1,"form-control","col-8",3,"ngModel","ngModelChange"],["email","ngModel"],[1,"btn","btn-warning",3,"disabled","click"],[4,"ngIf"],["routerLink","/"],["routerLink","/Gitfire/signup"],["routerLink","/Gitfire/login"],["class","invalid-feedback",4,"ngIf"],[1,"invalid-feedback"]],template:function(P,m){if(1&P&&(e.TgZ(0,"form",null,0)(2,"div",1)(3,"label",2),e._uU(4,"Email"),e.qZA(),e.TgZ(5,"input",3,4),e.NdJ("ngModelChange",function(ce){return m.emailInput=ce}),e.qZA(),e.TgZ(7,"button",5),e.NdJ("click",function(ce){return m.onClickReset(ce)}),e._uU(8,"\u30d1\u30b9\u30ef\u30fc\u30c9\u30ea\u30bb\u30c3\u30c8"),e.qZA(),e.YNc(9,ct,3,2,"ng-container",6),e.qZA()(),e.TgZ(10,"div")(11,"a",7),e._uU(12,"Top"),e.qZA()(),e.TgZ(13,"div")(14,"a",8),e._uU(15,"\u30a2\u30ab\u30a6\u30f3\u30c8\u3092\u4f5c\u6210\u3059\u308b"),e.qZA()(),e.TgZ(16,"div")(17,"a",9),e._uU(18,"\u30ed\u30b0\u30a4\u30f3"),e.qZA()()),2&P){const q=e.MAs(6);e.xp6(2),e.ekj("was-validated",q.dirty||q.touched),e.xp6(3),e.Q6J("ngModel",m.emailInput),e.xp6(2),e.Q6J("disabled",!q.valid),e.xp6(2),e.Q6J("ngIf",q.invalid)}},dependencies:[F.O5,r._Y,r.Fj,r.JJ,r.JL,r.Q7,r.wO,r.nD,r.On,r.F,pe.rH]})}return _})();function je(_,S){1&_&&e._UZ(0,"gitfire-signup")}function ee(_,S){1&_&&e._UZ(0,"gitfire-login")}function Le(_,S){1&_&&e._UZ(0,"gitfire-login-reset-password")}const A=[{path:"",component:(()=>{class _{route;mode;constructor(R){this.route=R,this.mode=R.snapshot.data.mode}ngOnInit(){(0,L.eM)("LoginRouterComponent.OnInit()")}static \u0275fac=function(P){return new(P||_)(e.Y36(pe.gz))};static \u0275cmp=e.Xpm({type:_,selectors:[["ng-component"]],decls:4,vars:4,consts:[[3,"ngSwitch"],[4,"ngSwitchCase"]],template:function(P,m){1&P&&(e.ynx(0,0),e.YNc(1,je,1,0,"gitfire-signup",1)(2,ee,1,0,"gitfire-login",1)(3,Le,1,0,"gitfire-login-reset-password",1),e.BQk()),2&P&&(e.Q6J("ngSwitch",m.mode),e.xp6(),e.Q6J("ngSwitchCase","signup"),e.xp6(),e.Q6J("ngSwitchCase","login"),e.xp6(),e.Q6J("ngSwitchCase","reset"))},dependencies:[F.RF,F.n9,Ee,ue,_e]})}return _})()}];let b=(()=>{class _{static \u0275fac=function(P){return new(P||_)};static \u0275mod=e.oAB({type:_});static \u0275inj=e.cJS({imports:[pe.Bz.forChild(A),pe.Bz]})}return _})();var I=g(2589);let U=(()=>{class _{static \u0275fac=function(P){return new(P||_)};static \u0275mod=e.oAB({type:_});static \u0275inj=e.cJS({providers:[me._W],imports:[F.ez,r.u5,r.UX,b,me.Rh.forRoot(L.NZ.toastrConfig),K.hO.initializeApp(L.NZ.firebaseConfig),de.yb,ne.ww,I._]})}return _})()},8337:(Jt,De,g)=>{g.r(De),g.d(De,{InputAuthComponent:()=>Qe});var F=g(5861),r=g(9212),K=g(5739),de=g(8645),ne=g(5619),me=g(2459),pe=g(9773),L=g(8180),e=g(7142),we=(g(752),g(553)),Ee=g(434),he=g(2425),Pe=g(5187),We=g(6814),le=g(2589),ue=g(9240);const fe=["mainForm"],Se=["confirmPasswordInput"];function z(O,W){1&O&&(r.TgZ(0,"div",15),r._uU(1,"OK!"),r.qZA())}function Q(O,W){1&O&&(r.TgZ(0,"div",17),r._uU(1,"E \u30e1\u30fc\u30eb\u306f\u5fc5\u9808\u3067\u3059\u3002"),r.qZA())}function Ne(O,W){1&O&&(r.TgZ(0,"div",17),r._uU(1,"E \u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044\u3002"),r.qZA())}function Oe(O,W){if(1&O&&(r.ynx(0),r.YNc(1,Q,2,0,"div",16)(2,Ne,2,0,"div",16),r.BQk()),2&O){const x=r.oxw();r.xp6(),r.Q6J("ngIf",null==x.emailControl.errors?null:x.emailControl.errors.required),r.xp6(),r.Q6J("ngIf",null==x.emailControl.errors?null:x.emailControl.errors.minlength)}}function ct(O,W){1&O&&(r.TgZ(0,"div",15),r._uU(1,"\u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u5f37\u5ea6\u306f\u5145\u5206\u306b\u3057\u3066\u304f\u3060\u3055\u3044\u3002"),r.qZA())}function _e(O,W){1&O&&(r.TgZ(0,"div",17),r._uU(1,"\u30d1\u30b9\u30ef\u30fc\u30c9\u306f\u5fc5\u9808\u3067\u3059\u3002"),r.qZA())}function je(O,W){1&O&&(r.TgZ(0,"div",17),r._uU(1,"\u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u9577\u3055\u304c\u8db3\u308a\u307e\u305b\u3093\u3002"),r.qZA())}function ee(O,W){if(1&O&&(r.ynx(0,18),r.YNc(1,_e,2,0,"div",16)(2,je,2,0,"div",16),r.BQk()),2&O){const x=r.oxw();r.xp6(),r.Q6J("ngIf",null==x.passwordControl.errors?null:x.passwordControl.errors.required),r.xp6(),r.Q6J("ngIf",null==x.passwordControl.errors?null:x.passwordControl.errors.minlength)}}const Le=()=>["(\u5371\u967a)","(\u5f31\u3044)","(\u666e\u901a)","(\u5f37\u3044)","(\u5145\u5206\u306b\u5b89\u5168)"],T=()=>["#DD2C00","#FF6D00","#FFD600","#AEEA00","#00C853"];function A(O,W){if(1&O&&(r._UZ(0,"ng9-password-strength-bar",19),r.ALo(1,"async")),2&O){const x=r.oxw();r.Q6J("passwordToCheck",r.lcZ(1,4,x.passwordControl.valueChanges))("barLabel","\u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u5f37\u5ea6(\u76ee\u5b89): ")("strengthLabels",r.DdM(6,Le))("barColors",r.DdM(7,T))}}function b(O,W){1&O&&(r.TgZ(0,"div",15),r._uU(1,"\u4e00\u81f4\u3057\u307e\u3057\u305f\uff01"),r.qZA())}function I(O,W){1&O&&(r.TgZ(0,"div",17),r._uU(1,"\u30d1\u30b9\u30ef\u30fc\u30c9\u306f\u5fc5\u9808\u3067\u3059\u3002"),r.qZA())}function U(O,W){1&O&&(r.TgZ(0,"div",17),r._uU(1,"\u30d1\u30b9\u30ef\u30fc\u30c9\u304c\u4e00\u81f4\u3057\u307e\u305b\u3093\u3002"),r.qZA())}function _(O,W){if(1&O&&(r.ynx(0),r.YNc(1,I,2,0,"div",16)(2,U,2,0,"div",16),r.BQk()),2&O){const x=r.oxw(2);r.xp6(),r.Q6J("ngIf",null==x.confirmPasswordControl.errors?null:x.confirmPasswordControl.errors.required),r.xp6(),r.Q6J("ngIf",null==x.confirmPasswordControl.errors?null:x.confirmPasswordControl.errors.passwordMisMatch)}}function S(O,W){if(1&O&&(r.TgZ(0,"div",2)(1,"label",20),r._uU(2,"Confirm Password"),r.qZA(),r._UZ(3,"input",21,22),r.YNc(5,b,2,0,"div",5)(6,_,3,2,"ng-container",6),r.qZA()),2&O){const x=r.oxw();r.ekj("was-validated",x.confirmPasswordControl.dirty||x.confirmPasswordControl.touched),r.xp6(3),r.Q6J("autocomplete",x.passwordAutocomplete),r.xp6(2),r.Q6J("ngIf",!x.confirmPasswordControl.invalid),r.xp6(),r.Q6J("ngIf",x.confirmPasswordControl.invalid)}}function R(O,W){1&O&&(r.TgZ(0,"div",29),r._uU(1,"OK!"),r.qZA())}function P(O,W){1&O&&(r.TgZ(0,"div",31),r._uU(1,"\u898f\u7d04\u306b\u540c\u610f\u3057\u3066\u3044\u305f\u3060\u304f\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002"),r.qZA())}function m(O,W){if(1&O&&(r.ynx(0),r.YNc(1,P,2,0,"div",30),r.BQk()),2&O){const x=r.oxw(2);r.xp6(),r.Q6J("ngIf",null==x.agreeTosControl.errors?null:x.agreeTosControl.errors.required)}}function q(O,W){if(1&O&&(r.TgZ(0,"div",23)(1,"label",24),r._uU(2,"\u898f\u7d04\u306b\u540c\u610f\u3059\u308b"),r.qZA(),r._UZ(3,"input",25),r.TgZ(4,"a",26),r._uU(5," [\u5229\u7528\u898f\u7d04] "),r.qZA(),r.TgZ(6,"span",27),r._uU(7,"\u306b\u540c\u610f\u3057\u307e\u3059\u3002"),r.qZA(),r.YNc(8,R,2,0,"div",28)(9,m,2,1,"ng-container",6),r.qZA()),2&O){const x=r.oxw();r.ekj("was-validated",x.agreeTosControl.dirty||x.agreeTosControl.touched),r.xp6(8),r.Q6J("ngIf",!x.agreeTosControl.invalid),r.xp6(),r.Q6J("ngIf",x.agreeTosControl.invalid)}}function ce(O,W){if(1&O){const x=r.EpF();r.TgZ(0,"button",32),r.NdJ("click",function(D){r.CHM(x);const re=r.oxw();return r.KtG(re.onClickSignup(D))}),r._uU(1,"\u30a2\u30ab\u30a6\u30f3\u30c8\u4f5c\u6210"),r.qZA()}if(2&O){const x=r.oxw();r.Q6J("disabled",!x.inputAuthForm.valid)}}function te(O,W){if(1&O){const x=r.EpF();r.TgZ(0,"button",32),r.NdJ("click",function(D){r.CHM(x);const re=r.oxw();return r.KtG(re.onClickLogin(D))}),r._UZ(1,"img",33),r._uU(2,"\u30ed\u30b0\u30a4\u30f3"),r.qZA()}if(2&O){const x=r.oxw();r.Q6J("disabled",!x.inputAuthForm.valid)}}function be(O,W){if(1&O){const x=r.EpF();r.TgZ(0,"button",32),r.NdJ("click",function(D){r.CHM(x);const re=r.oxw();return r.KtG(re.onClickReauth(D))}),r._UZ(1,"img",33),r._uU(2,"\u518d\u8a8d\u8a3c"),r.qZA()}if(2&O){const x=r.oxw();r.Q6J("disabled",!x.inputAuthForm.valid)}}function oe(O,W){if(1&O){const x=r.EpF();r.TgZ(0,"app-oauth-federations",34),r.NdJ("loginSucceeded",function(){r.CHM(x);const D=r.oxw();return r.KtG(D.onOauthLoginSucceeded())})("loginFailed",function(D){r.CHM(x);const re=r.oxw();return r.KtG(re.onOauthLoginFailed(D))}),r.qZA()}}let Qe=(()=>{class O{auth;toastr;router;route;isLogin=!1;isReauth=!1;reauthUser=null;isSignup=!1;showFederations=!0;reauthed=new r.vpe;destroy$=new de.x;inputAuthForm;loginUser$=new ne.X(null);passwordAutocomplete;mainForm;confirmPasswordInput;constructor(x,$,D,re){this.auth=x,this.toastr=$,this.router=D,this.route=re}ngOnInit(){this.passwordAutocomplete=this.isSignup?"new-password":"current-password",this.inputAuthForm=new K.cw({}),this.inputAuthForm.addControl("email",new K.NI("")),this.inputAuthForm.addControl("password",new K.NI("")),this.isSignup&&(this.inputAuthForm.addControl("retypePassword",new K.NI("")),this.inputAuthForm.addControl("agreeTosCheck",new K.NI(!1)),this.inputAuthForm.setValidators([this.validateXFPassword.bind(this)])),this.inputAuthForm.disable(),this.initializeAuthForm()}ngOnDestroy(){this.destroy$.next()}ngAfterViewInit(){this.auth.authState.pipe((0,pe.R)(this.destroy$)).subscribe(x=>{this.loginUser$.next(x)})}navigateAfterSucceeded(){this.route.queryParams.pipe((0,pe.R)(this.destroy$),(0,L.q)(1)).subscribe(x=>{const $=x.redirectPath;this.router.navigate($?[$]:["/"])})}erroredConnected(x){(0,we.wb)("error while connecting account",x);const $=x instanceof Error?x.message:"Unknown error";this.toastr.error(`Login \u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002 \n ( ${$} )`)}loginSucceeded(){this.toastr.success("Login \u3057\u307e\u3057\u305f\u3002"),this.navigateAfterSucceeded()}connectSucceeded(x){this.toastr.success("Sign-up \u3057\u307e\u3057\u305f\u3002"),this.navigateAfterSucceeded()}get emailControl(){return this.inputAuthForm.get("email")}get passwordControl(){return this.inputAuthForm.get("password")}get confirmPasswordControl(){return this.inputAuthForm.get("retypePassword")}get agreeTosControl(){return this.inputAuthForm.get("agreeTosCheck")}validateXFPassword(x){const $=x.get("password"),D=x.get("retypePassword");return $.value!==D.value?(D.setErrors({passwordMisMatch:!0}),this.confirmPasswordInput&&this.confirmPasswordInput.nativeElement.setCustomValidity("create error state"),null):(this.confirmPasswordInput&&this.confirmPasswordInput.nativeElement.setCustomValidity(""),D.setErrors(null),null)}validateAuthForm(){return this.inputAuthForm.markAllAsTouched(),!this.inputAuthForm.invalid||((0,we.wb)("Assert! Button should be disabled."),!1)}initializeAuthForm(){(0,me.D)(this.auth.setPersistence(e.Z.auth.Auth.Persistence.SESSION)).pipe((0,L.q)(1),(0,pe.R)(this.destroy$)).subscribe({next:()=>{this.inputAuthForm.enable()},error:x=>{this.toastr.error("\u8a8d\u8a3c Server \u3092\u521d\u671f\u5316\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002")}})}onClickSignup(x){var $=this;return(0,F.Z)(function*(){if(x.preventDefault(),$.validateAuthForm())try{const D=yield $.auth.createUserWithEmailAndPassword($.emailControl.value,$.passwordControl.value);$.toastr.info("\u30a2\u30ab\u30a6\u30f3\u30c8\u3092\u4f5c\u6210\u3057\u307e\u3057\u305f\u3002\u30e1\u30fc\u30eb\u3092\u78ba\u8a8d\u3057\u3066\u304f\u3060\u3055\u3044\u3002"),yield D.user.sendEmailVerification(),$.navigateAfterSucceeded()}catch(D){(0,we.wb)("Error while reject",D);const re=D instanceof Error?D.message:"Unknown error";$.toastr.error(`\u30a2\u30ab\u30a6\u30f3\u30c8\u306e\u4f5c\u6210\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002\u6700\u521d\u304b\u3089\u3084\u308a\u76f4\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n ( ${re} )`)}})()}onClickLogin(x){var $=this;return(0,F.Z)(function*(){if(x.preventDefault(),$.validateAuthForm())try{yield $.auth.signInWithEmailAndPassword($.emailControl.value,$.passwordControl.value),$.loginSucceeded()}catch(D){$.erroredConnected(D)}})()}onClickReauth(x){var $=this;return(0,F.Z)(function*(){if(x.preventDefault(),$.validateAuthForm())try{const D=e.Z.auth.EmailAuthProvider.credential($.emailControl.value,$.passwordControl.value);yield $.reauthUser.reauthenticateWithCredential(D),$.reauthed.next()}catch(D){$.erroredConnected(D)}})()}onOauthLoginFailed(x){this.erroredConnected(x)}onOauthLoginSucceeded(){this.loginSucceeded()}static \u0275fac=function($){return new($||O)(r.Y36(Ee.zQ),r.Y36(he._W),r.Y36(Pe.F0),r.Y36(Pe.gz))};static \u0275cmp=r.Xpm({type:O,selectors:[["gitfire-login-input-auth"]],viewQuery:function($,D){if(1&$&&(r.Gf(fe,5),r.Gf(Se,5)),2&$){let re;r.iGM(re=r.CRH())&&(D.mainForm=re.first),r.iGM(re=r.CRH())&&(D.confirmPasswordInput=re.first)}},inputs:{isLogin:"isLogin",isReauth:"isReauth",reauthUser:"reauthUser",isSignup:"isSignup",showFederations:"showFederations"},outputs:{reauthed:"reauthed"},decls:22,vars:17,consts:[[3,"formGroup"],["mainForm",""],[1,"row","m-3"],["for","appGitfireLoginEmailInput",1,"visually-hidden"],["id","appGitfireLoginEmailInput","name","email","formControlName","email","placeholder","email@example.com","autocomplete","email","type","email","required","","autofill","","autofocus","","maxlength","1024","minlength","5",1,"form-control","col-12"],["class","valid-feedback",4,"ngIf"],[4,"ngIf"],["for","appGitfireLoginPasswordInput",1,"visually-hidden"],["id","appGitfireLoginPasswordInput","type","password","name","password","formControlName","password","placeholder","Password","required","","autofill","","maxlength","256","minlength","6",1,"form-control","col-12",3,"autocomplete"],["class"," ",4,"ngIf"],["class","col-12 m-3",3,"passwordToCheck","barLabel","strengthLabels","barColors",4,"ngIf"],["class","row m-3",3,"was-validated",4,"ngIf"],["class","row custom-control custom-checkbox m-5 text-center",3,"was-validated",4,"ngIf"],["class","btn btn-lg btn-primary btn-block",3,"disabled","click",4,"ngIf"],[3,"loginSucceeded","loginFailed",4,"ngIf"],[1,"valid-feedback"],["class","invalid-feedback",4,"ngIf"],[1,"invalid-feedback"],[1,""],[1,"col-12","m-3",3,"passwordToCheck","barLabel","strengthLabels","barColors"],["for","appGitfireSignupPasswordConfirmInput",1,"visually-hidden"],["id","appGitfireSignupPasswordConfirmInput","type","password","name","password_confirm","formControlName","retypePassword","placeholder","Confirm password","required","",1,"form-control","col-12",3,"autocomplete"],["confirmPasswordInput",""],[1,"row","custom-control","custom-checkbox","m-5","text-center"],["for","appGitfireAgreeTosCheck",1,"col-auto","visually-hidden"],["id","col-auto appGitfireAgreeTosCheck","formControlName","agreeTosCheck","type","checkbox","required","",1,"form-check-input"],["tabindex","-1","about","_blank","href","/terms.htm",1,"col-auto"],[1,"col-auto"],["class","valid-feedback col-auto",4,"ngIf"],[1,"valid-feedback","col-auto"],["class","invalid-feedback col-auto",4,"ngIf"],[1,"invalid-feedback","col-auto"],[1,"btn","btn-lg","btn-primary","btn-block",3,"disabled","click"],["src","/assets/octicons/sign-in.svg",1,"m-1","gitfire-link-icon","octicon-info"],[3,"loginSucceeded","loginFailed"]],template:function($,D){1&$&&(r.TgZ(0,"form",0,1)(2,"div",2)(3,"label",3),r._uU(4,"Email"),r.qZA(),r._UZ(5,"input",4),r.YNc(6,z,2,0,"div",5)(7,Oe,3,2,"ng-container",6),r.qZA(),r.TgZ(8,"div",2)(9,"label",7),r._uU(10,"Password"),r.qZA(),r._UZ(11,"input",8),r.YNc(12,ct,2,0,"div",5)(13,ee,3,2,"ng-container",9)(14,A,2,8,"ng9-password-strength-bar",10),r.qZA(),r.YNc(15,S,7,5,"div",11)(16,q,10,4,"div",12),r.TgZ(17,"div",2),r.YNc(18,ce,2,1,"button",13)(19,te,3,1,"button",13)(20,be,3,1,"button",13),r.qZA(),r.YNc(21,oe,1,0,"app-oauth-federations",14),r.qZA()),2&$&&(r.Q6J("formGroup",D.inputAuthForm),r.xp6(2),r.ekj("was-validated",D.emailControl.dirty||D.emailControl.touched),r.xp6(4),r.Q6J("ngIf",!D.emailControl.invalid),r.xp6(),r.Q6J("ngIf",D.emailControl.invalid),r.xp6(),r.ekj("was-validated",D.passwordControl.dirty||D.passwordControl.touched),r.xp6(3),r.Q6J("autocomplete",D.passwordAutocomplete),r.xp6(),r.Q6J("ngIf",D.isSignup&&!D.passwordControl.invalid),r.xp6(),r.Q6J("ngIf",D.passwordControl.invalid),r.xp6(),r.Q6J("ngIf",D.isSignup),r.xp6(),r.Q6J("ngIf",D.isSignup),r.xp6(),r.Q6J("ngIf",D.isSignup),r.xp6(2),r.Q6J("ngIf",D.isSignup),r.xp6(),r.Q6J("ngIf",D.isLogin),r.xp6(),r.Q6J("ngIf",D.isReauth),r.xp6(),r.Q6J("ngIf",D.showFederations))},dependencies:[We.O5,K._Y,K.Fj,K.Wl,K.JJ,K.JL,K.Q7,K.wO,K.nD,K.Zs,K.sg,K.u,le.e,ue.x,We.Ov]})}return O})()},1134:(Jt,De,g)=>{g.d(De,{M:()=>K});var F=g(6814),r=g(9212);let K=(()=>{class de{static \u0275fac=function(pe){return new(pe||de)};static \u0275mod=r.oAB({type:de});static \u0275inj=r.cJS({imports:[F.ez]})}return de})()},2589:(Jt,De,g)=>{function ne(T,A,b,I){var S,U=arguments.length,_=U<3?A:null===I?I=Object.getOwnPropertyDescriptor(A,b):I;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)_=Reflect.decorate(T,A,b,I);else for(var R=T.length-1;R>=0;R--)(S=T[R])&&(_=(U<3?S(_):U>3?S(A,b,_):S(A,b))||_);return U>3&&_&&Object.defineProperty(A,b,_),_}g.d(De,{e:()=>ee,_:()=>Le});var je,_e=g(9212);let ee=je=class{constructor(){this.onStrengthChanged=new _e.vpe,this.defaultColors=["#F00","#F90","#FF0","#9F0","#0F0"],this.defaultThresholds=[90,70,40,20],this.defaultBaseColor="#DDD",this.colors=this.defaultColors,this.thresholds=this.defaultThresholds}static measureStrength(A){let b=0;const I={};for(let S=0;S<A.length;S++)I[A[S]]=(I[A[S]]||0)+1,b+=5/I[A[S]];const U={digits:/\d/.test(A),lower:/[a-z]/.test(A),upper:/[A-Z]/.test(A),nonWords:/\W/.test(A)};let _=0;for(let S in U)_+=U[S]?1:0;return b+=10*(_-1),Math.trunc(b)}checkBarColors(){this.colors=this.barColors&&5===this.barColors.length?this.barColors.slice():this.defaultColors,this.strengths=this.strengthLabels&&5===this.strengthLabels.length?this.strengthLabels.slice():null,this.setStrengthLabel(0),/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(this.baseColor)||(this.baseColor=this.defaultBaseColor)}checkThresholds(){this.thresholds=this.customThresholds&&4===this.customThresholds.length?this.customThresholds.slice():this.defaultThresholds}getColor(A){let b=0;return A>this.thresholds[0]?b=4:A>this.thresholds[1]?b=3:A>=this.thresholds[2]?b=2:A>=this.thresholds[3]&&(b=1),{idx:b+1,col:this.colors[b]}}getStrengthIndexAndColor(A){return this.getColor(je.measureStrength(A))}ngOnChanges(A){if(!A.passwordToCheck)return;const b=A.passwordToCheck.currentValue;this.checkBarColors(),this.checkThresholds(),this.setBarColors(5,this.baseColor);let I=0;if(b){const U=this.getStrengthIndexAndColor(b);I=U.idx-1,this.setStrengthLabel(I),this.setBarColors(U.idx,U.col)}this.onStrengthChanged.emit(I)}setBarColors(A,b){for(let I=0;I<A;I++)this["bar"+I]=b}setStrengthLabel(A){this.strengths&&(this.strengthLabel=this.strengths[A])}};ne([(0,_e.IIB)()],ee.prototype,"passwordToCheck",void 0),ne([(0,_e.IIB)()],ee.prototype,"barLabel",void 0),ne([(0,_e.IIB)()],ee.prototype,"barColors",void 0),ne([(0,_e.IIB)()],ee.prototype,"baseColor",void 0),ne([(0,_e.IIB)()],ee.prototype,"strengthLabels",void 0),ne([(0,_e.IIB)()],ee.prototype,"customThresholds",void 0),ne([(0,_e.r_U)()],ee.prototype,"onStrengthChanged",void 0),ee=je=ne([(0,_e.wA2)({selector:"ng9-password-strength-bar",template:'\n    <div id="strength" #strength>\n      <small>{{barLabel}}</small>\n      <ul id="strengthBar" class="strengthBar">\n        <li id="bar0" class="point" [style.background-color]="bar0"></li>\n        <li class="point" [style.background-color]="bar1"></li>\n        <li class="point" [style.background-color]="bar2"></li>\n        <li class="point" [style.background-color]="bar3"></li>\n        <li class="point" [style.background-color]="bar4"></li>\n      </ul>\n      <small [hidden]="!strengths" class="pre">  {{strengthLabel}}</small>\n    </div>\n  ',styles:["\n    .strengthBar {\n      display: inline;\n      list-style: none;\n      margin: 0 0 0 15px;\n      padding: 0;\n      vertical-align: 2px;\n    }\n\n    .strengthBar .point {\n      background: #DDD;\n      border-radius: 2px;\n      display: inline-block;\n      height: 5px;\n      margin-right: 1px;\n      width: 20px;\n    }\n\n    .strengthBar .point:last-child {\n      margin: 0;\n    }\n    .pre {\n      white-space: pre;\n    }\n  "]})],ee);let Le=(()=>{let T=class{};return T=ne([(0,_e.LVF)({declarations:[ee],imports:[],exports:[ee]})],T),T})()},8024:(Jt,De,g)=>{g.d(De,{Q1:()=>En,TE:()=>io});var F=g(8326),r=g(5592),K=g(2096),de=g(2459),ne=g(3620),me=g(7398),pe=g(4664),L=g(9212),e=g(7217),Xe=g(8168),we=g(5861),Ee=g(9032),he=g(9058),Pe=g(4537);const We="firebasestorage.googleapis.com",le="storageBucket";class z extends he.ZR{constructor(t,o,a=0){super(Ne(t),`Firebase Storage: ${o} (${Ne(t)})`),this.status_=a,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,z.prototype)}get status(){return this.status_}set status(t){this.status_=t}_codeEquals(t){return Ne(t)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(t){this.customData.serverResponse=t,this.message=this.customData.serverResponse?`${this._baseMessage}\n${this.customData.serverResponse}`:this._baseMessage}}var Q=function(n){return n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment",n}(Q||{});function Ne(n){return"storage/"+n}function Oe(){return new z(Q.UNKNOWN,"An unknown error occurred, please check the error payload for server response.")}function T(){return new z(Q.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function A(){return new z(Q.CANCELED,"User canceled the upload/download.")}function _(){return new z(Q.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function m(n){return new z(Q.INVALID_ARGUMENT,n)}function q(){return new z(Q.APP_DELETED,"The Firebase app was deleted.")}function ce(n){return new z(Q.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function te(n,t){return new z(Q.INVALID_FORMAT,"String does not match format '"+n+"': "+t)}function be(n){throw new z(Q.INTERNAL_ERROR,"Internal error: "+n)}class oe{constructor(t,o){this.bucket=t,this.path_=o}get path(){return this.path_}get isRoot(){return 0===this.path.length}fullServerUrl(){const t=encodeURIComponent;return"/b/"+t(this.bucket)+"/o/"+t(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(t,o){let a;try{a=oe.makeFromUrl(t,o)}catch{return new oe(t,"")}if(""===a.path)return a;throw function I(n){return new z(Q.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}(t)}static makeFromUrl(t,o){let a=null;const p="([A-Za-z0-9.\\-_]+)",G=new RegExp("^gs://"+p+"(/(.*))?$","i");function H(Me){Me.path_=decodeURIComponent(Me.path)}const Ie=o.replace(/[.]/g,"\\."),Je=[{regex:G,indices:{bucket:1,path:3},postModify:function C(Me){"/"===Me.path.charAt(Me.path.length-1)&&(Me.path_=Me.path_.slice(0,-1))}},{regex:new RegExp(`^https?://${Ie}/v[A-Za-z0-9_]+/b/${p}/o(/([^?#]*).*)?$`,"i"),indices:{bucket:1,path:3},postModify:H},{regex:new RegExp(`^https?://${o===We?"(?:storage.googleapis.com|storage.cloud.google.com)":o}/${p}/([^?#]*)`,"i"),indices:{bucket:1,path:2},postModify:H}];for(let Me=0;Me<Je.length;Me++){const zt=Je[Me],Xt=zt.regex.exec(t);if(Xt){let en=Xt[zt.indices.path];en||(en=""),a=new oe(Xt[zt.indices.bucket],en),zt.postModify(a);break}}if(null==a)throw function b(n){return new z(Q.INVALID_URL,"Invalid URL '"+n+"'.")}(t);return a}}class Qe{constructor(t){this.promise_=Promise.reject(t)}getPromise(){return this.promise_}cancel(t=!1){}}function re(n){return"string"==typeof n||n instanceof String}function nt(n){return ot()&&n instanceof Blob}function ot(){return typeof Blob<"u"}function Ve(n,t,o,a){if(a<t)throw m(`Invalid value for '${n}'. Expected ${t} or greater.`);if(a>o)throw m(`Invalid value for '${n}'. Expected ${o} or less.`)}function $e(n,t,o){let a=t;return null==o&&(a=`https://${t}`),`${o}://${a}/v0${n}`}function _t(n){const t=encodeURIComponent;let o="?";for(const a in n)n.hasOwnProperty(a)&&(o=o+(t(a)+"=")+t(n[a])+"&");return o=o.slice(0,-1),o}var He=function(n){return n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT",n}(He||{});function vt(n,t){const o=n>=500&&n<600,p=-1!==[408,429].indexOf(n),C=-1!==t.indexOf(n);return o||p||C}class jt{constructor(t,o,a,p,C,w,G,N,H,X,Ie,Ce=!0){this.url_=t,this.method_=o,this.headers_=a,this.body_=p,this.successCodes_=C,this.additionalRetryCodes_=w,this.callback_=G,this.errorCallback_=N,this.timeout_=H,this.progressCallback_=X,this.connectionFactory_=Ie,this.retry=Ce,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((ye,xe)=>{this.resolve_=ye,this.reject_=xe,this.start_()})}start_(){const o=(a,p)=>{const C=this.resolve_,w=this.reject_,G=p.connection;if(p.wasSuccessCode)try{const N=this.callback_(G,G.getResponse());!function x(n){return void 0!==n}(N)?C():C(N)}catch(N){w(N)}else if(null!==G){const N=Oe();N.serverResponse=G.getErrorText(),w(this.errorCallback_?this.errorCallback_(G,N):N)}else w(p.canceled?this.appDelete_?q():A():T())};this.canceled_?o(0,new Be(!1,null,!0)):this.backoffId_=function O(n,t,o){let a=1,p=null,C=null,w=!1,G=0;function N(){return 2===G}let H=!1;function X(...Re){H||(H=!0,t.apply(null,Re))}function Ie(Re){p=setTimeout(()=>{p=null,n(ye,N())},Re)}function Ce(){C&&clearTimeout(C)}function ye(Re,...Mt){if(H)return void Ce();if(Re)return Ce(),void X.call(null,Re,...Mt);if(N()||w)return Ce(),void X.call(null,Re,...Mt);let Je;a<64&&(a*=2),1===G?(G=2,Je=0):Je=1e3*(a+Math.random()),Ie(Je)}let xe=!1;function ut(Re){xe||(xe=!0,Ce(),!H&&(null!==p?(Re||(G=2),clearTimeout(p),Ie(0)):Re||(G=1)))}return Ie(0),C=setTimeout(()=>{w=!0,ut(!0)},o),ut}((a,p)=>{if(p)return void a(!1,new Be(!1,null,!0));const C=this.connectionFactory_();this.pendingConnection_=C;const w=G=>{null!==this.progressCallback_&&this.progressCallback_(G.loaded,G.lengthComputable?G.total:-1)};null!==this.progressCallback_&&C.addUploadProgressListener(w),C.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{null!==this.progressCallback_&&C.removeUploadProgressListener(w),this.pendingConnection_=null;const G=C.getErrorCode()===He.NO_ERROR,N=C.getStatus();if(!G||vt(N,this.additionalRetryCodes_)&&this.retry){const X=C.getErrorCode()===He.ABORT;return void a(!1,new Be(!1,null,X))}const H=-1!==this.successCodes_.indexOf(N);a(!0,new Be(H,C))})},o,this.timeout_)}getPromise(){return this.promise_}cancel(t){this.canceled_=!0,this.appDelete_=t||!1,null!==this.backoffId_&&function W(n){n(!1)}(this.backoffId_),null!==this.pendingConnection_&&this.pendingConnection_.abort()}}class Be{constructor(t,o,a){this.wasSuccessCode=t,this.connection=o,this.canceled=!!a}}function Ye(...n){const t=function Kt(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}();if(void 0!==t){const o=new t;for(let a=0;a<n.length;a++)o.append(n[a]);return o.getBlob()}if(ot())return new Blob(n);throw new z(Q.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}const Ue={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class yt{constructor(t,o){this.data=t,this.contentType=o||null}}function Ze(n,t){switch(n){case Ue.RAW:return new yt(bt(t));case Ue.BASE64:case Ue.BASE64URL:return new yt(dt(n,t));case Ue.DATA_URL:return new yt(function Tt(n){const t=new it(n);return t.base64?dt(Ue.BASE64,t.rest):function lt(n){let t;try{t=decodeURIComponent(n)}catch{throw te(Ue.DATA_URL,"Malformed data URL.")}return bt(t)}(t.rest)}(t),function pt(n){return new it(n).contentType}(t))}throw Oe()}function bt(n){const t=[];for(let o=0;o<n.length;o++){let a=n.charCodeAt(o);a<=127?t.push(a):a<=2047?t.push(192|a>>6,128|63&a):55296==(64512&a)?o<n.length-1&&56320==(64512&n.charCodeAt(o+1))?(a=65536|(1023&a)<<10|1023&n.charCodeAt(++o),t.push(240|a>>18,128|a>>12&63,128|a>>6&63,128|63&a)):t.push(239,191,189):56320==(64512&a)?t.push(239,191,189):t.push(224|a>>12,128|a>>6&63,128|63&a)}return new Uint8Array(t)}function dt(n,t){switch(n){case Ue.BASE64:{const p=-1!==t.indexOf("-"),C=-1!==t.indexOf("_");if(p||C)throw te(n,"Invalid character '"+(p?"-":"_")+"' found: is it base64url encoded?");break}case Ue.BASE64URL:{const p=-1!==t.indexOf("+"),C=-1!==t.indexOf("/");if(p||C)throw te(n,"Invalid character '"+(p?"+":"/")+"' found: is it base64 encoded?");t=t.replace(/-/g,"+").replace(/_/g,"/");break}}let o;try{o=function Ct(n){if(typeof atob>"u")throw function P(n){return new z(Q.UNSUPPORTED_ENVIRONMENT,`${n} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}("base-64");return atob(n)}(t)}catch(p){throw p.message.includes("polyfill")?p:te(n,"Invalid character found")}const a=new Uint8Array(o.length);for(let p=0;p<o.length;p++)a[p]=o.charCodeAt(p);return a}class it{constructor(t){this.base64=!1,this.contentType=null;const o=t.match(/^data:([^,]+)?,/);if(null===o)throw te(Ue.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const a=o[1]||null;null!=a&&(this.base64=function ht(n,t){return n.length>=t.length&&n.substring(n.length-t.length)===t}(a,";base64"),this.contentType=this.base64?a.substring(0,a.length-7):a),this.rest=t.substring(t.indexOf(",")+1)}}class ke{constructor(t,o){let a=0,p="";nt(t)?(this.data_=t,a=t.size,p=t.type):t instanceof ArrayBuffer?(o?this.data_=new Uint8Array(t):(this.data_=new Uint8Array(t.byteLength),this.data_.set(new Uint8Array(t))),a=this.data_.length):t instanceof Uint8Array&&(o?this.data_=t:(this.data_=new Uint8Array(t.length),this.data_.set(t)),a=t.length),this.size_=a,this.type_=p}size(){return this.size_}type(){return this.type_}slice(t,o){if(nt(this.data_)){const p=function $t(n,t,o){return n.webkitSlice?n.webkitSlice(t,o):n.mozSlice?n.mozSlice(t,o):n.slice?n.slice(t,o):null}(this.data_,t,o);return null===p?null:new ke(p)}{const a=new Uint8Array(this.data_.buffer,t,o-t);return new ke(a,!0)}}static getBlob(...t){if(ot()){const o=t.map(a=>a instanceof ke?a.data_:a);return new ke(Ye.apply(null,o))}{const o=t.map(w=>re(w)?Ze(Ue.RAW,w).data:w.data_);let a=0;o.forEach(w=>{a+=w.byteLength});const p=new Uint8Array(a);let C=0;return o.forEach(w=>{for(let G=0;G<w.length;G++)p[C++]=w[G]}),new ke(p,!0)}}uploadData(){return this.data_}}function ft(n){let t;try{t=JSON.parse(n)}catch{return null}return function D(n){return"object"==typeof n&&!Array.isArray(n)}(t)?t:null}function Dt(n){const t=n.lastIndexOf("/",n.length-2);return-1===t?n:n.slice(t+1)}function Gt(n,t){return t}class ve{constructor(t,o,a,p){this.server=t,this.local=o||t,this.writable=!!a,this.xform=p||Gt}}let At=null;function et(){if(At)return At;const n=[];n.push(new ve("bucket")),n.push(new ve("generation")),n.push(new ve("metageneration")),n.push(new ve("name","fullPath",!0));const o=new ve("name");o.xform=function t(C,w){return function Pt(n){return!re(n)||n.length<2?n:Dt(n)}(w)},n.push(o);const p=new ve("size");return p.xform=function a(C,w){return void 0!==w?Number(w):w},n.push(p),n.push(new ve("timeCreated")),n.push(new ve("updated")),n.push(new ve("md5Hash",null,!0)),n.push(new ve("cacheControl",null,!0)),n.push(new ve("contentDisposition",null,!0)),n.push(new ve("contentEncoding",null,!0)),n.push(new ve("contentLanguage",null,!0)),n.push(new ve("contentType",null,!0)),n.push(new ve("metadata","customMetadata",!0)),At=n,At}function Et(n,t,o){const a=ft(t);return null===a?null:function Wt(n,t,o){const a={type:"file"},p=o.length;for(let C=0;C<p;C++){const w=o[C];a[w.local]=w.xform(a,t[w.server])}return function wt(n,t){Object.defineProperty(n,"ref",{get:function o(){const C=new oe(n.bucket,n.fullPath);return t._makeStorageReference(C)}})}(a,n),a}(n,a,o)}function qt(n,t){const o={},a=t.length;for(let p=0;p<a;p++){const C=t[p];C.writable&&(o[C.server]=n[C.local])}return JSON.stringify(o)}const It="prefixes",st="items";class c{constructor(t,o,a,p){this.url=t,this.method=o,this.handler=a,this.timeout=p,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}function f(n){if(!n)throw Oe()}function k(n,t){return function o(a,p){const C=Et(n,p,t);return f(null!==C),C}}function J(n){return function t(o,a){let p;return p=401===o.getStatus()?o.getErrorText().includes("Firebase App Check token is invalid")?function ee(){return new z(Q.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}():function je(){return new z(Q.UNAUTHENTICATED,"User is not authenticated, please authenticate using Firebase Authentication and try again.")}():402===o.getStatus()?function _e(n){return new z(Q.QUOTA_EXCEEDED,"Quota for bucket '"+n+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}(n.bucket):403===o.getStatus()?function Le(n){return new z(Q.UNAUTHORIZED,"User does not have permission to access '"+n+"'.")}(n.path):a,p.status=o.getStatus(),p.serverResponse=a.serverResponse,p}}function ie(n){const t=J(n);return function o(a,p){let C=t(a,p);return 404===a.getStatus()&&(C=function ct(n){return new z(Q.OBJECT_NOT_FOUND,"Object '"+n+"' does not exist.")}(n.path)),C.serverResponse=p.serverResponse,C}}function at(n,t,o){const p=$e(t.fullServerUrl(),n.host,n._protocol),w=n.maxOperationRetryTime,G=new c(p,"GET",k(n,o),w);return G.errorHandler=ie(t),G}function tt(n,t,o,a,p){const C={};C.prefix=t.isRoot?"":t.path+"/",o&&o.length>0&&(C.delimiter=o),a&&(C.pageToken=a),p&&(C.maxResults=p);const G=$e(t.bucketOnlyServerUrl(),n.host,n._protocol),H=n.maxOperationRetryTime,X=new c(G,"GET",function B(n,t){return function o(a,p){const C=function Bt(n,t,o){const a=ft(o);return null===a?null:function Vt(n,t,o){const a={prefixes:[],items:[],nextPageToken:o.nextPageToken};if(o[It])for(const p of o[It]){const C=p.replace(/\/$/,""),w=n._makeStorageReference(new oe(t,C));a.prefixes.push(w)}if(o[st])for(const p of o[st]){const C=n._makeStorageReference(new oe(t,p.name));a.items.push(C)}return a}(n,t,a)}(n,t,p);return f(null!==C),C}}(n,t.bucket),H);return X.urlParams=C,X.errorHandler=J(t),X}function s(n,t,o){const a=Object.assign({},o);return a.fullPath=n.path,a.size=t.size(),a.contentType||(a.contentType=function i(n,t){return n&&n.contentType||t&&t.type()||"application/octet-stream"}(null,t)),a}class y{constructor(t,o,a,p){this.current=t,this.total=o,this.finalized=!!a,this.metadata=p||null}}function E(n,t){let o=null;try{o=n.getResponseHeader("X-Goog-Upload-Status")}catch{f(!1)}return f(!!o&&-1!==(t||["active"]).indexOf(o)),o}const mt={STATE_CHANGED:"state_changed"},Te={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function Fe(n){switch(n){case"running":case"pausing":case"canceling":return Te.RUNNING;case"paused":return Te.PAUSED;case"success":return Te.SUCCESS;case"canceled":return Te.CANCELED;default:return Te.ERROR}}class kt{constructor(t,o,a){if(function $(n){return"function"==typeof n}(t)||null!=o||null!=a)this.next=t,this.error=o??void 0,this.complete=a??void 0;else{const C=t;this.next=C.next,this.error=C.error,this.complete=C.complete}}}function Rt(n){return(...t)=>{Promise.resolve().then(()=>n(...t))}}let tn=null;class u{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=He.NO_ERROR,this.sendPromise_=new Promise(t=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=He.ABORT,t()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=He.NETWORK_ERROR,t()}),this.xhr_.addEventListener("load",()=>{t()})})}send(t,o,a,p){if(this.sent_)throw be("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(o,t,!0),void 0!==p)for(const C in p)p.hasOwnProperty(C)&&this.xhr_.setRequestHeader(C,p[C].toString());return void 0!==a?this.xhr_.send(a):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw be("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw be("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw be("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw be("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(t){return this.xhr_.getResponseHeader(t)}addUploadProgressListener(t){null!=this.xhr_.upload&&this.xhr_.upload.addEventListener("progress",t)}removeUploadProgressListener(t){null!=this.xhr_.upload&&this.xhr_.upload.removeEventListener("progress",t)}}class h extends u{initXhr(){this.xhr_.responseType="text"}}function v(){return tn?tn():new h}class Ae{constructor(t,o,a=null){this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=t,this._blob=o,this._metadata=a,this._mappings=et(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=p=>{if(this._request=void 0,this._chunkMultiplier=1,p._codeEquals(Q.CANCELED))this._needToFetchStatus=!0,this.completeTransitions_();else{const C=this.isExponentialBackoffExpired();if(vt(p.status,[])){if(!C)return this.sleepTime=Math.max(2*this.sleepTime,1e3),this._needToFetchStatus=!0,void this.completeTransitions_();p=T()}this._error=p,this._transition("error")}},this._metadataErrorHandler=p=>{this._request=void 0,p._codeEquals(Q.CANCELED)?this.completeTransitions_():(this._error=p,this._transition("error"))},this.sleepTime=0,this.maxSleepTime=this._ref.storage.maxUploadRetryTime,this._promise=new Promise((p,C)=>{this._resolve=p,this._reject=C,this._start()}),this._promise.then(null,()=>{})}isExponentialBackoffExpired(){return this.sleepTime>this.maxSleepTime}_makeProgressCallback(){const t=this._transferred;return o=>this._updateProgress(t+o)}_shouldDoResumable(t){return t.size()>262144}_start(){"running"===this._state&&void 0===this._request&&(this._resumable?void 0===this._uploadUrl?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this.pendingTimeout=setTimeout(()=>{this.pendingTimeout=void 0,this._continueUpload()},this.sleepTime):this._oneShotUpload())}_resolveToken(t){Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then(([o,a])=>{switch(this._state){case"running":t(o,a);break;case"canceling":this._transition("canceled");break;case"pausing":this._transition("paused")}})}_createResumable(){this._resolveToken((t,o)=>{const a=function ae(n,t,o,a,p){const C=t.bucketOnlyServerUrl(),w=s(t,a,p),G={name:w.fullPath},N=$e(C,n.host,n._protocol),X={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${a.size()}`,"X-Goog-Upload-Header-Content-Type":w.contentType,"Content-Type":"application/json; charset=utf-8"},Ie=qt(w,o),xe=new c(N,"POST",function ye(ut){let Re;E(ut);try{Re=ut.getResponseHeader("X-Goog-Upload-URL")}catch{f(!1)}return f(re(Re)),Re},n.maxUploadRetryTime);return xe.urlParams=G,xe.headers=X,xe.body=Ie,xe.errorHandler=J(t),xe}(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),p=this._ref.storage._makeRequest(a,v,t,o);this._request=p,p.getPromise().then(C=>{this._request=void 0,this._uploadUrl=C,this._needToFetchStatus=!1,this.completeTransitions_()},this._errorHandler)})}_fetchStatus(){const t=this._uploadUrl;this._resolveToken((o,a)=>{const p=function ze(n,t,o,a){const N=new c(o,"POST",function C(H){const X=E(H,["active","final"]);let Ie=null;try{Ie=H.getResponseHeader("X-Goog-Upload-Size-Received")}catch{f(!1)}Ie||f(!1);const Ce=Number(Ie);return f(!isNaN(Ce)),new y(Ce,a.size(),"final"===X)},n.maxUploadRetryTime);return N.headers={"X-Goog-Upload-Command":"query"},N.errorHandler=J(t),N}(this._ref.storage,this._ref._location,t,this._blob),C=this._ref.storage._makeRequest(p,v,o,a);this._request=C,C.getPromise().then(w=>{this._request=void 0,this._updateProgress(w.current),this._needToFetchStatus=!1,w.finalized&&(this._needToFetchMetadata=!0),this.completeTransitions_()},this._errorHandler)})}_continueUpload(){const t=262144*this._chunkMultiplier,o=new y(this._transferred,this._blob.size()),a=this._uploadUrl;this._resolveToken((p,C)=>{let w;try{w=function Ge(n,t,o,a,p,C,w,G){const N=new y(0,0);if(w?(N.current=w.current,N.total=w.total):(N.current=0,N.total=a.size()),a.size()!==N.total)throw function S(){return new z(Q.SERVER_FILE_WRONG_SIZE,"Server recorded incorrect upload file size, please retry the upload.")}();const H=N.total-N.current;let X=H;p>0&&(X=Math.min(X,p));const Ie=N.current;let ye="";ye=0===X?"finalize":H===X?"upload, finalize":"upload";const xe={"X-Goog-Upload-Command":ye,"X-Goog-Upload-Offset":`${N.current}`},ut=a.slice(Ie,Ie+X);if(null===ut)throw _();const Je=new c(o,"POST",function Re(Me,zt){const Xt=E(Me,["active","final"]),an=N.current+X,en=a.size();let un;return un="final"===Xt?k(t,C)(Me,zt):null,new y(an,en,"final"===Xt,un)},t.maxUploadRetryTime);return Je.headers=xe,Je.body=ut.uploadData(),Je.progressCallback=G||null,Je.errorHandler=J(n),Je}(this._ref._location,this._ref.storage,a,this._blob,t,this._mappings,o,this._makeProgressCallback())}catch(N){return this._error=N,void this._transition("error")}const G=this._ref.storage._makeRequest(w,v,p,C,!1);this._request=G,G.getPromise().then(N=>{this._increaseMultiplier(),this._request=void 0,this._updateProgress(N.current),N.finalized?(this._metadata=N.metadata,this._transition("success")):this.completeTransitions_()},this._errorHandler)})}_increaseMultiplier(){262144*this._chunkMultiplier*2<33554432&&(this._chunkMultiplier*=2)}_fetchMetadata(){this._resolveToken((t,o)=>{const a=at(this._ref.storage,this._ref._location,this._mappings),p=this._ref.storage._makeRequest(a,v,t,o);this._request=p,p.getPromise().then(C=>{this._request=void 0,this._metadata=C,this._transition("success")},this._metadataErrorHandler)})}_oneShotUpload(){this._resolveToken((t,o)=>{const a=function l(n,t,o,a,p){const C=t.bucketOnlyServerUrl(),w={"X-Goog-Upload-Protocol":"multipart"},N=function G(){let Je="";for(let Me=0;Me<2;Me++)Je+=Math.random().toString().slice(2);return Je}();w["Content-Type"]="multipart/related; boundary="+N;const H=s(t,a,p),X=qt(H,o),ye=ke.getBlob("--"+N+"\r\nContent-Type: application/json; charset=utf-8\r\n\r\n"+X+"\r\n--"+N+"\r\nContent-Type: "+H.contentType+"\r\n\r\n",a,"\r\n--"+N+"--");if(null===ye)throw _();const xe={name:H.fullPath},ut=$e(C,n.host,n._protocol),Mt=n.maxUploadRetryTime,Nt=new c(ut,"POST",k(n,o),Mt);return Nt.urlParams=xe,Nt.headers=w,Nt.body=ye.uploadData(),Nt.errorHandler=J(t),Nt}(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),p=this._ref.storage._makeRequest(a,v,t,o);this._request=p,p.getPromise().then(C=>{this._request=void 0,this._metadata=C,this._updateProgress(this._blob.size()),this._transition("success")},this._errorHandler)})}_updateProgress(t){const o=this._transferred;this._transferred=t,this._transferred!==o&&this._notifyObservers()}_transition(t){if(this._state!==t)switch(t){case"canceling":case"pausing":this._state=t,void 0!==this._request?this._request.cancel():this.pendingTimeout&&(clearTimeout(this.pendingTimeout),this.pendingTimeout=void 0,this.completeTransitions_());break;case"running":const o="paused"===this._state;this._state=t,o&&(this._notifyObservers(),this._start());break;case"paused":case"error":case"success":this._state=t,this._notifyObservers();break;case"canceled":this._error=A(),this._state=t,this._notifyObservers()}}completeTransitions_(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start()}}get snapshot(){const t=Fe(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:t,metadata:this._metadata,task:this,ref:this._ref}}on(t,o,a,p){const C=new kt(o||void 0,a||void 0,p||void 0);return this._addObserver(C),()=>{this._removeObserver(C)}}then(t,o){return this._promise.then(t,o)}catch(t){return this.then(null,t)}_addObserver(t){this._observers.push(t),this._notifyObserver(t)}_removeObserver(t){const o=this._observers.indexOf(t);-1!==o&&this._observers.splice(o,1)}_notifyObservers(){this._finishPromise(),this._observers.slice().forEach(o=>{this._notifyObserver(o)})}_finishPromise(){if(void 0!==this._resolve){let t=!0;switch(Fe(this._state)){case Te.SUCCESS:Rt(this._resolve.bind(null,this.snapshot))();break;case Te.CANCELED:case Te.ERROR:Rt(this._reject.bind(null,this._error))();break;default:t=!1}t&&(this._resolve=void 0,this._reject=void 0)}}_notifyObserver(t){switch(Fe(this._state)){case Te.RUNNING:case Te.PAUSED:t.next&&Rt(t.next.bind(t,this.snapshot))();break;case Te.SUCCESS:t.complete&&Rt(t.complete.bind(t))();break;default:t.error&&Rt(t.error.bind(t,this._error))()}}resume(){const t="paused"===this._state||"pausing"===this._state;return t&&this._transition("running"),t}pause(){const t="running"===this._state;return t&&this._transition("pausing"),t}cancel(){const t="running"===this._state||"pausing"===this._state;return t&&this._transition("canceling"),t}}class ge{constructor(t,o){this._service=t,this._location=o instanceof oe?o:oe.makeFromUrl(o,t.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(t,o){return new ge(t,o)}get root(){const t=new oe(this._location.bucket,"");return this._newRef(this._service,t)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return Dt(this._location.path)}get storage(){return this._service}get parent(){const t=function Ft(n){if(0===n.length)return null;const t=n.lastIndexOf("/");return-1===t?"":n.slice(0,t)}(this._location.path);if(null===t)return null;const o=new oe(this._location.bucket,t);return new ge(this._service,o)}_throwIfRoot(t){if(""===this._location.path)throw ce(t)}}function ln(n,t,o){return rn.apply(this,arguments)}function rn(){return(rn=(0,we.Z)(function*(n,t,o){const p=yield dn(n,{pageToken:o});t.prefixes.push(...p.prefixes),t.items.push(...p.items),null!=p.nextPageToken&&(yield ln(n,t,p.nextPageToken))})).apply(this,arguments)}function dn(n,t){null!=t&&"number"==typeof t.maxResults&&Ve("options.maxResults",1,1e3,t.maxResults);const o=t||{},a=tt(n.storage,n._location,"/",o.pageToken,o.maxResults);return n.storage.makeRequestWithTokens(a,v)}function Fn(n){n._throwIfRoot("getDownloadURL");const t=function xt(n,t,o){const p=$e(t.fullServerUrl(),n.host,n._protocol),w=n.maxOperationRetryTime,G=new c(p,"GET",function j(n,t){return function o(a,p){const C=Et(n,p,t);return f(null!==C),function Ot(n,t,o,a){const p=ft(t);if(null===p||!re(p.downloadTokens))return null;const C=p.downloadTokens;if(0===C.length)return null;const w=encodeURIComponent;return C.split(",").map(H=>{const Ie=n.fullPath;return $e("/b/"+w(n.bucket)+"/o/"+w(Ie),o,a)+_t({alt:"media",token:H})})[0]}(C,p,n.host,n._protocol)}}(n,o),w);return G.errorHandler=ie(t),G}(n.storage,n._location,et());return n.storage.makeRequestWithTokens(t,v).then(o=>{if(null===o)throw function R(){return new z(Q.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}();return o})}function pn(n,t){const o=function St(n,t){const o=t.split("/").filter(a=>a.length>0).join("/");return 0===n.length?o:n+"/"+o}(n._location.path,t),a=new oe(n._location.bucket,o);return new ge(n.storage,a)}function hn(n,t){if(n instanceof sn){const o=n;if(null==o._bucket)throw function U(){return new z(Q.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+le+"' property when initializing the app?")}();const a=new ge(o,o._bucket);return null!=t?hn(a,t):a}return void 0!==t?pn(n,t):n}function On(n,t){if(t&&function Dn(n){return/^[A-Za-z]+:\/\//.test(n)}(t)){if(n instanceof sn)return function Pn(n,t){return new ge(n,t)}(n,t);throw m("To use ref(service, url), the first argument must be a Storage instance.")}return hn(n,t)}function fn(n,t){const o=t?.[le];return null==o?null:oe.makeFromBucketSpec(o,n)}class sn{constructor(t,o,a,p,C){this.app=t,this._authProvider=o,this._appCheckProvider=a,this._url=p,this._firebaseVersion=C,this._bucket=null,this._host=We,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=12e4,this._maxUploadRetryTime=6e5,this._requests=new Set,this._bucket=null!=p?oe.makeFromBucketSpec(p,this._host):fn(this._host,this.app.options)}get host(){return this._host}set host(t){this._host=t,this._bucket=null!=this._url?oe.makeFromBucketSpec(this._url,t):fn(t,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(t){Ve("time",0,Number.POSITIVE_INFINITY,t),this._maxUploadRetryTime=t}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(t){Ve("time",0,Number.POSITIVE_INFINITY,t),this._maxOperationRetryTime=t}_getAuthToken(){var t=this;return(0,we.Z)(function*(){if(t._overrideAuthToken)return t._overrideAuthToken;const o=t._authProvider.getImmediate({optional:!0});if(o){const a=yield o.getToken();if(null!==a)return a.accessToken}return null})()}_getAppCheckToken(){var t=this;return(0,we.Z)(function*(){const o=t._appCheckProvider.getImmediate({optional:!0});return o?(yield o.getToken()).token:null})()}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(t=>t.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(t){return new ge(this,t)}_makeRequest(t,o,a,p,C=!0){if(this._deleted)return new Qe(q());{const w=function Lt(n,t,o,a,p,C,w=!0){const G=_t(n.urlParams),N=n.url+G,H=Object.assign({},n.headers);return function Qt(n,t){t&&(n["X-Firebase-GMPID"]=t)}(H,t),function rt(n,t){null!==t&&t.length>0&&(n.Authorization="Firebase "+t)}(H,o),function Ut(n,t){n["X-Firebase-Storage-Version"]="webjs/"+(t??"AppManager")}(H,C),function Ht(n,t){null!==t&&(n["X-Firebase-AppCheck"]=t)}(H,a),new jt(N,n.method,H,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,p,w)}(t,this._appId,a,p,o,this._firebaseVersion,C);return this._requests.add(w),w.getPromise().then(()=>this._requests.delete(w),()=>this._requests.delete(w)),w}}makeRequestWithTokens(t,o){var a=this;return(0,we.Z)(function*(){const[p,C]=yield Promise.all([a._getAuthToken(),a._getAppCheckToken()]);return a._makeRequest(t,o,p,C).getPromise()})()}}const gn="@firebase/storage";function vn(n,t){return On(n=(0,he.m9)(n),t)}function jn(n,{instanceIdentifier:t}){const o=n.getProvider("app").getImmediate(),a=n.getProvider("auth-internal"),p=n.getProvider("app-check-internal");return new sn(o,a,p,t,Ee.SDK_VERSION)}!function Qn(){(0,Ee._registerComponent)(new Pe.wA("storage",jn,"PUBLIC").setMultipleInstances(!0)),(0,Ee.registerVersion)(gn,"0.12.0",""),(0,Ee.registerVersion)(gn,"0.12.0","esm2017")}();class nn{constructor(t,o,a){this._delegate=t,this.task=o,this.ref=a}get bytesTransferred(){return this._delegate.bytesTransferred}get metadata(){return this._delegate.metadata}get state(){return this._delegate.state}get totalBytes(){return this._delegate.totalBytes}}class yn{constructor(t,o){this._delegate=t,this._ref=o,this.cancel=this._delegate.cancel.bind(this._delegate),this.catch=this._delegate.catch.bind(this._delegate),this.pause=this._delegate.pause.bind(this._delegate),this.resume=this._delegate.resume.bind(this._delegate)}get snapshot(){return new nn(this._delegate.snapshot,this,this._ref)}then(t,o){return this._delegate.then(a=>{if(t)return t(new nn(a,this,this._ref))},o)}on(t,o,a,p){let C;return o&&(C="function"==typeof o?w=>o(new nn(w,this,this._ref)):{next:o.next?w=>o.next(new nn(w,this,this._ref)):void 0,complete:o.complete||void 0,error:o.error||void 0}),this._delegate.on(t,C,a||void 0,p||void 0)}}class bn{constructor(t,o){this._delegate=t,this._service=o}get prefixes(){return this._delegate.prefixes.map(t=>new Zt(t,this._service))}get items(){return this._delegate.items.map(t=>new Zt(t,this._service))}get nextPageToken(){return this._delegate.nextPageToken||null}}class Zt{constructor(t,o){this._delegate=t,this.storage=o}get name(){return this._delegate.name}get bucket(){return this._delegate.bucket}get fullPath(){return this._delegate.fullPath}toString(){return this._delegate.toString()}child(t){const o=function Jn(n,t){return pn(n,t)}(this._delegate,t);return new Zt(o,this.storage)}get root(){return new Zt(this._delegate.root,this.storage)}get parent(){const t=this._delegate.parent;return null==t?null:new Zt(t,this.storage)}put(t,o){return this._throwIfRoot("put"),new yn(function Zn(n,t,o){return function In(n,t,o){return n._throwIfRoot("uploadBytesResumable"),new Ae(n,new ke(t),o)}(n=(0,he.m9)(n),t,o)}(this._delegate,t,o),this)}putString(t,o=Ue.RAW,a){this._throwIfRoot("putString");const p=Ze(o,t),C=Object.assign({},a);return null==C.contentType&&null!=p.contentType&&(C.contentType=p.contentType),new yn(new Ae(this._delegate,new ke(p.data,!0),C),this)}listAll(){return function $n(n){return function kn(n){const t={prefixes:[],items:[]};return ln(n,t).then(()=>t)}(n=(0,he.m9)(n))}(this._delegate).then(t=>new bn(t,this.storage))}list(t){return function Ln(n,t){return dn(n=(0,he.m9)(n),t)}(this._delegate,t||void 0).then(o=>new bn(o,this.storage))}getMetadata(){return function Mn(n){return function Rn(n){n._throwIfRoot("getMetadata");const t=at(n.storage,n._location,et());return n.storage.makeRequestWithTokens(t,v)}(n=(0,he.m9)(n))}(this._delegate)}updateMetadata(t){return function Nn(n,t){return function Un(n,t){n._throwIfRoot("updateMetadata");const o=function d(n,t,o,a){const C=$e(t.fullServerUrl(),n.host,n._protocol),G=qt(o,a),H=n.maxOperationRetryTime,X=new c(C,"PATCH",k(n,a),H);return X.headers={"Content-Type":"application/json; charset=utf-8"},X.body=G,X.errorHandler=ie(t),X}(n.storage,n._location,t,et());return n.storage.makeRequestWithTokens(o,v)}(n=(0,he.m9)(n),t)}(this._delegate,t)}getDownloadURL(){return function Gn(n){return Fn(n=(0,he.m9)(n))}(this._delegate)}delete(){return this._throwIfRoot("delete"),function qn(n){return function Sn(n){n._throwIfRoot("deleteObject");const t=function M(n,t){const a=$e(t.fullServerUrl(),n.host,n._protocol),G=new c(a,"DELETE",function w(N,H){},n.maxOperationRetryTime);return G.successCodes=[200,204],G.errorHandler=ie(t),G}(n.storage,n._location);return n.storage.makeRequestWithTokens(t,v)}(n=(0,he.m9)(n))}(this._delegate)}_throwIfRoot(t){if(""===this._delegate._location.path)throw ce(t)}}class Tn{constructor(t,o){this.app=t,this._delegate=o}get maxOperationRetryTime(){return this._delegate.maxOperationRetryTime}get maxUploadRetryTime(){return this._delegate.maxUploadRetryTime}ref(t){if(An(t))throw m("ref() expected a child path but got a URL, use refFromURL instead.");return new Zt(vn(this._delegate,t),this)}refFromURL(t){if(!An(t))throw m("refFromURL() expected a full URL but got a child path, use ref() instead.");try{oe.makeFromUrl(t,this._delegate.host)}catch{throw m("refFromUrl() expected a valid full URL but got an invalid one.")}return new Zt(vn(this._delegate,t),this)}setMaxUploadRetryTime(t){this._delegate.maxUploadRetryTime=t}setMaxOperationRetryTime(t){this._delegate.maxOperationRetryTime=t}useEmulator(t,o,a={}){!function Cn(n,t,o,a={}){!function Bn(n,t,o,a={}){n.host=`${t}:${o}`,n._protocol="http";const{mockUserToken:p}=a;p&&(n._overrideAuthToken="string"==typeof p?p:(0,he.Sg)(p,n.app.options.projectId))}(n,t,o,a)}(this._delegate,t,o,a)}}function An(n){return/^[A-Za-z]+:\/\//.test(n)}function Vn(n,{instanceIdentifier:t}){const o=n.getProvider("app-compat").getImmediate(),a=n.getProvider("storage").getImmediate({identifier:t});return new Tn(o,a)}!function Yn(n){const t={TaskState:Te,TaskEvent:mt,StringFormat:Ue,Storage:Tn,Reference:Zt};n.INTERNAL.registerComponent(new Pe.wA("storage-compat",Vn,"PUBLIC").setServiceProps(t).setMultipleInstances(!0)),n.registerVersion("@firebase/storage-compat","0.3.3")}(Xe.Z);var zn=g(7142);function wn(n){const t=function Xn(n){return new r.y(t=>{const o=w=>t.next(w);o(n.snapshot);const C=n.on("state_changed",o);return n.then(w=>{o(w),t.complete()},w=>{o(n.snapshot),(w=>{t.error(w)})(w)}),function(){C()}}).pipe((0,ne.b)(0))}(n);return{task:n,then:n.then.bind(n),catch:n.catch.bind(n),pause:n.pause.bind(n),cancel:n.cancel.bind(n),resume:n.resume.bind(n),snapshotChanges:()=>t,percentageChanges:()=>t.pipe((0,me.U)(o=>o.bytesTransferred/o.totalBytes*100))}}function on(n){return{getDownloadURL:()=>(0,K.of)(void 0).pipe(F.fc,(0,pe.w)(()=>n.getDownloadURL()),F.iC),getMetadata:()=>(0,K.of)(void 0).pipe(F.fc,(0,pe.w)(()=>n.getMetadata()),F.iC),delete:()=>(0,de.D)(n.delete()),child:t=>on(n.child(t)),updateMetadata:t=>(0,de.D)(n.updateMetadata(t)),put:(t,o)=>wn(n.put(t,o)),putString:(t,o,a)=>wn(n.putString(t,o,a)),list:t=>(0,de.D)(n.list(t)),listAll:()=>(0,de.D)(n.listAll())}}const eo=new L.OlP("angularfire2.storageBucket"),to=new L.OlP("angularfire2.storage.maxUploadRetryTime"),no=new L.OlP("angularfire2.storage.maxOperationRetryTime"),oo=new L.OlP("angularfire2.storage.use-emulator");let En=(()=>{class n{storage;constructor(o,a,p,C,w,G,N,H,X,Ie){const Ce=(0,e.on)(o,w,a);this.storage=(0,e.cc)(`${Ce.name}.storage.${p}`,"AngularFireStorage",Ce.name,()=>{const ye=w.runOutsideAngular(()=>Ce.storage(p||void 0)),xe=X;return xe&&ye.useEmulator(...xe),N&&ye.setMaxUploadRetryTime(N),H&&ye.setMaxOperationRetryTime(H),ye},[N,H])}ref(o){return on(this.storage.ref(o))}refFromURL(o){return on(this.storage.refFromURL(o))}upload(o,a,p){return on(this.storage.ref(o)).put(a,p)}static \u0275fac=function(a){return new(a||n)(L.LFG(e.Dh),L.LFG(e.xv,8),L.LFG(eo,8),L.LFG(L.Lbi),L.LFG(L.R0b),L.LFG(F.HU),L.LFG(to,8),L.LFG(no,8),L.LFG(oo,8),L.LFG(F.Rf,8))};static \u0275prov=L.Yz7({token:n,factory:n.\u0275fac,providedIn:"any"})}return n})(),ro=(()=>{class n{static \u0275fac=function(a){return new(a||n)};static \u0275mod=L.oAB({type:n});static \u0275inj=L.cJS({})}return n})(),io=(()=>{class n{constructor(){zn.Z.registerVersion("angularfire",F.q4.full,"gcs-compat")}static \u0275fac=function(a){return new(a||n)};static \u0275mod=L.oAB({type:n});static \u0275inj=L.cJS({providers:[En],imports:[ro]})}return n})()},3882:(Jt,De,g)=>{var F=g(5861),r=g(6122),K=g(4537),de=g(9058);const ne=(u,h)=>h.some(v=>u instanceof v);let me,pe;const Xe=new WeakMap,we=new WeakMap,Ee=new WeakMap,he=new WeakMap,Pe=new WeakMap;let ue={get(u,h,v){if(u instanceof IDBTransaction){if("done"===h)return we.get(u);if("objectStoreNames"===h)return u.objectStoreNames||Ee.get(u);if("store"===h)return v.objectStoreNames[1]?void 0:v.objectStore(v.objectStoreNames[0])}return Q(u[h])},set:(u,h,v)=>(u[h]=v,!0),has:(u,h)=>u instanceof IDBTransaction&&("done"===h||"store"===h)||h in u};function z(u){return"function"==typeof u?function Se(u){return u!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?function e(){return pe||(pe=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}().includes(u)?function(...h){return u.apply(Ne(this),h),Q(Xe.get(this))}:function(...h){return Q(u.apply(Ne(this),h))}:function(h,...v){const Z=u.call(Ne(this),h,...v);return Ee.set(Z,h.sort?h.sort():[h]),Q(Z)}}(u):(u instanceof IDBTransaction&&function le(u){if(we.has(u))return;const h=new Promise((v,Z)=>{const Y=()=>{u.removeEventListener("complete",V),u.removeEventListener("error",se),u.removeEventListener("abort",se)},V=()=>{v(),Y()},se=()=>{Z(u.error||new DOMException("AbortError","AbortError")),Y()};u.addEventListener("complete",V),u.addEventListener("error",se),u.addEventListener("abort",se)});we.set(u,h)}(u),ne(u,function L(){return me||(me=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}())?new Proxy(u,ue):u)}function Q(u){if(u instanceof IDBRequest)return function We(u){const h=new Promise((v,Z)=>{const Y=()=>{u.removeEventListener("success",V),u.removeEventListener("error",se)},V=()=>{v(Q(u.result)),Y()},se=()=>{Z(u.error),Y()};u.addEventListener("success",V),u.addEventListener("error",se)});return h.then(v=>{v instanceof IDBCursor&&Xe.set(v,u)}).catch(()=>{}),Pe.set(h,u),h}(u);if(he.has(u))return he.get(u);const h=z(u);return h!==u&&(he.set(u,h),Pe.set(h,u)),h}const Ne=u=>Pe.get(u),_e=["get","getKey","getAll","getAllKeys","count"],je=["put","add","delete","clear"],ee=new Map;function Le(u,h){if(!(u instanceof IDBDatabase)||h in u||"string"!=typeof h)return;if(ee.get(h))return ee.get(h);const v=h.replace(/FromIndex$/,""),Z=h!==v,Y=je.includes(v);if(!(v in(Z?IDBIndex:IDBObjectStore).prototype)||!Y&&!_e.includes(v))return;const V=function(){var se=(0,F.Z)(function*(Ae,...ge){const qe=this.transaction(Ae,Y?"readwrite":"readonly");let Yt=qe.store;return Z&&(Yt=Yt.index(ge.shift())),(yield Promise.all([Yt[v](...ge),Y&&qe.done]))[0]});return function(ge){return se.apply(this,arguments)}}();return ee.set(h,V),V}!function fe(u){ue=u(ue)}(u=>({...u,get:(h,v,Z)=>Le(h,v)||u.get(h,v,Z),has:(h,v)=>!!Le(h,v)||u.has(h,v)}));const T="@firebase/installations",A="0.6.4",b=1e4,I=`w:${A}`,U="FIS_v2",_="https://firebaseinstallations.googleapis.com/v1",S=36e5,q=new de.LL("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function ce(u){return u instanceof de.ZR&&u.code.includes("request-failed")}function te({projectId:u}){return`${_}/projects/${u}/installations`}function be(u){return{token:u.token,requestStatus:2,expiresIn:D(u.expiresIn),creationTime:Date.now()}}function oe(u,h){return Qe.apply(this,arguments)}function Qe(){return(Qe=(0,F.Z)(function*(u,h){const Z=(yield h.json()).error;return q.create("request-failed",{requestName:u,serverCode:Z.code,serverMessage:Z.message,serverStatus:Z.status})})).apply(this,arguments)}function O({apiKey:u}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":u})}function x(u){return $.apply(this,arguments)}function $(){return($=(0,F.Z)(function*(u){const h=yield u();return h.status>=500&&h.status<600?u():h})).apply(this,arguments)}function D(u){return Number(u.replace("s","000"))}function ot(){return(ot=(0,F.Z)(function*({appConfig:u,heartbeatServiceProvider:h},{fid:v}){const Z=te(u),Y=O(u),V=h.getImmediate({optional:!0});if(V){const qe=yield V.getHeartbeatsHeader();qe&&Y.append("x-firebase-client",qe)}const Ae={method:"POST",headers:Y,body:JSON.stringify({fid:v,authVersion:U,appId:u.appId,sdkVersion:I})},ge=yield x(()=>fetch(Z,Ae));if(ge.ok){const qe=yield ge.json();return{fid:qe.fid||v,registrationStatus:2,refreshToken:qe.refreshToken,authToken:be(qe.authToken)}}throw yield oe("Create Installation",ge)})).apply(this,arguments)}function Ve(u){return new Promise(h=>{setTimeout(h,u)})}const _t=/^[cdef][\w-]{21}$/,He="";function vt(){try{const u=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(u),u[0]=112+u[0]%16;const v=function jt(u){return function $e(u){return btoa(String.fromCharCode(...u)).replace(/\+/g,"-").replace(/\//g,"_")}(u).substr(0,22)}(u);return _t.test(v)?v:He}catch{return He}}function Be(u){return`${u.appName}!${u.appId}`}const rt=new Map;function Ut(u,h){const v=Be(u);Lt(v,h),function Kt(u,h){const v=function $t(){return!Ye&&"BroadcastChannel"in self&&(Ye=new BroadcastChannel("[Firebase] FID Change"),Ye.onmessage=u=>{Lt(u.data.key,u.data.fid)}),Ye}();v&&v.postMessage({key:u,fid:h}),function Ct(){0===rt.size&&Ye&&(Ye.close(),Ye=null)}()}(v,h)}function Lt(u,h){const v=rt.get(u);if(v)for(const Z of v)Z(h)}let Ye=null;const Ue="firebase-installations-database",yt=1,Ze="firebase-installations-store";let bt=null;function lt(){return bt||(bt=function Oe(u,h,{blocked:v,upgrade:Z,blocking:Y,terminated:V}={}){const se=indexedDB.open(u,h),Ae=Q(se);return Z&&se.addEventListener("upgradeneeded",ge=>{Z(Q(se.result),ge.oldVersion,ge.newVersion,Q(se.transaction))}),v&&se.addEventListener("blocked",()=>v()),Ae.then(ge=>{V&&ge.addEventListener("close",()=>V()),Y&&ge.addEventListener("versionchange",()=>Y())}).catch(()=>{}),Ae}(Ue,yt,{upgrade:(u,h)=>{0===h&&u.createObjectStore(Ze)}})),bt}function dt(u,h){return it.apply(this,arguments)}function it(){return(it=(0,F.Z)(function*(u,h){const v=Be(u),Y=(yield lt()).transaction(Ze,"readwrite"),V=Y.objectStore(Ze),se=yield V.get(v);return yield V.put(h,v),yield Y.done,(!se||se.fid!==h.fid)&&Ut(u,h.fid),h})).apply(this,arguments)}function Tt(u){return pt.apply(this,arguments)}function pt(){return(pt=(0,F.Z)(function*(u){const h=Be(u),Z=(yield lt()).transaction(Ze,"readwrite");yield Z.objectStore(Ze).delete(h),yield Z.done})).apply(this,arguments)}function ht(u,h){return ke.apply(this,arguments)}function ke(){return(ke=(0,F.Z)(function*(u,h){const v=Be(u),Y=(yield lt()).transaction(Ze,"readwrite"),V=Y.objectStore(Ze),se=yield V.get(v),Ae=h(se);return void 0===Ae?yield V.delete(v):yield V.put(Ae,v),yield Y.done,Ae&&(!se||se.fid!==Ae.fid)&&Ut(u,Ae.fid),Ae})).apply(this,arguments)}function ft(u){return Ft.apply(this,arguments)}function Ft(){return Ft=(0,F.Z)(function*(u){let h;const v=yield ht(u.appConfig,Z=>{const Y=function St(u){return wt(u||{fid:vt(),registrationStatus:0})}(Z),V=function Dt(u,h){if(0===h.registrationStatus){if(!navigator.onLine)return{installationEntry:h,registrationPromise:Promise.reject(q.create("app-offline"))};const v={fid:h.fid,registrationStatus:1,registrationTime:Date.now()},Z=function Gt(u,h){return ve.apply(this,arguments)}(u,v);return{installationEntry:v,registrationPromise:Z}}return 1===h.registrationStatus?{installationEntry:h,registrationPromise:At(u)}:{installationEntry:h}}(u,Y);return h=V.registrationPromise,V.installationEntry});return v.fid===He?{installationEntry:yield h}:{installationEntry:v,registrationPromise:h}}),Ft.apply(this,arguments)}function ve(){return ve=(0,F.Z)(function*(u,h){try{const v=yield function nt(u,h){return ot.apply(this,arguments)}(u,h);return dt(u.appConfig,v)}catch(v){throw ce(v)&&409===v.customData.serverCode?yield Tt(u.appConfig):yield dt(u.appConfig,{fid:h.fid,registrationStatus:0}),v}}),ve.apply(this,arguments)}function At(u){return Pt.apply(this,arguments)}function Pt(){return(Pt=(0,F.Z)(function*(u){let h=yield et(u.appConfig);for(;1===h.registrationStatus;)yield Ve(100),h=yield et(u.appConfig);if(0===h.registrationStatus){const{installationEntry:v,registrationPromise:Z}=yield ft(u);return Z||v}return h})).apply(this,arguments)}function et(u){return ht(u,h=>{if(!h)throw q.create("installation-not-found");return wt(h)})}function wt(u){return function Wt(u){return 1===u.registrationStatus&&u.registrationTime+b<Date.now()}(u)?{fid:u.fid,registrationStatus:0}:u}function Ot(){return(Ot=(0,F.Z)(function*({appConfig:u,heartbeatServiceProvider:h},v){const Z=function qt(u,{fid:h}){return`${te(u)}/${h}/authTokens:generate`}(u,v),Y=function W(u,{refreshToken:h}){const v=O(u);return v.append("Authorization",function re(u){return`${U} ${u}`}(h)),v}(u,v),V=h.getImmediate({optional:!0});if(V){const qe=yield V.getHeartbeatsHeader();qe&&Y.append("x-firebase-client",qe)}const Ae={method:"POST",headers:Y,body:JSON.stringify({installation:{sdkVersion:I,appId:u.appId}})},ge=yield x(()=>fetch(Z,Ae));if(ge.ok)return be(yield ge.json());throw yield oe("Generate Auth Token",ge)})).apply(this,arguments)}function It(u){return st.apply(this,arguments)}function st(){return st=(0,F.Z)(function*(u,h=!1){let v;const Z=yield ht(u.appConfig,V=>{if(!B(V))throw q.create("not-registered");const se=V.authToken;if(!h&&function j(u){return 2===u.requestStatus&&!function J(u){const h=Date.now();return h<u.creationTime||u.creationTime+u.expiresIn<h+S}(u)}(se))return V;if(1===se.requestStatus)return v=function Vt(u,h){return Bt.apply(this,arguments)}(u,h),V;{if(!navigator.onLine)throw q.create("app-offline");const Ae=function ie(u){const h={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},u),{authToken:h})}(V);return v=function f(u,h){return k.apply(this,arguments)}(u,Ae),Ae}});return v?yield v:Z.authToken}),st.apply(this,arguments)}function Bt(){return(Bt=(0,F.Z)(function*(u,h){let v=yield c(u.appConfig);for(;1===v.authToken.requestStatus;)yield Ve(100),v=yield c(u.appConfig);const Z=v.authToken;return 0===Z.requestStatus?It(u,h):Z})).apply(this,arguments)}function c(u){return ht(u,h=>{if(!B(h))throw q.create("not-registered");return function at(u){return 1===u.requestStatus&&u.requestTime+b<Date.now()}(h.authToken)?Object.assign(Object.assign({},h),{authToken:{requestStatus:0}}):h})}function k(){return k=(0,F.Z)(function*(u,h){try{const v=yield function Et(u,h){return Ot.apply(this,arguments)}(u,h),Z=Object.assign(Object.assign({},h),{authToken:v});return yield dt(u.appConfig,Z),v}catch(v){if(!ce(v)||401!==v.customData.serverCode&&404!==v.customData.serverCode){const Z=Object.assign(Object.assign({},h),{authToken:{requestStatus:0}});yield dt(u.appConfig,Z)}else yield Tt(u.appConfig);throw v}}),k.apply(this,arguments)}function B(u){return void 0!==u&&2===u.registrationStatus}function gt(){return(gt=(0,F.Z)(function*(u){const h=u,{installationEntry:v,registrationPromise:Z}=yield ft(h);return Z?Z.catch(console.error):It(h).catch(console.error),v.fid})).apply(this,arguments)}function d(){return d=(0,F.Z)(function*(u,h=!1){const v=u;return yield function M(u){return i.apply(this,arguments)}(v),(yield It(v,h)).token}),d.apply(this,arguments)}function i(){return(i=(0,F.Z)(function*(u){const{registrationPromise:h}=yield ft(u);h&&(yield h)})).apply(this,arguments)}function mt(u){return q.create("missing-app-config-values",{valueName:u})}const Te="installations",kt=u=>{const h=u.getProvider("app").getImmediate(),v=function Ge(u){if(!u||!u.options)throw mt("App Configuration");if(!u.name)throw mt("App Name");const h=["projectId","apiKey","appId"];for(const v of h)if(!u.options[v])throw mt(v);return{appName:u.name,projectId:u.options.projectId,apiKey:u.options.apiKey,appId:u.options.appId}}(h);return{app:h,appConfig:v,heartbeatServiceProvider:(0,r.qX)(h,"heartbeat"),_delete:()=>Promise.resolve()}},Rt=u=>{const h=u.getProvider("app").getImmediate(),v=(0,r.qX)(h,Te).getImmediate();return{getId:()=>function tt(u){return gt.apply(this,arguments)}(v),getToken:Y=>function xt(u){return d.apply(this,arguments)}(v,Y)}};(function tn(){(0,r.Xd)(new K.wA(Te,kt,"PUBLIC")),(0,r.Xd)(new K.wA("installations-internal",Rt,"PRIVATE"))})(),(0,r.KN)(T,A),(0,r.KN)(T,A,"esm2017")},3338:(Jt,De,g)=>{g.d(De,{Gb:()=>et,LP:()=>It,pQ:()=>Vt,ps:()=>Bt});var F=g(5861),K=(g(3882),g(4537)),de=g(8667),ne=g(9058),me=g(9032);const pe="/firebase-messaging-sw.js",L="/firebase-cloud-messaging-push-scope",e="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",Xe="https://fcmregistrations.googleapis.com/v1",we="google.c.a.c_id",Ee="google.c.a.c_l",he="google.c.a.ts";var le=function(c){return c.PUSH_RECEIVED="push-received",c.NOTIFICATION_CLICKED="notification-clicked",c}(le||{});function ue(c){const f=new Uint8Array(c);return btoa(String.fromCharCode(...f)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function fe(c){const k=(c+"=".repeat((4-c.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),B=atob(k),j=new Uint8Array(B.length);for(let J=0;J<B.length;++J)j[J]=B.charCodeAt(J);return j}const Se="fcm_token_details_db",z=5,Q="fcm_token_object_Store";function Oe(){return Oe=(0,F.Z)(function*(c){if("databases"in indexedDB&&!(yield indexedDB.databases()).map(J=>J.name).includes(Se))return null;let f=null;return(yield(0,de.X3)(Se,z,{upgrade:(B=(0,F.Z)(function*(j,J,ie,at){var tt;if(J<2||!j.objectStoreNames.contains(Q))return;const gt=at.objectStore(Q),xt=yield gt.index("fcmSenderId").get(c);if(yield gt.clear(),xt)if(2===J){const d=xt;if(!d.auth||!d.p256dh||!d.endpoint)return;f={token:d.fcmToken,createTime:null!==(tt=d.createTime)&&void 0!==tt?tt:Date.now(),subscriptionOptions:{auth:d.auth,p256dh:d.p256dh,endpoint:d.endpoint,swScope:d.swScope,vapidKey:"string"==typeof d.vapidKey?d.vapidKey:ue(d.vapidKey)}}}else if(3===J){const d=xt;f={token:d.fcmToken,createTime:d.createTime,subscriptionOptions:{auth:ue(d.auth),p256dh:ue(d.p256dh),endpoint:d.endpoint,swScope:d.swScope,vapidKey:ue(d.vapidKey)}}}else if(4===J){const d=xt;f={token:d.fcmToken,createTime:d.createTime,subscriptionOptions:{auth:ue(d.auth),p256dh:ue(d.p256dh),endpoint:d.endpoint,swScope:d.swScope,vapidKey:ue(d.vapidKey)}}}}),function(J,ie,at,tt){return B.apply(this,arguments)})})).close(),yield(0,de.Lj)(Se),yield(0,de.Lj)("fcm_vapid_details_db"),yield(0,de.Lj)("undefined"),function ct(c){if(!c||!c.subscriptionOptions)return!1;const{subscriptionOptions:f}=c;return"number"==typeof c.createTime&&c.createTime>0&&"string"==typeof c.token&&c.token.length>0&&"string"==typeof f.auth&&f.auth.length>0&&"string"==typeof f.p256dh&&f.p256dh.length>0&&"string"==typeof f.endpoint&&f.endpoint.length>0&&"string"==typeof f.swScope&&f.swScope.length>0&&"string"==typeof f.vapidKey&&f.vapidKey.length>0}(f)?f:null;var B}),Oe.apply(this,arguments)}const _e="firebase-messaging-database",je=1,ee="firebase-messaging-store";let Le=null;function T(){return Le||(Le=(0,de.X3)(_e,je,{upgrade:(c,f)=>{0===f&&c.createObjectStore(ee)}})),Le}function A(c){return b.apply(this,arguments)}function b(){return b=(0,F.Z)(function*(c){const f=R(c),B=yield(yield T()).transaction(ee).objectStore(ee).get(f);if(B)return B;{const j=yield function Ne(c){return Oe.apply(this,arguments)}(c.appConfig.senderId);if(j)return yield I(c,j),j}}),b.apply(this,arguments)}function I(c,f){return U.apply(this,arguments)}function U(){return(U=(0,F.Z)(function*(c,f){const k=R(c),j=(yield T()).transaction(ee,"readwrite");return yield j.objectStore(ee).put(f,k),yield j.done,f})).apply(this,arguments)}function S(){return(S=(0,F.Z)(function*(c){const f=R(c),B=(yield T()).transaction(ee,"readwrite");yield B.objectStore(ee).delete(f),yield B.done})).apply(this,arguments)}function R({appConfig:c}){return c.appId}const m=new ne.LL("messaging","Messaging",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."});function q(c,f){return ce.apply(this,arguments)}function ce(){return(ce=(0,F.Z)(function*(c,f){const k=yield W(c),B=$(f),j={method:"POST",headers:k,body:JSON.stringify(B)};let J;try{J=yield(yield fetch(O(c.appConfig),j)).json()}catch(ie){throw m.create("token-subscribe-failed",{errorInfo:ie?.toString()})}if(J.error)throw m.create("token-subscribe-failed",{errorInfo:J.error.message});if(!J.token)throw m.create("token-subscribe-no-token");return J.token})).apply(this,arguments)}function be(){return(be=(0,F.Z)(function*(c,f){const k=yield W(c),B=$(f.subscriptionOptions),j={method:"PATCH",headers:k,body:JSON.stringify(B)};let J;try{J=yield(yield fetch(`${O(c.appConfig)}/${f.token}`,j)).json()}catch(ie){throw m.create("token-update-failed",{errorInfo:ie?.toString()})}if(J.error)throw m.create("token-update-failed",{errorInfo:J.error.message});if(!J.token)throw m.create("token-update-no-token");return J.token})).apply(this,arguments)}function oe(c,f){return Qe.apply(this,arguments)}function Qe(){return(Qe=(0,F.Z)(function*(c,f){const B={method:"DELETE",headers:yield W(c)};try{const J=yield(yield fetch(`${O(c.appConfig)}/${f}`,B)).json();if(J.error)throw m.create("token-unsubscribe-failed",{errorInfo:J.error.message})}catch(j){throw m.create("token-unsubscribe-failed",{errorInfo:j?.toString()})}})).apply(this,arguments)}function O({projectId:c}){return`${Xe}/projects/${c}/registrations`}function W(c){return x.apply(this,arguments)}function x(){return(x=(0,F.Z)(function*({appConfig:c,installations:f}){const k=yield f.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":c.apiKey,"x-goog-firebase-installations-auth":`FIS ${k}`})})).apply(this,arguments)}function $({p256dh:c,auth:f,endpoint:k,vapidKey:B}){const j={web:{endpoint:k,auth:f,p256dh:c}};return B!==e&&(j.web.applicationPubKey=B),j}const D=6048e5;function nt(){return nt=(0,F.Z)(function*(c){const f=yield function jt(c,f){return Be.apply(this,arguments)}(c.swRegistration,c.vapidKey),k={vapidKey:c.vapidKey,swScope:c.swRegistration.scope,endpoint:f.endpoint,auth:ue(f.getKey("auth")),p256dh:ue(f.getKey("p256dh"))},B=yield A(c.firebaseDependencies);if(B){if(function rt(c,f){return f.vapidKey===c.vapidKey&&f.endpoint===c.endpoint&&f.auth===c.auth&&f.p256dh===c.p256dh}(B.subscriptionOptions,k))return Date.now()>=B.createTime+D?function $e(c,f){return _t.apply(this,arguments)}(c,{token:B.token,createTime:Date.now(),subscriptionOptions:k}):B.token;try{yield oe(c.firebaseDependencies,B.token)}catch(j){console.warn(j)}return He(c.firebaseDependencies,k)}return He(c.firebaseDependencies,k)}),nt.apply(this,arguments)}function ot(c){return Ve.apply(this,arguments)}function Ve(){return Ve=(0,F.Z)(function*(c){const f=yield A(c.firebaseDependencies);f&&(yield oe(c.firebaseDependencies,f.token),yield function _(c){return S.apply(this,arguments)}(c.firebaseDependencies));const k=yield c.swRegistration.pushManager.getSubscription();return!k||k.unsubscribe()}),Ve.apply(this,arguments)}function _t(){return _t=(0,F.Z)(function*(c,f){try{const k=yield function te(c,f){return be.apply(this,arguments)}(c.firebaseDependencies,f),B=Object.assign(Object.assign({},f),{token:k,createTime:Date.now()});return yield I(c.firebaseDependencies,B),k}catch(k){throw yield ot(c),k}}),_t.apply(this,arguments)}function He(c,f){return vt.apply(this,arguments)}function vt(){return(vt=(0,F.Z)(function*(c,f){const B={token:yield q(c,f),createTime:Date.now(),subscriptionOptions:f};return yield I(c,B),B.token})).apply(this,arguments)}function Be(){return(Be=(0,F.Z)(function*(c,f){return(yield c.pushManager.getSubscription())||c.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:fe(f)})})).apply(this,arguments)}function Ut(c){const f={from:c.from,collapseKey:c.collapse_key,messageId:c.fcmMessageId};return function Qt(c,f){if(!f.notification)return;c.notification={};const k=f.notification.title;k&&(c.notification.title=k);const B=f.notification.body;B&&(c.notification.body=B);const j=f.notification.image;j&&(c.notification.image=j);const J=f.notification.icon;J&&(c.notification.icon=J)}(f,c),function Ht(c,f){f.data&&(c.data=f.data)}(f,c),function Lt(c,f){var k,B,j,J,ie;if(!(f.fcmOptions||null!==(k=f.notification)&&void 0!==k&&k.click_action))return;c.fcmOptions={};const at=null!==(j=null===(B=f.fcmOptions)||void 0===B?void 0:B.link)&&void 0!==j?j:null===(J=f.notification)||void 0===J?void 0:J.click_action;at&&(c.fcmOptions.link=at);const tt=null===(ie=f.fcmOptions)||void 0===ie?void 0:ie.analytics_label;tt&&(c.fcmOptions.analyticsLabel=tt)}(f,c),f}function Ye(c,f){const k=[];for(let B=0;B<c.length;B++)k.push(c.charAt(B)),B<f.length&&k.push(f.charAt(B));return k.join("")}function Ct(c){return m.create("missing-app-config-values",{valueName:c})}Ye("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),Ye("AzSCbw63g1R0nCw85jG8","Iaya3yLKwmgvh7cF0q4");class Ue{constructor(f,k,B){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const j=function $t(c){if(!c||!c.options)throw Ct("App Configuration Object");if(!c.name)throw Ct("App Name");const f=["projectId","apiKey","appId","messagingSenderId"],{options:k}=c;for(const B of f)if(!k[B])throw Ct(B);return{appName:c.name,projectId:k.projectId,apiKey:k.apiKey,appId:k.appId,senderId:k.messagingSenderId}}(f);this.firebaseDependencies={app:f,appConfig:j,installations:k,analyticsProvider:B}}_delete(){return Promise.resolve()}}function yt(c){return Ze.apply(this,arguments)}function Ze(){return(Ze=(0,F.Z)(function*(c){try{c.swRegistration=yield navigator.serviceWorker.register(pe,{scope:L}),c.swRegistration.update().catch(()=>{})}catch(f){throw m.create("failed-service-worker-registration",{browserErrorMessage:f?.message})}})).apply(this,arguments)}function lt(){return(lt=(0,F.Z)(function*(c,f){if(!f&&!c.swRegistration&&(yield yt(c)),f||!c.swRegistration){if(!(f instanceof ServiceWorkerRegistration))throw m.create("invalid-sw-registration");c.swRegistration=f}})).apply(this,arguments)}function it(){return(it=(0,F.Z)(function*(c,f){f?c.vapidKey=f:c.vapidKey||(c.vapidKey=e)})).apply(this,arguments)}function Tt(c,f){return pt.apply(this,arguments)}function pt(){return pt=(0,F.Z)(function*(c,f){if(!navigator)throw m.create("only-available-in-window");if("default"===Notification.permission&&(yield Notification.requestPermission()),"granted"!==Notification.permission)throw m.create("permission-blocked");return yield function dt(c,f){return it.apply(this,arguments)}(c,f?.vapidKey),yield function bt(c,f){return lt.apply(this,arguments)}(c,f?.serviceWorkerRegistration),function re(c){return nt.apply(this,arguments)}(c)}),pt.apply(this,arguments)}function ke(){return(ke=(0,F.Z)(function*(c,f,k){const B=function ft(c){switch(c){case le.NOTIFICATION_CLICKED:return"notification_open";case le.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}(f);(yield c.firebaseDependencies.analyticsProvider.get()).logEvent(B,{message_id:k[we],message_name:k[Ee],message_time:k[he],message_device_time:Math.floor(Date.now()/1e3)})})).apply(this,arguments)}function St(){return St=(0,F.Z)(function*(c,f){const k=f.data;if(!k.isFirebaseMessaging)return;c.onMessageHandler&&k.messageType===le.PUSH_RECEIVED&&("function"==typeof c.onMessageHandler?c.onMessageHandler(Ut(k)):c.onMessageHandler.next(Ut(k)));const B=k.data;(function Kt(c){return"object"==typeof c&&!!c&&we in c})(B)&&"1"===B["google.c.a.e"]&&(yield function ht(c,f,k){return ke.apply(this,arguments)}(c,k.messageType,B))}),St.apply(this,arguments)}const Dt="@firebase/messaging",ve=c=>{const f=new Ue(c.getProvider("app").getImmediate(),c.getProvider("installations-internal").getImmediate(),c.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",k=>function Ft(c,f){return St.apply(this,arguments)}(f,k)),f},At=c=>{const f=c.getProvider("messaging").getImmediate();return{getToken:B=>Tt(f,B)}};function et(){return wt.apply(this,arguments)}function wt(){return(wt=(0,F.Z)(function*(){try{yield(0,ne.eu)()}catch{return!1}return typeof window<"u"&&(0,ne.hl)()&&(0,ne.zI)()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")})).apply(this,arguments)}function Et(){return(Et=(0,F.Z)(function*(c){if(!navigator)throw m.create("only-available-in-window");return c.swRegistration||(yield yt(c)),ot(c)})).apply(this,arguments)}function It(c,f){return st.apply(this,arguments)}function st(){return(st=(0,F.Z)(function*(c,f){return Tt(c=(0,ne.m9)(c),f)})).apply(this,arguments)}function Vt(c){return function Wt(c){return Et.apply(this,arguments)}(c=(0,ne.m9)(c))}function Bt(c,f){return function Ot(c,f){if(!navigator)throw m.create("only-available-in-window");return c.onMessageHandler=f,()=>{c.onMessageHandler=null}}(c=(0,ne.m9)(c),f)}!function Pt(){(0,me._registerComponent)(new K.wA("messaging",ve,"PUBLIC")),(0,me._registerComponent)(new K.wA("messaging-internal",At,"PRIVATE")),(0,me.registerVersion)(Dt,"0.12.5"),(0,me.registerVersion)(Dt,"0.12.5","esm2017")}()}}]);