"use strict";(self.webpackChunkKaguraGithubPages=self.webpackChunkKaguraGithubPages||[]).push([[483],{3483:(j,f,a)=>{a.r(f),a.d(f,{EvolutionRadarModule:()=>Z});var g=a(6814),R=a(1858),A=a(5187),F=a(3185),I=a(9935),P=a(553),p=a(8645),c=a(5619),C=a(2572),v=a(9773),h=a(7398),T=a(3019),V=a(1687),S=a(2096),x=a(6232),y=a(2459),b=a(9026),L=a(1479),B=a(3620),M=a(4664),O=a(9336),$=a(9769),k=a(9071),i=a(9212),U=a(4154),E=a(271),H=a(2933),N=a(6457),z=a(8822);const w=["statusChart"],D=[{path:"",redirectTo:"index.htm"},{path:"index.htm",component:(()=>{class r{master;dom;HUE_COLORS=["#FF0000AA","#FFFF00AA","#00FF00AA","#00FFFFAA","#0000FFAA","#FF00FFAA","#FF4000AA","#BFFF00AA","#00FF40AA","#00BFFFAA","#4000FFAA","#FF00BFAA","#FF8000AA","#80FF00AA","#00FF80AA","#0080FFAA","#8000FFAA","#FF0080AA","#FFBF00AA","#40FF00AA","#00FFBFAA","#0040FFAA","#BF00FFAA","#FF0040AA"];basicPokemonId$=new p.x;isValidPokemonTree$;inputHasError;inputPL=20;inputIV={AP:15,DP:15,HP:15};evolutionNodeSelected$=new p.x;evolutionRootCleared$=new c.X(void 0);currentStatus$=new c.X(null);computePLValidator$=new p.x;initializeVisibleStatus$=new p.x;inputPL$=new c.X(this.inputPL);inputStatus$=new p.x;inputFormChanged$=new c.X(void 0);pokemonForm$=new p.x;pokemonIV$=new c.X(this.inputIV);destroy$=new p.x;evolutionRoot$;evolutionRootTree$;statusChart;constructor(o,s){this.master=o,this.dom=s}ngAfterViewInit(){}ngOnInit(){this.dom.setTitle("Evoution status radar (Junk)"),(0,C.a)([this.master.level$,this.pokemonForm$,this.pokemonIV$,this.inputStatus$]).pipe((0,v.R)(this.destroy$)).subscribe(([t,e,n,m])=>{this.maybeComputePL(t,e,n,m)});const o=new I.i(this.master);this.evolutionRoot$=this.pokemonForm$.pipe((0,B.b)(500),(0,M.w)(t=>o.fetchEvolutionRoot$(t))),this.evolutionRootTree$=this.evolutionRoot$.pipe((0,h.U)(t=>o.buildEvolutionTree(t))),(0,C.a)([this.pokemonIV$,this.inputPL$]).pipe((0,h.U)(()=>{})),this.prepareChartStream(),this.isValidPokemonTree$=(0,T.T)(this.basicPokemonId$.pipe((0,h.U)(()=>!0)),this.evolutionRootCleared$.pipe((0,h.U)(()=>!1))).pipe()}prepareChartStream(){(0,V.F)(500).pipe((0,v.R)(this.destroy$)).subscribe(t=>{});const o=(0,C.a)([(0,S.of)(0),this.evolutionRootTree$]).pipe((0,M.w)(t=>(0,S.of)(t)),(0,O.j)(([t,e])=>e.children$?e.children$.pipe((0,$.z)(n=>(0,y.D)(n)),(0,h.U)(n=>[t+1,n])):x.E),(0,$.z)(([t,e])=>this.master.level$.pipe((0,h.U)(n=>{const m=new k.PokemonForm(n,e.formJson),l={};e.form.megaBranch&&(l.megaBranch=e.form.megaBranch);const u=m.getPokemonId(l),d={depth:t,settings:m,nodeId:u,label:u};return e.form.megaBranch&&(d.megaBranch=e.form.megaBranch),d}))),(0,$.z)(t=>this.master.readPokemonName(t.label).pipe((0,h.U)(e=>(t.label=e,t))))),s=(0,b.$)([o,(0,L.w)(1,999999)]).pipe((0,h.U)(([t,e])=>{const n=t;return n.pseudoId=e,n.colorHex=this.HUE_COLORS[e%this.HUE_COLORS.length],n}));this.inputFormChanged$.pipe((0,v.R)(this.destroy$)).subscribe(t=>{this.initializeVisibleStatus$.next(),this.currentStatus$.next(null),this.statusChartDataset=[],this.chartMap={},this.chartUpdated$.next()}),s.pipe((0,v.R)(this.destroy$)).subscribe(t=>{let e=this.chartMap[t.nodeId];if(!e){const n={backgroundColor:t.colorHex,fill:!0,data:[],label:t.label};this.statusChartDataset.push(n),e={model:t,statusView:n},this.chartMap[t.nodeId]=e}this.chartUpdated$.next()}),(0,C.a)([this.pokemonIV$,this.inputPL$,this.chartUpdated$]).pipe((0,v.R)(this.destroy$)).subscribe(([t,e,n])=>{for(const m in this.chartMap){const l=this.chartMap[m],d=l.model.settings.computeStatus(t,e,{megaBranch:l.model.megaBranch});l.statusView.data=[d.AP,d.DP,d.HP]}this.statusChart.update()})}chartMap={};statusChartDataset=[];chartUpdated$=new p.x;tooltipEvolutionItem(o){let s="";for(const t of o)s+=`Name: ${t.dataset.label}\n`,s+=`CP: ${t.parsed.y}\n`;return s}statusChartOptions={responsive:!0,scales:{r:{min:0,ticks:{stepSize:50}}},plugins:{legend:{position:"top"}},elements:{point:{radius:5,hoverRadius:10}}};statusChartLabels=["Attack","Defence","Stamina"];statusChartLegend=!0;statusChartClick({event:o,active:s}){(0,P.eM)("MainComponent.statusChartClick()",o,s),this.clickChartItem(o,s)}clickChartItem(o,s){if(!s||0===s.length||!o)return;const m=o.chart.data.datasets[s[0].datasetIndex];for(const l in this.chartMap){const u=this.chartMap[l];if(u.statusView===m)return void this.evolutionNodeSelected$.next(u.model)}}statusChartHover(o){}onChangePL(o){this.inputPL$.next(o)}onChangeIV(o){this.inputIV=o,this.pokemonIV$.next(this.inputIV)}evolveForms$;ngOnDestroy(){this.destroy$.next()}maybeComputePL(o,s,t,e){if(!e.CP)return;const n=e.HP,m=e.CP;try{const u=new k.PokemonForm(o,s).computeMatchingLevel(m,n,t);this.currentStatus$.next(u),this.computePLValidator$.next(!0)}catch(l){(0,P.wb)("Seems compution failed. This message should be hidden.",l),this.computePLValidator$.next(!1)}}onValidatedPokemonName(o){this.basicPokemonId$.next(o)}onSelectedPokemonForm(o){this.evolutionNodeSelected$.next({settings:o})}onFormValueChanged(){this.inputFormChanged$.next()}onSelectedRawForm(o){this.pokemonForm$.next(o)}onClearedPokemonId(){this.evolutionRootCleared$.next()}onClickShowGrowUpStatus(){}onChangeVisibleStatus(o){this.inputStatus$.next(o)}static \u0275fac=function(s){return new(s||r)(i.Y36(U.m),i.Y36(E.v))};static \u0275cmp=i.Xpm({type:r,selectors:[["app-evolution-radar"]],viewQuery:function(s,t){if(1&s&&i.Gf(w,5,F.jh),2&s){let e;i.iGM(e=i.CRH())&&(t.statusChart=e.first)}},decls:8,vars:9,consts:[[1,"toolInputGroup"],[3,"validatedName","selectedForm","selectedRawForm","valueChanged","valueCleared"],[1,"m-2","toolInputGroup",3,"valueChanged"],[1,"toolInputGroup","m-2",2,"display","block",3,"validatorResult","initialize","disabled","currentStatus$","valueChanged"],[2,"display","block"],["baseChart","","type","radar",3,"datasets","labels","options","chartHover","chartClick"],["statusChart",""]],template:function(s,t){1&s&&(i.TgZ(0,"div",0)(1,"app-pokemon-form",1),i.NdJ("validatedName",function(n){return t.onValidatedPokemonName(n)})("selectedForm",function(n){return t.onSelectedPokemonForm(n)})("selectedRawForm",function(n){return t.onSelectedRawForm(n)})("valueChanged",function(){return t.onFormValueChanged()})("valueCleared",function(){return t.onClearedPokemonId()}),i.qZA(),i.TgZ(2,"app-pokemon-iv",2),i.NdJ("valueChanged",function(n){return t.onChangeIV(n)}),i.qZA(),i.TgZ(3,"app-pokemon-visible-status",3),i.NdJ("valueChanged",function(n){return t.onChangeVisibleStatus(n)}),i.ALo(4,"async"),i.qZA()(),i.TgZ(5,"div",4)(6,"canvas",5,6),i.NdJ("chartHover",function(n){return t.statusChartHover(n)})("chartClick",function(n){return t.statusChartClick(n)}),i.qZA()()),2&s&&(i.xp6(3),i.Q6J("validatorResult",t.computePLValidator$)("initialize",t.initializeVisibleStatus$)("disabled",!i.lcZ(4,7,t.isValidPokemonTree$))("currentStatus$",t.currentStatus$),i.xp6(3),i.Q6J("datasets",t.statusChartDataset)("labels",t.statusChartLabels)("options",t.statusChartOptions))},dependencies:[F.jh,H.l,N.J,z.k,g.Ov],styles:[".toolInputGroup[_ngcontent-%COMP%]{border:solid #eeeeee;border-radius:5px}.toolSmallText[_ngcontent-%COMP%]{font-size:.8em}.toolExtraSmallText[_ngcontent-%COMP%]{font-size:.5em}.appPokemonThumb[_ngcontent-%COMP%]{max-width:40px;max-height:40px}"]})}return r})(),data:{gitweeTitle:"TITLE_POKEMON_RADAR_CHART"}}];let J=(()=>{class r{static \u0275fac=function(s){return new(s||r)};static \u0275mod=i.oAB({type:r});static \u0275inj=i.cJS({imports:[A.Bz.forChild(D),A.Bz]})}return r})();var G=a(3766);let Z=(()=>{class r{static \u0275fac=function(s){return new(s||r)};static \u0275mod=i.oAB({type:r});static \u0275inj=i.cJS({providers:[{provide:G.uY,useValue:"app/tools/pokemongo/evolution-radar/evolution-radar/"}],imports:[g.ez,F.vQ,R.p,J]})}return r})()}}]);