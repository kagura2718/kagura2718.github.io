"use strict";(self.webpackChunkKaguraGithubPages=self.webpackChunkKaguraGithubPages||[]).push([[79,138],{1409:(Y,V,s)=>{var k=s(9574),u=s(467),U=s(1631),A=s(1871),j=s(8779);function J(e,n){const t={};for(const r in e)e.hasOwnProperty(r)&&(t[r]=n(e[r]));return t}function P(e){if(null==e)return null;if(e instanceof Number&&(e=e.valueOf()),"number"==typeof e&&isFinite(e)||!0===e||!1===e||"[object String]"===Object.prototype.toString.call(e))return e;if(e instanceof Date)return e.toISOString();if(Array.isArray(e))return e.map(n=>P(n));if("function"==typeof e||"object"==typeof e)return J(e,n=>P(n));throw new Error("Data cannot be encoded in JSON: "+e)}function v(e){if(null==e)return e;if(e["@type"])switch(e["@type"]){case"type.googleapis.com/google.protobuf.Int64Value":case"type.googleapis.com/google.protobuf.UInt64Value":{const n=Number(e.value);if(isNaN(n))throw new Error("Data cannot be decoded from JSON: "+e);return n}default:throw new Error("Data cannot be decoded from JSON: "+e)}return Array.isArray(e)?e.map(n=>v(n)):"function"==typeof e||"object"==typeof e?J(e,n=>v(n)):e}const B="functions",L={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class i extends A.g{constructor(n,t,r){super(`${B}/${n}`,t||""),this.details=r,Object.setPrototypeOf(this,i.prototype)}}function l(e,n){let a,t=function o(e){if(e>=200&&e<300)return"ok";switch(e){case 0:case 500:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}(e),r=t;try{const d=n&&n.error;if(d){const h=d.status;if("string"==typeof h){if(!L[h])return new i("internal","internal");t=L[h],r=h}const f=d.message;"string"==typeof f&&(r=f),a=d.details,void 0!==a&&(a=v(a))}}catch{}return"ok"===t?null:new i(t,r,a)}class _{constructor(n,t,r,a){this.app=n,this.auth=null,this.messaging=null,this.appCheck=null,this.serverAppAppCheckToken=null,(0,U._isFirebaseServerApp)(n)&&n.settings.appCheckToken&&(this.serverAppAppCheckToken=n.settings.appCheckToken),this.auth=t.getImmediate({optional:!0}),this.messaging=r.getImmediate({optional:!0}),this.auth||t.get().then(d=>this.auth=d,()=>{}),this.messaging||r.get().then(d=>this.messaging=d,()=>{}),this.appCheck||a?.get().then(d=>this.appCheck=d,()=>{})}getAuthToken(){var n=this;return(0,u.A)(function*(){if(n.auth)try{const t=yield n.auth.getToken();return t?.accessToken}catch{return}})()}getMessagingToken(){var n=this;return(0,u.A)(function*(){if(n.messaging&&"Notification"in self&&"granted"===Notification.permission)try{return yield n.messaging.getToken()}catch{return}})()}getAppCheckToken(n){var t=this;return(0,u.A)(function*(){if(t.serverAppAppCheckToken)return t.serverAppAppCheckToken;if(t.appCheck){const r=n?yield t.appCheck.getLimitedUseToken():yield t.appCheck.getToken();return r.error?null:r.token}return null})()}getContext(n){var t=this;return(0,u.A)(function*(){return{authToken:yield t.getAuthToken(),messagingToken:yield t.getMessagingToken(),appCheckToken:yield t.getAppCheckToken(n)}})()}}const y="us-central1",p=/^data: (.*?)(?:\n|$)/;class O{constructor(n,t,r,a,d=y,h=(...f)=>fetch(...f)){this.app=n,this.fetchImpl=h,this.emulatorOrigin=null,this.contextProvider=new _(n,t,r,a),this.cancelAllRequests=new Promise(f=>{this.deleteService=()=>Promise.resolve(f())});try{const f=new URL(d);this.customDomain=f.origin+("/"===f.pathname?"":f.pathname),this.region=y}catch{this.customDomain=null,this.region=d}}_delete(){return this.deleteService()}_url(n){const t=this.app.options.projectId;return null!==this.emulatorOrigin?`${this.emulatorOrigin}/${t}/${this.region}/${n}`:null!==this.customDomain?`${this.customDomain}/${n}`:`https://${this.region}-${t}.cloudfunctions.net/${n}`}}function W(e,n,t,r){return S.apply(this,arguments)}function S(){return(S=(0,u.A)(function*(e,n,t,r){let a;t["Content-Type"]="application/json";try{a=yield r(e,{method:"POST",body:JSON.stringify(n),headers:t})}catch{return{status:0,json:null}}let d=null;try{d=yield a.json()}catch{}return{status:a.status,json:d}})).apply(this,arguments)}function K(e,n){return F.apply(this,arguments)}function F(){return(F=(0,u.A)(function*(e,n){const t={},r=yield e.contextProvider.getContext(n.limitedUseAppCheckTokens);return r.authToken&&(t.Authorization="Bearer "+r.authToken),r.messagingToken&&(t["Firebase-Instance-ID-Token"]=r.messagingToken),null!==r.appCheckToken&&(t["X-Firebase-AppCheck"]=r.appCheckToken),t})).apply(this,arguments)}function N(e,n,t,r){return w.apply(this,arguments)}function w(){return(w=(0,u.A)(function*(e,n,t,r){const a={data:t=P(t)},d=yield K(e,r),f=function T(e){let n=null;return{promise:new Promise((t,r)=>{n=setTimeout(()=>{r(new i("deadline-exceeded","deadline-exceeded"))},e)}),cancel:()=>{n&&clearTimeout(n)}}}(r.timeout||7e4),C=yield Promise.race([W(n,a,d,e.fetchImpl),f.promise,e.cancelAllRequests]);if(f.cancel(),!C)throw new i("cancelled","Firebase Functions instance was deleted.");const $=l(C.status,C.json);if($)throw $;if(!C.json)throw new i("internal","Response is not valid JSON object.");let m=C.json.data;if(typeof m>"u"&&(m=C.json.result),typeof m>"u")throw new i("internal","Response is missing data field.");return{data:v(m)}})).apply(this,arguments)}function E(e,n,t,r){return R.apply(this,arguments)}function R(){return R=(0,u.A)(function*(e,n,t,r){var a;const d={data:t=P(t)},h=yield K(e,r);let f,C,$;h["Content-Type"]="application/json",h.Accept="text/event-stream";try{f=yield e.fetchImpl(n,{method:"POST",body:JSON.stringify(d),headers:h,signal:r?.signal})}catch(I){if(I instanceof Error&&"AbortError"===I.name){const q=new i("cancelled","Request was cancelled.");return{data:Promise.reject(q),stream:{[Symbol.asyncIterator]:()=>({next:()=>Promise.reject(q)})}}}const X=l(0,null);return{data:Promise.reject(X),stream:{[Symbol.asyncIterator]:()=>({next:()=>Promise.reject(X)})}}}const m=new Promise((I,X)=>{C=I,$=X});null===(a=r?.signal)||void 0===a||a.addEventListener("abort",()=>{const I=new i("cancelled","Request was cancelled.");$(I)});const Z=function G(e,n,t,r){const a=(h,f)=>{const C=h.match(p);if(!C)return;const $=C[1];try{const m=JSON.parse($);if("result"in m)return void n(v(m.result));if("message"in m)return void f.enqueue(v(m.message));if("error"in m){const H=l(0,m);return f.error(H),void t(H)}}catch(m){if(m instanceof i)return f.error(m),void t(m)}},d=new TextDecoder;return new ReadableStream({start(h){let f="";return C();function C(){return $.apply(this,arguments)}function $(){return $=(0,u.A)(function*(){if(r?.aborted){const m=new i("cancelled","Request was cancelled");return h.error(m),t(m),Promise.resolve()}try{const{value:m,done:H}=yield e.read();if(H)return f.trim()&&a(f.trim(),h),void h.close();if(r?.aborted){const I=new i("cancelled","Request was cancelled");return h.error(I),t(I),void(yield e.cancel())}f+=d.decode(m,{stream:!0});const Z=f.split("\n");f=Z.pop()||"";for(const I of Z)I.trim()&&a(I.trim(),h);return C()}catch(m){const H=m instanceof i?m:l(0,null);h.error(H),t(H)}}),$.apply(this,arguments)}},cancel:()=>e.cancel()})}(f.body.getReader(),C,$,r?.signal);return{stream:{[Symbol.asyncIterator](){const I=Z.getReader();return{next:()=>(0,u.A)(function*(){const{value:X,done:q}=yield I.read();return{value:X,done:q}})(),return:()=>(0,u.A)(function*(){return yield I.cancel(),{done:!0,value:void 0}})()}}},data:m}}),R.apply(this,arguments)}const Q="@firebase/functions";function ee(e,n,t){!function M(e,n,t){const r=(0,A.zJ)(n);e.emulatorOrigin=`http${r?"s":""}://${n}:${t}`,r&&((0,A.gE)(e.emulatorOrigin),(0,A.P1)("Functions",!0))}((0,A.Ku)(e),n,t)}!function ie(e){(0,U._registerComponent)(new j.uA(B,(t,{instanceIdentifier:r})=>{const a=t.getProvider("app").getImmediate(),d=t.getProvider("auth-internal"),h=t.getProvider("messaging-internal"),f=t.getProvider("app-check-internal");return new O(a,d,h,f,r)},"PUBLIC").setMultipleInstances(!0)),(0,U.registerVersion)(Q,"0.12.9",e),(0,U.registerVersion)(Q,"0.12.9","esm2017")}();class ne{constructor(n,t){this.app=n,this._delegate=t,this._region=this._delegate.region,this._customDomain=this._delegate.customDomain}httpsCallable(n,t){return function ae(e,n,t){return function c(e,n,t){const r=a=>function D(e,n,t,r){const a=e._url(n);return N(e,a,t,r)}(e,n,a,t||{});return r.stream=(a,d)=>function g(e,n,t,r){const a=e._url(n);return E(e,a,t,r||{})}(e,n,a,d),r}((0,A.Ku)(e),n,t)}(this._delegate,n,t)}httpsCallableFromURL(n,t){return function ue(e,n,t){return function z(e,n,t){const r=a=>N(e,n,a,t||{});return r.stream=(a,d)=>E(e,n,a,d||{}),r}((0,A.Ku)(e),n,t)}(this._delegate,n,t)}useFunctionsEmulator(n){const t=n.match("[a-zA-Z]+://([a-zA-Z0-9.-]+)(?::([0-9]+))?");if(null==t)throw new A.g("functions","No origin provided to useFunctionsEmulator()");if(null==t[2])throw new A.g("functions","Port missing in origin provided to useFunctionsEmulator()");return ee(this._delegate,t[1],Number(t[2]))}useEmulator(n,t){return ee(this._delegate,n,t)}}const fe=(e,{instanceIdentifier:n})=>{const t=e.getProvider("app-compat").getImmediate(),r=e.getProvider("functions").getImmediate({identifier:n??"us-central1"});return new ne(t,r)};(function _e(){const e={Functions:ne};k.A.INTERNAL.registerComponent(new j.uA("functions-compat",fe,"PUBLIC").setServiceProps(e).setMultipleInstances(!0))})(),k.A.registerVersion("@firebase/functions-compat","0.3.26")},1474:(Y,V,s)=>{s.d(V,{u:()=>M});var k=s(467),u=s(2615),U=s(1413),A=s(2771),j=s(7673),b=s(152),x=s(3294),J=s(5964),P=s(9568),v=s(5558),B=s(6697),L=s(6977),i=s(8141),o=s(5312),l=s(1152),_=s(4871),y=s(9182),p=s(8334),T=s(4715);class O{auth;funcs;localSession;store;dom;finalize$=new U.B;state$;localUser$;isAdminUser=!1;isDevelopUser=!1;hasMessagingDevice=!1;loginUid=null;env=(0,u.WQX)(u.uvJ);sourceValue$=new A.m;constructor(z,W,S,K,F){var D=this;this.auth=z,this.funcs=W,this.localSession=S,this.store=K,this.dom=F,(0,o.Oi)("SingletonAuth.constructor()"),this.dom.addResourceHint("https://identitytoolkit.googleapis.com","preconnect"),this.dom.addResourceHint("https://firebaseinstallations.googleapis.com","preconnect"),this.dom.addResourceHint("https://firestore.googleapis.com","preconnect"),this.dom.addResourceHint("https://apis.google.com","preconnect"),this.dom.addResourceHint(`https://${o.cA.firebaseConfig.authDomain}`,"preconnect"),this.dom.addResourceHint(`https://${o.cA.FirebaseCloudFunctionsHost}`,"preconnect");const N=this.auth.user.pipe((0,x.F)());N.pipe((0,x.F)(),(0,L.Q)(this.finalize$)).subscribe(g=>{this.sourceValue$.next()}),this.state$=N.pipe((0,J.p)(g=>null!==g)),this.localSession.markedLogout$.pipe((0,L.Q)(this.finalize$)).subscribe(()=>{this.sourceValue$.next()}),this.state$.pipe((0,L.Q)(this.finalize$)).subscribe({error:g=>{(0,o.sJ)("AuthService.state$ error",g),this.doFinalize()},complete:()=>{(0,o.rD)("AuthService.state$ completed."),this.doFinalize()}}),this.state$.pipe((0,v.n)(g=>(0,u.N4e)(this.env,()=>this.store.collection(`/users/v1/protected/${g.uid}/fcm`).valueChanges().pipe((0,i.M)(E=>(0,o.Oi)("UserProtectedStore has changed.",E))))),(0,L.Q)(this.finalize$)).subscribe({next:g=>{this.sourceValue$.next()},error:g=>{(0,o.sJ)("AuthService.state$ Maybe after logout permission error. Ignore it.",g),this.doFinalize()},complete:()=>{(0,o.rD)("AuthService.state$ completed."),this.doFinalize()}});const w=this.state$.pipe((0,v.n)(function(){var g=(0,k.A)(function*(E){try{const R=yield D.funcs.call("readUserSettings"),G=E;return G.isAdmin=R.isAdmin,G.isDeveloper=R.isDeveloper,G.hasMessaging=R.hasMessaging,G}catch(R){return(0,o.sJ)("AuthService while check user settings.",R),null}});return function(E){return g.apply(this,arguments)}}()));var g;this.localUser$=this.sourceValue$.pipe((0,b.B)(100),(0,v.n)(()=>N.pipe((0,v.n)(g=>null===g?(0,j.of)(null):w))),(0,P.t)(1)),this.localUser$.pipe((0,L.Q)(this.finalize$)).subscribe({next:(g=(0,k.A)(function*(E){(0,o.Oi)("AuthService.localUser$.subscribe()",E),E?(D.loginUid=E.uid,D.isAdminUser=!!E.isAdmin,D.isDevelopUser=!!E.isDeveloper,D.hasMessagingDevice=!!E.hasMessaging,D.localSession.updateLoginPhoto(E.photoURL),D.localSession.markLogin()):(D.localSession.unmarkLogin(),D.localSession.updateLoginPhoto(null),D.loginUid=null,D.isAdminUser=!1,D.isDevelopUser=!1,D.hasMessagingDevice=!1,(0,o.rD)("Explicitly logout on client sdk."),yield D.auth.signOut())}),function(R){return g.apply(this,arguments)}),complete:()=>{(0,o.rD)("AuthService.localUser$ complete."),this.doFinalize()},error:g=>{(0,o.sJ)("AuthService.localUser$ error while retrieving.",g),this.doFinalize()}})}doFinalize(){this.finalize$.isStopped||((0,o.rD)("Do finalize Singleton Auth"),this.finalize$.next(),this.finalize$.complete())}}let M=(()=>{class c{auth;funcs;localSession;store;dom;static AUTH=null;_clientSideUser$;constructor(W,S,K,F,D){this.auth=W,this.funcs=S,this.localSession=K,this.store=F,this.dom=D,(0,o.Oi)("AuthService.constructor()");const N=new A.m;null===c.AUTH&&(c.AUTH=new O(W,S,K,F,D),c.AUTH.finalize$.pipe((0,B.s)(1)).subscribe({next:()=>{(0,o.rD)("Finalize singleton auth continue..")},complete:()=>{(0,o.rD)("Finalizing singleton auth completed."),c.AUTH=null,N.next()},error:w=>{(0,o.sJ)("Finalizing singleton auth cause by error.",w),c.AUTH=null,N.next()}})),this._clientSideUser$=N.pipe((0,v.n)(()=>null===c.AUTH?(0,j.of)(null):c.AUTH.localUser$),(0,P.t)(1)),N.next()}get clientSideUser$(){return this._clientSideUser$}get isAdmin(){return!!c.AUTH&&c.AUTH.isAdminUser}get isDeveloper(){return!!c.AUTH&&c.AUTH.isDevelopUser}get hasMessaging(){return!!c.AUTH&&c.AUTH.hasMessagingDevice}get myUid(){return c.AUTH?c.AUTH.loginUid:null}static \u0275fac=function(S){return new(S||c)(u.KVO(l.DS),u.KVO(_.Y),u.KVO(y.Q),u.KVO(p.Qe),u.KVO(T.K))};static \u0275prov=u.jDH({token:c,factory:c.\u0275fac,providedIn:"root"})}return c})()},4441:(Y,V,s)=>{s.d(V,{Zg:()=>_,s:()=>p}),s(1409);var u=s(2615),U=s(3664),A=s(5407),j=s(4121),b=s(9253),x=s(8455),J=s(7673),P=s(6354),v=s(941),B=s(9568),L=s(5558);s(762);const l=new u.nKC("angularfire2.functions.origin"),_=new u.nKC("angularfire2.functions.region"),y=new u.nKC("angularfire2.functions.use-emulator");let p=(()=>{class O{httpsCallable;constructor(c,z,W,S,K,F,D,N){const w=D,g=(0,J.of)(void 0).pipe((0,v.Q)(S.outsideAngular),(0,L.n)(()=>Promise.resolve().then(s.bind(s,1409))),(0,P.T)(()=>(0,b.iB)(c,W,z)),(0,P.T)(E=>(0,b.BM)(`${E.name}.functions.${K||F}`,"AngularFireFunctions",E.name,()=>{let R;if(K&&F)throw new Error("REGION and ORIGIN can't be used at the same time.");return R=E.functions(K||F||void 0),w&&R.useEmulator(...w),R},[K,F,w])),(0,B.t)({bufferSize:1,refCount:!1}));return this.httpsCallable=(E,R)=>G=>(0,x.H)(g).pipe((0,v.Q)(S.insideAngular),(0,L.n)(Q=>Q.httpsCallable(E,R)(G)),(0,P.T)(Q=>Q.data)),(0,b.Gt)(this,g,W)}static \u0275fac=function(z){return new(z||O)(u.KVO(b.rx),u.KVO(b.uP,8),u.KVO(U.SKi),u.KVO(A.u0),u.KVO(_,8),u.KVO(l,8),u.KVO(y,8),u.KVO(j.kR,8))};static \u0275prov=u.jDH({token:O,factory:O.\u0275fac,providedIn:"any"})}return O})()},4871:(Y,V,s)=>{s.d(V,{Y:()=>b});var k=s(467),u=s(6697),U=s(5312),A=s(2615),j=s(4441);let b=(()=>{class x{remote;constructor(P){this.remote=P,(0,U.Oi)("LocalFunctionsService.constructor()")}call(P,v){var B=this;return(0,k.A)(function*(){return yield B.remote.httpsCallable(P)(v).pipe((0,u.s)(1)).toPromise()})()}static \u0275fac=function(v){return new(v||x)(A.KVO(j.s))};static \u0275prov=A.jDH({token:x,factory:x.\u0275fac,providedIn:"root"})}return x})()},9079:(Y,V,s)=>{s.d(V,{YV:()=>B,pQ:()=>A});var k=s(1985),u=s(6977),U=s(2615);function A(i){i||(i=(0,U.WQX)(U.abz));const o=new k.c(l=>{if(!i.destroyed)return i.onDestroy(l.next.bind(l));l.next()});return l=>l.pipe((0,u.Q)(o))}function B(i){void 0===i&&(i=(0,U.WQX)(U.zZn));const o=i.get(U.u5s);return l=>new k.c(_=>{const y=o.add();let p=!1;function T(){p||(y(),p=!0)}const O=l.subscribe({next:M=>{_.next(M),T()},complete:()=>{_.complete(),T()},error:M=>{_.error(M),T()}});return O.add(()=>{_.unsubscribe(),T()}),O})}}}]);