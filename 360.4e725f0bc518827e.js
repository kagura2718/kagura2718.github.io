"use strict";(self.webpackChunkKaguraGithubPages=self.webpackChunkKaguraGithubPages||[]).push([[360],{360:(Dt,Oe,g)=>{g.r(Oe),g.d(Oe,{GitfireModule:()=>ee});var D=g(1368),r=g(6504),V=g(6e3),ue=g(5608),te=g(8472),he=g(331),ce=g(12),$=g(1528),e=g(4496),qe=g(7900),Te=g(7240),be=g(2700),pe=g(8960),Pe=g(3252),Ne=g(7228),J=g(2924),se=g(3920),ae=g(7368),Ie=g(4704),z=g(8476),q=g(7940),xe=g(9144),we=g(8152),Le=g(2156),le=g(9252);const ne=new e.UbH("angularfire2.messaging.vapid-key"),Be=new e.UbH("angularfire2.messaging.service-worker-registeration");let v=(()=>{class l{requestPermission;getToken;tokenChanges;messages;requestToken;deleteToken;constructor(i,s,d,y,k,de,ze){const We=ze,Ve=(0,be.of)(void 0).pipe((0,J.y)(k.outsideAngular),(0,se.y)(k.insideAngular),(0,ae.G)(Te.mO),(0,ae.G)(Se=>Se?g.e(264).then(g.bind(g,7264)):pe.k),(0,Ie.k)(()=>(0,V._G)(i,y,s)),(0,ae.G)(Se=>(0,V.PQ)(`${Se.name}.messaging`,"AngularFireMessaging",Se.name,()=>(0,be.of)(Se.messaging()),[])),(0,z.C)({bufferSize:1,refCount:!1}));this.requestPermission=Ve.pipe((0,J.y)(k.outsideAngular),(0,se.y)(k.insideAngular),(0,ae.G)(()=>Notification.requestPermission())),this.getToken=Ve.pipe((0,J.y)(k.outsideAngular),(0,se.y)(k.insideAngular),(0,ae.G)(function(){var Se=(0,$.c)(function*(St){if("granted"===Notification.permission){const Ft=We?yield We:null;return yield St.getToken({vapidKey:de,serviceWorkerRegistration:Ft})}return null});return function(St){return Se.apply(this,arguments)}}()));const Nt=new Pe._(Se=>{navigator.permissions.query({name:"notifications"}).then(St=>{St.onchange=()=>Se.next()})}),ke=Ve.pipe((0,J.y)(k.outsideAngular),(0,se.y)(k.insideAngular),(0,q.i)(Nt),(0,q.i)(this.getToken));return this.tokenChanges=Ve.pipe((0,J.y)(k.outsideAngular),(0,se.y)(k.insideAngular),(0,ae.G)(()=>(0,Ne.W)(this.getToken,ke))),this.messages=Ve.pipe((0,J.y)(k.outsideAngular),(0,se.y)(k.insideAngular),(0,ae.G)(Se=>new Pe._(St=>Se.onMessage(St)))),this.requestToken=Ve.pipe((0,J.y)(k.outsideAngular),(0,se.y)(k.insideAngular),(0,ae.G)(()=>this.requestPermission),(0,xe.a)(()=>(0,be.of)(null)),(0,we.O)(()=>this.tokenChanges)),this.deleteToken=()=>Ve.pipe((0,J.y)(k.outsideAngular),(0,se.y)(k.insideAngular),(0,ae.G)(Se=>Se.deleteToken()),(0,Le.G)(!1)),(0,V._w)(this,Ve,y)}static \u0275fac=function(s){return new(s||l)(e.CoB(V.E9),e.CoB(V.Ml,8),e.CoB(e.AHE),e.CoB(e.WW2),e.CoB(qe.u),e.CoB(ne,8),e.CoB(Be,8))};static \u0275prov=e.wxM({token:l,factory:l.\u0275fac,providedIn:"any"})}return l})(),E=(()=>{class l{constructor(){le.c.registerVersion("angularfire",qe.j1.full,"fcm-compat")}static \u0275fac=function(s){return new(s||l)};static \u0275mod=e.a4G({type:l});static \u0275inj=e.s3X({providers:[v]})}return l})();var b=g(4400),w=g(5112),O=g(4192),_=g(5657),P=g(3616),A=g(3992),x=g(6684),m=g(6716),j=g(496),re=g(1524);let oe=(()=>{class l extends re.m{constructor(){super()}ngOnInit(){(0,m.qe)("DeleteConfirmComponent.OnInit()")}static \u0275fac=function(s){return new(s||l)};static \u0275cmp=e.In1({type:l,selectors:[["gitfire-delete-confirm"]],features:[e.eg9],decls:10,vars:0,consts:[[1,"m-3"]],template:function(s,d){1&s&&(e.I0R(0,"div",0)(1,"div"),e.OEk(2,"\u672c\u5f53\u306b\u524a\u9664\u3057\u307e\u3059\u304b\uff1f"),e.C$Y(),e.I0R(3,"ul")(4,"li"),e.OEk(5,"Google / Twitter \u306a\u3069\u306e\u30a2\u30ab\u30a6\u30f3\u30c8\u60c5\u5831\u306f\u524a\u9664\u3055\u308c\u307e\u305b\u3093\u3002"),e.C$Y(),e.I0R(6,"li"),e.OEk(7,"\u516c\u958b\u3055\u308c\u305f\u6295\u7a3f\u306f\u524a\u9664\u3055\u308c\u307e\u305b\u3093\u3002"),e.C$Y(),e.I0R(8,"li"),e.OEk(9,"\u53d6\u308a\u6d88\u3057\u306f\u3067\u304d\u307e\u305b\u3093\u3002"),e.C$Y()()())}})}return l})();g(972);var X=g(8164);const Ye=["specialAuthContainer"];function B(l,S){if(1&l){const i=e.KQA();e.I0R(0,"a",7),e.qCj("click",function(d){const k=e.usT(i).$implicit,de=e.GaO();return e.CGJ(de.onClickReauthProvider(d,k))}),e.OEk(1),e.C$Y()}if(2&l){const i=S.$implicit;e.yG2(),e.cNF(i.providerId)}}class H extends re.m{loader;toastr;static SUPPORTED_PROVIDERS={};static SupportedOauthProviderIds=[];destroy$=new _.E;get providers(){return this.currentUser.providerData}currentUser;reauthed=new e._w7;specialAuthContainer;static#e=(()=>{const S=H.SUPPORTED_PROVIDERS,i=le.c.auth;S[i.EmailAuthProvider.PROVIDER_ID]=i.EmailAuthProvider,S[i.TwitterAuthProvider.PROVIDER_ID]=i.TwitterAuthProvider,S[i.GoogleAuthProvider.PROVIDER_ID]=i.GoogleAuthProvider,S[i.GithubAuthProvider.PROVIDER_ID]=i.GithubAuthProvider;const s=H.SupportedOauthProviderIds;s.push(i.TwitterAuthProvider.PROVIDER_ID),s.push(i.GoogleAuthProvider.PROVIDER_ID),s.push(i.GithubAuthProvider.PROVIDER_ID)})();constructor(S,i){super(),this.loader=S,this.toastr=i}ngOnDestroy(){this.destroy$.next()}isOAuthProvider(S){return!!H.SupportedOauthProviderIds.includes(S)}onClickReauthProvider(S,i){var s=()=>super.close,d=this;return(0,$.c)(function*(){(0,m.qe)("onClickReauthProvider()",S,i),S.preventDefault();const k=new(0,H.SUPPORTED_PROVIDERS[i.providerId]);if(d.specialAuthContainer.clear(),d.isOAuthProvider(i.providerId)){try{yield d.currentUser.reauthenticateWithPopup(k)}catch(de){(0,m.sJ)("Error while reauth",de);const ze=de instanceof Error?de.message:"Unknown error";return void d.toastr.error(`\u518d\u8a8d\u8a3c\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002 ( ${ze} )`)}(0,m.qe)("Reanthenticated via OAuth provider")}else{const{GitfireLoginModule:de}=yield Promise.resolve().then(g.bind(g,8636)),{InputAuthComponent:ze}=yield Promise.resolve().then(g.bind(g,124)),We=d.loader.appendComponent(d.specialAuthContainer,de,ze);We.isReauth=!0,We.reauthUser=d.currentUser,We.showFederations=!1;const Ve=We.reauthed.pipe((0,A.U)(1));try{yield Ve.toPromise()}catch(Nt){(0,m.sJ)("Error while reauth done",Nt);const ke=Nt instanceof Error?Nt.message:"Unknown error";return void d.toastr.error(`\u518d\u8a8d\u8a3c\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002 ( ${ke} )`)}(0,m.qe)("Reanthenticated via password")}d.reauthed.next(),s().call(d)})()}static \u0275fac=function(i){return new(i||H)(e.GI1(X.g),e.GI1(b.SA))};static \u0275cmp=e.In1({type:H,selectors:[["gitfire-reauth-box"]],viewQuery:function(i,s){if(1&i&&e.CC$(Ye,5,e.y8U),2&i){let d;e.wto(d=e.Gqi())&&(s.specialAuthContainer=d.first)}},inputs:{currentUser:"currentUser"},outputs:{reauthed:"reauthed"},features:[e.eg9],decls:10,vars:1,consts:[[1,"m-3"],[1,"btn-group"],["type","button","data-bs-toggle","dropdown","aria-haspopup","true","aria-expanded","false",1,"btn","btn-primary","dropdown-toggle"],[1,"visually-hidden"],[1,"dropdown-menu"],["class","dropdown-item","href","#",3,"click",4,"ngFor","ngForOf"],["specialAuthContainer",""],["href","#",1,"dropdown-item",3,"click"]],template:function(i,s){1&i&&(e.I0R(0,"div",0)(1,"div",1)(2,"button",2)(3,"span",3),e.OEk(4,"Toggle Dropdown"),e.C$Y(),e.OEk(5,"\u8a8d\u8a3c\u65b9\u6cd5"),e.C$Y(),e.I0R(6,"div",4),e.yuY(7,B,2,1,"a",5),e.C$Y()(),e.wR5(8,"div",null,6),e.C$Y()),2&i&&(e.yG2(7),e.E7m("ngForOf",s.providers))},dependencies:[D.ay]})}var R=g(9460);function N(l,S){if(l.value!==S){if(l.dirty)return void(0,m.sJ)(`Upstream value has been changed to ${l.value} -> ${S} but sillengly ignore the value.`);l.setErrors(null),l.setValue(S)}}function U(l){l.markAsPristine(),l.markAsUntouched()}var Z=g(4304),Ge=g(2112),Je=g(256),Me=g(4848),Ae=g(6040),je=g(4e3),$e=g(9212),Xe=g(6520);let lt=(()=>{class l{controlLabel;formName;tooltipText;parentForm;checkChanged=new e._w7;autoGeneratedId;constructor(){const i=Math.random().toString(36).substring(2);this.autoGeneratedId=`appViewInput-${i}`}ngOnInit(){(0,m.qe)("SwitchComponent.OnInit()")}onChangeBox(i){(0,m.qe)("SwitchComponent.onChangeBox()",this.parentForm),this.checkChanged.emit(i)}static \u0275fac=function(s){return new(s||l)};static \u0275cmp=e.In1({type:l,selectors:[["app-switch"]],inputs:{controlLabel:"controlLabel",formName:"formName",tooltipText:"tooltipText",parentForm:"parentForm"},outputs:{checkChanged:"checkChanged"},decls:4,vars:7,consts:[[1,"custom-control","custom-switch",3,"formGroup","title"],["type","checkbox",1,"custom-control-input",3,"id","name","formControlName","change"],[1,"custom-control-label",3,"for"]],template:function(s,d){1&s&&(e.I0R(0,"span",0)(1,"input",1),e.qCj("change",function(k){return d.onChangeBox(k)}),e.C$Y(),e.I0R(2,"label",2),e.OEk(3),e.C$Y()()),2&s&&(e._6D("title",d.tooltipText),e.E7m("formGroup",d.parentForm),e.yG2(),e._6D("id",d.autoGeneratedId),e._6D("name",d.formName),e._6D("formControlName",d.formName),e.yG2(),e._6D("for",d.autoGeneratedId),e.yG2(),e.cNF(d.controlLabel))},dependencies:[r.SU,r.ue,r.u,r.uW,r.Wo]})}return l})();function Qe(l,S){if(1&l){const i=e.KQA();e.I0R(0,"button",22),e.qCj("click",function(d){e.usT(i);const y=e.GaO().$implicit,k=e.GaO();return e.CGJ(k.onClickDeleteDevice(d,y))}),e.OEk(1,"\u524a\u9664"),e.C$Y()}}function Pt(l,S){if(1&l){const i=e.KQA();e.I0R(0,"div",19)(1,"app-switch",20),e.qCj("checkChanged",function(d){const k=e.usT(i).$implicit,de=e.GaO();return e.CGJ(de.onToggleDevice(d,k))}),e.wVc(2,"date"),e.C$Y(),e.yuY(3,Qe,2,0,"button",21),e.C$Y()}if(2&l){const i=S.$implicit,s=e.GaO();e.yG2(),e.qsE("controlLabel","",i.name||"No Name"," ",i.id===s.registeredDeviceId?"[\u3053\u306e\u7aef\u672b]":null," (\u767b\u9332\u65e5: ",e.g7$(2,6,i.createdAt.toDate(),"yyyy-MM-dd"),")"),e.CI5("formName","device-",i.id,""),e.E7m("parentForm",s.deviceForm),e.yG2(2),e.E7m("ngIf",i.id!==s.registeredDeviceId)}}function wt(l,S){if(1&l&&(e.I0R(0,"div"),e.OEk(1),e.C$Y()),2&l){const i=S.$implicit,s=S.index;e.yG2(),e.CAO("",s,": ",i,"")}}function dt(l,S){if(1&l&&(e.I0R(0,"div"),e.OEk(1),e.C$Y()),2&l){const i=S.$implicit,s=S.index;e.yG2(),e.CAO("",s,": ",i,"")}}function xt(l,S){if(1&l&&(e.I0R(0,"div"),e.OEk(1),e.C$Y()),2&l){const i=S.$implicit,s=S.index;e.yG2(),e.CAO("",s,": ",i,"")}}function ht(l,S){if(1&l&&(e.I0R(0,"div"),e.OEk(1),e.wVc(2,"json"),e.C$Y()),2&l){const i=S.$implicit;e.yG2(),e.cNF(e.kDX(2,1,i))}}let At=(()=>{class l{auth;dialog;toastr;store;funcs;messaging;destroy$=new _.E;mainForm;userPrivStore$;deviceForm;messagingTypeArray;configArray;currentUser$;registeredDeviceId;registeredToken;debugObservable={};devices;tokenReceived=new _.E;tokenReceived$;privUser;constructor(i,s,d,y,k,de){this.auth=i,this.dialog=s,this.toastr=d,this.store=y,this.funcs=k,this.messaging=de,this.privUser=this.store.collection("/users/v1/protected"),this.currentUser$=this.auth.clientSideUser$.pipe((0,x.I)(ze=>!!ze))}onToggleDevice(i,s){(0,m.qe)("onToggleDevice()");const d=this.getDeviceControl(s),y={deviceId:s.id,off:!d.value};try{this.funcs.call("toggleSuspendDevice",y),this.toastr.success("\u7aef\u672b\u306e\u8a2d\u5b9a\u3092\u66f4\u65b0\u3057\u307e\u3057\u305f\u3002")}catch{this.toastr.error("\u7aef\u672b\u306e\u8a2d\u5b9a\u304c\u66f4\u65b0\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002")}}onClickDeleteDevice(i,s){var k,d=this;(0,m.qe)("onClickDeleteDevice()"),this.messaging.deleteToken(s.token).pipe((0,P.a)(this.destroy$)).subscribe({next:(k=(0,$.c)(function*(de){(0,m.rD)(`deleteToken() result ${de}`),d.toastr.success("\u7aef\u672b\u306e\u901a\u77e5\u3092\u89e3\u9664\u3057\u307e\u3057\u305f\u3002")}),function(ze){return k.apply(this,arguments)}),error:k=>{(0,m.sJ)(`Failed to delete token token: ${s.token}`,k),this.toastr.error("\u7aef\u672b\u306e\u901a\u77e5\u3092\u89e3\u9664\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002\u65e2\u306b\u5931\u52b9\u3057\u3066\u3044\u308b\u53ef\u80fd\u6027\u304c\u3042\u308a\u307e\u3059\u3002")}});const y={deviceId:s.id};try{this.funcs.call("revokeDevice",y),this.toastr.success("\u30b7\u30b9\u30c6\u30e0\u4e0a\u304b\u3089\u7aef\u672b\u306e\u901a\u77e5\u3092\u89e3\u9664\u3057\u307e\u3057\u305f\u3002")}catch{this.toastr.error("\u30b7\u30b9\u30c6\u30e0\u4e0a\u306e\u7aef\u672b\u306e\u901a\u77e5\u3092\u89e3\u9664\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002")}}ngOnInit(){var i=this;const d=this.currentUser$.pipe((0,A.U)(1),(0,x.I)(y=>!!y)).pipe((0,ae.G)(y=>this.store.collection(`users/v1/protected/${y.uid}/fcm`).valueChanges({idField:"id"})),(0,z.C)(1));d.pipe((0,P.a)(this.destroy$)).subscribe(y=>{this.devices=y;for(const k in this.deviceForm.controls)this.deviceForm.removeControl(k);for(const k of this.devices)this.addDeviceControl(k);this.triggerTokenRefresh()}),this.mainForm.addControl("messagingOn",new r.Ku(!1,[])),this.deviceForm=new r.WC({}),this.mainForm.addControl("devices",this.deviceForm),this.mainForm.addControl("messagingSystemCheck",new r.Ku(!1,[])),this.mainForm.addControl("messagingTrivialCheck",new r.Ku(!1,[])),this.mainForm.addControl("messagingMentionCheck",new r.Ku(!1,[])),this.mainForm.addControl("messagingAdminCheck",new r.Ku(!1,[])),this.messagingTypeArray=new r.Sg([this.typeSystemControl,this.typeMentionControl,this.typeAdminControl]),this.configArray=new r.Sg([this.typeTrivialControl,this.messagingTypeArray]),this.userPrivStore$.pipe((0,P.a)(this.destroy$)).subscribe(y=>{(0,m.rD)("this.userPrivStore$.subscribe()",y);const k=y.messagingTypes||["mention","admin"];N(this.typeSystemControl,k.includes("system")),N(this.typeMentionControl,k.includes("mention")),N(this.typeAdminControl,k.includes("admin")),N(this.typeTrivialControl,y.isWatchTrivial)}),this.tokenReceived$=this.tokenReceived.pipe((0,x.I)(y=>null!==y),(0,je.a)()),(0,Ae.E)(this.tokenReceived$,d).pipe((0,P.a)(this.destroy$)).subscribe(function(){var y=(0,$.c)(function*([k,de]){if((0,m.qe)("this.messaging.tokenReceived subscribe()",k,de),i.debugObservable.registeredToken=k,i.registeredToken=k,k){const We=i.findDeviceId(k,de);i.registeredDeviceId=We}N(i.messagingOnControl,!!i.registeredDeviceId)});return function(k){return y.apply(this,arguments)}}()),this.triggerTokenRefresh(),this.debugObservable.messages=[],this.messaging.messages.pipe((0,P.a)(this.destroy$)).subscribe(y=>{(0,m.rD)("message received from messaging",y),this.debugObservable.messages.push(y)}),this.debugObservable.getToken$=this.messaging.getToken,this.debugObservable.getToken=[],this.debugObservable.getToken$.subscribe({next:y=>this.debugObservable.getToken.push(y),complete:()=>(0,m.rD)("Complete getToken()")}),this.debugObservable.tokenChanges$=this.messaging.tokenChanges,this.debugObservable.tokenChanges=[],this.debugObservable.tokenChanges$.subscribe({next:y=>this.debugObservable.tokenChanges.push(y),complete:()=>(0,m.rD)("Complete tokenChanges()")}),this.debugObservable.tokenReceived=[]}findDeviceId(i,s){for(const d of s)if(d.token===i)return d.id;return null}ngOnDestroy(){this.destroy$.next()}triggerTokenRefresh(){this.messaging.getToken.pipe((0,A.U)(1),(0,P.a)(this.destroy$)).subscribe({next:i=>this.tokenReceived.next(i),complete:()=>(0,m.qe)("Completed getToken")})}get messagingOnControl(){return this.mainForm.get("messagingOn")}getDeviceControl(i){return this.deviceForm.get(`device-${i.id}`)}addDeviceControl(i){const s=new r.Ku(!i.isSuspend,[]);this.deviceForm.addControl(`device-${i.id}`,s)}get typeTrivialControl(){return this.mainForm.get("messagingTrivialCheck")}get typeSystemControl(){return this.mainForm.get("messagingSystemCheck")}get typeMentionControl(){return this.mainForm.get("messagingMentionCheck")}get typeAdminControl(){return this.mainForm.get("messagingAdminCheck")}revokeNotification(){var i=this;return(0,$.c)(function*(){if(!i.registeredDeviceId)return(0,m.sJ)("Unexpectedly no deviceId is found."),void i.toastr.error("\u30c7\u30d0\u30a4\u30b9\u60c5\u5831\u3092\u7121\u52b9\u306b\u3067\u304d\u307e\u305b\u3093\u3002");try{i.funcs.call("revokeDevice",{deviceId:i.registeredDeviceId}),i.toastr.info("\u30b7\u30b9\u30c6\u30e0\u304b\u3089\u901a\u77e5\u60c5\u5831\u3092\u524a\u9664\u3057\u307e\u3057\u305f\u3002")}catch(s){return(0,m.sJ)("Error while deleting token via Functions",s),i.messagingOnControl.setValue(!0),U(i.messagingOnControl),void i.toastr.error("\u30b7\u30b9\u30c6\u30e0\u306e\u901a\u77e5\u60c5\u5831\u3092\u524a\u9664\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002")}i.messaging.getToken.pipe((0,$e.y)(s=>(0,m.qe)(`getToken before deleteToken ${s}`)),(0,we.O)(s=>i.messaging.deleteToken(s)),(0,A.U)(1),(0,P.a)(i.destroy$)).subscribe({next:s=>{(0,m.rD)(`Deleted result: ${s} on FCM.`),U(i.messagingOnControl),i.toastr.success("\u901a\u77e5\u60c5\u5831\u3092\u524a\u9664\u3057\u307e\u3057\u305f\u3002")},error:s=>{(0,m.sJ)("Error while deleting token on FCM",s),i.toastr.error("\u901a\u77e5\u60c5\u5831\u304c\u524a\u9664\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002")}})})()}onToggleMessaging(i){var s=this;return(0,$.c)(function*(){if((0,m.qe)("UserSettingsComponent.onToggleMessaging()"),s.messagingOnControl.value){if(!s.registeredDeviceId&&s.devices&&s.devices.length>=m.OU.FCMDeviceMaxCount)return void s.toastr.error("\u767b\u9332\u3055\u308c\u305f\u30c7\u30d0\u30a4\u30b9\u304c\u591a\u3059\u304e\u307e\u3059\u3002\u524a\u9664\u3057\u3066\u304b\u3089\u3084\u308a\u76f4\u3057\u3066\u304f\u3060\u3055\u3044\u3002");yield s.updateRequestToken()}else{const y=s.dialog.createHtmlBuilder(),k=new Xe.AV("\n<div>\n\u767b\u9332\u3092\u89e3\u9664\u3059\u308b\u3068\u3059\u3079\u3066\u306e\u901a\u77e5\u306f\u505c\u6b62\u3057\u307e\u3059\u3002\u3088\u308d\u3057\u3044\u3067\u3059\u304b\uff1f\n</div>\n");y.setMessage(k).setType(j.aU.Warn).setSize(j.q2.Default).setTitle("\u78ba\u8a8d").okButton((0,$.c)(function*(){yield s.revokeNotification()})).cancelButton(()=>{s.messagingOnControl.setValue(!0),U(s.messagingOnControl)}).open()}})()}getMessagingTypes(){const i=[];return this.typeSystemControl.value&&i.push("system"),this.typeMentionControl.value&&i.push("mention"),this.typeAdminControl.value&&i.push("admin"),i}updateRequestToken(){var i=this;return(0,$.c)(function*(){var s;i.messaging.requestToken.pipe((0,A.U)(1),(0,P.a)(i.destroy$)).subscribe({next:(s=(0,$.c)(function*(d){if(i.tokenReceived.next(d),i.debugObservable.tokenReceived.push(d),!d)return(0,m.sJ)("No token returned from requestToken"),i.messagingOnControl.setValue(!1),U(i.messagingOnControl),void i.toastr.error("\u901a\u77e5\u60c5\u5831\u3092\u53d6\u5f97\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002");try{(0,m.qe)(`Updated token with ${d}`);const y={token:d,deviceId:i.registeredDeviceId};i.registeredToken=d,i.registeredDeviceId=yield i.funcs.call("saveDeviceToken",y),i.toastr.success("\u901a\u77e5\u60c5\u5831\u3092\u4fdd\u5b58\u3057\u307e\u3057\u305f\u3002"),U(i.messagingOnControl)}catch(y){(0,m.sJ)("Error while save token to Firestore",y),i.messagingOnControl.setValue(!1),U(i.messagingOnControl),i.toastr.error("\u901a\u77e5\u60c5\u5831\u3092\u4fdd\u5b58\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002")}}),function(y){return s.apply(this,arguments)}),error:s=>{(0,m.sJ)("Error while request Token",s),i.messagingOnControl.setValue(!1),U(i.messagingOnControl),i.toastr.error("\u901a\u77e5\u3092\u6709\u52b9\u306b\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002\u30d6\u30e9\u30a6\u30b6\u306e\u8a2d\u5b9a\u3092\u78ba\u8a8d\u3057\u3066\u304f\u3060\u3055\u3044\u3002")}})})()}onClickUpdateMessaging(i){var s=this;return(0,$.c)(function*(){(0,m.qe)("UserSettingsComponent.onClickUpdateMessaging()");try{const d={messageTypes:s.getMessagingTypes(),token:s.registeredToken,isWatchTrivial:s.typeTrivialControl.value};yield s.funcs.call("setNotifications",d),U(s.configArray),s.toastr.success("\u8a2d\u5b9a\u3092\u4fdd\u5b58\u3057\u307e\u3057\u305f\u3002")}catch(d){(0,m.sJ)("Failed to save configuration",d),s.toastr.error("\u8a2d\u5b9a\u304c\u4fdd\u5b58\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002")}})()}onClickSubscribeTopic(i){var s=this;return(0,$.c)(function*(){if(!s.debugObservable.topicText)return void alert("Not set");const d={topic:s.debugObservable.topicText,token:s.registeredToken},y=yield s.funcs.call("subscribeTopicTest",d);(0,m.rD)("subscribeTopicTest ->",y),s.toastr.success(`done subscribe ${y}`)})()}onClickUnsubscribeTopic(i){var s=this;return(0,$.c)(function*(){if(!s.debugObservable.topicText)return void alert("Not set");const d={topic:s.debugObservable.topicText,token:s.registeredToken},y=yield s.funcs.call("unsubscribeTopicTest",d);(0,m.rD)("unsubscribeTopicTest ->",y),s.toastr.success(`done unsubscribe ${y}`)})()}onClickPostToTopic(i){var s=this;return(0,$.c)(function*(){if(!s.debugObservable.topicText||!s.debugObservable.topicPostText)return void alert("Not set");const d={topic:s.debugObservable.topicText,title:s.debugObservable.topicPostText},y=yield s.funcs.call("postTopicTest",d);(0,m.rD)("postTopicTest ->",y),s.toastr.success(`done post ${y}`)})()}onClickConditionPostToTopic(i){var s=this;return(0,$.c)(function*(){if(!s.debugObservable.conditionTopicPostText||!s.debugObservable.conditionTopicPostText)return void alert("Not set");const d={topic:s.debugObservable.conditionTopicPostText,title:s.debugObservable.topicPostText},y=yield s.funcs.call("postConditionTopicTest",d);(0,m.rD)("postConditionTopicTest ->",y),s.toastr.success(`done post ${y}`)})()}onClickClearMessages(i){this.debugObservable.messages=[]}static \u0275fac=function(s){return new(s||l)(e.GI1(Z.o),e.GI1(j.EF),e.GI1(b.SA),e.GI1(te.i4),e.GI1(Ge.W),e.GI1(v))};static \u0275cmp=e.In1({type:l,selectors:[["gitfire-user-notification"]],inputs:{mainForm:"mainForm",userPrivStore$:"userPrivStore$"},decls:69,vars:16,consts:[[1,"m-2"],["title","\u3053\u306e\u6a5f\u80fd\u306f\u30c6\u30b9\u30c8\u4e2d\u306e\u305f\u3081\u5909\u66f4\u3055\u308c\u308b\u3053\u3068\u3084\u3001\u60f3\u5b9a\u5916\u306e\u6319\u52d5\u3092\u3059\u308b\u5834\u5408\u304c\u3042\u308a\u307e\u3059\u3002\u30d6\u30e9\u30a6\u30b6\u304b\u3089\u306e\u901a\u77e5\u3092\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u3057\u307e\u3059\u3002\u8a2d\u5b9a\u304c\u3046\u307e\u304f\u3044\u304b\u306a\u3044\u5834\u5408\u306f\u30d6\u30e9\u30a6\u30b6\u304b\u3089\u5f53\u30b5\u30a4\u30c8\u306e\u901a\u77e5 on/off \u3092\u3057\u305f\u308a\u3001\u300e\u7aef\u672b\u306e\u524a\u9664\u300f\u3092\u304a\u8a66\u3057\u304f\u3060\u3055\u3044\u3002","src","/assets/octicons/question.svg",1,"m-3","octicon-info","help-icon"],[1,"m-2",3,"formGroup"],[1,"row","p-1"],[1,"d-flex","align-content-start","flex-wrap","p-1"],["controlLabel","\u901a\u77e5\u3092\u53d7\u3051\u53d6\u308b","formName","messagingOn","tooltipText","\u30d6\u30e9\u30a6\u30b6\u304b\u3089\u306e\u901a\u77e5\u3092\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u3057\u307e\u3059\u3002",1,"p-2",3,"parentForm","checkChanged"],[1,"d-flex","align-content-start","flex-wrap","p-3"],["class","m-1 input-group",4,"ngFor","ngForOf"],[1,"row","m-2"],["controlLabel","\u3061\u3087\u3063\u3068\u3057\u305f\u901a\u77e5","formName","messagingTrivialCheck","tooltipText","\u3061\u3087\u3063\u3068\u3057\u305f\u901a\u77e5\u3082\u53d7\u3051\u53d6\u308b\u304b\u3069\u3046\u304b\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\u901a\u5e38\u306f\u4e0d\u8981\u3067\u3059\u3002",1,"p-2",3,"parentForm"],["controlLabel","\u30b7\u30b9\u30c6\u30e0","formName","messagingSystemCheck","tooltipText","\u30b7\u30b9\u30c6\u30e0\u304b\u3089\u306e\u901a\u77e5\u3092\u9001\u308b\u304b\u3069\u3046\u304b\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002",1,"p-2",3,"parentForm"],["controlLabel","\u3042\u306a\u305f\u3078\u306e\u8a00\u53ca","formName","messagingMentionCheck","tooltipText","\u30b7\u30b9\u30c6\u30e0\u306e\u30e1\u30c3\u30bb\u30fc\u30b8\u30b7\u30b9\u30c6\u30e0\u3067\u3042\u306a\u305f\u306b\u8a00\u53ca\u3055\u308c\u305f\u5834\u5408\u306b\u901a\u77e5\u3092\u9001\u308b\u304b\u3069\u3046\u304b\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002",1,"p-2",3,"parentForm"],["controlLabel","\u7ba1\u7406\u4eba\u304b\u3089","formName","messagingAdminCheck","tooltipText","\u7ba1\u7406\u4eba\u304c\u624b\u52d5\u3067\u3042\u306a\u305f\u306b\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u9001\u3063\u305f\u5834\u5408\u306b\u901a\u77e5\u3092\u9001\u308b\u304b\u3069\u3046\u304b\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002",1,"p-2",3,"parentForm"],[1,"btn","btn-primary",3,"disabled","click"],[2,"width","100%","overflow-wrap","break-word"],[4,"ngFor","ngForOf"],["type","text",3,"ngModel","ngModelChange"],[1,"btn","btn-primary",3,"click"],[1,"btn","btn-warning",3,"click"],[1,"m-1","input-group"],["tooltipText","\u767b\u9332\u3055\u308c\u305f Device \u306e\u901a\u77e5\u3092\u4e00\u6642\u7684\u306b\u505c\u6b62\u3057\u307e\u3059\u3002",1,"m-2",3,"parentForm","controlLabel","formName","checkChanged"],["class","btn btn-warning","title","\u767b\u9332\u60c5\u5831\u3092\u524a\u9664\u3057\u3066\u3001\u3053\u306e\u7aef\u672b\u3078\u306e\u901a\u77e5\u3092\u89e3\u9664\u3057\u307e\u3059\u3002",3,"click",4,"ngIf"],["title","\u767b\u9332\u60c5\u5831\u3092\u524a\u9664\u3057\u3066\u3001\u3053\u306e\u7aef\u672b\u3078\u306e\u901a\u77e5\u3092\u89e3\u9664\u3057\u307e\u3059\u3002",1,"btn","btn-warning",3,"click"]],template:function(s,d){1&s&&(e.I0R(0,"h2",0),e.OEk(1,"\u901a\u77e5\u8a2d\u5b9a (\u30c6\u30b9\u30c8\u4e2d)"),e.wR5(2,"img",1),e.C$Y(),e.I0R(3,"div",2)(4,"div",3)(5,"div",4)(6,"app-switch",5),e.qCj("checkChanged",function(k){return d.onToggleMessaging(k)}),e.C$Y()()(),e.I0R(7,"div",0)(8,"h3"),e.OEk(9,"\u767b\u9332\u3055\u308c\u305f\u30c7\u30d0\u30a4\u30b9"),e.C$Y(),e.I0R(10,"div",6),e.yuY(11,Pt,4,9,"div",7),e.C$Y()(),e.I0R(12,"div")(13,"div",8)(14,"h3"),e.OEk(15,"\u91cd\u8981\u5ea6"),e.C$Y(),e.I0R(16,"div",4),e.wR5(17,"app-switch",9),e.C$Y()(),e.I0R(18,"div",8)(19,"h3"),e.OEk(20,"\u7a2e\u985e"),e.C$Y(),e.I0R(21,"div",4),e.wR5(22,"app-switch",10)(23,"app-switch",11)(24,"app-switch",12),e.C$Y()(),e.I0R(25,"div",8)(26,"button",13),e.qCj("click",function(k){return d.onClickUpdateMessaging(k)}),e.OEk(27,"\u66f4\u65b0"),e.C$Y()()()(),e.I0R(28,"div",14)(29,"div"),e.OEk(30,"Token: "),e.I0R(31,"div"),e.OEk(32),e.C$Y()(),e.I0R(33,"div"),e.OEk(34,"GetToken: "),e.yuY(35,wt,2,2,"div",15),e.C$Y(),e.I0R(36,"div"),e.OEk(37,"TokenChanges: "),e.yuY(38,dt,2,2,"div",15),e.C$Y(),e.I0R(39,"div"),e.OEk(40,"TokenReceived: "),e.yuY(41,xt,2,2,"div",15),e.C$Y(),e.I0R(42,"div")(43,"div")(44,"label"),e.OEk(45,"Topic: "),e.I0R(46,"input",16),e.iHE("ngModelChange",function(k){return e.kNx(d.debugObservable.topicText,k)||(d.debugObservable.topicText=k),k}),e.C$Y()(),e.I0R(47,"button",17),e.qCj("click",function(k){return d.onClickSubscribeTopic(k)}),e.OEk(48,"subscribe"),e.C$Y(),e.I0R(49,"button",17),e.qCj("click",function(k){return d.onClickUnsubscribeTopic(k)}),e.OEk(50,"unsubscribe"),e.C$Y()(),e.I0R(51,"div")(52,"label"),e.OEk(53,"Post Title: "),e.I0R(54,"input",16),e.iHE("ngModelChange",function(k){return e.kNx(d.debugObservable.topicPostText,k)||(d.debugObservable.topicPostText=k),k}),e.C$Y()(),e.I0R(55,"button",17),e.qCj("click",function(k){return d.onClickPostToTopic(k)}),e.OEk(56,"Post"),e.C$Y()(),e.I0R(57,"div")(58,"label"),e.OEk(59,"Condition Topic Post: "),e.I0R(60,"input",16),e.iHE("ngModelChange",function(k){return e.kNx(d.debugObservable.conditionTopicPostText,k)||(d.debugObservable.conditionTopicPostText=k),k}),e.C$Y()(),e.I0R(61,"button",17),e.qCj("click",function(k){return d.onClickConditionPostToTopic(k)}),e.OEk(62,"CondPost"),e.C$Y()()()(),e.I0R(63,"div")(64,"button",18),e.qCj("click",function(k){return d.onClickClearMessages(k)}),e.OEk(65,"Clear"),e.C$Y(),e.I0R(66,"div"),e.OEk(67,"Messages: "),e.yuY(68,ht,3,3,"div",15),e.C$Y()()),2&s&&(e.yG2(3),e.E7m("formGroup",d.mainForm),e.yG2(3),e.E7m("parentForm",d.mainForm),e.yG2(5),e.E7m("ngForOf",d.devices),e.yG2(6),e.E7m("parentForm",d.mainForm),e.yG2(5),e.E7m("parentForm",d.mainForm),e.yG2(),e.E7m("parentForm",d.mainForm),e.yG2(),e.E7m("parentForm",d.mainForm),e.yG2(2),e.E7m("disabled",d.configArray.invalid||!d.configArray.dirty),e.yG2(6),e.cNF(d.debugObservable.registeredToken),e.yG2(3),e.E7m("ngForOf",d.debugObservable.getToken),e.yG2(3),e.E7m("ngForOf",d.debugObservable.tokenChanges),e.yG2(3),e.E7m("ngForOf",d.debugObservable.tokenReceived),e.yG2(5),e.OKB("ngModel",d.debugObservable.topicText),e.yG2(8),e.OKB("ngModel",d.debugObservable.topicPostText),e.yG2(6),e.OKB("ngModel",d.debugObservable.conditionTopicPostText),e.yG2(8),e.E7m("ngForOf",d.debugObservable.messages))},dependencies:[D.ay,D.u_,r.ot,r.ue,r.u,r._G,r.uW,lt,D.ED,D.y]})}return l})();const pt=["protectedSettings"],Ut=["imageBox"];function ft(l,S){1&l&&e.OEk(0,"\u753b\u50cf\u304c\u3042\u308a\u307e\u305b\u3093")}function _e(l,S){if(1&l&&e.wR5(0,"img",39),2&l){const i=e.GaO().ngIf;e._6D("src",i.photoURL,e.K6U)}}function rt(l,S){if(1&l){const i=e.KQA();e.SAx(0),e.I0R(1,"span",40),e.OEk(2," -> "),e.C$Y(),e.I0R(3,"label",8),e.OEk(4,"\u65b0\u3057\u3044\u753b\u50cf"),e.C$Y(),e.wR5(5,"img",41),e.I0R(6,"button",42),e.qCj("click",function(d){const k=e.usT(i).ngIf,de=e.GaO(2);return e.CGJ(de.onClickOkImage(d,k))}),e.OEk(7,"\u78ba\u5b9a"),e.C$Y(),e.k70()}if(2&l){const i=S.ngIf;e.yG2(5),e._6D("src",i,e.K6U)}}function He(l,S){1&l&&e.wR5(0,"div",43)}function it(l,S){if(1&l&&(e.I0R(0,"div",43),e.OEk(1),e.C$Y()),2&l){const i=e.GaO(3);e.yG2(),e.oRS("\u6b8b\u308a ",i.nicknameResult.changesRemain," \u56de \u5909\u66f4\u3067\u304d\u307e\u3059\u3002")}}function gt(l,S){1&l&&(e.I0R(0,"div",45),e.OEk(1,"\u3053\u308c\u4ee5\u4e0a\u306f\u5909\u66f4\u3067\u304d\u307e\u305b\u3093\u3002"),e.C$Y())}function st(l,S){if(1&l&&(e.SAx(0),e.yuY(1,it,2,1,"div",19)(2,gt,2,0,"div",44),e.k70()),2&l){const i=e.GaO(2);e.yG2(),e.E7m("ngIf",i.nicknameResult.changesRemain>0),e.yG2(),e.E7m("ngIf",0===i.nicknameResult.changesRemain)}}function tt(l,S){1&l&&(e.I0R(0,"div",45),e.OEk(1,"\u5165\u529b\u5fc5\u9808\u3067\u3059\u3002"),e.C$Y())}function Rt(l,S){1&l&&(e.I0R(0,"div",45),e.OEk(1,"\u9577\u3059\u304e\u307e\u3059\u3002"),e.C$Y())}function nt(l,S){1&l&&(e.I0R(0,"div",45),e.OEk(1,"\u77ed\u3059\u304e\u307e\u3059\u3002"),e.C$Y())}function Ot(l,S){if(1&l&&(e.SAx(0),e.yuY(1,tt,2,0,"div",44)(2,Rt,2,0,"div",44)(3,nt,2,0,"div",44),e.k70()),2&l){const i=e.GaO(2);e.yG2(),e.E7m("ngIf",null==i.nicknameControl.errors?null:i.nicknameControl.errors.required),e.yG2(),e.E7m("ngIf",null==i.nicknameControl.errors?null:i.nicknameControl.errors.maxlength),e.yG2(),e.E7m("ngIf",null==i.nicknameControl.errors?null:i.nicknameControl.errors.minlength)}}function Re(l,S){1&l&&e.wR5(0,"div",43)}function mt(l,S){1&l&&(e.I0R(0,"div",45),e.OEk(1,"\u9577\u3059\u304e\u307e\u3059\u3002"),e.C$Y())}function Bt(l,S){if(1&l&&(e.SAx(0),e.yuY(1,mt,2,0,"div",44),e.k70()),2&l){const i=e.GaO(2);e.yG2(),e.E7m("ngIf",null==i.aboutControl.errors?null:i.aboutControl.errors.maxlength)}}function _t(l,S){if(1&l&&(e.SAx(0),e.wR5(1,"hr")(2,"gitfire-user-notification",46),e.k70()),2&l){const i=e.GaO(2);e.yG2(2),e.E7m("mainForm",i.notificationForm)("userPrivStore$",i.userPrivate$)}}function Ct(l,S){1&l&&e.wR5(0,"div",43)}function at(l,S){1&l&&(e.I0R(0,"div",45),e.OEk(1,"E \u30e1\u30fc\u30eb\u306f\u5fc5\u9808\u3067\u3059\u3002"),e.C$Y())}function Ce(l,S){1&l&&(e.I0R(0,"div",45),e.OEk(1,"E \u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044\u3002"),e.C$Y())}function Ze(l,S){if(1&l&&(e.SAx(0),e.yuY(1,at,2,0,"div",44)(2,Ce,2,0,"div",44),e.k70()),2&l){const i=e.GaO(2);e.yG2(),e.E7m("ngIf",null==i.emailControl.errors?null:i.emailControl.errors.required),e.yG2(),e.E7m("ngIf",(null==i.emailControl.errors?null:i.emailControl.errors.minlength)||(null==i.emailControl.errors?null:i.emailControl.errors.maxlength))}}function Gt(l,S){1&l&&(e.I0R(0,"div",43),e.OEk(1,"\u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u5f37\u5ea6\u306f\u5145\u5206\u306b\u3057\u3066\u304f\u3060\u3055\u3044\u3002"),e.C$Y())}function Ke(l,S){1&l&&(e.I0R(0,"div",45),e.OEk(1,"\u30d1\u30b9\u30ef\u30fc\u30c9\u306f\u5fc5\u9808\u3067\u3059\u3002"),e.C$Y())}function yt(l,S){1&l&&(e.I0R(0,"div",45),e.OEk(1,"\u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u9577\u3055\u304c\u8db3\u308a\u307e\u305b\u3093\u3002"),e.C$Y())}function vt(l,S){if(1&l&&(e.SAx(0),e.yuY(1,Ke,2,0,"div",44)(2,yt,2,0,"div",44),e.k70()),2&l){const i=e.GaO(2);e.yG2(),e.E7m("ngIf",null==i.passwordControl.errors?null:i.passwordControl.errors.required),e.yG2(),e.E7m("ngIf",null==i.passwordControl.errors?null:i.passwordControl.errors.minlength)}}const ut=()=>["(\u5371\u967a)","(\u5f31\u3044)","(\u666e\u901a)","(\u5f37\u3044)","(\u5145\u5206\u306b\u5b89\u5168)"],Yt=()=>["#DD2C00","#FF6D00","#FFD600","#AEEA00","#00C853"];function ct(l,S){if(1&l){const i=e.KQA();e.SAx(0),e.I0R(1,"div",1)(2,"form",2,3)(4,"h2",4),e.OEk(5,"\u516c\u958b\u8a2d\u5b9a"),e.wR5(6,"img",5),e.C$Y(),e.I0R(7,"div")(8,"div",6)(9,"div",7)(10,"label",8),e.OEk(11,"\u73fe\u5728\u306e\u753b\u50cf"),e.C$Y(),e.yuY(12,ft,1,0,"ng-template",null,9,e.gJz)(14,_e,1,1,"img",10)(15,rt,8,1,"ng-container",0),e.wVc(16,"async"),e.C$Y(),e.I0R(17,"div",11),e.wR5(18,"input",12,13),e.I0R(20,"button",14),e.qCj("click",function(d){e.usT(i);const y=e.GaO();return e.CGJ(y.onClickUploadImage(d))}),e.OEk(21,"Upload"),e.C$Y()()(),e.I0R(22,"div",15)(23,"label",16),e.OEk(24,"\u30cb\u30c3\u30af\u30cd\u30fc\u30e0"),e.wR5(25,"img",17),e.C$Y(),e.wR5(26,"input",18),e.I0R(27,"button",14),e.qCj("click",function(d){e.usT(i);const y=e.GaO();return e.CGJ(y.onClickUpdateNickname(d))}),e.OEk(28,"\u66f4\u65b0"),e.C$Y()(),e.yuY(29,He,1,0,"div",19)(30,st,3,2,"ng-container",0)(31,Ot,4,3,"ng-container",0),e.I0R(32,"div",15)(33,"label",16),e.OEk(34,"\u81ea\u5df1\u7d39\u4ecb"),e.wR5(35,"img",20),e.C$Y(),e.wR5(36,"textarea",21),e.I0R(37,"button",22),e.qCj("click",function(d){e.usT(i);const y=e.GaO();return e.CGJ(y.onClickUpdateAbout(d))}),e.OEk(38,"\u66f4\u65b0"),e.C$Y()()(),e.yuY(39,Re,1,0,"div",19)(40,Bt,2,1,"ng-container",0)(41,_t,3,2,"ng-container",0),e.wR5(42,"hr"),e.I0R(43,"a",23),e.qCj("click",function(d){e.usT(i);const y=e.GaO();return e.CGJ(y.onClickImportant(d))}),e.OEk(44),e.C$Y(),e.I0R(45,"div",24,25)(47,"div",26)(48,"label",27),e.OEk(49,"\u540d\u524d"),e.wR5(50,"img",28),e.C$Y(),e.wR5(51,"input",29),e.C$Y(),e.I0R(52,"div",26)(53,"label",27),e.OEk(54,"Email"),e.wR5(55,"img",30),e.C$Y(),e.wR5(56,"input",31),e.I0R(57,"button",32),e.qCj("click",function(d){e.usT(i);const y=e.GaO();return e.CGJ(y.onClickUpdateEmail(d))}),e.OEk(58,"\u66f4\u65b0"),e.C$Y(),e.yuY(59,Ct,1,0,"div",19)(60,Ze,3,2,"ng-container",0),e.C$Y(),e.I0R(61,"div",26)(62,"label",27),e.OEk(63,"Password"),e.wR5(64,"img",33),e.C$Y(),e.wR5(65,"input",34),e.I0R(66,"button",32),e.qCj("click",function(d){e.usT(i);const y=e.GaO();return e.CGJ(y.onClickUpdatePassword(d))}),e.OEk(67,"\u66f4\u65b0"),e.C$Y(),e.wR5(68,"ng9-password-strength-bar",35),e.wVc(69,"async"),e.yuY(70,Gt,2,0,"div",19)(71,vt,3,2,"ng-container",0),e.C$Y(),e.I0R(72,"h3",36),e.OEk(73,"\u30a2\u30ab\u30a6\u30f3\u30c8\u306e\u7d42\u4e86"),e.C$Y(),e.I0R(74,"div",37)(75,"button",38),e.qCj("click",function(d){e.usT(i);const y=e.GaO();return e.CGJ(y.onClickDeleteAccount(d))}),e.OEk(76,"\u30a2\u30ab\u30a6\u30f3\u30c8\u3092\u524a\u9664"),e.C$Y()()()()(),e.k70()}if(2&l){const i=S.ngIf,s=e.Gew(13),d=e.GaO();e.yG2(2),e.E7m("formGroup",d.inputForm),e.yG2(12),e.E7m("ngIf",i.photoURL)("ngIfElse",s),e.yG2(),e.E7m("ngIf",e.kDX(16,35,d.profileTempImage$)),e.yG2(5),e.E7m("disabled",d.userIconControl.invalid||!d.userIconControl.dirty),e.yG2(2),e.eAK("was-validated",d.nicknameControl.dirty||d.nicknameControl.touched),e.yG2(5),e.E7m("disabled",d.nicknameControl.invalid||!d.nicknameControl.dirty),e.yG2(2),e.E7m("ngIf",!d.nicknameControl.invalid),e.yG2(),e.E7m("ngIf",d.nicknameResult),e.yG2(),e.E7m("ngIf",d.nicknameControl.invalid),e.yG2(),e.eAK("was-validated",d.aboutControl.dirty||d.aboutControl.touched),e.yG2(5),e.E7m("disabled",d.aboutControl.invalid||!d.aboutControl.dirty),e.yG2(2),e.E7m("ngIf",!d.aboutControl.invalid),e.yG2(),e.E7m("ngIf",d.aboutControl.invalid),e.yG2(),e.E7m("ngIf",d.auth.isDeveloper),e.yG2(3),e.cNF(d.isOpenOther?"\u518d\u8a8d\u8a3c":"\u305d\u306e\u4ed6\u306e\u8a2d\u5b9a"),e.yG2(7),e.E7m("value",i.displayName),e.yG2(),e.eAK("was-validated",d.emailControl.dirty||d.emailControl.touched),e.yG2(5),e.E7m("disabled",d.emailControl.invalid||!d.emailControl.dirty),e.yG2(2),e.E7m("ngIf",!d.emailControl.invalid),e.yG2(),e.E7m("ngIf",d.emailControl.invalid),e.yG2(),e.eAK("was-validated",d.passwordControl.dirty||d.passwordControl.touched),e.yG2(5),e.E7m("disabled",!d.passwordControl.value||d.passwordControl.invalid||!d.passwordControl.dirty),e.yG2(2),e.m4B("display",""===d.passwordControl.value?"none":null),e.E7m("passwordToCheck",e.kDX(69,37,d.passwordControl.valueChanges))("barLabel","\u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u5f37\u5ea6(\u76ee\u5b89): ")("strengthLabels",e.q4q(39,ut))("barColors",e.q4q(40,Yt)),e.yG2(2),e.E7m("ngIf",!d.passwordControl.invalid),e.yG2(),e.E7m("ngIf",d.passwordControl.invalid)}}let Mt=(()=>{class l{auth;storage;funcs;store;toastr;router;dialog;localSession;destroy$=new _.E;currentUser;currentUser$;userPublic;userPrivate$=new _.E;profileTempImage$;inputForm;notificationForm;isOpenOther=!1;nicknameResult=null;protectedSettings;imageBox;pubUser;privUser;nicknameIndex;constructor(i,s,d,y,k,de,ze,We){this.auth=i,this.storage=s,this.funcs=d,this.store=y,this.toastr=k,this.router=de,this.dialog=ze,this.localSession=We,this.pubUser=this.store.collection("/users/v1/public"),this.privUser=this.store.collection("/users/v1/protected"),this.nicknameIndex=this.store.collection("/index/users/usernick"),this.currentUser$=this.auth.clientSideUser$,this.currentUser$.pipe((0,P.a)(this.destroy$)).subscribe(Ve=>{this.currentUser=Ve})}ngOnInit(){this.inputForm=new r.WC({}),this.inputForm.addControl("userIcon",new r.Ku("",[r.AQ.required])),this.inputForm.addControl("email",new r.Ku({value:"",disabled:!1},[r.AQ.required])),this.inputForm.addControl("password",new r.Ku("",[])),this.inputForm.addControl("nickname",new r.Ku({value:"",disabled:!0},[r.AQ.required])),this.inputForm.addControl("about",new r.Ku({value:"",disabled:!0},[])),this.notificationForm=new r.WC({}),this.inputForm.addControl("messaging",this.notificationForm)}ngAfterViewInit(){const i=this.currentUser$.pipe((0,A.U)(1),(0,x.I)(s=>!!s));i.pipe((0,ae.G)(s=>this.pubUser.doc(s.uid).valueChanges()),(0,P.a)(this.destroy$)).subscribe(s=>{this.userPublic=s,N(this.aboutControl,s.about),this.aboutControl.enable(),N(this.nicknameControl,s.nickname),this.nicknameControl.enable()}),i.pipe((0,ae.G)(s=>this.privUser.doc(s.uid).valueChanges()),(0,P.a)(this.destroy$)).subscribe(s=>{this.userPrivate$.next(s)}),i.pipe((0,P.a)(this.destroy$)).subscribe(s=>{this.emailControl.setValue(s.email)})}ngOnDestroy(){this.destroy$.next()}get emailControl(){return this.inputForm.get("email")}get passwordControl(){return this.inputForm.get("password")}get aboutControl(){return this.inputForm.get("about")}get nicknameControl(){return this.inputForm.get("nickname")}get userIconControl(){return this.inputForm.get("userIcon")}onClickDeleteAccount(i){this.dialog.createDefaultBuilder().prepareBody(oe).setType(j.aU.Warn).setSize(j.q2.Default).setTitle("\u6700\u7d42\u78ba\u8a8d").okButton(()=>{this.doDeleteAccount()}).cancelButton(()=>{}).open()}doDeleteAccount(){var i=this;return(0,$.c)(function*(){try{yield i.currentUser.delete(),(0,m.qe)("Account is deleted")}catch(d){(0,m.sJ)("Error while delete account",d);const y=d instanceof Error?d.message:"Unknown error";return void i.toastr.error(`\u30a2\u30ab\u30a6\u30f3\u30c8\u3092\u524a\u9664\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002 ( ${y} )`)}i.localSession.unmarkLogin(),i.router.navigate(["/"])})()}updateError(i,s){(0,m.sJ)(`Error while update tag:${i}`,s);const d=s instanceof Error?s.message:"Unknown error";this.toastr.error(`${i} \u306e\u66f4\u65b0\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002 ( ${d} )`)}updateSucceeded(i,s){this.toastr.success(`${i} \u3092 "${s}" \u306b\u66f4\u65b0\u3057\u307e\u3057\u305f\u3002`)}updateProfileImage(i){var s=this;return(0,$.c)(function*(){if(""===i)return;const d="\u30d7\u30ed\u30d5\u30a3\u30fc\u30eb\u753b\u50cf";try{yield s.currentUser.updateProfile({photoURL:i});const k={photoURL:i,updatedAt:le.c.firestore.FieldValue.serverTimestamp()};yield s.pubUser.doc(s.currentUser.uid).update(k),s.updateSucceeded(d,"Upload \u3057\u305f\u753b\u50cf"),s.getProfileRef("temp_profile").delete(),s.profileTempImage$=null,s.userIconControl.setValue(""),U(s.userIconControl)}catch(y){s.updateError(d,y)}})()}onClickUpdateNickname(i){var s=this;return(0,$.c)(function*(){if(s.nicknameControl.invalid)return;const d=s.nicknameControl.value;if(d===s.userPublic.nickname)return;const y="\u30cb\u30c3\u30af\u30cd\u30fc\u30e0";try{const k={nickname:d};s.nicknameResult=yield s.funcs.call("updateNickname",k),s.updateSucceeded(y,d),U(s.nicknameControl)}catch(k){s.updateError(y,k)}})()}onClickUpdateAbout(i){var s=this;return(0,$.c)(function*(){if(s.aboutControl.invalid)return;const d=s.aboutControl.value;if(d===s.userPublic.about)return;const y="\u81ea\u5df1\u7d39\u4ecb";try{const k={about:d};yield s.funcs.call("updateAbout",k),s.updateSucceeded(y,d),U(s.aboutControl)}catch(k){s.updateError(y,k)}})()}onClickUpdateEmail(i){var s=this;return(0,$.c)(function*(){if(s.emailControl.invalid)return;const d=s.emailControl.value;d!==s.currentUser.email&&s.dialog.createSimpleBuilder().setType(j.aU.Warn).setSize(j.q2.Default).setMessage("\u767b\u9332\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u3092\u5909\u66f4\u3057\u307e\u3059\u3002\u3088\u308d\u3057\u3044\u3067\u3059\u304b\uff1f").setTitle("\u78ba\u8a8d").okButton(()=>{s.doChangeEmail(d)}).cancelButton(()=>{}).open()})()}doChangeEmail(i){var s=this;return(0,$.c)(function*(){const d="Email";try{yield s.currentUser.updateEmail(i),yield s.currentUser.sendEmailVerification(),s.updateSucceeded(d,i),U(s.emailControl),s.toastr.info("\u78ba\u8a8d\u306e\u30e1\u30fc\u30eb\u3092\u9001\u4fe1\u3057\u307e\u3057\u305f\u3002")}catch(y){s.updateError(d,y)}})()}onClickUpdatePassword(i){var s=this;return(0,$.c)(function*(){if(s.passwordControl.invalid)return;const d=s.passwordControl.value;if(""===d)return;const y="\u30d1\u30b9\u30ef\u30fc\u30c9";try{yield s.currentUser.updatePassword(d),s.updateSucceeded(y,"********"),U(s.passwordControl)}catch(k){s.updateError(y,k)}finally{s.passwordControl.setValue("")}})()}listProvider(){}ensureImageFile(){const i=this.imageBox.nativeElement;if(0===i.files.length)return this.toastr.error("\u30d5\u30a1\u30a4\u30eb\u3092\u9078\u629e\u3057\u3066\u304f\u3060\u3055\u3044\u3002"),null;const s=i.files[0];return s.size>=524288?(this.toastr.error("\u30d5\u30a1\u30a4\u30eb\u306e\u30b5\u30a4\u30ba\u304c\u5927\u304d\u3059\u304e\u307e\u3059\u3002(\u7d04 500kb \u307e\u3067)"),null):s}getProfileRef(i){return this.storage.ref(`/image/${this.currentUser.uid}/profile/${i}`)}onClickUploadImage(i){var s=this;return(0,$.c)(function*(){const d=s.ensureImageFile();if(!d)return;const y=yield s.uploadProfileImage("temp_profile",d);s.profileTempImage$=y.ref.getDownloadURL()})()}uploadProfileImage(i,s){var d=this;return(0,$.c)(function*(){return yield d.getProfileRef(i).put(s)})()}doChangePhoto(i){var s=this;return(0,$.c)(function*(){const y=yield(yield s.uploadProfileImage("profile",i)).ref.getDownloadURL();s.updateProfileImage(y)})()}initializeReauth(i){i.currentUser=this.currentUser,i.reauthed.subscribe(()=>{new R.aS(this.protectedSettings.nativeElement).show(),this.isOpenOther=!0})}constructReauth(){return i=>{}}onClickImportant(i){(0,m.qe)("onClickImportant()"),this.dialog.createDefaultBuilder().prepareBody(H,d=>this.initializeReauth(d)).setupChild(this.constructReauth()).setType(j.aU.Info).setSize(j.q2.Default).setTitle("\u518d\u8a8d\u8a3c").cancelButton(()=>{}).closeButton(()=>{}).open()}onClickOkImage(i,s){const d=this.ensureImageFile();d&&this.dialog.createSimpleBuilder().setType(j.aU.Info).setSize(j.q2.Default).setMessage("\u753b\u50cf\u306f\u516c\u958b\u3055\u308c\u307e\u3059\u3002\u3088\u308d\u3057\u3044\u3067\u3059\u304b\uff1f").setTitle("\u78ba\u8a8d").okButton(()=>{this.doChangePhoto(d)}).cancelButton(()=>{}).open()}static \u0275fac=function(s){return new(s||l)(e.GI1(Z.o),e.GI1(ce.WK),e.GI1(Ge.W),e.GI1(te.i4),e.GI1(b.SA),e.GI1(Je.G),e.GI1(j.EF),e.GI1(Me.U))};static \u0275cmp=e.In1({type:l,selectors:[["ng-component"]],viewQuery:function(s,d){if(1&s&&(e.CC$(pt,5),e.CC$(Ut,5)),2&s){let y;e.wto(y=e.Gqi())&&(d.protectedSettings=y.first),e.wto(y=e.Gqi())&&(d.imageBox=y.first)}},decls:1,vars:1,consts:[[4,"ngIf"],[1,"container"],[3,"formGroup"],["configForm",""],[1,"mb-3"],["title","\u4e00\u822c\u516c\u958b\u3055\u308c\u308b\u60c5\u5831\u3092\u7de8\u96c6\u3067\u304d\u307e\u3059\u3002","src","/assets/octicons/question.svg",1,"m-3","octicon-info","help-icon"],[1,"my-2"],[1,"input-group","my-1"],[1,"visually-hidden"],["noPhoto",""],["class","user-settings-profile-image rounded","alt","Profile \u753b\u50cf",3,"src",4,"ngIf","ngIfElse"],[1,"input-group"],["id","appGitfireInputIconFileInput","name","userIcon","formControlName","userIcon","type","file","placeholder","\u30a2\u30a4\u30b3\u30f3\u3092\u9078\u629e","accept","image/*",1,"form-control"],["imageBox",""],[1,"btn","btn-primary",3,"disabled","click"],[1,"input-group","my-2"],[1,"input-group-text"],["title","\u30e1\u30c3\u30bb\u30fc\u30b8\u4e0a\u306b\u8868\u793a\u3055\u308c\u308b\u3042\u306a\u305f\u306e\u540d\u524d\u3067\u3059\u3002","src","/assets/octicons/question.svg",1,"m-1","octicon-info","help-icon"],["name","nickname","placeholder","\u4f8b: hogehoge1032","formControlName","nickname","autofocus","","type","text","maxlength","19","minlength","4","required","",1,"form-control"],["class","valid-feedback",4,"ngIf"],["title","\u30d5\u30ea\u30fc\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u3067\u3059\u3002","src","/assets/octicons/question.svg",1,"m-1","octicon-info","help-icon"],["name","about","placeholder","\u4f8b: Ingress: kagura2718 (RES) \u30dd\u30b1\u30e2\u30f3go: kagura271(\u8d64)","formControlName","about","maxlength","200","type","text",1,"form-control"],["type","button",1,"btn","btn-primary",3,"disabled","click"],["role","button","aria-expanded","false",1,"btn","btn-secondary","collapsed",3,"click"],["id","appGitfireUserSettingsSecretContainer",1,"collapse","m-3"],["protectedSettings",""],[1,"row","input-group","m-3"],[1,"col-2","text-md-end","col-form-label"],["title","\u8a8d\u8a3c\u30d7\u30ed\u30d0\u30a4\u30c0\u304b\u3089\u63d0\u4f9b\u3055\u308c\u305f\u540d\u524d\u3067\u3059\u3002(\u975e\u516c\u958b)","src","/assets/octicons/question.svg",1,"m-1","octicon-info","help-icon"],["name","displayname","placeholder","\u4f8b: hogehoge1032","type","text","disabled","",1,"col-10","form-control",3,"value"],["title","\u8a8d\u8a3c\u306b\u4f7f\u308f\u308c\u308b\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u3067\u3059\u3002(\u975e\u516c\u958b)","src","/assets/octicons/question.svg",1,"m-1","octicon-info","help-icon"],["name","email","placeholder","email@example.com","formControlName","email","autocomplete","email","type","email","required","","autofill","","maxlength","1024","minlength","5",1,"col-8","form-control"],[1,"btn","btn-primary","col-2",3,"disabled","click"],["title","\u30ed\u30b0\u30a4\u30f3\u6642\u306e\u30d1\u30b9\u30ef\u30fc\u30c9\u3067\u3059\u3002\u4ed6\u4eba\u306b\u63a8\u6e2c\u3055\u308c\u306a\u3044\u3082\u306e\u3092\u4f7f\u7528\u3057\u3066\u304f\u3060\u3055\u3044\u3002(\u975e\u516c\u958b)","src","/assets/octicons/question.svg",1,"m-1","octicon-info","help-icon"],["name","password","placeholder","\u5909\u66f4\u306a\u3057","formControlName","password","type","password","autocomplete","new-password","maxlength","256","minlength","6",1,"col-8","form-control"],[1,"col-lg-5","col-form-label",3,"passwordToCheck","barLabel","strengthLabels","barColors"],[1,"m-3"],[1,"input-group","m-3"],["tabindex","-1",1,"btn","btn-warning",3,"click"],["alt","Profile \u753b\u50cf",1,"user-settings-profile-image","rounded",3,"src"],[1,"p-3"],["alt","\u65b0\u3057\u3044 Profile \u753b\u50cf",1,"user-settings-profile-image","rounded",3,"src"],[1,"btn","btn-primary",3,"click"],[1,"valid-feedback"],["class","invalid-feedback",4,"ngIf"],[1,"invalid-feedback"],[3,"mainForm","userPrivStore$"]],template:function(s,d){1&s&&e.yuY(0,ct,77,41,"ng-container",0),2&s&&e.E7m("ngIf",d.currentUser)},dependencies:[D.u_,r.sz,r.ot,r.ue,r.u,r.eJ,r.El,r.Mj,r.uW,r.Wo,w.y,At,D.a],styles:[".user-settings-profile-image[_ngcontent-%COMP%]{width:80px;height:80px}.help-icon[_ngcontent-%COMP%]{width:20px;height:20px}"]})}return l})();function bt(l,S){if(1&l&&(e.I0R(0,"div"),e.OEk(1),e.C$Y()),2&l){const i=e.GaO().$implicit;e.yG2(),e.oRS("URL: ",i.url,"")}}function $t(l,S){if(1&l&&(e.I0R(0,"div")(1,"div")(2,"div"),e.OEk(3),e.C$Y(),e.yuY(4,bt,2,1,"div",0),e.I0R(5,"div"),e.OEk(6),e.C$Y(),e.I0R(7,"div"),e.OEk(8),e.wVc(9,"date"),e.C$Y()(),e.wR5(10,"hr"),e.I0R(11,"div"),e.OEk(12),e.C$Y()()),2&l){const i=S.$implicit;e.yG2(3),e.oRS("Title: ",i.title,""),e.yG2(),e.E7m("ngIf",i.url),e.yG2(2),e.oRS("Done: ",i.hasRead,""),e.yG2(2),e.oRS("Date: ",e.g7$(9,5,i.createdAt.toDate(),"yyyy-MM-dd hh:mm:ss"),""),e.yG2(4),e.cNF(i.body)}}let Et=(()=>{class l{auth;route;store;destroy$=new _.E;id$;trayStore;constructor(i,s,d){this.auth=i,this.route=s,this.store=d}ngOnDestroy(){this.destroy$.next()}ngOnInit(){(0,m.qe)("UserTrayMessageComponent.OnInit()",this.route.snapshot),this.id$=this.route.queryParams.pipe((0,x.I)(i=>"id"in i),(0,Ie.k)(i=>i.id)),this.id$.pipe((0,ae.G)(i=>(0,Ae.E)((0,be.of)(i),this.auth.clientSideUser$)),(0,x.I)(([i,s])=>null!==s),(0,ae.G)(([i,s])=>this.store.doc(`/users/v1/protected/${s.uid}/tray/${i}`).valueChanges({idField:"id"}).pipe((0,A.U)(1))),(0,P.a)(this.destroy$)).subscribe(i=>{this.trayStore=i})}static \u0275fac=function(s){return new(s||l)(e.GI1(Z.o),e.GI1(O.gV),e.GI1(te.i4))};static \u0275cmp=e.In1({type:l,selectors:[["app-user-tray-message"]],decls:1,vars:1,consts:[[4,"ngIf"]],template:function(s,d){1&s&&e.yuY(0,$t,13,8,"div",0),2&s&&e.E7m("ngIf",d.trayStore)},dependencies:[D.u_,D.y]})}return l})(),c=(()=>{class l{auth;localSession;router;constructor(i,s,d){this.auth=i,this.localSession=s,this.router=d,(0,m.qe)("AuthGuard.constructor")}canActivate(i,s){return this.auth.clientSideUser$.pipe((0,Ie.k)(d=>{if((0,m.rD)("AuthGuard",d),d)return!0;const y={queryParams:{redirectPath:s.url}};return(0,m.qe)("auth.guard Prepare to redirect",y),this.router.createUrlTree(["/Gitfire/login"],y)}))}static \u0275fac=function(s){return new(s||l)(e.CoB(Z.o),e.CoB(Me.U),e.CoB(O.E5))};static \u0275prov=e.wxM({token:l,factory:l.\u0275fac,providedIn:"root"})}return l})(),p=(()=>{class l{auth;localSession;router;constructor(i,s,d){this.auth=i,this.localSession=s,this.router=d}canActivate(i,s){return this.auth.authState.pipe((0,Ie.k)(d=>((0,m.rD)("LoginGuard",d),!d||this.router.createUrlTree(["/"]))))}static \u0275fac=function(s){return new(s||l)(e.CoB(he._o),e.CoB(Me.U),e.CoB(O.E5))};static \u0275prov=e.wxM({token:l,factory:l.\u0275fac,providedIn:"root"})}return l})();const F=[{path:"login.htm",loadChildren:()=>Promise.resolve().then(g.bind(g,8636)).then(l=>l.GitfireLoginModule),data:{mode:"login"},canActivate:[p]},{path:"login",redirectTo:"login.htm"},{path:"signup.htm",loadChildren:()=>Promise.resolve().then(g.bind(g,8636)).then(l=>l.GitfireLoginModule),data:{mode:"signup"},canActivate:[p]},{path:"signup",redirectTo:"signup.htm"},{path:"reset.htm",loadChildren:()=>Promise.resolve().then(g.bind(g,8636)).then(l=>l.GitfireLoginModule),data:{mode:"reset"}},{path:"reset",redirectTo:"reset.htm"},{path:"chat.htm",loadChildren:()=>Promise.all([g.e(312),g.e(652)]).then(g.bind(g,3652)).then(l=>l.GitfireChatModule),canActivate:[c]},{path:"chat",redirectTo:"chat.htm"},{path:"post.htm",loadChildren:()=>g.e(280).then(g.bind(g,6280)).then(l=>l.GitfirePostModule),canActivate:[c]},{path:"post",redirectTo:"post.htm"},{path:"settings.htm",component:Mt,canActivate:[c]},{path:"settings",redirectTo:"settings.htm"},{path:"tray.htm",component:Et,canActivate:[c]},{path:"tray",redirectTo:"tray.htm"}];let G=(()=>{class l{static \u0275fac=function(s){return new(s||l)};static \u0275mod=e.a4G({type:l});static \u0275inj=e.s3X({imports:[O.qQ.forChild(F),O.qQ]})}return l})();var K=g(8636),u=g(8784),f=g(5192),T=g(2980);let L=(()=>{class l{static \u0275fac=function(s){return new(s||l)};static \u0275mod=e.a4G({type:l});static \u0275inj=e.s3X({providers:[T.o,f.k],imports:[D.MD,r.y,r.sl,u.C]})}return l})();var ie=g(4576);let ee=(()=>{class l{constructor(){(0,m.rD)("Dynamically loaded GitfireModule")}static \u0275fac=function(s){return new(s||l)};static \u0275mod=e.a4G({type:l});static \u0275inj=e.s3X({providers:[b.SA,Z.o,c,p,Ge.W,{provide:ue.yC,useValue:m.OU.FirebaseCloudFunctionsRegion},{provide:ne,useValue:m.OU.firebaseVapidKey}],imports:[D.MD,r.y,r.sl,G,K.GitfireLoginModule,L,w.e,b.gv.forRoot(m.OU.toastrConfig),V.UN.initializeApp(m.OU.firebaseConfig),te.Se,he.Q$,ce._Q,ue.oP,E,ie.w]})}return l})()},8636:(Dt,Oe,g)=>{g.r(Oe),g.d(Oe,{GitfireLoginModule:()=>O});var D=g(1368),r=g(6504),V=g(6e3),ue=g(8472),te=g(331),he=g(4400),ce=g(4192),$=g(6716),e=g(4496),qe=g(5657),Te=g(124);let be=(()=>{class _{router;destroy$=new qe.E;constructor(A){this.router=A}ngOnInit(){(0,$.qe)("LoginComponent.OnInit()")}ngOnDestroy(){this.destroy$.next()}static \u0275fac=function(x){return new(x||_)(e.GI1(ce.E5))};static \u0275cmp=e.In1({type:_,selectors:[["gitfire-login"]],decls:12,vars:1,consts:[[1,"h3","mb-3","fw-normal"],[3,"isLogin"],["routerLink","/Gitfire/signup"],["routerLink","/Gitfire/reset"],["routerLink","/"]],template:function(x,m){1&x&&(e.I0R(0,"h1",0),e.OEk(1,"\u30ed\u30b0\u30a4\u30f3\u60c5\u5831"),e.C$Y(),e.wR5(2,"gitfire-login-input-auth",1),e.I0R(3,"div")(4,"a",2),e.OEk(5,"\u30a2\u30ab\u30a6\u30f3\u30c8\u3092\u4f5c\u6210\u3059\u308b"),e.C$Y()(),e.I0R(6,"div")(7,"a",3),e.OEk(8,"\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u5fd8\u308c\u305f\u5834\u5408"),e.C$Y()(),e.I0R(9,"div")(10,"a",4),e.OEk(11,"Top"),e.C$Y()()),2&x&&(e.yG2(2),e.E7m("isLogin",!0))},dependencies:[ce.ER,Te.InputAuthComponent]})}return _})();var pe=g(4848);const Pe=["app-cookie-confirm",""];function Ne(_,P){if(1&_){const A=e.KQA();e.I0R(0,"button",4),e.qCj("click",function(){e.usT(A);const m=e.GaO();return e.CGJ(m.remove())}),e.I0R(1,"span",5),e.OEk(2,"\xd7"),e.C$Y()()}}let J=(()=>{class _ extends he.qA{toastr;toastPackage;localSession;constructor(A,x,m){super(A,x),this.toastr=A,this.toastPackage=x,this.localSession=m}ngOnInit(){(0,$.qe)("CookieConfirmComponent.OnInit()")}onClickDeny(A){this.localSession.declineAccess(),this.remove()}onClickGrant(A){this.localSession.grantAccess(),this.remove()}static \u0275fac=function(x){return new(x||_)(e.GI1(he.SA),e.GI1(he.k7),e.GI1(pe.U))};static \u0275cmp=e.In1({type:_,selectors:[["","app-cookie-confirm",""]],features:[e.eg9],attrs:Pe,decls:12,vars:4,consts:[["class","toast-close-button","aria-label","Close",3,"click",4,"ngIf"],["role","alertdialog","aria-live","polite"],["href","/terms.htm"],[1,"btn","btn-outline-primary",3,"click"],["aria-label","Close",1,"toast-close-button",3,"click"],["aria-hidden","true"]],template:function(x,m){1&x&&(e.yuY(0,Ne,3,0,"button",0),e.I0R(1,"div",1)(2,"p"),e.OEk(3,"\u5f53\u30b5\u30a4\u30c8\u3067\u306f\u5229\u7528\u8005\u306e\u5229\u4fbf\u6027\u306e\u305f\u3081\u306b\u30af\u30c3\u30ad\u30fc (Cookies) \u3092\u4f7f\u7528\u3057\u307e\u3059\u3002\u8a73\u3057\u304f\u306f"),e.I0R(4,"a",2),e.OEk(5," [\u5229\u7528\u898f\u7d04] "),e.C$Y(),e.OEk(6,"\u3092\u3054\u89a7\u304f\u3060\u3055\u3044\u3002"),e.C$Y(),e.I0R(7,"div")(8,"button",3),e.qCj("click",function(re){return m.onClickGrant(re)}),e.OEk(9,"\u8a31\u53ef\u3059\u308b"),e.C$Y(),e.I0R(10,"button",3),e.qCj("click",function(re){return m.onClickDeny(re)}),e.OEk(11,"\u62d2\u5426\u3059\u308b"),e.C$Y()()()),2&x&&(e.E7m("ngIf",m.options.closeButton),e.yG2(),e.m8U(m.options.messageClass),e.e48("aria-label",m.message))},styles:["[_nghost-%COMP%]{background:#eefef0;width:100%;height:100%}a[_ngcontent-%COMP%]:link{color:red}a[_ngcontent-%COMP%]:visited{color:#a00}a[_ngcontent-%COMP%]:hover{color:red}a[_ngcontent-%COMP%]:active{color:#ff8000}"]})}return _})(),se=(()=>{class _{toastr;localSession;constructor(A,x){this.toastr=A,this.localSession=x}ngOnInit(){(0,$.qe)("SignupComponent.OnInit()")}ngAfterViewInit(){this.maybeConfirm()}maybeConfirm(){this.localSession.shouldConfirm()&&this.toastr.info(void 0,void 0,{toastComponent:J,disableTimeOut:!0,tapToDismiss:!1,preventDuplicates:!0})}static \u0275fac=function(x){return new(x||_)(e.GI1(he.SA),e.GI1(pe.U))};static \u0275cmp=e.In1({type:_,selectors:[["gitfire-signup"]],decls:9,vars:1,consts:[[1,"h3","mb-3","fw-normal"],[3,"isSignup"],["routerLink","/Gitfire/login"],["routerLink","/"]],template:function(x,m){1&x&&(e.I0R(0,"h1",0),e.OEk(1,"\u30a2\u30ab\u30a6\u30f3\u30c8\u306e\u4f5c\u6210"),e.C$Y(),e.wR5(2,"gitfire-login-input-auth",1),e.I0R(3,"div")(4,"a",2),e.OEk(5,"\u30ed\u30b0\u30a4\u30f3"),e.C$Y()(),e.I0R(6,"div")(7,"a",3),e.OEk(8,"Top"),e.C$Y()()),2&x&&(e.yG2(2),e.E7m("isSignup",!0))},dependencies:[ce.ER,Te.InputAuthComponent]})}return _})();var ae=g(1528),Ie=g(6520),z=g(496);const q=["resetForm"];function xe(_,P){1&_&&(e.I0R(0,"div",11),e.OEk(1,"E \u30e1\u30fc\u30eb\u306f\u5fc5\u9808\u3067\u3059\u3002"),e.C$Y())}function we(_,P){1&_&&(e.I0R(0,"div",11),e.OEk(1,"E \u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044\u3002"),e.C$Y())}function Le(_,P){if(1&_&&(e.SAx(0),e.yuY(1,xe,2,0,"div",10)(2,we,2,0,"div",10),e.k70()),2&_){e.GaO();const A=e.Gew(6);e.yG2(),e.E7m("ngIf",null==A.errors?null:A.errors.required),e.yG2(),e.E7m("ngIf",null==A.errors?null:A.errors.minlength)}}let le=(()=>{class _{auth;dialog;toastr;emailInput="";resetForm;constructor(A,x,m){this.auth=A,this.dialog=x,this.toastr=m}ngOnInit(){(0,$.qe)("ResetPasswordComponent.OnInit()")}onClickReset(A){this.dialog.createSimpleBuilder().setType(Ie.aU.Warn).setSize(Ie.q2.Default).setTitle("\u78ba\u8a8d").setMessage(`\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u306f\u6b63\u3057\u3044\u3067\u3059\u304b\uff1f ${this.emailInput}`).okButton(()=>{this.tryResetPassword(this.emailInput)}).cancelButton(()=>{}).open()}tryResetPassword(A){var x=this;return(0,ae.c)(function*(){try{yield x.auth.sendPasswordResetEmail(A),x.toastr.info("\u30e1\u30fc\u30eb\u3092\u9001\u4fe1\u3057\u307e\u3057\u305f\u3002")}catch(m){(0,$.sJ)("Error while sent reset mail",m),Error,x.toastr.error("\u5931\u6557\u3057\u307e\u3057\u305f\u3002( ${errmsg} )")}})()}static \u0275fac=function(x){return new(x||_)(e.GI1(te._o),e.GI1(z.EF),e.GI1(he.SA))};static \u0275cmp=e.In1({type:_,selectors:[["gitfire-login-reset-password"]],viewQuery:function(x,m){if(1&x&&e.CC$(q,5),2&x){let j;e.wto(j=e.Gqi())&&(m.resetForm=j.first)}},decls:19,vars:5,consts:[["resetForm",""],[1,"row","p-3"],[1,"visually-hidden"],["autofocus","","type","email","name","email","placeholder","Email address","required","","autofill","","maxlength","1024","minlength","5",1,"form-control","col-8",3,"ngModel","ngModelChange"],["email","ngModel"],[1,"btn","btn-warning",3,"disabled","click"],[4,"ngIf"],["routerLink","/"],["routerLink","/Gitfire/signup"],["routerLink","/Gitfire/login"],["class","invalid-feedback",4,"ngIf"],[1,"invalid-feedback"]],template:function(x,m){if(1&x&&(e.I0R(0,"form",null,0)(2,"div",1)(3,"label",2),e.OEk(4,"Email"),e.C$Y(),e.I0R(5,"input",3,4),e.iHE("ngModelChange",function(re){return e.kNx(m.emailInput,re)||(m.emailInput=re),re}),e.C$Y(),e.I0R(7,"button",5),e.qCj("click",function(re){return m.onClickReset(re)}),e.OEk(8,"\u30d1\u30b9\u30ef\u30fc\u30c9\u30ea\u30bb\u30c3\u30c8"),e.C$Y(),e.yuY(9,Le,3,2,"ng-container",6),e.C$Y()(),e.I0R(10,"div")(11,"a",7),e.OEk(12,"Top"),e.C$Y()(),e.I0R(13,"div")(14,"a",8),e.OEk(15,"\u30a2\u30ab\u30a6\u30f3\u30c8\u3092\u4f5c\u6210\u3059\u308b"),e.C$Y()(),e.I0R(16,"div")(17,"a",9),e.OEk(18,"\u30ed\u30b0\u30a4\u30f3"),e.C$Y()()),2&x){const j=e.Gew(6);e.yG2(2),e.eAK("was-validated",j.dirty||j.touched),e.yG2(3),e.OKB("ngModel",m.emailInput),e.yG2(2),e.E7m("disabled",!j.valid),e.yG2(2),e.E7m("ngIf",j.invalid)}},dependencies:[D.u_,r.sz,r.ot,r.ue,r.u,r.eJ,r.El,r.Mj,r._G,r.SC,ce.ER]})}return _})();function Ue(_,P){1&_&&e.wR5(0,"gitfire-signup")}function ne(_,P){1&_&&e.wR5(0,"gitfire-login")}function Be(_,P){1&_&&e.wR5(0,"gitfire-login-reset-password")}const E=[{path:"",component:(()=>{class _{route;mode;constructor(A){this.route=A,this.mode=A.snapshot.data.mode}ngOnInit(){(0,$.qe)("LoginRouterComponent.OnInit()")}static \u0275fac=function(x){return new(x||_)(e.GI1(ce.gV))};static \u0275cmp=e.In1({type:_,selectors:[["ng-component"]],decls:4,vars:4,consts:[[3,"ngSwitch"],[4,"ngSwitchCase"]],template:function(x,m){1&x&&(e.SAx(0,0),e.yuY(1,Ue,1,0,"gitfire-signup",1)(2,ne,1,0,"gitfire-login",1)(3,Be,1,0,"gitfire-login-reset-password",1),e.k70()),2&x&&(e.E7m("ngSwitch",m.mode),e.yG2(),e.E7m("ngSwitchCase","signup"),e.yG2(),e.E7m("ngSwitchCase","login"),e.yG2(),e.E7m("ngSwitchCase","reset"))},dependencies:[D.Ko,D.Wm,be,se,le]})}return _})()}];let b=(()=>{class _{static \u0275fac=function(x){return new(x||_)};static \u0275mod=e.a4G({type:_});static \u0275inj=e.s3X({imports:[ce.qQ.forChild(E),ce.qQ]})}return _})();var w=g(5112);let O=(()=>{class _{static \u0275fac=function(x){return new(x||_)};static \u0275mod=e.a4G({type:_});static \u0275inj=e.s3X({providers:[he.SA],imports:[D.MD,r.y,r.sl,b,he.gv.forRoot($.OU.toastrConfig),V.UN.initializeApp($.OU.firebaseConfig),ue.Se,te.Q$,w.e]})}return _})()},124:(Dt,Oe,g)=>{g.r(Oe),g.d(Oe,{InputAuthComponent:()=>Ye});var D=g(1528),r=g(4496),V=g(6504),ue=g(5657),te=g(6700),he=g(9900),ce=g(3616),$=g(3992),e=g(9252),Te=(g(8836),g(6716)),be=g(331),pe=g(4400),Pe=g(4192),Ne=g(1368),J=g(5112),se=g(6228);const ae=["mainForm"],Ie=["confirmPasswordInput"];function z(B,H){1&B&&(r.I0R(0,"div",15),r.OEk(1,"OK!"),r.C$Y())}function q(B,H){1&B&&(r.I0R(0,"div",17),r.OEk(1,"E \u30e1\u30fc\u30eb\u306f\u5fc5\u9808\u3067\u3059\u3002"),r.C$Y())}function xe(B,H){1&B&&(r.I0R(0,"div",17),r.OEk(1,"E \u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044\u3002"),r.C$Y())}function we(B,H){if(1&B&&(r.SAx(0),r.yuY(1,q,2,0,"div",16)(2,xe,2,0,"div",16),r.k70()),2&B){const R=r.GaO();r.yG2(),r.E7m("ngIf",null==R.emailControl.errors?null:R.emailControl.errors.required),r.yG2(),r.E7m("ngIf",null==R.emailControl.errors?null:R.emailControl.errors.minlength)}}function Le(B,H){1&B&&(r.I0R(0,"div",15),r.OEk(1,"\u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u5f37\u5ea6\u306f\u5145\u5206\u306b\u3057\u3066\u304f\u3060\u3055\u3044\u3002"),r.C$Y())}function le(B,H){1&B&&(r.I0R(0,"div",17),r.OEk(1,"\u30d1\u30b9\u30ef\u30fc\u30c9\u306f\u5fc5\u9808\u3067\u3059\u3002"),r.C$Y())}function Ue(B,H){1&B&&(r.I0R(0,"div",17),r.OEk(1,"\u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u9577\u3055\u304c\u8db3\u308a\u307e\u305b\u3093\u3002"),r.C$Y())}function ne(B,H){if(1&B&&(r.SAx(0,18),r.yuY(1,le,2,0,"div",16)(2,Ue,2,0,"div",16),r.k70()),2&B){const R=r.GaO();r.yG2(),r.E7m("ngIf",null==R.passwordControl.errors?null:R.passwordControl.errors.required),r.yG2(),r.E7m("ngIf",null==R.passwordControl.errors?null:R.passwordControl.errors.minlength)}}const Be=()=>["(\u5371\u967a)","(\u5f31\u3044)","(\u666e\u901a)","(\u5f37\u3044)","(\u5145\u5206\u306b\u5b89\u5168)"],v=()=>["#DD2C00","#FF6D00","#FFD600","#AEEA00","#00C853"];function E(B,H){if(1&B&&(r.wR5(0,"ng9-password-strength-bar",19),r.wVc(1,"async")),2&B){const R=r.GaO();r.E7m("passwordToCheck",r.kDX(1,4,R.passwordControl.valueChanges))("barLabel","\u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u5f37\u5ea6(\u76ee\u5b89): ")("strengthLabels",r.q4q(6,Be))("barColors",r.q4q(7,v))}}function b(B,H){1&B&&(r.I0R(0,"div",15),r.OEk(1,"\u4e00\u81f4\u3057\u307e\u3057\u305f\uff01"),r.C$Y())}function w(B,H){1&B&&(r.I0R(0,"div",17),r.OEk(1,"\u30d1\u30b9\u30ef\u30fc\u30c9\u306f\u5fc5\u9808\u3067\u3059\u3002"),r.C$Y())}function O(B,H){1&B&&(r.I0R(0,"div",17),r.OEk(1,"\u30d1\u30b9\u30ef\u30fc\u30c9\u304c\u4e00\u81f4\u3057\u307e\u305b\u3093\u3002"),r.C$Y())}function _(B,H){if(1&B&&(r.SAx(0),r.yuY(1,w,2,0,"div",16)(2,O,2,0,"div",16),r.k70()),2&B){const R=r.GaO(2);r.yG2(),r.E7m("ngIf",null==R.confirmPasswordControl.errors?null:R.confirmPasswordControl.errors.required),r.yG2(),r.E7m("ngIf",null==R.confirmPasswordControl.errors?null:R.confirmPasswordControl.errors.passwordMisMatch)}}function P(B,H){if(1&B&&(r.I0R(0,"div",2)(1,"label",20),r.OEk(2,"Confirm Password"),r.C$Y(),r.wR5(3,"input",21,22),r.yuY(5,b,2,0,"div",5)(6,_,3,2,"ng-container",6),r.C$Y()),2&B){const R=r.GaO();r.eAK("was-validated",R.confirmPasswordControl.dirty||R.confirmPasswordControl.touched),r.yG2(3),r.E7m("autocomplete",R.passwordAutocomplete),r.yG2(2),r.E7m("ngIf",!R.confirmPasswordControl.invalid),r.yG2(),r.E7m("ngIf",R.confirmPasswordControl.invalid)}}function A(B,H){1&B&&(r.I0R(0,"div",29),r.OEk(1,"OK!"),r.C$Y())}function x(B,H){1&B&&(r.I0R(0,"div",31),r.OEk(1,"\u898f\u7d04\u306b\u540c\u610f\u3057\u3066\u3044\u305f\u3060\u304f\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002"),r.C$Y())}function m(B,H){if(1&B&&(r.SAx(0),r.yuY(1,x,2,0,"div",30),r.k70()),2&B){const R=r.GaO(2);r.yG2(),r.E7m("ngIf",null==R.agreeTosControl.errors?null:R.agreeTosControl.errors.required)}}function j(B,H){if(1&B&&(r.I0R(0,"div",23)(1,"label",24),r.OEk(2,"\u898f\u7d04\u306b\u540c\u610f\u3059\u308b"),r.C$Y(),r.wR5(3,"input",25),r.I0R(4,"a",26),r.OEk(5," [\u5229\u7528\u898f\u7d04] "),r.C$Y(),r.I0R(6,"span",27),r.OEk(7,"\u306b\u540c\u610f\u3057\u307e\u3059\u3002"),r.C$Y(),r.yuY(8,A,2,0,"div",28)(9,m,2,1,"ng-container",6),r.C$Y()),2&B){const R=r.GaO();r.eAK("was-validated",R.agreeTosControl.dirty||R.agreeTosControl.touched),r.yG2(8),r.E7m("ngIf",!R.agreeTosControl.invalid),r.yG2(),r.E7m("ngIf",R.agreeTosControl.invalid)}}function re(B,H){if(1&B){const R=r.KQA();r.I0R(0,"button",32),r.qCj("click",function(U){r.usT(R);const Z=r.GaO();return r.CGJ(Z.onClickSignup(U))}),r.OEk(1,"\u30a2\u30ab\u30a6\u30f3\u30c8\u4f5c\u6210"),r.C$Y()}if(2&B){const R=r.GaO();r.E7m("disabled",!R.inputAuthForm.valid)}}function oe(B,H){if(1&B){const R=r.KQA();r.I0R(0,"button",32),r.qCj("click",function(U){r.usT(R);const Z=r.GaO();return r.CGJ(Z.onClickLogin(U))}),r.wR5(1,"img",33),r.OEk(2,"\u30ed\u30b0\u30a4\u30f3"),r.C$Y()}if(2&B){const R=r.GaO();r.E7m("disabled",!R.inputAuthForm.valid)}}function me(B,H){if(1&B){const R=r.KQA();r.I0R(0,"button",32),r.qCj("click",function(U){r.usT(R);const Z=r.GaO();return r.CGJ(Z.onClickReauth(U))}),r.wR5(1,"img",33),r.OEk(2,"\u518d\u8a8d\u8a3c"),r.C$Y()}if(2&B){const R=r.GaO();r.E7m("disabled",!R.inputAuthForm.valid)}}function X(B,H){if(1&B){const R=r.KQA();r.I0R(0,"app-oauth-federations",34),r.qCj("loginSucceeded",function(){r.usT(R);const U=r.GaO();return r.CGJ(U.onOauthLoginSucceeded())})("loginFailed",function(U){r.usT(R);const Z=r.GaO();return r.CGJ(Z.onOauthLoginFailed(U))}),r.C$Y()}}let Ye=(()=>{class B{auth;toastr;router;route;isLogin=!1;isReauth=!1;reauthUser=null;isSignup=!1;showFederations=!0;reauthed=new r._w7;destroy$=new ue.E;inputAuthForm;loginUser$=new te.g(null);passwordAutocomplete;mainForm;confirmPasswordInput;constructor(R,N,U,Z){this.auth=R,this.toastr=N,this.router=U,this.route=Z}ngOnInit(){this.passwordAutocomplete=this.isSignup?"new-password":"current-password",this.inputAuthForm=new V.WC({}),this.inputAuthForm.addControl("email",new V.Ku("")),this.inputAuthForm.addControl("password",new V.Ku("")),this.isSignup&&(this.inputAuthForm.addControl("retypePassword",new V.Ku("")),this.inputAuthForm.addControl("agreeTosCheck",new V.Ku(!1)),this.inputAuthForm.setValidators([this.validateXFPassword.bind(this)])),this.inputAuthForm.disable(),this.initializeAuthForm()}ngOnDestroy(){this.destroy$.next()}ngAfterViewInit(){this.auth.authState.pipe((0,ce.a)(this.destroy$)).subscribe(R=>{this.loginUser$.next(R)})}navigateAfterSucceeded(){this.route.queryParams.pipe((0,ce.a)(this.destroy$),(0,$.U)(1)).subscribe(R=>{const N=R.redirectPath;this.router.navigate(N?[N]:["/"])})}erroredConnected(R){(0,Te.sJ)("error while connecting account",R);const N=R instanceof Error?R.message:"Unknown error";this.toastr.error(`Login \u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002 \n ( ${N} )`)}loginSucceeded(){this.toastr.success("Login \u3057\u307e\u3057\u305f\u3002"),this.navigateAfterSucceeded()}connectSucceeded(R){this.toastr.success("Sign-up \u3057\u307e\u3057\u305f\u3002"),this.navigateAfterSucceeded()}get emailControl(){return this.inputAuthForm.get("email")}get passwordControl(){return this.inputAuthForm.get("password")}get confirmPasswordControl(){return this.inputAuthForm.get("retypePassword")}get agreeTosControl(){return this.inputAuthForm.get("agreeTosCheck")}validateXFPassword(R){const N=R.get("password"),U=R.get("retypePassword");return N.value!==U.value?(U.setErrors({passwordMisMatch:!0}),this.confirmPasswordInput&&this.confirmPasswordInput.nativeElement.setCustomValidity("create error state"),null):(this.confirmPasswordInput&&this.confirmPasswordInput.nativeElement.setCustomValidity(""),U.setErrors(null),null)}validateAuthForm(){return this.inputAuthForm.markAllAsTouched(),!this.inputAuthForm.invalid||((0,Te.sJ)("Assert! Button should be disabled."),!1)}initializeAuthForm(){(0,he.Q)(this.auth.setPersistence(e.c.auth.Auth.Persistence.SESSION)).pipe((0,$.U)(1),(0,ce.a)(this.destroy$)).subscribe({next:()=>{this.inputAuthForm.enable()},error:R=>{this.toastr.error("\u8a8d\u8a3c Server \u3092\u521d\u671f\u5316\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002")}})}onClickSignup(R){var N=this;return(0,D.c)(function*(){if(R.preventDefault(),N.validateAuthForm())try{const U=yield N.auth.createUserWithEmailAndPassword(N.emailControl.value,N.passwordControl.value);N.toastr.info("\u30a2\u30ab\u30a6\u30f3\u30c8\u3092\u4f5c\u6210\u3057\u307e\u3057\u305f\u3002\u30e1\u30fc\u30eb\u3092\u78ba\u8a8d\u3057\u3066\u304f\u3060\u3055\u3044\u3002"),yield U.user.sendEmailVerification(),N.navigateAfterSucceeded()}catch(U){(0,Te.sJ)("Error while reject",U);const Z=U instanceof Error?U.message:"Unknown error";N.toastr.error(`\u30a2\u30ab\u30a6\u30f3\u30c8\u306e\u4f5c\u6210\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002\u6700\u521d\u304b\u3089\u3084\u308a\u76f4\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n ( ${Z} )`)}})()}onClickLogin(R){var N=this;return(0,D.c)(function*(){if(R.preventDefault(),N.validateAuthForm())try{yield N.auth.signInWithEmailAndPassword(N.emailControl.value,N.passwordControl.value),N.loginSucceeded()}catch(U){N.erroredConnected(U)}})()}onClickReauth(R){var N=this;return(0,D.c)(function*(){if(R.preventDefault(),N.validateAuthForm())try{const U=e.c.auth.EmailAuthProvider.credential(N.emailControl.value,N.passwordControl.value);yield N.reauthUser.reauthenticateWithCredential(U),N.reauthed.next()}catch(U){N.erroredConnected(U)}})()}onOauthLoginFailed(R){this.erroredConnected(R)}onOauthLoginSucceeded(){this.loginSucceeded()}static \u0275fac=function(N){return new(N||B)(r.GI1(be._o),r.GI1(pe.SA),r.GI1(Pe.E5),r.GI1(Pe.gV))};static \u0275cmp=r.In1({type:B,selectors:[["gitfire-login-input-auth"]],viewQuery:function(N,U){if(1&N&&(r.CC$(ae,5),r.CC$(Ie,5)),2&N){let Z;r.wto(Z=r.Gqi())&&(U.mainForm=Z.first),r.wto(Z=r.Gqi())&&(U.confirmPasswordInput=Z.first)}},inputs:{isLogin:"isLogin",isReauth:"isReauth",reauthUser:"reauthUser",isSignup:"isSignup",showFederations:"showFederations"},outputs:{reauthed:"reauthed"},decls:22,vars:17,consts:[[3,"formGroup"],["mainForm",""],[1,"row","m-3"],["for","appGitfireLoginEmailInput",1,"visually-hidden"],["id","appGitfireLoginEmailInput","name","email","formControlName","email","placeholder","email@example.com","autocomplete","email","type","email","required","","autofill","","autofocus","","maxlength","1024","minlength","5",1,"form-control","col-12"],["class","valid-feedback",4,"ngIf"],[4,"ngIf"],["for","appGitfireLoginPasswordInput",1,"visually-hidden"],["id","appGitfireLoginPasswordInput","type","password","name","password","formControlName","password","placeholder","Password","required","","autofill","","maxlength","256","minlength","6",1,"form-control","col-12",3,"autocomplete"],["class"," ",4,"ngIf"],["class","col-12 m-3",3,"passwordToCheck","barLabel","strengthLabels","barColors",4,"ngIf"],["class","row m-3",3,"was-validated",4,"ngIf"],["class","row custom-control custom-checkbox m-5 text-center",3,"was-validated",4,"ngIf"],["class","btn btn-lg btn-primary btn-block",3,"disabled","click",4,"ngIf"],[3,"loginSucceeded","loginFailed",4,"ngIf"],[1,"valid-feedback"],["class","invalid-feedback",4,"ngIf"],[1,"invalid-feedback"],[1,""],[1,"col-12","m-3",3,"passwordToCheck","barLabel","strengthLabels","barColors"],["for","appGitfireSignupPasswordConfirmInput",1,"visually-hidden"],["id","appGitfireSignupPasswordConfirmInput","type","password","name","password_confirm","formControlName","retypePassword","placeholder","Confirm password","required","",1,"form-control","col-12",3,"autocomplete"],["confirmPasswordInput",""],[1,"row","custom-control","custom-checkbox","m-5","text-center"],["for","appGitfireAgreeTosCheck",1,"col-auto","visually-hidden"],["id","col-auto appGitfireAgreeTosCheck","formControlName","agreeTosCheck","type","checkbox","required","",1,"form-check-input"],["tabindex","-1","about","_blank","href","/terms.htm",1,"col-auto"],[1,"col-auto"],["class","valid-feedback col-auto",4,"ngIf"],[1,"valid-feedback","col-auto"],["class","invalid-feedback col-auto",4,"ngIf"],[1,"invalid-feedback","col-auto"],[1,"btn","btn-lg","btn-primary","btn-block",3,"disabled","click"],["src","/assets/octicons/sign-in.svg",1,"m-1","gitfire-link-icon","octicon-info"],[3,"loginSucceeded","loginFailed"]],template:function(N,U){1&N&&(r.I0R(0,"form",0,1)(2,"div",2)(3,"label",3),r.OEk(4,"Email"),r.C$Y(),r.wR5(5,"input",4),r.yuY(6,z,2,0,"div",5)(7,we,3,2,"ng-container",6),r.C$Y(),r.I0R(8,"div",2)(9,"label",7),r.OEk(10,"Password"),r.C$Y(),r.wR5(11,"input",8),r.yuY(12,Le,2,0,"div",5)(13,ne,3,2,"ng-container",9)(14,E,2,8,"ng9-password-strength-bar",10),r.C$Y(),r.yuY(15,P,7,5,"div",11)(16,j,10,4,"div",12),r.I0R(17,"div",2),r.yuY(18,re,2,1,"button",13)(19,oe,3,1,"button",13)(20,me,3,1,"button",13),r.C$Y(),r.yuY(21,X,1,0,"app-oauth-federations",14),r.C$Y()),2&N&&(r.E7m("formGroup",U.inputAuthForm),r.yG2(2),r.eAK("was-validated",U.emailControl.dirty||U.emailControl.touched),r.yG2(4),r.E7m("ngIf",!U.emailControl.invalid),r.yG2(),r.E7m("ngIf",U.emailControl.invalid),r.yG2(),r.eAK("was-validated",U.passwordControl.dirty||U.passwordControl.touched),r.yG2(3),r.E7m("autocomplete",U.passwordAutocomplete),r.yG2(),r.E7m("ngIf",U.isSignup&&!U.passwordControl.invalid),r.yG2(),r.E7m("ngIf",U.passwordControl.invalid),r.yG2(),r.E7m("ngIf",U.isSignup),r.yG2(),r.E7m("ngIf",U.isSignup),r.yG2(),r.E7m("ngIf",U.isSignup),r.yG2(2),r.E7m("ngIf",U.isSignup),r.yG2(),r.E7m("ngIf",U.isLogin),r.yG2(),r.E7m("ngIf",U.isReauth),r.yG2(),r.E7m("ngIf",U.showFederations))},dependencies:[Ne.u_,V.sz,V.ot,V.SU,V.ue,V.u,V.eJ,V.El,V.Mj,V.cX,V.uW,V.Wo,J.y,se.c,Ne.a]})}return B})()},8784:(Dt,Oe,g)=>{g.d(Oe,{C:()=>V});var D=g(1368),r=g(4496);let V=(()=>{class ue{static \u0275fac=function(ce){return new(ce||ue)};static \u0275mod=r.a4G({type:ue});static \u0275inj=r.s3X({imports:[D.MD]})}return ue})()},5112:(Dt,Oe,g)=>{function te(v,E,b,w){var P,O=arguments.length,_=O<3?E:null===w?w=Object.getOwnPropertyDescriptor(E,b):w;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)_=Reflect.decorate(v,E,b,w);else for(var A=v.length-1;A>=0;A--)(P=v[A])&&(_=(O<3?P(_):O>3?P(E,b,_):P(E,b))||_);return O>3&&_&&Object.defineProperty(E,b,_),_}g.d(Oe,{y:()=>ne,e:()=>Be});var Ue,le=g(4496);let ne=Ue=class{constructor(){this.onStrengthChanged=new le._w7,this.defaultColors=["#F00","#F90","#FF0","#9F0","#0F0"],this.defaultThresholds=[90,70,40,20],this.defaultBaseColor="#DDD",this.colors=this.defaultColors,this.thresholds=this.defaultThresholds}static measureStrength(E){let b=0;const w={};for(let P=0;P<E.length;P++)w[E[P]]=(w[E[P]]||0)+1,b+=5/w[E[P]];const O={digits:/\d/.test(E),lower:/[a-z]/.test(E),upper:/[A-Z]/.test(E),nonWords:/\W/.test(E)};let _=0;for(let P in O)_+=O[P]?1:0;return b+=10*(_-1),Math.trunc(b)}checkBarColors(){this.colors=this.barColors&&5===this.barColors.length?this.barColors.slice():this.defaultColors,this.strengths=this.strengthLabels&&5===this.strengthLabels.length?this.strengthLabels.slice():null,this.setStrengthLabel(0),/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(this.baseColor)||(this.baseColor=this.defaultBaseColor)}checkThresholds(){this.thresholds=this.customThresholds&&4===this.customThresholds.length?this.customThresholds.slice():this.defaultThresholds}getColor(E){let b=0;return E>this.thresholds[0]?b=4:E>this.thresholds[1]?b=3:E>=this.thresholds[2]?b=2:E>=this.thresholds[3]&&(b=1),{idx:b+1,col:this.colors[b]}}getStrengthIndexAndColor(E){return this.getColor(Ue.measureStrength(E))}ngOnChanges(E){if(!E.passwordToCheck)return;const b=E.passwordToCheck.currentValue;this.checkBarColors(),this.checkThresholds(),this.setBarColors(5,this.baseColor);let w=0;if(b){const O=this.getStrengthIndexAndColor(b);w=O.idx-1,this.setStrengthLabel(w),this.setBarColors(O.idx,O.col)}this.onStrengthChanged.emit(w)}setBarColors(E,b){for(let w=0;w<E;w++)this["bar"+w]=b}setStrengthLabel(E){this.strengths&&(this.strengthLabel=this.strengths[E])}};te([(0,le.EFl)()],ne.prototype,"passwordToCheck",void 0),te([(0,le.EFl)()],ne.prototype,"barLabel",void 0),te([(0,le.EFl)()],ne.prototype,"barColors",void 0),te([(0,le.EFl)()],ne.prototype,"baseColor",void 0),te([(0,le.EFl)()],ne.prototype,"strengthLabels",void 0),te([(0,le.EFl)()],ne.prototype,"customThresholds",void 0),te([(0,le.C_D)()],ne.prototype,"onStrengthChanged",void 0),ne=Ue=te([(0,le.YlN)({selector:"ng9-password-strength-bar",template:'\n    <div id="strength" #strength>\n      <small>{{barLabel}}</small>\n      <ul id="strengthBar" class="strengthBar">\n        <li id="bar0" class="point" [style.background-color]="bar0"></li>\n        <li class="point" [style.background-color]="bar1"></li>\n        <li class="point" [style.background-color]="bar2"></li>\n        <li class="point" [style.background-color]="bar3"></li>\n        <li class="point" [style.background-color]="bar4"></li>\n      </ul>\n      <small [hidden]="!strengths" class="pre">  {{strengthLabel}}</small>\n    </div>\n  ',styles:["\n    .strengthBar {\n      display: inline;\n      list-style: none;\n      margin: 0 0 0 15px;\n      padding: 0;\n      vertical-align: 2px;\n    }\n\n    .strengthBar .point {\n      background: #DDD;\n      border-radius: 2px;\n      display: inline-block;\n      height: 5px;\n      margin-right: 1px;\n      width: 20px;\n    }\n\n    .strengthBar .point:last-child {\n      margin: 0;\n    }\n    .pre {\n      white-space: pre;\n    }\n  "]})],ne);let Be=(()=>{let v=class{};return v=te([(0,le.S0t)({declarations:[ne],imports:[],exports:[ne]})],v),v})()},12:(Dt,Oe,g)=>{g.d(Oe,{WK:()=>_n,_Q:()=>io});var D=g(7900),r=g(3252),V=g(2700),ue=g(9900),te=g(4680),he=g(4704),ce=g(7368),$=g(4496),e=g(6e3),qe=g(9624),Te=g(1528),be=g(8360),pe=g(3584),Pe=g(3144);const Ne="firebasestorage.googleapis.com",J="storageBucket";class z extends pe.kx{constructor(t,o,a=0){super(xe(t),`Firebase Storage: ${o} (${xe(t)})`),this.status_=a,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,z.prototype)}get status(){return this.status_}set status(t){this.status_=t}_codeEquals(t){return xe(t)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(t){this.customData.serverResponse=t,this.message=this.customData.serverResponse?`${this._baseMessage}\n${this.customData.serverResponse}`:this._baseMessage}}var q=function(n){return n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment",n}(q||{});function xe(n){return"storage/"+n}function we(){return new z(q.UNKNOWN,"An unknown error occurred, please check the error payload for server response.")}function v(){return new z(q.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function E(){return new z(q.CANCELED,"User canceled the upload/download.")}function _(){return new z(q.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function m(n){return new z(q.INVALID_ARGUMENT,n)}function j(){return new z(q.APP_DELETED,"The Firebase app was deleted.")}function re(n){return new z(q.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function oe(n,t){return new z(q.INVALID_FORMAT,"String does not match format '"+n+"': "+t)}function me(n){throw new z(q.INTERNAL_ERROR,"Internal error: "+n)}class X{constructor(t,o){this.bucket=t,this.path_=o}get path(){return this.path_}get isRoot(){return 0===this.path.length}fullServerUrl(){const t=encodeURIComponent;return"/b/"+t(this.bucket)+"/o/"+t(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(t,o){let a;try{a=X.makeFromUrl(t,o)}catch{return new X(t,"")}if(""===a.path)return a;throw function w(n){return new z(q.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}(t)}static makeFromUrl(t,o){let a=null;const h="([A-Za-z0-9.\\-_]+)",Y=new RegExp("^gs://"+h+"(/(.*))?$","i");function W(Fe){Fe.path_=decodeURIComponent(Fe.path)}const ye=o.replace(/[.]/g,"\\."),De=[{regex:Y,indices:{bucket:1,path:3},postModify:function C(Fe){"/"===Fe.path.charAt(Fe.path.length-1)&&(Fe.path_=Fe.path_.slice(0,-1))}},{regex:new RegExp(`^https?://${ye}/v[A-Za-z0-9_]+/b/${h}/o(/([^?#]*).*)?$`,"i"),indices:{bucket:1,path:3},postModify:W},{regex:new RegExp(`^https?://${o===Ne?"(?:storage.googleapis.com|storage.cloud.google.com)":o}/${h}/([^?#]*)`,"i"),indices:{bucket:1,path:2},postModify:W}];for(let Fe=0;Fe<De.length;Fe++){const jt=De[Fe],Kt=jt.regex.exec(t);if(Kt){let Wt=Kt[jt.indices.path];Wt||(Wt=""),a=new X(Kt[jt.indices.bucket],Wt),jt.postModify(a);break}}if(null==a)throw function b(n){return new z(q.INVALID_URL,"Invalid URL '"+n+"'.")}(t);return a}}class Ye{constructor(t){this.promise_=Promise.reject(t)}getPromise(){return this.promise_}cancel(t=!1){}}function Z(n){return"string"==typeof n||n instanceof String}function Ge(n){return Je()&&n instanceof Blob}function Je(){return typeof Blob<"u"}function Me(n,t,o,a){if(a<t)throw m(`Invalid value for '${n}'. Expected ${t} or greater.`);if(a>o)throw m(`Invalid value for '${n}'. Expected ${o} or less.`)}function Ae(n,t,o){let a=t;return null==o&&(a=`https://${t}`),`${o}://${a}/v0${n}`}function je(n){const t=encodeURIComponent;let o="?";for(const a in n)n.hasOwnProperty(a)&&(o=o+(t(a)+"=")+t(n[a])+"&");return o=o.slice(0,-1),o}var $e=function(n){return n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT",n}($e||{});function Xe(n,t){const o=n>=500&&n<600,h=-1!==[408,429].indexOf(n),C=-1!==t.indexOf(n);return o||h||C}class lt{constructor(t,o,a,h,C,I,Y,M,W,Q,ye,fe=!0){this.url_=t,this.method_=o,this.headers_=a,this.body_=h,this.successCodes_=C,this.additionalRetryCodes_=I,this.callback_=Y,this.errorCallback_=M,this.timeout_=W,this.progressCallback_=Q,this.connectionFactory_=ye,this.retry=fe,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((ge,ve)=>{this.resolve_=ge,this.reject_=ve,this.start_()})}start_(){const o=(a,h)=>{const C=this.resolve_,I=this.reject_,Y=h.connection;if(h.wasSuccessCode)try{const M=this.callback_(Y,Y.getResponse());!function R(n){return void 0!==n}(M)?C():C(M)}catch(M){I(M)}else if(null!==Y){const M=we();M.serverResponse=Y.getErrorText(),I(this.errorCallback_?this.errorCallback_(Y,M):M)}else I(h.canceled?this.appDelete_?j():E():v())};this.canceled_?o(0,new Qe(!1,null,!0)):this.backoffId_=function B(n,t,o){let a=1,h=null,C=null,I=!1,Y=0;function M(){return 2===Y}let W=!1;function Q(...Ee){W||(W=!0,t.apply(null,Ee))}function ye(Ee){h=setTimeout(()=>{h=null,n(ge,M())},Ee)}function fe(){C&&clearTimeout(C)}function ge(Ee,...It){if(W)return void fe();if(Ee)return fe(),void Q.call(null,Ee,...It);if(M()||I)return fe(),void Q.call(null,Ee,...It);let De;a<64&&(a*=2),1===Y?(Y=2,De=0):De=1e3*(a+Math.random()),ye(De)}let ve=!1;function et(Ee){ve||(ve=!0,fe(),!W&&(null!==h?(Ee||(Y=2),clearTimeout(h),ye(0)):Ee||(Y=1)))}return ye(0),C=setTimeout(()=>{I=!0,et(!0)},o),et}((a,h)=>{if(h)return void a(!1,new Qe(!1,null,!0));const C=this.connectionFactory_();this.pendingConnection_=C;const I=Y=>{null!==this.progressCallback_&&this.progressCallback_(Y.loaded,Y.lengthComputable?Y.total:-1)};null!==this.progressCallback_&&C.addUploadProgressListener(I),C.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{null!==this.progressCallback_&&C.removeUploadProgressListener(I),this.pendingConnection_=null;const Y=C.getErrorCode()===$e.NO_ERROR,M=C.getStatus();if(!Y||Xe(M,this.additionalRetryCodes_)&&this.retry){const Q=C.getErrorCode()===$e.ABORT;return void a(!1,new Qe(!1,null,Q))}const W=-1!==this.successCodes_.indexOf(M);a(!0,new Qe(W,C))})},o,this.timeout_)}getPromise(){return this.promise_}cancel(t){this.canceled_=!0,this.appDelete_=t||!1,null!==this.backoffId_&&function H(n){n(!1)}(this.backoffId_),null!==this.pendingConnection_&&this.pendingConnection_.abort()}}class Qe{constructor(t,o,a){this.wasSuccessCode=t,this.connection=o,this.canceled=!!a}}function pt(...n){const t=function At(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}();if(void 0!==t){const o=new t;for(let a=0;a<n.length;a++)o.append(n[a]);return o.getBlob()}if(Je())return new Blob(n);throw new z(q.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}const _e={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class rt{constructor(t,o){this.data=t,this.contentType=o||null}}function He(n,t){switch(n){case _e.RAW:return new rt(it(t));case _e.BASE64:case _e.BASE64URL:return new rt(st(n,t));case _e.DATA_URL:return new rt(function Rt(n){const t=new tt(n);return t.base64?st(_e.BASE64,t.rest):function gt(n){let t;try{t=decodeURIComponent(n)}catch{throw oe(_e.DATA_URL,"Malformed data URL.")}return it(t)}(t.rest)}(t),function nt(n){return new tt(n).contentType}(t))}throw we()}function it(n){const t=[];for(let o=0;o<n.length;o++){let a=n.charCodeAt(o);a<=127?t.push(a):a<=2047?t.push(192|a>>6,128|63&a):55296==(64512&a)?o<n.length-1&&56320==(64512&n.charCodeAt(o+1))?(a=65536|(1023&a)<<10|1023&n.charCodeAt(++o),t.push(240|a>>18,128|a>>12&63,128|a>>6&63,128|63&a)):t.push(239,191,189):56320==(64512&a)?t.push(239,191,189):t.push(224|a>>12,128|a>>6&63,128|63&a)}return new Uint8Array(t)}function st(n,t){switch(n){case _e.BASE64:{const h=-1!==t.indexOf("-"),C=-1!==t.indexOf("_");if(h||C)throw oe(n,"Invalid character '"+(h?"-":"_")+"' found: is it base64url encoded?");break}case _e.BASE64URL:{const h=-1!==t.indexOf("+"),C=-1!==t.indexOf("/");if(h||C)throw oe(n,"Invalid character '"+(h?"+":"/")+"' found: is it base64 encoded?");t=t.replace(/-/g,"+").replace(/_/g,"/");break}}let o;try{o=function ft(n){if(typeof atob>"u")throw function x(n){return new z(q.UNSUPPORTED_ENVIRONMENT,`${n} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}("base-64");return atob(n)}(t)}catch(h){throw h.message.includes("polyfill")?h:oe(n,"Invalid character found")}const a=new Uint8Array(o.length);for(let h=0;h<o.length;h++)a[h]=o.charCodeAt(h);return a}class tt{constructor(t){this.base64=!1,this.contentType=null;const o=t.match(/^data:([^,]+)?,/);if(null===o)throw oe(_e.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const a=o[1]||null;null!=a&&(this.base64=function Ot(n,t){return n.length>=t.length&&n.substring(n.length-t.length)===t}(a,";base64"),this.contentType=this.base64?a.substring(0,a.length-7):a),this.rest=t.substring(t.indexOf(",")+1)}}class Re{constructor(t,o){let a=0,h="";Ge(t)?(this.data_=t,a=t.size,h=t.type):t instanceof ArrayBuffer?(o?this.data_=new Uint8Array(t):(this.data_=new Uint8Array(t.byteLength),this.data_.set(new Uint8Array(t))),a=this.data_.length):t instanceof Uint8Array&&(o?this.data_=t:(this.data_=new Uint8Array(t.length),this.data_.set(t)),a=t.length),this.size_=a,this.type_=h}size(){return this.size_}type(){return this.type_}slice(t,o){if(Ge(this.data_)){const h=function Ut(n,t,o){return n.webkitSlice?n.webkitSlice(t,o):n.mozSlice?n.mozSlice(t,o):n.slice?n.slice(t,o):null}(this.data_,t,o);return null===h?null:new Re(h)}{const a=new Uint8Array(this.data_.buffer,t,o-t);return new Re(a,!0)}}static getBlob(...t){if(Je()){const o=t.map(a=>a instanceof Re?a.data_:a);return new Re(pt.apply(null,o))}{const o=t.map(I=>Z(I)?He(_e.RAW,I).data:I.data_);let a=0;o.forEach(I=>{a+=I.byteLength});const h=new Uint8Array(a);let C=0;return o.forEach(I=>{for(let Y=0;Y<I.length;Y++)h[C++]=I[Y]}),new Re(h,!0)}}uploadData(){return this.data_}}function mt(n){let t;try{t=JSON.parse(n)}catch{return null}return function U(n){return"object"==typeof n&&!Array.isArray(n)}(t)?t:null}function Ct(n){const t=n.lastIndexOf("/",n.length-2);return-1===t?n:n.slice(t+1)}function at(n,t){return t}class Ce{constructor(t,o,a,h){this.server=t,this.local=o||t,this.writable=!!a,this.xform=h||at}}let Ze=null;function Ke(){if(Ze)return Ze;const n=[];n.push(new Ce("bucket")),n.push(new Ce("generation")),n.push(new Ce("metageneration")),n.push(new Ce("name","fullPath",!0));const o=new Ce("name");o.xform=function t(C,I){return function Gt(n){return!Z(n)||n.length<2?n:Ct(n)}(I)},n.push(o);const h=new Ce("size");return h.xform=function a(C,I){return void 0!==I?Number(I):I},n.push(h),n.push(new Ce("timeCreated")),n.push(new Ce("updated")),n.push(new Ce("md5Hash",null,!0)),n.push(new Ce("cacheControl",null,!0)),n.push(new Ce("contentDisposition",null,!0)),n.push(new Ce("contentEncoding",null,!0)),n.push(new Ce("contentLanguage",null,!0)),n.push(new Ce("contentType",null,!0)),n.push(new Ce("metadata","customMetadata",!0)),Ze=n,Ze}function ut(n,t,o){const a=mt(t);return null===a?null:function vt(n,t,o){const a={type:"file"},h=o.length;for(let C=0;C<h;C++){const I=o[C];a[I.local]=I.xform(a,t[I.server])}return function yt(n,t){Object.defineProperty(n,"ref",{get:function o(){const C=new X(n.bucket,n.fullPath);return t._makeStorageReference(C)}})}(a,n),a}(n,a,o)}function ct(n,t){const o={},a=t.length;for(let h=0;h<a;h++){const C=t[h];C.writable&&(o[C.server]=n[C.local])}return JSON.stringify(o)}const Mt="prefixes",bt="items";class c{constructor(t,o,a,h){this.url=t,this.method=o,this.handler=a,this.timeout=h,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}function p(n){if(!n)throw we()}function F(n,t){return function o(a,h){const C=ut(n,h,t);return p(null!==C),C}}function u(n){return function t(o,a){let h;return h=401===o.getStatus()?o.getErrorText().includes("Firebase App Check token is invalid")?function ne(){return new z(q.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}():function Ue(){return new z(q.UNAUTHENTICATED,"User is not authenticated, please authenticate using Firebase Authentication and try again.")}():402===o.getStatus()?function le(n){return new z(q.QUOTA_EXCEEDED,"Quota for bucket '"+n+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}(n.bucket):403===o.getStatus()?function Be(n){return new z(q.UNAUTHORIZED,"User does not have permission to access '"+n+"'.")}(n.path):a,h.status=o.getStatus(),h.serverResponse=a.serverResponse,h}}function f(n){const t=u(n);return function o(a,h){let C=t(a,h);return 404===a.getStatus()&&(C=function Le(n){return new z(q.OBJECT_NOT_FOUND,"Object '"+n+"' does not exist.")}(n.path)),C.serverResponse=h.serverResponse,C}}function T(n,t,o){const h=Ae(t.fullServerUrl(),n.host,n._protocol),I=n.maxOperationRetryTime,Y=new c(h,"GET",F(n,o),I);return Y.errorHandler=f(t),Y}function L(n,t,o,a,h){const C={};C.prefix=t.isRoot?"":t.path+"/",o&&o.length>0&&(C.delimiter=o),a&&(C.pageToken=a),h&&(C.maxResults=h);const Y=Ae(t.bucketOnlyServerUrl(),n.host,n._protocol),W=n.maxOperationRetryTime,Q=new c(Y,"GET",function G(n,t){return function o(a,h){const C=function Et(n,t,o){const a=mt(o);return null===a?null:function $t(n,t,o){const a={prefixes:[],items:[],nextPageToken:o.nextPageToken};if(o[Mt])for(const h of o[Mt]){const C=h.replace(/\/$/,""),I=n._makeStorageReference(new X(t,C));a.prefixes.push(I)}if(o[bt])for(const h of o[bt]){const C=n._makeStorageReference(new X(t,h.name));a.items.push(C)}return a}(n,t,a)}(n,t,h);return p(null!==C),C}}(n,t.bucket),W);return Q.urlParams=C,Q.errorHandler=u(t),Q}function s(n,t,o){const a=Object.assign({},o);return a.fullPath=n.path,a.size=t.size(),a.contentType||(a.contentType=function i(n,t){return n&&n.contentType||t&&t.type()||"application/octet-stream"}(null,t)),a}class y{constructor(t,o,a,h){this.current=t,this.total=o,this.finalized=!!a,this.metadata=h||null}}function k(n,t){let o=null;try{o=n.getResponseHeader("X-Goog-Upload-Status")}catch{p(!1)}return p(!!o&&-1!==(t||["active"]).indexOf(o)),o}const Nt={STATE_CHANGED:"state_changed"},ke={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function Se(n){switch(n){case"running":case"pausing":case"canceling":return ke.RUNNING;case"paused":return ke.PAUSED;case"success":return ke.SUCCESS;case"canceled":return ke.CANCELED;default:return ke.ERROR}}class St{constructor(t,o,a){if(function N(n){return"function"==typeof n}(t)||null!=o||null!=a)this.next=t,this.error=o??void 0,this.complete=a??void 0;else{const C=t;this.next=C.next,this.error=C.error,this.complete=C.complete}}}function Ft(n){return(...t)=>{Promise.resolve().then(()=>n(...t))}}let Qt=null;class Cn{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=$e.NO_ERROR,this.sendPromise_=new Promise(t=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=$e.ABORT,t()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=$e.NETWORK_ERROR,t()}),this.xhr_.addEventListener("load",()=>{t()})})}send(t,o,a,h){if(this.sent_)throw me("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(o,t,!0),void 0!==h)for(const C in h)h.hasOwnProperty(C)&&this.xhr_.setRequestHeader(C,h[C].toString());return void 0!==a?this.xhr_.send(a):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw me("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw me("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw me("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw me("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(t){return this.xhr_.getResponseHeader(t)}addUploadProgressListener(t){null!=this.xhr_.upload&&this.xhr_.upload.addEventListener("progress",t)}removeUploadProgressListener(t){null!=this.xhr_.upload&&this.xhr_.upload.removeEventListener("progress",t)}}class yn extends Cn{initXhr(){this.xhr_.responseType="text"}}function ot(){return Qt?Qt():new yn}class Zt{constructor(t,o,a=null){this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=t,this._blob=o,this._metadata=a,this._mappings=Ke(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=h=>{if(this._request=void 0,this._chunkMultiplier=1,h._codeEquals(q.CANCELED))this._needToFetchStatus=!0,this.completeTransitions_();else{const C=this.isExponentialBackoffExpired();if(Xe(h.status,[])){if(!C)return this.sleepTime=Math.max(2*this.sleepTime,1e3),this._needToFetchStatus=!0,void this.completeTransitions_();h=v()}this._error=h,this._transition("error")}},this._metadataErrorHandler=h=>{this._request=void 0,h._codeEquals(q.CANCELED)?this.completeTransitions_():(this._error=h,this._transition("error"))},this.sleepTime=0,this.maxSleepTime=this._ref.storage.maxUploadRetryTime,this._promise=new Promise((h,C)=>{this._resolve=h,this._reject=C,this._start()}),this._promise.then(null,()=>{})}isExponentialBackoffExpired(){return this.sleepTime>this.maxSleepTime}_makeProgressCallback(){const t=this._transferred;return o=>this._updateProgress(t+o)}_shouldDoResumable(t){return t.size()>262144}_start(){"running"===this._state&&void 0===this._request&&(this._resumable?void 0===this._uploadUrl?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this.pendingTimeout=setTimeout(()=>{this.pendingTimeout=void 0,this._continueUpload()},this.sleepTime):this._oneShotUpload())}_resolveToken(t){Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then(([o,a])=>{switch(this._state){case"running":t(o,a);break;case"canceling":this._transition("canceled");break;case"pausing":this._transition("paused")}})}_createResumable(){this._resolveToken((t,o)=>{const a=function de(n,t,o,a,h){const C=t.bucketOnlyServerUrl(),I=s(t,a,h),Y={name:I.fullPath},M=Ae(C,n.host,n._protocol),Q={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${a.size()}`,"X-Goog-Upload-Header-Content-Type":I.contentType,"Content-Type":"application/json; charset=utf-8"},ye=ct(I,o),ve=new c(M,"POST",function ge(et){let Ee;k(et);try{Ee=et.getResponseHeader("X-Goog-Upload-URL")}catch{p(!1)}return p(Z(Ee)),Ee},n.maxUploadRetryTime);return ve.urlParams=Y,ve.headers=Q,ve.body=ye,ve.errorHandler=u(t),ve}(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),h=this._ref.storage._makeRequest(a,ot,t,o);this._request=h,h.getPromise().then(C=>{this._request=void 0,this._uploadUrl=C,this._needToFetchStatus=!1,this.completeTransitions_()},this._errorHandler)})}_fetchStatus(){const t=this._uploadUrl;this._resolveToken((o,a)=>{const h=function ze(n,t,o,a){const M=new c(o,"POST",function C(W){const Q=k(W,["active","final"]);let ye=null;try{ye=W.getResponseHeader("X-Goog-Upload-Size-Received")}catch{p(!1)}ye||p(!1);const fe=Number(ye);return p(!isNaN(fe)),new y(fe,a.size(),"final"===Q)},n.maxUploadRetryTime);return M.headers={"X-Goog-Upload-Command":"query"},M.errorHandler=u(t),M}(this._ref.storage,this._ref._location,t,this._blob),C=this._ref.storage._makeRequest(h,ot,o,a);this._request=C,C.getPromise().then(I=>{this._request=void 0,this._updateProgress(I.current),this._needToFetchStatus=!1,I.finalized&&(this._needToFetchMetadata=!0),this.completeTransitions_()},this._errorHandler)})}_continueUpload(){const t=262144*this._chunkMultiplier,o=new y(this._transferred,this._blob.size()),a=this._uploadUrl;this._resolveToken((h,C)=>{let I;try{I=function Ve(n,t,o,a,h,C,I,Y){const M=new y(0,0);if(I?(M.current=I.current,M.total=I.total):(M.current=0,M.total=a.size()),a.size()!==M.total)throw function P(){return new z(q.SERVER_FILE_WRONG_SIZE,"Server recorded incorrect upload file size, please retry the upload.")}();const W=M.total-M.current;let Q=W;h>0&&(Q=Math.min(Q,h));const ye=M.current;let ge="";ge=0===Q?"finalize":W===Q?"upload, finalize":"upload";const ve={"X-Goog-Upload-Command":ge,"X-Goog-Upload-Offset":`${M.current}`},et=a.slice(ye,ye+Q);if(null===et)throw _();const De=new c(o,"POST",function Ee(Fe,jt){const Kt=k(Fe,["active","final"]),Jt=M.current+Q,Wt=a.size();let Xt;return Xt="final"===Kt?F(t,C)(Fe,jt):null,new y(Jt,Wt,"final"===Kt,Xt)},t.maxUploadRetryTime);return De.headers=ve,De.body=et.uploadData(),De.progressCallback=Y||null,De.errorHandler=u(n),De}(this._ref._location,this._ref.storage,a,this._blob,t,this._mappings,o,this._makeProgressCallback())}catch(M){return this._error=M,void this._transition("error")}const Y=this._ref.storage._makeRequest(I,ot,h,C,!1);this._request=Y,Y.getPromise().then(M=>{this._increaseMultiplier(),this._request=void 0,this._updateProgress(M.current),M.finalized?(this._metadata=M.metadata,this._transition("success")):this.completeTransitions_()},this._errorHandler)})}_increaseMultiplier(){262144*this._chunkMultiplier*2<33554432&&(this._chunkMultiplier*=2)}_fetchMetadata(){this._resolveToken((t,o)=>{const a=T(this._ref.storage,this._ref._location,this._mappings),h=this._ref.storage._makeRequest(a,ot,t,o);this._request=h,h.getPromise().then(C=>{this._request=void 0,this._metadata=C,this._transition("success")},this._metadataErrorHandler)})}_oneShotUpload(){this._resolveToken((t,o)=>{const a=function d(n,t,o,a,h){const C=t.bucketOnlyServerUrl(),I={"X-Goog-Upload-Protocol":"multipart"},M=function Y(){let De="";for(let Fe=0;Fe<2;Fe++)De+=Math.random().toString().slice(2);return De}();I["Content-Type"]="multipart/related; boundary="+M;const W=s(t,a,h),Q=ct(W,o),ge=Re.getBlob("--"+M+"\r\nContent-Type: application/json; charset=utf-8\r\n\r\n"+Q+"\r\n--"+M+"\r\nContent-Type: "+W.contentType+"\r\n\r\n",a,"\r\n--"+M+"--");if(null===ge)throw _();const ve={name:W.fullPath},et=Ae(C,n.host,n._protocol),It=n.maxUploadRetryTime,kt=new c(et,"POST",F(n,o),It);return kt.urlParams=ve,kt.headers=I,kt.body=ge.uploadData(),kt.errorHandler=u(t),kt}(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),h=this._ref.storage._makeRequest(a,ot,t,o);this._request=h,h.getPromise().then(C=>{this._request=void 0,this._metadata=C,this._updateProgress(this._blob.size()),this._transition("success")},this._errorHandler)})}_updateProgress(t){const o=this._transferred;this._transferred=t,this._transferred!==o&&this._notifyObservers()}_transition(t){if(this._state!==t)switch(t){case"canceling":case"pausing":this._state=t,void 0!==this._request?this._request.cancel():this.pendingTimeout&&(clearTimeout(this.pendingTimeout),this.pendingTimeout=void 0,this.completeTransitions_());break;case"running":const o="paused"===this._state;this._state=t,o&&(this._notifyObservers(),this._start());break;case"paused":case"error":case"success":this._state=t,this._notifyObservers();break;case"canceled":this._error=E(),this._state=t,this._notifyObservers()}}completeTransitions_(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start()}}get snapshot(){const t=Se(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:t,metadata:this._metadata,task:this,ref:this._ref}}on(t,o,a,h){const C=new St(o||void 0,a||void 0,h||void 0);return this._addObserver(C),()=>{this._removeObserver(C)}}then(t,o){return this._promise.then(t,o)}catch(t){return this.then(null,t)}_addObserver(t){this._observers.push(t),this._notifyObserver(t)}_removeObserver(t){const o=this._observers.indexOf(t);-1!==o&&this._observers.splice(o,1)}_notifyObservers(){this._finishPromise(),this._observers.slice().forEach(o=>{this._notifyObserver(o)})}_finishPromise(){if(void 0!==this._resolve){let t=!0;switch(Se(this._state)){case ke.SUCCESS:Ft(this._resolve.bind(null,this.snapshot))();break;case ke.CANCELED:case ke.ERROR:Ft(this._reject.bind(null,this._error))();break;default:t=!1}t&&(this._resolve=void 0,this._reject=void 0)}}_notifyObserver(t){switch(Se(this._state)){case ke.RUNNING:case ke.PAUSED:t.next&&Ft(t.next.bind(t,this.snapshot))();break;case ke.SUCCESS:t.complete&&Ft(t.complete.bind(t))();break;default:t.error&&Ft(t.error.bind(t,this._error))()}}resume(){const t="paused"===this._state||"pausing"===this._state;return t&&this._transition("running"),t}pause(){const t="running"===this._state;return t&&this._transition("pausing"),t}cancel(){const t="running"===this._state||"pausing"===this._state;return t&&this._transition("canceling"),t}}class Lt{constructor(t,o){this._service=t,this._location=o instanceof X?o:X.makeFromUrl(o,t.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(t,o){return new Lt(t,o)}get root(){const t=new X(this._location.bucket,"");return this._newRef(this._service,t)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return Ct(this._location.path)}get storage(){return this._service}get parent(){const t=function Bt(n){if(0===n.length)return null;const t=n.lastIndexOf("/");return-1===t?"":n.slice(0,t)}(this._location.path);if(null===t)return null;const o=new X(this._location.bucket,t);return new Lt(this._service,o)}_throwIfRoot(t){if(""===this._location.path)throw re(t)}}function tn(n,t,o){return Ht.apply(this,arguments)}function Ht(){return(Ht=(0,Te.c)(function*(n,t,o){const h=yield nn(n,{pageToken:o});t.prefixes.push(...h.prefixes),t.items.push(...h.items),null!=h.nextPageToken&&(yield tn(n,t,h.nextPageToken))})).apply(this,arguments)}function nn(n,t){null!=t&&"number"==typeof t.maxResults&&Me("options.maxResults",1,1e3,t.maxResults);const o=t||{},a=L(n.storage,n._location,"/",o.pageToken,o.maxResults);return n.storage.makeRequestWithTokens(a,ot)}function Fn(n){n._throwIfRoot("getDownloadURL");const t=function ee(n,t,o){const h=Ae(t.fullServerUrl(),n.host,n._protocol),I=n.maxOperationRetryTime,Y=new c(h,"GET",function K(n,t){return function o(a,h){const C=ut(n,h,t);return p(null!==C),function Yt(n,t,o,a){const h=mt(t);if(null===h||!Z(h.downloadTokens))return null;const C=h.downloadTokens;if(0===C.length)return null;const I=encodeURIComponent;return C.split(",").map(W=>{const ye=n.fullPath;return Ae("/b/"+I(n.bucket)+"/o/"+I(ye),o,a)+je({alt:"media",token:W})})[0]}(C,h,n.host,n._protocol)}}(n,o),I);return Y.errorHandler=f(t),Y}(n.storage,n._location,Ke());return n.storage.makeRequestWithTokens(t,ot).then(o=>{if(null===o)throw function A(){return new z(q.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}();return o})}function on(n,t){const o=function _t(n,t){const o=t.split("/").filter(a=>a.length>0).join("/");return 0===n.length?o:n+"/"+o}(n._location.path,t),a=new X(n._location.bucket,o);return new Lt(n.storage,a)}function rn(n,t){if(n instanceof zt){const o=n;if(null==o._bucket)throw function O(){return new z(q.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+J+"' property when initializing the app?")}();const a=new Lt(o,o._bucket);return null!=t?rn(a,t):a}return void 0!==t?on(n,t):n}function Un(n,t){if(t&&function Pn(n){return/^[A-Za-z]+:\/\//.test(n)}(t)){if(n instanceof zt)return function xn(n,t){return new Lt(n,t)}(n,t);throw m("To use ref(service, url), the first argument must be a Storage instance.")}return rn(n,t)}function sn(n,t){const o=t?.[J];return null==o?null:X.makeFromBucketSpec(o,n)}class zt{constructor(t,o,a,h,C){this.app=t,this._authProvider=o,this._appCheckProvider=a,this._url=h,this._firebaseVersion=C,this._bucket=null,this._host=Ne,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=12e4,this._maxUploadRetryTime=6e5,this._requests=new Set,this._bucket=null!=h?X.makeFromBucketSpec(h,this._host):sn(this._host,this.app.options)}get host(){return this._host}set host(t){this._host=t,this._bucket=null!=this._url?X.makeFromBucketSpec(this._url,t):sn(t,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(t){Me("time",0,Number.POSITIVE_INFINITY,t),this._maxUploadRetryTime=t}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(t){Me("time",0,Number.POSITIVE_INFINITY,t),this._maxOperationRetryTime=t}_getAuthToken(){var t=this;return(0,Te.c)(function*(){if(t._overrideAuthToken)return t._overrideAuthToken;const o=t._authProvider.getImmediate({optional:!0});if(o){const a=yield o.getToken();if(null!==a)return a.accessToken}return null})()}_getAppCheckToken(){var t=this;return(0,Te.c)(function*(){const o=t._appCheckProvider.getImmediate({optional:!0});return o?(yield o.getToken()).token:null})()}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(t=>t.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(t){return new Lt(this,t)}_makeRequest(t,o,a,h,C=!0){if(this._deleted)return new Ye(j());{const I=function ht(n,t,o,a,h,C,I=!0){const Y=je(n.urlParams),M=n.url+Y,W=Object.assign({},n.headers);return function dt(n,t){t&&(n["X-Firebase-GMPID"]=t)}(W,t),function Pt(n,t){null!==t&&t.length>0&&(n.Authorization="Firebase "+t)}(W,o),function wt(n,t){n["X-Firebase-Storage-Version"]="webjs/"+(t??"AppManager")}(W,C),function xt(n,t){null!==t&&(n["X-Firebase-AppCheck"]=t)}(W,a),new lt(M,n.method,W,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,h,I)}(t,this._appId,a,h,o,this._firebaseVersion,C);return this._requests.add(I),I.getPromise().then(()=>this._requests.delete(I),()=>this._requests.delete(I)),I}}makeRequestWithTokens(t,o){var a=this;return(0,Te.c)(function*(){const[h,C]=yield Promise.all([a._getAuthToken(),a._getAppCheckToken()]);return a._makeRequest(t,o,h,C).getPromise()})()}}const an="@firebase/storage";function ln(n,t){return Un(n=(0,pe.Yj)(n),t)}function Wn(n,{instanceIdentifier:t}){const o=n.getProvider("app").getImmediate(),a=n.getProvider("auth-internal"),h=n.getProvider("app-check-internal");return new zt(o,a,h,t,be.SDK_VERSION)}!function Vn(){(0,be._registerComponent)(new Pe.Yl("storage",Wn,"PUBLIC").setMultipleInstances(!0)),(0,be.registerVersion)(an,"0.12.1",""),(0,be.registerVersion)(an,"0.12.1","esm2017")}();class Vt{constructor(t,o,a){this._delegate=t,this.task=o,this.ref=a}get bytesTransferred(){return this._delegate.bytesTransferred}get metadata(){return this._delegate.metadata}get state(){return this._delegate.state}get totalBytes(){return this._delegate.totalBytes}}class hn{constructor(t,o){this._delegate=t,this._ref=o,this.cancel=this._delegate.cancel.bind(this._delegate),this.catch=this._delegate.catch.bind(this._delegate),this.pause=this._delegate.pause.bind(this._delegate),this.resume=this._delegate.resume.bind(this._delegate)}get snapshot(){return new Vt(this._delegate.snapshot,this,this._ref)}then(t,o){return this._delegate.then(a=>{if(t)return t(new Vt(a,this,this._ref))},o)}on(t,o,a,h){let C;return o&&(C="function"==typeof o?I=>o(new Vt(I,this,this._ref)):{next:o.next?I=>o.next(new Vt(I,this,this._ref)):void 0,complete:o.complete||void 0,error:o.error||void 0}),this._delegate.on(t,C,a||void 0,h||void 0)}}class pn{constructor(t,o){this._delegate=t,this._service=o}get prefixes(){return this._delegate.prefixes.map(t=>new Tt(t,this._service))}get items(){return this._delegate.items.map(t=>new Tt(t,this._service))}get nextPageToken(){return this._delegate.nextPageToken||null}}class Tt{constructor(t,o){this._delegate=t,this.storage=o}get name(){return this._delegate.name}get bucket(){return this._delegate.bucket}get fullPath(){return this._delegate.fullPath}toString(){return this._delegate.toString()}child(t){const o=function Kn(n,t){return on(n,t)}(this._delegate,t);return new Tt(o,this.storage)}get root(){return new Tt(this._delegate.root,this.storage)}get parent(){const t=this._delegate.parent;return null==t?null:new Tt(t,this.storage)}put(t,o){return this._throwIfRoot("put"),new hn(function Gn(n,t,o){return function wn(n,t,o){return n._throwIfRoot("uploadBytesResumable"),new Zt(n,new Re(t),o)}(n=(0,pe.Yj)(n),t,o)}(this._delegate,t,o),this)}putString(t,o=_e.RAW,a){this._throwIfRoot("putString");const h=He(o,t),C=Object.assign({},a);return null==C.contentType&&null!=h.contentType&&(C.contentType=h.contentType),new hn(new Zt(this._delegate,new Re(h.data,!0),C),this)}listAll(){return function Ln(n){return function Rn(n){const t={prefixes:[],items:[]};return tn(n,t).then(()=>t)}(n=(0,pe.Yj)(n))}(this._delegate).then(t=>new pn(t,this.storage))}list(t){return function Nn(n,t){return nn(n=(0,pe.Yj)(n),t)}(this._delegate,t||void 0).then(o=>new pn(o,this.storage))}getMetadata(){return function Mn(n){return function On(n){n._throwIfRoot("getMetadata");const t=T(n.storage,n._location,Ke());return n.storage.makeRequestWithTokens(t,ot)}(n=(0,pe.Yj)(n))}(this._delegate)}updateMetadata(t){return function $n(n,t){return function Sn(n,t){n._throwIfRoot("updateMetadata");const o=function l(n,t,o,a){const C=Ae(t.fullServerUrl(),n.host,n._protocol),Y=ct(o,a),W=n.maxOperationRetryTime,Q=new c(C,"PATCH",F(n,a),W);return Q.headers={"Content-Type":"application/json; charset=utf-8"},Q.body=Y,Q.errorHandler=f(t),Q}(n.storage,n._location,t,Ke());return n.storage.makeRequestWithTokens(o,ot)}(n=(0,pe.Yj)(n),t)}(this._delegate,t)}getDownloadURL(){return function Yn(n){return Fn(n=(0,pe.Yj)(n))}(this._delegate)}delete(){return this._throwIfRoot("delete"),function jn(n){return function Dn(n){n._throwIfRoot("deleteObject");const t=function S(n,t){const a=Ae(t.fullServerUrl(),n.host,n._protocol),Y=new c(a,"DELETE",function I(M,W){},n.maxOperationRetryTime);return Y.successCodes=[200,204],Y.errorHandler=f(t),Y}(n.storage,n._location);return n.storage.makeRequestWithTokens(t,ot)}(n=(0,pe.Yj)(n))}(this._delegate)}_throwIfRoot(t){if(""===this._delegate._location.path)throw re(t)}}class fn{constructor(t,o){this.app=t,this._delegate=o}get maxOperationRetryTime(){return this._delegate.maxOperationRetryTime}get maxUploadRetryTime(){return this._delegate.maxUploadRetryTime}ref(t){if(gn(t))throw m("ref() expected a child path but got a URL, use refFromURL instead.");return new Tt(ln(this._delegate,t),this)}refFromURL(t){if(!gn(t))throw m("refFromURL() expected a full URL but got a child path, use ref() instead.");try{X.makeFromUrl(t,this._delegate.host)}catch{throw m("refFromUrl() expected a valid full URL but got an invalid one.")}return new Tt(ln(this._delegate,t),this)}setMaxUploadRetryTime(t){this._delegate.maxUploadRetryTime=t}setMaxOperationRetryTime(t){this._delegate.maxOperationRetryTime=t}useEmulator(t,o,a={}){!function dn(n,t,o,a={}){!function Bn(n,t,o,a={}){n.host=`${t}:${o}`,n._protocol="http";const{mockUserToken:h}=a;h&&(n._overrideAuthToken="string"==typeof h?h:(0,pe.YD)(h,n.app.options.projectId))}(n,t,o,a)}(this._delegate,t,o,a)}}function gn(n){return/^[A-Za-z]+:\/\//.test(n)}function Jn(n,{instanceIdentifier:t}){const o=n.getProvider("app-compat").getImmediate(),a=n.getProvider("storage").getImmediate({identifier:t});return new fn(o,a)}!function Xn(n){const t={TaskState:ke,TaskEvent:Nt,StringFormat:_e,Storage:fn,Reference:Tt};n.INTERNAL.registerComponent(new Pe.Yl("storage-compat",Jn,"PUBLIC").setServiceProps(t).setMultipleInstances(!0)),n.registerVersion("@firebase/storage-compat","0.3.4")}(qe.c);var Qn=g(9252);function mn(n){const t=function Zn(n){return new r._(t=>{const o=I=>t.next(I);o(n.snapshot);const C=n.on("state_changed",o);return n.then(I=>{o(I),t.complete()},I=>{o(n.snapshot),(I=>{t.error(I)})(I)}),function(){C()}}).pipe((0,te.o)(0))}(n);return{task:n,then:n.then.bind(n),catch:n.catch.bind(n),pause:n.pause.bind(n),cancel:n.cancel.bind(n),resume:n.resume.bind(n),snapshotChanges:()=>t,percentageChanges:()=>t.pipe((0,he.k)(o=>o.bytesTransferred/o.totalBytes*100))}}function qt(n){return{getDownloadURL:()=>(0,V.of)(void 0).pipe(D.QT,(0,ce.G)(()=>n.getDownloadURL()),D.wH),getMetadata:()=>(0,V.of)(void 0).pipe(D.QT,(0,ce.G)(()=>n.getMetadata()),D.wH),delete:()=>(0,ue.Q)(n.delete()),child:t=>qt(n.child(t)),updateMetadata:t=>(0,ue.Q)(n.updateMetadata(t)),put:(t,o)=>mn(n.put(t,o)),putString:(t,o,a)=>mn(n.putString(t,o,a)),list:t=>(0,ue.Q)(n.list(t)),listAll:()=>(0,ue.Q)(n.listAll())}}const eo=new $.UbH("angularfire2.storageBucket"),to=new $.UbH("angularfire2.storage.maxUploadRetryTime"),no=new $.UbH("angularfire2.storage.maxOperationRetryTime"),oo=new $.UbH("angularfire2.storage.use-emulator");let _n=(()=>{class n{storage;constructor(o,a,h,C,I,Y,M,W,Q,ye){const fe=(0,e._G)(o,I,a);this.storage=(0,e.PQ)(`${fe.name}.storage.${h}`,"AngularFireStorage",fe.name,()=>{const ge=I.runOutsideAngular(()=>fe.storage(h||void 0)),ve=Q;return ve&&ge.useEmulator(...ve),M&&ge.setMaxUploadRetryTime(M),W&&ge.setMaxOperationRetryTime(W),ge},[M,W])}ref(o){return qt(this.storage.ref(o))}refFromURL(o){return qt(this.storage.refFromURL(o))}upload(o,a,h){return qt(this.storage.ref(o)).put(a,h)}static \u0275fac=function(a){return new(a||n)($.CoB(e.E9),$.CoB(e.Ml,8),$.CoB(eo,8),$.CoB($.AHE),$.CoB($.WW2),$.CoB(D.u),$.CoB(to,8),$.CoB(no,8),$.CoB(oo,8),$.CoB(D.gJ,8))};static \u0275prov=$.wxM({token:n,factory:n.\u0275fac,providedIn:"any"})}return n})(),ro=(()=>{class n{static \u0275fac=function(a){return new(a||n)};static \u0275mod=$.a4G({type:n});static \u0275inj=$.s3X({})}return n})(),io=(()=>{class n{constructor(){Qn.c.registerVersion("angularfire",D.j1.full,"gcs-compat")}static \u0275fac=function(a){return new(a||n)};static \u0275mod=$.a4G({type:n});static \u0275inj=$.s3X({providers:[_n],imports:[ro]})}return n})()},2936:(Dt,Oe,g)=>{var D=g(1528),r=g(8360),V=g(3144),ue=g(3584),te=g(5712);const he="@firebase/installations",ce="0.6.5",$=1e4,e=`w:${ce}`,qe="FIS_v2",Te="https://firebaseinstallations.googleapis.com/v1",be=36e5,J=new ue.UR("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function se(u){return u instanceof ue.kx&&u.code.includes("request-failed")}function ae({projectId:u}){return`${Te}/projects/${u}/installations`}function Ie(u){return{token:u.token,requestStatus:2,expiresIn:Ue(u.expiresIn),creationTime:Date.now()}}function z(u,f){return q.apply(this,arguments)}function q(){return(q=(0,D.c)(function*(u,f){const L=(yield f.json()).error;return J.create("request-failed",{requestName:u,serverCode:L.code,serverMessage:L.message,serverStatus:L.status})})).apply(this,arguments)}function xe({apiKey:u}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":u})}function Le(u){return le.apply(this,arguments)}function le(){return(le=(0,D.c)(function*(u){const f=yield u();return f.status>=500&&f.status<600?u():f})).apply(this,arguments)}function Ue(u){return Number(u.replace("s","000"))}function v(){return(v=(0,D.c)(function*({appConfig:u,heartbeatServiceProvider:f},{fid:T}){const L=ae(u),ie=xe(u),ee=f.getImmediate({optional:!0});if(ee){const s=yield ee.getHeartbeatsHeader();s&&ie.append("x-firebase-client",s)}const S={method:"POST",headers:ie,body:JSON.stringify({fid:T,authVersion:qe,appId:u.appId,sdkVersion:e})},i=yield Le(()=>fetch(L,S));if(i.ok){const s=yield i.json();return{fid:s.fid||T,registrationStatus:2,refreshToken:s.refreshToken,authToken:Ie(s.authToken)}}throw yield z("Create Installation",i)})).apply(this,arguments)}function E(u){return new Promise(f=>{setTimeout(f,u)})}const w=/^[cdef][\w-]{21}$/,O="";function _(){try{const u=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(u),u[0]=112+u[0]%16;const T=function P(u){return function b(u){return btoa(String.fromCharCode(...u)).replace(/\+/g,"-").replace(/\//g,"_")}(u).substr(0,22)}(u);return w.test(T)?T:O}catch{return O}}function A(u){return`${u.appName}!${u.appId}`}const x=new Map;function m(u,f){const T=A(u);oe(T,f),function me(u,f){const T=function Ye(){return!X&&"BroadcastChannel"in self&&(X=new BroadcastChannel("[Firebase] FID Change"),X.onmessage=u=>{oe(u.data.key,u.data.fid)}),X}();T&&T.postMessage({key:u,fid:f}),function B(){0===x.size&&X&&(X.close(),X=null)}()}(T,f)}function oe(u,f){const T=x.get(u);if(T)for(const L of T)L(f)}let X=null;const H="firebase-installations-database",R=1,N="firebase-installations-store";let U=null;function Z(){return U||(U=(0,te.CA)(H,R,{upgrade:(u,f)=>{0===f&&u.createObjectStore(N)}})),U}function Ge(u,f){return Je.apply(this,arguments)}function Je(){return(Je=(0,D.c)(function*(u,f){const T=A(u),ie=(yield Z()).transaction(N,"readwrite"),ee=ie.objectStore(N),l=yield ee.get(T);return yield ee.put(f,T),yield ie.done,(!l||l.fid!==f.fid)&&m(u,f.fid),f})).apply(this,arguments)}function Me(u){return Ae.apply(this,arguments)}function Ae(){return(Ae=(0,D.c)(function*(u){const f=A(u),L=(yield Z()).transaction(N,"readwrite");yield L.objectStore(N).delete(f),yield L.done})).apply(this,arguments)}function je(u,f){return $e.apply(this,arguments)}function $e(){return($e=(0,D.c)(function*(u,f){const T=A(u),ie=(yield Z()).transaction(N,"readwrite"),ee=ie.objectStore(N),l=yield ee.get(T),S=f(l);return void 0===S?yield ee.delete(T):yield ee.put(S,T),yield ie.done,S&&(!l||l.fid!==S.fid)&&m(u,S.fid),S})).apply(this,arguments)}function Xe(u){return lt.apply(this,arguments)}function lt(){return lt=(0,D.c)(function*(u){let f;const T=yield je(u.appConfig,L=>{const ie=function Qe(u){return pt(u||{fid:_(),registrationStatus:0})}(L),ee=function Pt(u,f){if(0===f.registrationStatus){if(!navigator.onLine)return{installationEntry:f,registrationPromise:Promise.reject(J.create("app-offline"))};const T={fid:f.fid,registrationStatus:1,registrationTime:Date.now()},L=function wt(u,f){return dt.apply(this,arguments)}(u,T);return{installationEntry:T,registrationPromise:L}}return 1===f.registrationStatus?{installationEntry:f,registrationPromise:xt(u)}:{installationEntry:f}}(u,ie);return f=ee.registrationPromise,ee.installationEntry});return T.fid===O?{installationEntry:yield f}:{installationEntry:T,registrationPromise:f}}),lt.apply(this,arguments)}function dt(){return dt=(0,D.c)(function*(u,f){try{const T=yield function Be(u,f){return v.apply(this,arguments)}(u,f);return Ge(u.appConfig,T)}catch(T){throw se(T)&&409===T.customData.serverCode?yield Me(u.appConfig):yield Ge(u.appConfig,{fid:f.fid,registrationStatus:0}),T}}),dt.apply(this,arguments)}function xt(u){return ht.apply(this,arguments)}function ht(){return(ht=(0,D.c)(function*(u){let f=yield At(u.appConfig);for(;1===f.registrationStatus;)yield E(100),f=yield At(u.appConfig);if(0===f.registrationStatus){const{installationEntry:T,registrationPromise:L}=yield Xe(u);return L||T}return f})).apply(this,arguments)}function At(u){return je(u,f=>{if(!f)throw J.create("installation-not-found");return pt(f)})}function pt(u){return function Ut(u){return 1===u.registrationStatus&&u.registrationTime+$<Date.now()}(u)?{fid:u.fid,registrationStatus:0}:u}function _e(){return(_e=(0,D.c)(function*({appConfig:u,heartbeatServiceProvider:f},T){const L=function rt(u,{fid:f}){return`${ae(u)}/${f}/authTokens:generate`}(u,T),ie=function we(u,{refreshToken:f}){const T=xe(u);return T.append("Authorization",function ne(u){return`${qe} ${u}`}(f)),T}(u,T),ee=f.getImmediate({optional:!0});if(ee){const s=yield ee.getHeartbeatsHeader();s&&ie.append("x-firebase-client",s)}const S={method:"POST",headers:ie,body:JSON.stringify({installation:{sdkVersion:e,appId:u.appId}})},i=yield Le(()=>fetch(L,S));if(i.ok)return Ie(yield i.json());throw yield z("Generate Auth Token",i)})).apply(this,arguments)}function He(u){return it.apply(this,arguments)}function it(){return it=(0,D.c)(function*(u,f=!1){let T;const L=yield je(u.appConfig,ee=>{if(!Ot(ee))throw J.create("not-registered");const l=ee.authToken;if(!f&&function Re(u){return 2===u.requestStatus&&!function mt(u){const f=Date.now();return f<u.creationTime||u.creationTime+u.expiresIn<f+be}(u)}(l))return ee;if(1===l.requestStatus)return T=function gt(u,f){return st.apply(this,arguments)}(u,f),ee;{if(!navigator.onLine)throw J.create("app-offline");const S=function Bt(u){const f={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},u),{authToken:f})}(ee);return T=function Rt(u,f){return nt.apply(this,arguments)}(u,S),S}});return T?yield T:L.authToken}),it.apply(this,arguments)}function st(){return(st=(0,D.c)(function*(u,f){let T=yield tt(u.appConfig);for(;1===T.authToken.requestStatus;)yield E(100),T=yield tt(u.appConfig);const L=T.authToken;return 0===L.requestStatus?He(u,f):L})).apply(this,arguments)}function tt(u){return je(u,f=>{if(!Ot(f))throw J.create("not-registered");return function _t(u){return 1===u.requestStatus&&u.requestTime+$<Date.now()}(f.authToken)?Object.assign(Object.assign({},f),{authToken:{requestStatus:0}}):f})}function nt(){return nt=(0,D.c)(function*(u,f){try{const T=yield function ft(u,f){return _e.apply(this,arguments)}(u,f),L=Object.assign(Object.assign({},f),{authToken:T});return yield Ge(u.appConfig,L),T}catch(T){if(!se(T)||401!==T.customData.serverCode&&404!==T.customData.serverCode){const L=Object.assign(Object.assign({},f),{authToken:{requestStatus:0}});yield Ge(u.appConfig,L)}else yield Me(u.appConfig);throw T}}),nt.apply(this,arguments)}function Ot(u){return void 0!==u&&2===u.registrationStatus}function at(){return(at=(0,D.c)(function*(u){const f=u,{installationEntry:T,registrationPromise:L}=yield Xe(f);return L?L.catch(console.error):He(f).catch(console.error),T.fid})).apply(this,arguments)}function Ze(){return Ze=(0,D.c)(function*(u,f=!1){const T=u;return yield function Gt(u){return Ke.apply(this,arguments)}(T),(yield He(T,f)).token}),Ze.apply(this,arguments)}function Ke(){return(Ke=(0,D.c)(function*(u){const{registrationPromise:f}=yield Xe(u);f&&(yield f)})).apply(this,arguments)}function Et(u){return J.create("missing-app-config-values",{valueName:u})}const c="installations",F=u=>{const f=u.getProvider("app").getImmediate(),T=function $t(u){if(!u||!u.options)throw Et("App Configuration");if(!u.name)throw Et("App Name");const f=["projectId","apiKey","appId"];for(const T of f)if(!u.options[T])throw Et(T);return{appName:u.name,projectId:u.options.projectId,apiKey:u.options.apiKey,appId:u.options.appId}}(f);return{app:f,appConfig:T,heartbeatServiceProvider:(0,r._getProvider)(f,"heartbeat"),_delete:()=>Promise.resolve()}},G=u=>{const f=u.getProvider("app").getImmediate(),T=(0,r._getProvider)(f,c).getImmediate();return{getId:()=>function Ct(u){return at.apply(this,arguments)}(T),getToken:ie=>function Ce(u){return Ze.apply(this,arguments)}(T,ie)}};(function K(){(0,r._registerComponent)(new V.Yl(c,F,"PUBLIC")),(0,r._registerComponent)(new V.Yl("installations-internal",G,"PRIVATE"))})(),(0,r.registerVersion)(he,ce),(0,r.registerVersion)(he,ce,"esm2017")},7240:(Dt,Oe,g)=>{g.d(Oe,{cD:()=>$t,mO:()=>Ke,mS:()=>Et,uE:()=>Mt});var D=g(1528),V=(g(2936),g(3144)),ue=g(5712),te=g(3584),he=g(8360);const ce="/firebase-messaging-sw.js",$="/firebase-cloud-messaging-push-scope",e="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",qe="https://fcmregistrations.googleapis.com/v1",Te="google.c.a.c_id",be="google.c.a.c_l",pe="google.c.a.ts";var J=function(c){return c.PUSH_RECEIVED="push-received",c.NOTIFICATION_CLICKED="notification-clicked",c}(J||{});function se(c){const p=new Uint8Array(c);return btoa(String.fromCharCode(...p)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function ae(c){const F=(c+"=".repeat((4-c.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),G=atob(F),K=new Uint8Array(G.length);for(let u=0;u<G.length;++u)K[u]=G.charCodeAt(u);return K}const Ie="fcm_token_details_db",z=5,q="fcm_token_object_Store";function we(){return we=(0,D.c)(function*(c){if("databases"in indexedDB&&!(yield indexedDB.databases()).map(u=>u.name).includes(Ie))return null;let p=null;return(yield(0,ue.CA)(Ie,z,{upgrade:(G=(0,D.c)(function*(K,u,f,T){var L;if(u<2||!K.objectStoreNames.contains(q))return;const ie=T.objectStore(q),ee=yield ie.index("fcmSenderId").get(c);if(yield ie.clear(),ee)if(2===u){const l=ee;if(!l.auth||!l.p256dh||!l.endpoint)return;p={token:l.fcmToken,createTime:null!==(L=l.createTime)&&void 0!==L?L:Date.now(),subscriptionOptions:{auth:l.auth,p256dh:l.p256dh,endpoint:l.endpoint,swScope:l.swScope,vapidKey:"string"==typeof l.vapidKey?l.vapidKey:se(l.vapidKey)}}}else if(3===u){const l=ee;p={token:l.fcmToken,createTime:l.createTime,subscriptionOptions:{auth:se(l.auth),p256dh:se(l.p256dh),endpoint:l.endpoint,swScope:l.swScope,vapidKey:se(l.vapidKey)}}}else if(4===u){const l=ee;p={token:l.fcmToken,createTime:l.createTime,subscriptionOptions:{auth:se(l.auth),p256dh:se(l.p256dh),endpoint:l.endpoint,swScope:l.swScope,vapidKey:se(l.vapidKey)}}}}),function(u,f,T,L){return G.apply(this,arguments)})})).close(),yield(0,ue.eA)(Ie),yield(0,ue.eA)("fcm_vapid_details_db"),yield(0,ue.eA)("undefined"),function Le(c){if(!c||!c.subscriptionOptions)return!1;const{subscriptionOptions:p}=c;return"number"==typeof c.createTime&&c.createTime>0&&"string"==typeof c.token&&c.token.length>0&&"string"==typeof p.auth&&p.auth.length>0&&"string"==typeof p.p256dh&&p.p256dh.length>0&&"string"==typeof p.endpoint&&p.endpoint.length>0&&"string"==typeof p.swScope&&p.swScope.length>0&&"string"==typeof p.vapidKey&&p.vapidKey.length>0}(p)?p:null;var G}),we.apply(this,arguments)}const le="firebase-messaging-database",Ue=1,ne="firebase-messaging-store";let Be=null;function v(){return Be||(Be=(0,ue.CA)(le,Ue,{upgrade:(c,p)=>{0===p&&c.createObjectStore(ne)}})),Be}function E(c){return b.apply(this,arguments)}function b(){return b=(0,D.c)(function*(c){const p=A(c),G=yield(yield v()).transaction(ne).objectStore(ne).get(p);if(G)return G;{const K=yield function xe(c){return we.apply(this,arguments)}(c.appConfig.senderId);if(K)return yield w(c,K),K}}),b.apply(this,arguments)}function w(c,p){return O.apply(this,arguments)}function O(){return(O=(0,D.c)(function*(c,p){const F=A(c),K=(yield v()).transaction(ne,"readwrite");return yield K.objectStore(ne).put(p,F),yield K.done,p})).apply(this,arguments)}function P(){return(P=(0,D.c)(function*(c){const p=A(c),G=(yield v()).transaction(ne,"readwrite");yield G.objectStore(ne).delete(p),yield G.done})).apply(this,arguments)}function A({appConfig:c}){return c.appId}const m=new te.UR("messaging","Messaging",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."});function j(c,p){return re.apply(this,arguments)}function re(){return(re=(0,D.c)(function*(c,p){const F=yield H(c),G=N(p),K={method:"POST",headers:F,body:JSON.stringify(G)};let u;try{u=yield(yield fetch(B(c.appConfig),K)).json()}catch(f){throw m.create("token-subscribe-failed",{errorInfo:f?.toString()})}if(u.error)throw m.create("token-subscribe-failed",{errorInfo:u.error.message});if(!u.token)throw m.create("token-subscribe-no-token");return u.token})).apply(this,arguments)}function me(){return(me=(0,D.c)(function*(c,p){const F=yield H(c),G=N(p.subscriptionOptions),K={method:"PATCH",headers:F,body:JSON.stringify(G)};let u;try{u=yield(yield fetch(`${B(c.appConfig)}/${p.token}`,K)).json()}catch(f){throw m.create("token-update-failed",{errorInfo:f?.toString()})}if(u.error)throw m.create("token-update-failed",{errorInfo:u.error.message});if(!u.token)throw m.create("token-update-no-token");return u.token})).apply(this,arguments)}function X(c,p){return Ye.apply(this,arguments)}function Ye(){return(Ye=(0,D.c)(function*(c,p){const G={method:"DELETE",headers:yield H(c)};try{const u=yield(yield fetch(`${B(c.appConfig)}/${p}`,G)).json();if(u.error)throw m.create("token-unsubscribe-failed",{errorInfo:u.error.message})}catch(K){throw m.create("token-unsubscribe-failed",{errorInfo:K?.toString()})}})).apply(this,arguments)}function B({projectId:c}){return`${qe}/projects/${c}/registrations`}function H(c){return R.apply(this,arguments)}function R(){return(R=(0,D.c)(function*({appConfig:c,installations:p}){const F=yield p.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":c.apiKey,"x-goog-firebase-installations-auth":`FIS ${F}`})})).apply(this,arguments)}function N({p256dh:c,auth:p,endpoint:F,vapidKey:G}){const K={web:{endpoint:F,auth:p,p256dh:c}};return G!==e&&(K.web.applicationPubKey=G),K}const U=6048e5;function Ge(){return Ge=(0,D.c)(function*(c){const p=yield function lt(c,p){return Qe.apply(this,arguments)}(c.swRegistration,c.vapidKey),F={vapidKey:c.vapidKey,swScope:c.swRegistration.scope,endpoint:p.endpoint,auth:se(p.getKey("auth")),p256dh:se(p.getKey("p256dh"))},G=yield E(c.firebaseDependencies);if(G){if(function Pt(c,p){return p.vapidKey===c.vapidKey&&p.endpoint===c.endpoint&&p.auth===c.auth&&p.p256dh===c.p256dh}(G.subscriptionOptions,F))return Date.now()>=G.createTime+U?function Ae(c,p){return je.apply(this,arguments)}(c,{token:G.token,createTime:Date.now(),subscriptionOptions:F}):G.token;try{yield X(c.firebaseDependencies,G.token)}catch(K){console.warn(K)}return $e(c.firebaseDependencies,F)}return $e(c.firebaseDependencies,F)}),Ge.apply(this,arguments)}function Je(c){return Me.apply(this,arguments)}function Me(){return Me=(0,D.c)(function*(c){const p=yield E(c.firebaseDependencies);p&&(yield X(c.firebaseDependencies,p.token),yield function _(c){return P.apply(this,arguments)}(c.firebaseDependencies));const F=yield c.swRegistration.pushManager.getSubscription();return!F||F.unsubscribe()}),Me.apply(this,arguments)}function je(){return je=(0,D.c)(function*(c,p){try{const F=yield function oe(c,p){return me.apply(this,arguments)}(c.firebaseDependencies,p),G=Object.assign(Object.assign({},p),{token:F,createTime:Date.now()});return yield w(c.firebaseDependencies,G),F}catch(F){throw yield Je(c),F}}),je.apply(this,arguments)}function $e(c,p){return Xe.apply(this,arguments)}function Xe(){return(Xe=(0,D.c)(function*(c,p){const G={token:yield j(c,p),createTime:Date.now(),subscriptionOptions:p};return yield w(c,G),G.token})).apply(this,arguments)}function Qe(){return(Qe=(0,D.c)(function*(c,p){return(yield c.pushManager.getSubscription())||c.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:ae(p)})})).apply(this,arguments)}function wt(c){const p={from:c.from,collapseKey:c.collapse_key,messageId:c.fcmMessageId};return function dt(c,p){if(!p.notification)return;c.notification={};const F=p.notification.title;F&&(c.notification.title=F);const G=p.notification.body;G&&(c.notification.body=G);const K=p.notification.image;K&&(c.notification.image=K);const u=p.notification.icon;u&&(c.notification.icon=u)}(p,c),function xt(c,p){p.data&&(c.data=p.data)}(p,c),function ht(c,p){var F,G,K,u,f;if(!(p.fcmOptions||null!==(F=p.notification)&&void 0!==F&&F.click_action))return;c.fcmOptions={};const T=null!==(K=null===(G=p.fcmOptions)||void 0===G?void 0:G.link)&&void 0!==K?K:null===(u=p.notification)||void 0===u?void 0:u.click_action;T&&(c.fcmOptions.link=T);const L=null===(f=p.fcmOptions)||void 0===f?void 0:f.analytics_label;L&&(c.fcmOptions.analyticsLabel=L)}(p,c),p}function pt(c,p){const F=[];for(let G=0;G<c.length;G++)F.push(c.charAt(G)),G<p.length&&F.push(p.charAt(G));return F.join("")}function ft(c){return m.create("missing-app-config-values",{valueName:c})}pt("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),pt("AzSCbw63g1R0nCw85jG8","Iaya3yLKwmgvh7cF0q4");class _e{constructor(p,F,G){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const K=function Ut(c){if(!c||!c.options)throw ft("App Configuration Object");if(!c.name)throw ft("App Name");const p=["projectId","apiKey","appId","messagingSenderId"],{options:F}=c;for(const G of p)if(!F[G])throw ft(G);return{appName:c.name,projectId:F.projectId,apiKey:F.apiKey,appId:F.appId,senderId:F.messagingSenderId}}(p);this.firebaseDependencies={app:p,appConfig:K,installations:F,analyticsProvider:G}}_delete(){return Promise.resolve()}}function rt(c){return He.apply(this,arguments)}function He(){return(He=(0,D.c)(function*(c){try{c.swRegistration=yield navigator.serviceWorker.register(ce,{scope:$}),c.swRegistration.update().catch(()=>{})}catch(p){throw m.create("failed-service-worker-registration",{browserErrorMessage:p?.message})}})).apply(this,arguments)}function gt(){return(gt=(0,D.c)(function*(c,p){if(!p&&!c.swRegistration&&(yield rt(c)),p||!c.swRegistration){if(!(p instanceof ServiceWorkerRegistration))throw m.create("invalid-sw-registration");c.swRegistration=p}})).apply(this,arguments)}function tt(){return(tt=(0,D.c)(function*(c,p){p?c.vapidKey=p:c.vapidKey||(c.vapidKey=e)})).apply(this,arguments)}function Rt(c,p){return nt.apply(this,arguments)}function nt(){return nt=(0,D.c)(function*(c,p){if(!navigator)throw m.create("only-available-in-window");if("default"===Notification.permission&&(yield Notification.requestPermission()),"granted"!==Notification.permission)throw m.create("permission-blocked");return yield function st(c,p){return tt.apply(this,arguments)}(c,p?.vapidKey),yield function it(c,p){return gt.apply(this,arguments)}(c,p?.serviceWorkerRegistration),function Z(c){return Ge.apply(this,arguments)}(c)}),nt.apply(this,arguments)}function Re(){return(Re=(0,D.c)(function*(c,p,F){const G=function mt(c){switch(c){case J.NOTIFICATION_CLICKED:return"notification_open";case J.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}(p);(yield c.firebaseDependencies.analyticsProvider.get()).logEvent(G,{message_id:F[Te],message_name:F[be],message_time:F[pe],message_device_time:Math.floor(Date.now()/1e3)})})).apply(this,arguments)}function _t(){return _t=(0,D.c)(function*(c,p){const F=p.data;if(!F.isFirebaseMessaging)return;c.onMessageHandler&&F.messageType===J.PUSH_RECEIVED&&("function"==typeof c.onMessageHandler?c.onMessageHandler(wt(F)):c.onMessageHandler.next(wt(F)));const G=F.data;(function At(c){return"object"==typeof c&&!!c&&Te in c})(G)&&"1"===G["google.c.a.e"]&&(yield function Ot(c,p,F){return Re.apply(this,arguments)}(c,F.messageType,G))}),_t.apply(this,arguments)}const Ct="@firebase/messaging",Ce=c=>{const p=new _e(c.getProvider("app").getImmediate(),c.getProvider("installations-internal").getImmediate(),c.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",F=>function Bt(c,p){return _t.apply(this,arguments)}(p,F)),p},Ze=c=>{const p=c.getProvider("messaging").getImmediate();return{getToken:G=>Rt(p,G)}};function Ke(){return yt.apply(this,arguments)}function yt(){return(yt=(0,D.c)(function*(){try{yield(0,te.A3)()}catch{return!1}return typeof window<"u"&&(0,te.yy)()&&(0,te.Ks)()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")})).apply(this,arguments)}function ut(){return(ut=(0,D.c)(function*(c){if(!navigator)throw m.create("only-available-in-window");return c.swRegistration||(yield rt(c)),Je(c)})).apply(this,arguments)}function Mt(c,p){return bt.apply(this,arguments)}function bt(){return(bt=(0,D.c)(function*(c,p){return Rt(c=(0,te.Yj)(c),p)})).apply(this,arguments)}function $t(c){return function vt(c){return ut.apply(this,arguments)}(c=(0,te.Yj)(c))}function Et(c,p){return function Yt(c,p){if(!navigator)throw m.create("only-available-in-window");return c.onMessageHandler=p,()=>{c.onMessageHandler=null}}(c=(0,te.Yj)(c),p)}!function Gt(){(0,he._registerComponent)(new V.Yl("messaging",Ce,"PUBLIC")),(0,he._registerComponent)(new V.Yl("messaging-internal",Ze,"PRIVATE")),(0,he.registerVersion)(Ct,"0.12.6"),(0,he.registerVersion)(Ct,"0.12.6","esm2017")}()}}]);