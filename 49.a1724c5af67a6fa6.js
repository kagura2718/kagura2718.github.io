"use strict";(self.webpackChunkKaguraGithubPages=self.webpackChunkKaguraGithubPages||[]).push([[49],{9049:(It,xe,f)=>{f.r(xe),f.d(xe,{GitfireModule:()=>ie});var O=f(6814),r=f(5739),K=f(7217),ue=f(5070),oe=f(5579),he=f(434),ce=f(4186),N=f(5861),e=f(9212),Pe=f(8326),me=f(2650),ye=f(2096),fe=f(6232),Re=f(5592),Ze=f(5211),X=f(5137),ae=f(3093),ee=f(4664),_e=f(7398),Y=f(7081),V=f(4867),Oe=f(6306),Ie=f(9769),Se=f(3572),le=f(7142);const U=new e.OlP("angularfire2.messaging.vapid-key"),j=new e.OlP("angularfire2.messaging.service-worker-registeration");let C=(()=>{class l{requestPermission;getToken;tokenChanges;messages;requestToken;deleteToken;constructor(i,s,d,T,I,ge,Ke){const Qe=Ke,He=(0,ye.of)(void 0).pipe((0,X.R)(I.outsideAngular),(0,ae.Q)(I.insideAngular),(0,ee.w)(me.Gb),(0,ee.w)(Be=>Be?f.e(29).then(f.bind(f,29)):fe.E),(0,_e.U)(()=>(0,K.on)(i,T,s)),(0,ee.w)(Be=>(0,K.cc)(`${Be.name}.messaging`,"AngularFireMessaging",Be.name,()=>(0,ye.of)(Be.messaging()),[])),(0,Y.d)({bufferSize:1,refCount:!1}));this.requestPermission=He.pipe((0,X.R)(I.outsideAngular),(0,ae.Q)(I.insideAngular),(0,ee.w)(()=>Notification.requestPermission())),this.getToken=He.pipe((0,X.R)(I.outsideAngular),(0,ae.Q)(I.insideAngular),(0,ee.w)(function(){var Be=(0,N.Z)(function*(St){if("granted"===Notification.permission){const Ft=Qe?yield Qe:null;return yield St.getToken({vapidKey:ge,serviceWorkerRegistration:Ft})}return null});return function(St){return Be.apply(this,arguments)}}()));const Lt=new Re.y(Be=>{navigator.permissions.query({name:"notifications"}).then(St=>{St.onchange=()=>Be.next()})}),Ue=He.pipe((0,X.R)(I.outsideAngular),(0,ae.Q)(I.insideAngular),(0,V.c)(Lt),(0,V.c)(this.getToken));return this.tokenChanges=He.pipe((0,X.R)(I.outsideAngular),(0,ae.Q)(I.insideAngular),(0,ee.w)(()=>(0,Ze.z)(this.getToken,Ue))),this.messages=He.pipe((0,X.R)(I.outsideAngular),(0,ae.Q)(I.insideAngular),(0,ee.w)(Be=>new Re.y(St=>Be.onMessage(St)))),this.requestToken=He.pipe((0,X.R)(I.outsideAngular),(0,ae.Q)(I.insideAngular),(0,ee.w)(()=>this.requestPermission),(0,Oe.K)(()=>(0,ye.of)(null)),(0,Ie.z)(()=>this.tokenChanges)),this.deleteToken=()=>He.pipe((0,X.R)(I.outsideAngular),(0,ae.Q)(I.insideAngular),(0,ee.w)(Be=>Be.deleteToken()),(0,Se.d)(!1)),(0,K.pX)(this,He,T)}static \u0275fac=function(s){return new(s||l)(e.LFG(K.Dh),e.LFG(K.xv,8),e.LFG(e.Lbi),e.LFG(e.R0b),e.LFG(Pe.HU),e.LFG(U,8),e.LFG(j,8))};static \u0275prov=e.Yz7({token:l,factory:l.\u0275fac,providedIn:"any"})}return l})(),b=(()=>{class l{constructor(){le.Z.registerVersion("angularfire",Pe.q4.full,"fcm-compat")}static \u0275fac=function(s){return new(s||l)};static \u0275mod=e.oAB({type:l});static \u0275inj=e.cJS({providers:[C]})}return l})();var y=f(2425),A=f(2589),R=f(5187),m=f(8645),D=f(9773),k=f(8180),B=f(2181),_=f(553),Q=f(103),pe=f(1248);let se=(()=>{class l extends pe.W{constructor(){super()}ngOnInit(){(0,_.eM)("DeleteConfirmComponent.OnInit()")}static \u0275fac=function(s){return new(s||l)};static \u0275cmp=e.Xpm({type:l,selectors:[["gitfire-delete-confirm"]],features:[e.qOj],decls:10,vars:0,consts:[[1,"m-3"]],template:function(s,d){1&s&&(e.TgZ(0,"div",0)(1,"div"),e._uU(2,"\u672c\u5f53\u306b\u524a\u9664\u3057\u307e\u3059\u304b\uff1f"),e.qZA(),e.TgZ(3,"ul")(4,"li"),e._uU(5,"Google / Twitter \u306a\u3069\u306e\u30a2\u30ab\u30a6\u30f3\u30c8\u60c5\u5831\u306f\u524a\u9664\u3055\u308c\u307e\u305b\u3093\u3002"),e.qZA(),e.TgZ(6,"li"),e._uU(7,"\u516c\u958b\u3055\u308c\u305f\u6295\u7a3f\u306f\u524a\u9664\u3055\u308c\u307e\u305b\u3093\u3002"),e.qZA(),e.TgZ(8,"li"),e._uU(9,"\u53d6\u308a\u6d88\u3057\u306f\u3067\u304d\u307e\u305b\u3093\u3002"),e.qZA()()())}})}return l})();f(4015);var te=f(353);const qe=["specialAuthContainer"];function Z(l,F){if(1&l){const i=e.EpF();e.TgZ(0,"a",7),e.NdJ("click",function(d){const I=e.CHM(i).$implicit,ge=e.oxw();return e.KtG(ge.onClickReauthProvider(d,I))}),e._uU(1),e.qZA()}if(2&l){const i=F.$implicit;e.xp6(1),e.Oqu(i.providerId)}}class z extends pe.W{loader;toastr;static SUPPORTED_PROVIDERS={};static SupportedOauthProviderIds=[];destroy$=new m.x;get providers(){return this.currentUser.providerData}currentUser;reauthed=new e.vpe;specialAuthContainer;static#e=(()=>{const F=z.SUPPORTED_PROVIDERS,i=le.Z.auth;F[i.EmailAuthProvider.PROVIDER_ID]=i.EmailAuthProvider,F[i.TwitterAuthProvider.PROVIDER_ID]=i.TwitterAuthProvider,F[i.GoogleAuthProvider.PROVIDER_ID]=i.GoogleAuthProvider,F[i.GithubAuthProvider.PROVIDER_ID]=i.GithubAuthProvider;const s=z.SupportedOauthProviderIds;s.push(i.TwitterAuthProvider.PROVIDER_ID),s.push(i.GoogleAuthProvider.PROVIDER_ID),s.push(i.GithubAuthProvider.PROVIDER_ID)})();constructor(F,i){super(),this.loader=F,this.toastr=i}ngOnDestroy(){this.destroy$.next()}isOAuthProvider(F){return!!z.SupportedOauthProviderIds.includes(F)}onClickReauthProvider(F,i){var s=()=>super.close,d=this;return(0,N.Z)(function*(){(0,_.eM)("onClickReauthProvider()",F,i),F.preventDefault();const I=new(0,z.SUPPORTED_PROVIDERS[i.providerId]);if(d.specialAuthContainer.clear(),d.isOAuthProvider(i.providerId)){try{yield d.currentUser.reauthenticateWithPopup(I)}catch(ge){(0,_.wb)("Error while reauth",ge);const Ke=ge instanceof Error?ge.message:"Unknown error";return void d.toastr.error(`\u518d\u8a8d\u8a3c\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002 ( ${Ke} )`)}(0,_.eM)("Reanthenticated via OAuth provider")}else{const{GitfireLoginModule:ge}=yield Promise.resolve().then(f.bind(f,3128)),{InputAuthComponent:Ke}=yield Promise.resolve().then(f.bind(f,8337)),Qe=d.loader.appendComponent(d.specialAuthContainer,ge,Ke);Qe.isReauth=!0,Qe.reauthUser=d.currentUser,Qe.showFederations=!1;const He=Qe.reauthed.pipe((0,k.q)(1));try{yield He.toPromise()}catch(Lt){(0,_.wb)("Error while reauth done",Lt);const Ue=Lt instanceof Error?Lt.message:"Unknown error";return void d.toastr.error(`\u518d\u8a8d\u8a3c\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002 ( ${Ue} )`)}(0,_.eM)("Reanthenticated via password")}d.reauthed.next(),s().call(d)})()}static \u0275fac=function(i){return new(i||z)(e.Y36(te.j),e.Y36(y._W))};static \u0275cmp=e.Xpm({type:z,selectors:[["gitfire-reauth-box"]],viewQuery:function(i,s){if(1&i&&e.Gf(qe,5,e.s_b),2&i){let d;e.iGM(d=e.CRH())&&(s.specialAuthContainer=d.first)}},inputs:{currentUser:"currentUser"},outputs:{reauthed:"reauthed"},features:[e.qOj],decls:10,vars:1,consts:[[1,"m-3"],[1,"btn-group"],["type","button","data-bs-toggle","dropdown","aria-haspopup","true","aria-expanded","false",1,"btn","btn-primary","dropdown-toggle"],[1,"visually-hidden"],[1,"dropdown-menu"],["class","dropdown-item","href","#",3,"click",4,"ngFor","ngForOf"],["specialAuthContainer",""],["href","#",1,"dropdown-item",3,"click"]],template:function(i,s){1&i&&(e.TgZ(0,"div",0)(1,"div",1)(2,"button",2)(3,"span",3),e._uU(4,"Toggle Dropdown"),e.qZA(),e._uU(5,"\u8a8d\u8a3c\u65b9\u6cd5"),e.qZA(),e.TgZ(6,"div",4),e.YNc(7,Z,2,1,"a",5),e.qZA()(),e._UZ(8,"div",null,6),e.qZA()),2&i&&(e.xp6(7),e.Q6J("ngForOf",s.providers))},dependencies:[O.sg]})}var S=f(1748);function G(l,F){if(l.value!==F){if(l.dirty)return void(0,_.wb)(`Upstream value has been changed to ${l.value} -> ${F} but sillengly ignore the value.`);l.setErrors(null),l.setValue(F)}}function M(l){l.markAsPristine(),l.markAsUntouched()}var re=f(9782),Le=f(2413),Ve=f(9339),$e=f(3867),Fe=f(2572),Je=f(3997),Ge=f(9397),Ye=f(7319);let lt=(()=>{class l{controlLabel;formName;tooltipText;parentForm;checkChanged=new e.vpe;autoGeneratedId;constructor(){const i=Math.random().toString(36).substring(2);this.autoGeneratedId=`appViewInput-${i}`}ngOnInit(){(0,_.eM)("SwitchComponent.OnInit()")}onChangeBox(i){(0,_.eM)("SwitchComponent.onChangeBox()",this.parentForm),this.checkChanged.emit(i)}static \u0275fac=function(s){return new(s||l)};static \u0275cmp=e.Xpm({type:l,selectors:[["app-switch"]],inputs:{controlLabel:"controlLabel",formName:"formName",tooltipText:"tooltipText",parentForm:"parentForm"},outputs:{checkChanged:"checkChanged"},decls:4,vars:7,consts:[[1,"custom-control","custom-switch",3,"formGroup","title"],["type","checkbox",1,"custom-control-input",3,"id","name","formControlName","change"],[1,"custom-control-label",3,"for"]],template:function(s,d){1&s&&(e.TgZ(0,"span",0)(1,"input",1),e.NdJ("change",function(I){return d.onChangeBox(I)}),e.qZA(),e.TgZ(2,"label",2),e._uU(3),e.qZA()()),2&s&&(e.s9C("title",d.tooltipText),e.Q6J("formGroup",d.parentForm),e.xp6(1),e.s9C("id",d.autoGeneratedId),e.s9C("name",d.formName),e.s9C("formControlName",d.formName),e.xp6(1),e.s9C("for",d.autoGeneratedId),e.xp6(1),e.Oqu(d.controlLabel))},dependencies:[r.Wl,r.JJ,r.JL,r.sg,r.u]})}return l})();function ze(l,F){if(1&l){const i=e.EpF();e.TgZ(0,"button",22),e.NdJ("click",function(d){e.CHM(i);const T=e.oxw().$implicit,I=e.oxw();return e.KtG(I.onClickDeleteDevice(d,T))}),e._uU(1,"\u524a\u9664"),e.qZA()}}function Dt(l,F){if(1&l){const i=e.EpF();e.TgZ(0,"div",19)(1,"app-switch",20),e.NdJ("checkChanged",function(d){const I=e.CHM(i).$implicit,ge=e.oxw();return e.KtG(ge.onToggleDevice(d,I))}),e.ALo(2,"date"),e.qZA(),e.YNc(3,ze,2,0,"button",21),e.qZA()}if(2&l){const i=F.$implicit,s=e.oxw();e.xp6(1),e.cQ8("controlLabel","",i.name||"No Name"," ",i.id===s.registeredDeviceId?"[\u3053\u306e\u7aef\u672b]":null," (\u767b\u9332\u65e5: ",e.xi3(2,6,i.createdAt.toDate(),"yyyy-MM-dd"),")"),e.MGl("formName","device-",i.id,""),e.Q6J("parentForm",s.deviceForm),e.xp6(2),e.Q6J("ngIf",i.id!==s.registeredDeviceId)}}function kt(l,F){if(1&l&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&l){const i=F.$implicit,s=F.index;e.xp6(1),e.AsE("",s,": ",i,"")}}function dt(l,F){if(1&l&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&l){const i=F.$implicit,s=F.index;e.xp6(1),e.AsE("",s,": ",i,"")}}function Pt(l,F){if(1&l&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&l){const i=F.$implicit,s=F.index;e.xp6(1),e.AsE("",s,": ",i,"")}}function pt(l,F){if(1&l&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"json"),e.qZA()),2&l){const i=F.$implicit;e.xp6(1),e.Oqu(e.lcZ(2,1,i))}}let xt=(()=>{class l{auth;dialog;toastr;store;funcs;messaging;destroy$=new m.x;mainForm;userPrivStore$;deviceForm;messagingTypeArray;configArray;currentUser$;registeredDeviceId;registeredToken;debugObservable={};devices;tokenReceived=new m.x;tokenReceived$;privUser;constructor(i,s,d,T,I,ge){this.auth=i,this.dialog=s,this.toastr=d,this.store=T,this.funcs=I,this.messaging=ge,this.privUser=this.store.collection("/users/v1/protected"),this.currentUser$=this.auth.clientSideUser$.pipe((0,B.h)(Ke=>!!Ke))}onToggleDevice(i,s){(0,_.eM)("onToggleDevice()");const d=this.getDeviceControl(s),T={deviceId:s.id,off:!d.value};try{this.funcs.call("toggleSuspendDevice",T),this.toastr.success("\u7aef\u672b\u306e\u8a2d\u5b9a\u3092\u66f4\u65b0\u3057\u307e\u3057\u305f\u3002")}catch{this.toastr.error("\u7aef\u672b\u306e\u8a2d\u5b9a\u304c\u66f4\u65b0\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002")}}onClickDeleteDevice(i,s){var I,d=this;(0,_.eM)("onClickDeleteDevice()"),this.messaging.deleteToken(s.token).pipe((0,D.R)(this.destroy$)).subscribe({next:(I=(0,N.Z)(function*(ge){(0,_.H_)(`deleteToken() result ${ge}`),d.toastr.success("\u7aef\u672b\u306e\u901a\u77e5\u3092\u89e3\u9664\u3057\u307e\u3057\u305f\u3002")}),function(Ke){return I.apply(this,arguments)}),error:I=>{(0,_.wb)(`Failed to delete token token: ${s.token}`,I),this.toastr.error("\u7aef\u672b\u306e\u901a\u77e5\u3092\u89e3\u9664\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002\u65e2\u306b\u5931\u52b9\u3057\u3066\u3044\u308b\u53ef\u80fd\u6027\u304c\u3042\u308a\u307e\u3059\u3002")}});const T={deviceId:s.id};try{this.funcs.call("revokeDevice",T),this.toastr.success("\u30b7\u30b9\u30c6\u30e0\u4e0a\u304b\u3089\u7aef\u672b\u306e\u901a\u77e5\u3092\u89e3\u9664\u3057\u307e\u3057\u305f\u3002")}catch{this.toastr.error("\u30b7\u30b9\u30c6\u30e0\u4e0a\u306e\u7aef\u672b\u306e\u901a\u77e5\u3092\u89e3\u9664\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002")}}ngOnInit(){var i=this;const d=this.currentUser$.pipe((0,k.q)(1),(0,B.h)(T=>!!T)).pipe((0,ee.w)(T=>this.store.collection(`users/v1/protected/${T.uid}/fcm`).valueChanges({idField:"id"})),(0,Y.d)(1));d.pipe((0,D.R)(this.destroy$)).subscribe(T=>{this.devices=T;for(const I in this.deviceForm.controls)this.deviceForm.removeControl(I);for(const I of this.devices)this.addDeviceControl(I);this.triggerTokenRefresh()}),this.mainForm.addControl("messagingOn",new r.NI(!1,[])),this.deviceForm=new r.cw({}),this.mainForm.addControl("devices",this.deviceForm),this.mainForm.addControl("messagingSystemCheck",new r.NI(!1,[])),this.mainForm.addControl("messagingTrivialCheck",new r.NI(!1,[])),this.mainForm.addControl("messagingMentionCheck",new r.NI(!1,[])),this.mainForm.addControl("messagingAdminCheck",new r.NI(!1,[])),this.messagingTypeArray=new r.Oe([this.typeSystemControl,this.typeMentionControl,this.typeAdminControl]),this.configArray=new r.Oe([this.typeTrivialControl,this.messagingTypeArray]),this.userPrivStore$.pipe((0,D.R)(this.destroy$)).subscribe(T=>{(0,_.H_)("this.userPrivStore$.subscribe()",T);const I=T.messagingTypes||["mention","admin"];G(this.typeSystemControl,I.includes("system")),G(this.typeMentionControl,I.includes("mention")),G(this.typeAdminControl,I.includes("admin")),G(this.typeTrivialControl,T.isWatchTrivial)}),this.tokenReceived$=this.tokenReceived.pipe((0,B.h)(T=>null!==T),(0,Je.x)()),(0,Fe.a)(this.tokenReceived$,d).pipe((0,D.R)(this.destroy$)).subscribe(function(){var T=(0,N.Z)(function*([I,ge]){if((0,_.eM)("this.messaging.tokenReceived subscribe()",I,ge),i.debugObservable.registeredToken=I,i.registeredToken=I,I){const Qe=i.findDeviceId(I,ge);i.registeredDeviceId=Qe}G(i.messagingOnControl,!!i.registeredDeviceId)});return function(I){return T.apply(this,arguments)}}()),this.triggerTokenRefresh(),this.debugObservable.messages=[],this.messaging.messages.pipe((0,D.R)(this.destroy$)).subscribe(T=>{(0,_.H_)("message received from messaging",T),this.debugObservable.messages.push(T)}),this.debugObservable.getToken$=this.messaging.getToken,this.debugObservable.getToken=[],this.debugObservable.getToken$.subscribe({next:T=>this.debugObservable.getToken.push(T),complete:()=>(0,_.H_)("Complete getToken()")}),this.debugObservable.tokenChanges$=this.messaging.tokenChanges,this.debugObservable.tokenChanges=[],this.debugObservable.tokenChanges$.subscribe({next:T=>this.debugObservable.tokenChanges.push(T),complete:()=>(0,_.H_)("Complete tokenChanges()")}),this.debugObservable.tokenReceived=[]}findDeviceId(i,s){for(const d of s)if(d.token===i)return d.id;return null}ngOnDestroy(){this.destroy$.next()}triggerTokenRefresh(){this.messaging.getToken.pipe((0,k.q)(1),(0,D.R)(this.destroy$)).subscribe({next:i=>this.tokenReceived.next(i),complete:()=>(0,_.eM)("Completed getToken")})}get messagingOnControl(){return this.mainForm.get("messagingOn")}getDeviceControl(i){return this.deviceForm.get(`device-${i.id}`)}addDeviceControl(i){const s=new r.NI(!i.isSuspend,[]);this.deviceForm.addControl(`device-${i.id}`,s)}get typeTrivialControl(){return this.mainForm.get("messagingTrivialCheck")}get typeSystemControl(){return this.mainForm.get("messagingSystemCheck")}get typeMentionControl(){return this.mainForm.get("messagingMentionCheck")}get typeAdminControl(){return this.mainForm.get("messagingAdminCheck")}revokeNotification(){var i=this;return(0,N.Z)(function*(){if(!i.registeredDeviceId)return(0,_.wb)("Unexpectedly no deviceId is found."),void i.toastr.error("\u30c7\u30d0\u30a4\u30b9\u60c5\u5831\u3092\u7121\u52b9\u306b\u3067\u304d\u307e\u305b\u3093\u3002");try{i.funcs.call("revokeDevice",{deviceId:i.registeredDeviceId}),i.toastr.info("\u30b7\u30b9\u30c6\u30e0\u304b\u3089\u901a\u77e5\u60c5\u5831\u3092\u524a\u9664\u3057\u307e\u3057\u305f\u3002")}catch(s){return(0,_.wb)("Error while deleting token via Functions",s),i.messagingOnControl.setValue(!0),M(i.messagingOnControl),void i.toastr.error("\u30b7\u30b9\u30c6\u30e0\u306e\u901a\u77e5\u60c5\u5831\u3092\u524a\u9664\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002")}i.messaging.getToken.pipe((0,Ge.b)(s=>(0,_.eM)(`getToken before deleteToken ${s}`)),(0,Ie.z)(s=>i.messaging.deleteToken(s)),(0,k.q)(1),(0,D.R)(i.destroy$)).subscribe({next:s=>{(0,_.H_)(`Deleted result: ${s} on FCM.`),M(i.messagingOnControl),i.toastr.success("\u901a\u77e5\u60c5\u5831\u3092\u524a\u9664\u3057\u307e\u3057\u305f\u3002")},error:s=>{(0,_.wb)("Error while deleting token on FCM",s),i.toastr.error("\u901a\u77e5\u60c5\u5831\u304c\u524a\u9664\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002")}})})()}onToggleMessaging(i){var s=this;return(0,N.Z)(function*(){if((0,_.eM)("UserSettingsComponent.onToggleMessaging()"),s.messagingOnControl.value){if(!s.registeredDeviceId&&s.devices&&s.devices.length>=_.NZ.FCMDeviceMaxCount)return void s.toastr.error("\u767b\u9332\u3055\u308c\u305f\u30c7\u30d0\u30a4\u30b9\u304c\u591a\u3059\u304e\u307e\u3059\u3002\u524a\u9664\u3057\u3066\u304b\u3089\u3084\u308a\u76f4\u3057\u3066\u304f\u3060\u3055\u3044\u3002");yield s.updateRequestToken()}else{const T=s.dialog.createHtmlBuilder(),I=new Ye.ww("\n<div>\n\u767b\u9332\u3092\u89e3\u9664\u3059\u308b\u3068\u3059\u3079\u3066\u306e\u901a\u77e5\u306f\u505c\u6b62\u3057\u307e\u3059\u3002\u3088\u308d\u3057\u3044\u3067\u3059\u304b\uff1f\n</div>\n");T.setMessage(I).setType(Q.iR.Warn).setSize(Q.PW.Default).setTitle("\u78ba\u8a8d").okButton((0,N.Z)(function*(){yield s.revokeNotification()})).cancelButton(()=>{s.messagingOnControl.setValue(!0),M(s.messagingOnControl)}).open()}})()}getMessagingTypes(){const i=[];return this.typeSystemControl.value&&i.push("system"),this.typeMentionControl.value&&i.push("mention"),this.typeAdminControl.value&&i.push("admin"),i}updateRequestToken(){var i=this;return(0,N.Z)(function*(){var s;i.messaging.requestToken.pipe((0,k.q)(1),(0,D.R)(i.destroy$)).subscribe({next:(s=(0,N.Z)(function*(d){if(i.tokenReceived.next(d),i.debugObservable.tokenReceived.push(d),!d)return(0,_.wb)("No token returned from requestToken"),i.messagingOnControl.setValue(!1),M(i.messagingOnControl),void i.toastr.error("\u901a\u77e5\u60c5\u5831\u3092\u53d6\u5f97\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002");try{(0,_.eM)(`Updated token with ${d}`);const T={token:d,deviceId:i.registeredDeviceId};i.registeredToken=d,i.registeredDeviceId=yield i.funcs.call("saveDeviceToken",T),i.toastr.success("\u901a\u77e5\u60c5\u5831\u3092\u4fdd\u5b58\u3057\u307e\u3057\u305f\u3002"),M(i.messagingOnControl)}catch(T){(0,_.wb)("Error while save token to Firestore",T),i.messagingOnControl.setValue(!1),M(i.messagingOnControl),i.toastr.error("\u901a\u77e5\u60c5\u5831\u3092\u4fdd\u5b58\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002")}}),function(T){return s.apply(this,arguments)}),error:s=>{(0,_.wb)("Error while request Token",s),i.messagingOnControl.setValue(!1),M(i.messagingOnControl),i.toastr.error("\u901a\u77e5\u3092\u6709\u52b9\u306b\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002\u30d6\u30e9\u30a6\u30b6\u306e\u8a2d\u5b9a\u3092\u78ba\u8a8d\u3057\u3066\u304f\u3060\u3055\u3044\u3002")}})})()}onClickUpdateMessaging(i){var s=this;return(0,N.Z)(function*(){(0,_.eM)("UserSettingsComponent.onClickUpdateMessaging()");try{const d={messageTypes:s.getMessagingTypes(),token:s.registeredToken,isWatchTrivial:s.typeTrivialControl.value};yield s.funcs.call("setNotifications",d),M(s.configArray),s.toastr.success("\u8a2d\u5b9a\u3092\u4fdd\u5b58\u3057\u307e\u3057\u305f\u3002")}catch(d){(0,_.wb)("Failed to save configuration",d),s.toastr.error("\u8a2d\u5b9a\u304c\u4fdd\u5b58\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002")}})()}onClickSubscribeTopic(i){var s=this;return(0,N.Z)(function*(){if(!s.debugObservable.topicText)return void alert("Not set");const d={topic:s.debugObservable.topicText,token:s.registeredToken},T=yield s.funcs.call("subscribeTopicTest",d);(0,_.H_)("subscribeTopicTest ->",T),s.toastr.success(`done subscribe ${T}`)})()}onClickUnsubscribeTopic(i){var s=this;return(0,N.Z)(function*(){if(!s.debugObservable.topicText)return void alert("Not set");const d={topic:s.debugObservable.topicText,token:s.registeredToken},T=yield s.funcs.call("unsubscribeTopicTest",d);(0,_.H_)("unsubscribeTopicTest ->",T),s.toastr.success(`done unsubscribe ${T}`)})()}onClickPostToTopic(i){var s=this;return(0,N.Z)(function*(){if(!s.debugObservable.topicText||!s.debugObservable.topicPostText)return void alert("Not set");const d={topic:s.debugObservable.topicText,title:s.debugObservable.topicPostText},T=yield s.funcs.call("postTopicTest",d);(0,_.H_)("postTopicTest ->",T),s.toastr.success(`done post ${T}`)})()}onClickConditionPostToTopic(i){var s=this;return(0,N.Z)(function*(){if(!s.debugObservable.conditionTopicPostText||!s.debugObservable.conditionTopicPostText)return void alert("Not set");const d={topic:s.debugObservable.conditionTopicPostText,title:s.debugObservable.topicPostText},T=yield s.funcs.call("postConditionTopicTest",d);(0,_.H_)("postConditionTopicTest ->",T),s.toastr.success(`done post ${T}`)})()}onClickClearMessages(i){this.debugObservable.messages=[]}static \u0275fac=function(s){return new(s||l)(e.Y36(re.e),e.Y36(Q.xA),e.Y36(y._W),e.Y36(oe.ST),e.Y36(Le.c),e.Y36(C))};static \u0275cmp=e.Xpm({type:l,selectors:[["gitfire-user-notification"]],inputs:{mainForm:"mainForm",userPrivStore$:"userPrivStore$"},decls:69,vars:16,consts:[[1,"m-2"],["title","\u3053\u306e\u6a5f\u80fd\u306f\u30c6\u30b9\u30c8\u4e2d\u306e\u305f\u3081\u5909\u66f4\u3055\u308c\u308b\u3053\u3068\u3084\u3001\u60f3\u5b9a\u5916\u306e\u6319\u52d5\u3092\u3059\u308b\u5834\u5408\u304c\u3042\u308a\u307e\u3059\u3002\u30d6\u30e9\u30a6\u30b6\u304b\u3089\u306e\u901a\u77e5\u3092\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u3057\u307e\u3059\u3002\u8a2d\u5b9a\u304c\u3046\u307e\u304f\u3044\u304b\u306a\u3044\u5834\u5408\u306f\u30d6\u30e9\u30a6\u30b6\u304b\u3089\u5f53\u30b5\u30a4\u30c8\u306e\u901a\u77e5 on/off \u3092\u3057\u305f\u308a\u3001\u300e\u7aef\u672b\u306e\u524a\u9664\u300f\u3092\u304a\u8a66\u3057\u304f\u3060\u3055\u3044\u3002","src","/assets/octicons/question.svg",1,"m-3","octicon-info","help-icon"],[1,"m-2",3,"formGroup"],[1,"row","p-1"],[1,"d-flex","align-content-start","flex-wrap","p-1"],["controlLabel","\u901a\u77e5\u3092\u53d7\u3051\u53d6\u308b","formName","messagingOn","tooltipText","\u30d6\u30e9\u30a6\u30b6\u304b\u3089\u306e\u901a\u77e5\u3092\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u3057\u307e\u3059\u3002",1,"p-2",3,"parentForm","checkChanged"],[1,"d-flex","align-content-start","flex-wrap","p-3"],["class","m-1 input-group",4,"ngFor","ngForOf"],[1,"row","m-2"],["controlLabel","\u3061\u3087\u3063\u3068\u3057\u305f\u901a\u77e5","formName","messagingTrivialCheck","tooltipText","\u3061\u3087\u3063\u3068\u3057\u305f\u901a\u77e5\u3082\u53d7\u3051\u53d6\u308b\u304b\u3069\u3046\u304b\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\u901a\u5e38\u306f\u4e0d\u8981\u3067\u3059\u3002",1,"p-2",3,"parentForm"],["controlLabel","\u30b7\u30b9\u30c6\u30e0","formName","messagingSystemCheck","tooltipText","\u30b7\u30b9\u30c6\u30e0\u304b\u3089\u306e\u901a\u77e5\u3092\u9001\u308b\u304b\u3069\u3046\u304b\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002",1,"p-2",3,"parentForm"],["controlLabel","\u3042\u306a\u305f\u3078\u306e\u8a00\u53ca","formName","messagingMentionCheck","tooltipText","\u30b7\u30b9\u30c6\u30e0\u306e\u30e1\u30c3\u30bb\u30fc\u30b8\u30b7\u30b9\u30c6\u30e0\u3067\u3042\u306a\u305f\u306b\u8a00\u53ca\u3055\u308c\u305f\u5834\u5408\u306b\u901a\u77e5\u3092\u9001\u308b\u304b\u3069\u3046\u304b\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002",1,"p-2",3,"parentForm"],["controlLabel","\u7ba1\u7406\u4eba\u304b\u3089","formName","messagingAdminCheck","tooltipText","\u7ba1\u7406\u4eba\u304c\u624b\u52d5\u3067\u3042\u306a\u305f\u306b\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u9001\u3063\u305f\u5834\u5408\u306b\u901a\u77e5\u3092\u9001\u308b\u304b\u3069\u3046\u304b\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002",1,"p-2",3,"parentForm"],[1,"btn","btn-primary",3,"disabled","click"],[2,"width","100%","overflow-wrap","break-word"],[4,"ngFor","ngForOf"],["type","text",3,"ngModel","ngModelChange"],[1,"btn","btn-primary",3,"click"],[1,"btn","btn-warning",3,"click"],[1,"m-1","input-group"],["tooltipText","\u767b\u9332\u3055\u308c\u305f Device \u306e\u901a\u77e5\u3092\u4e00\u6642\u7684\u306b\u505c\u6b62\u3057\u307e\u3059\u3002",1,"m-2",3,"parentForm","controlLabel","formName","checkChanged"],["class","btn btn-warning","title","\u767b\u9332\u60c5\u5831\u3092\u524a\u9664\u3057\u3066\u3001\u3053\u306e\u7aef\u672b\u3078\u306e\u901a\u77e5\u3092\u89e3\u9664\u3057\u307e\u3059\u3002",3,"click",4,"ngIf"],["title","\u767b\u9332\u60c5\u5831\u3092\u524a\u9664\u3057\u3066\u3001\u3053\u306e\u7aef\u672b\u3078\u306e\u901a\u77e5\u3092\u89e3\u9664\u3057\u307e\u3059\u3002",1,"btn","btn-warning",3,"click"]],template:function(s,d){1&s&&(e.TgZ(0,"h2",0),e._uU(1,"\u901a\u77e5\u8a2d\u5b9a (\u30c6\u30b9\u30c8\u4e2d)"),e._UZ(2,"img",1),e.qZA(),e.TgZ(3,"div",2)(4,"div",3)(5,"div",4)(6,"app-switch",5),e.NdJ("checkChanged",function(I){return d.onToggleMessaging(I)}),e.qZA()()(),e.TgZ(7,"div",0)(8,"h3"),e._uU(9,"\u767b\u9332\u3055\u308c\u305f\u30c7\u30d0\u30a4\u30b9"),e.qZA(),e.TgZ(10,"div",6),e.YNc(11,Dt,4,9,"div",7),e.qZA()(),e.TgZ(12,"div")(13,"div",8)(14,"h3"),e._uU(15,"\u91cd\u8981\u5ea6"),e.qZA(),e.TgZ(16,"div",4),e._UZ(17,"app-switch",9),e.qZA()(),e.TgZ(18,"div",8)(19,"h3"),e._uU(20,"\u7a2e\u985e"),e.qZA(),e.TgZ(21,"div",4),e._UZ(22,"app-switch",10)(23,"app-switch",11)(24,"app-switch",12),e.qZA()(),e.TgZ(25,"div",8)(26,"button",13),e.NdJ("click",function(I){return d.onClickUpdateMessaging(I)}),e._uU(27,"\u66f4\u65b0"),e.qZA()()()(),e.TgZ(28,"div",14)(29,"div"),e._uU(30,"Token: "),e.TgZ(31,"div"),e._uU(32),e.qZA()(),e.TgZ(33,"div"),e._uU(34,"GetToken: "),e.YNc(35,kt,2,2,"div",15),e.qZA(),e.TgZ(36,"div"),e._uU(37,"TokenChanges: "),e.YNc(38,dt,2,2,"div",15),e.qZA(),e.TgZ(39,"div"),e._uU(40,"TokenReceived: "),e.YNc(41,Pt,2,2,"div",15),e.qZA(),e.TgZ(42,"div")(43,"div")(44,"label"),e._uU(45,"Topic: "),e.TgZ(46,"input",16),e.NdJ("ngModelChange",function(I){return d.debugObservable.topicText=I}),e.qZA()(),e.TgZ(47,"button",17),e.NdJ("click",function(I){return d.onClickSubscribeTopic(I)}),e._uU(48,"subscribe"),e.qZA(),e.TgZ(49,"button",17),e.NdJ("click",function(I){return d.onClickUnsubscribeTopic(I)}),e._uU(50,"unsubscribe"),e.qZA()(),e.TgZ(51,"div")(52,"label"),e._uU(53,"Post Title: "),e.TgZ(54,"input",16),e.NdJ("ngModelChange",function(I){return d.debugObservable.topicPostText=I}),e.qZA()(),e.TgZ(55,"button",17),e.NdJ("click",function(I){return d.onClickPostToTopic(I)}),e._uU(56,"Post"),e.qZA()(),e.TgZ(57,"div")(58,"label"),e._uU(59,"Condition Topic Post: "),e.TgZ(60,"input",16),e.NdJ("ngModelChange",function(I){return d.debugObservable.conditionTopicPostText=I}),e.qZA()(),e.TgZ(61,"button",17),e.NdJ("click",function(I){return d.onClickConditionPostToTopic(I)}),e._uU(62,"CondPost"),e.qZA()()()(),e.TgZ(63,"div")(64,"button",18),e.NdJ("click",function(I){return d.onClickClearMessages(I)}),e._uU(65,"Clear"),e.qZA(),e.TgZ(66,"div"),e._uU(67,"Messages: "),e.YNc(68,pt,3,3,"div",15),e.qZA()()),2&s&&(e.xp6(3),e.Q6J("formGroup",d.mainForm),e.xp6(3),e.Q6J("parentForm",d.mainForm),e.xp6(5),e.Q6J("ngForOf",d.devices),e.xp6(6),e.Q6J("parentForm",d.mainForm),e.xp6(5),e.Q6J("parentForm",d.mainForm),e.xp6(1),e.Q6J("parentForm",d.mainForm),e.xp6(1),e.Q6J("parentForm",d.mainForm),e.xp6(2),e.Q6J("disabled",d.configArray.invalid||!d.configArray.dirty),e.xp6(6),e.Oqu(d.debugObservable.registeredToken),e.xp6(3),e.Q6J("ngForOf",d.debugObservable.getToken),e.xp6(3),e.Q6J("ngForOf",d.debugObservable.tokenChanges),e.xp6(3),e.Q6J("ngForOf",d.debugObservable.tokenReceived),e.xp6(5),e.Q6J("ngModel",d.debugObservable.topicText),e.xp6(8),e.Q6J("ngModel",d.debugObservable.topicPostText),e.xp6(6),e.Q6J("ngModel",d.debugObservable.conditionTopicPostText),e.xp6(8),e.Q6J("ngForOf",d.debugObservable.messages))},dependencies:[O.sg,O.O5,r.Fj,r.JJ,r.JL,r.On,r.sg,lt,O.Ts,O.uU]})}return l})();const ht=["protectedSettings"],Ot=["imageBox"];function ft(l,F){1&l&&e._uU(0,"\u753b\u50cf\u304c\u3042\u308a\u307e\u305b\u3093")}function Te(l,F){if(1&l&&e._UZ(0,"img",39),2&l){const i=e.oxw().ngIf;e.s9C("src",i.photoURL,e.LSH)}}function rt(l,F){if(1&l){const i=e.EpF();e.ynx(0),e.TgZ(1,"span",40),e._uU(2," -> "),e.qZA(),e.TgZ(3,"label",8),e._uU(4,"\u65b0\u3057\u3044\u753b\u50cf"),e.qZA(),e._UZ(5,"img",41),e.TgZ(6,"button",42),e.NdJ("click",function(d){const I=e.CHM(i).ngIf,ge=e.oxw(2);return e.KtG(ge.onClickOkImage(d,I))}),e._uU(7,"\u78ba\u5b9a"),e.qZA(),e.BQk()}if(2&l){const i=F.ngIf;e.xp6(5),e.s9C("src",i,e.LSH)}}function We(l,F){1&l&&e._UZ(0,"div",43)}function it(l,F){if(1&l&&(e.TgZ(0,"div",43),e._uU(1),e.qZA()),2&l){const i=e.oxw(3);e.xp6(1),e.hij("\u6b8b\u308a ",i.nicknameResult.changesRemain," \u56de \u5909\u66f4\u3067\u304d\u307e\u3059\u3002")}}function gt(l,F){1&l&&(e.TgZ(0,"div",45),e._uU(1,"\u3053\u308c\u4ee5\u4e0a\u306f\u5909\u66f4\u3067\u304d\u307e\u305b\u3093\u3002"),e.qZA())}function st(l,F){if(1&l&&(e.ynx(0),e.YNc(1,it,2,1,"div",19)(2,gt,2,0,"div",44),e.BQk()),2&l){const i=e.oxw(2);e.xp6(1),e.Q6J("ngIf",i.nicknameResult.changesRemain>0),e.xp6(1),e.Q6J("ngIf",0===i.nicknameResult.changesRemain)}}function tt(l,F){1&l&&(e.TgZ(0,"div",45),e._uU(1,"\u5165\u529b\u5fc5\u9808\u3067\u3059\u3002"),e.qZA())}function Rt(l,F){1&l&&(e.TgZ(0,"div",45),e._uU(1,"\u9577\u3059\u304e\u307e\u3059\u3002"),e.qZA())}function nt(l,F){1&l&&(e.TgZ(0,"div",45),e._uU(1,"\u77ed\u3059\u304e\u307e\u3059\u3002"),e.qZA())}function Ut(l,F){if(1&l&&(e.ynx(0),e.YNc(1,tt,2,0,"div",44)(2,Rt,2,0,"div",44)(3,nt,2,0,"div",44),e.BQk()),2&l){const i=e.oxw(2);e.xp6(1),e.Q6J("ngIf",null==i.nicknameControl.errors?null:i.nicknameControl.errors.required),e.xp6(1),e.Q6J("ngIf",null==i.nicknameControl.errors?null:i.nicknameControl.errors.maxlength),e.xp6(1),e.Q6J("ngIf",null==i.nicknameControl.errors?null:i.nicknameControl.errors.minlength)}}function De(l,F){1&l&&e._UZ(0,"div",43)}function mt(l,F){1&l&&(e.TgZ(0,"div",45),e._uU(1,"\u9577\u3059\u304e\u307e\u3059\u3002"),e.qZA())}function Bt(l,F){if(1&l&&(e.ynx(0),e.YNc(1,mt,2,0,"div",44),e.BQk()),2&l){const i=e.oxw(2);e.xp6(1),e.Q6J("ngIf",null==i.aboutControl.errors?null:i.aboutControl.errors.maxlength)}}function _t(l,F){if(1&l&&(e.ynx(0),e._UZ(1,"hr")(2,"gitfire-user-notification",46),e.BQk()),2&l){const i=e.oxw(2);e.xp6(2),e.Q6J("mainForm",i.notificationForm)("userPrivStore$",i.userPrivate$)}}function vt(l,F){1&l&&e._UZ(0,"div",43)}function at(l,F){1&l&&(e.TgZ(0,"div",45),e._uU(1,"E \u30e1\u30fc\u30eb\u306f\u5fc5\u9808\u3067\u3059\u3002"),e.qZA())}function Ae(l,F){1&l&&(e.TgZ(0,"div",45),e._uU(1,"E \u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044\u3002"),e.qZA())}function Xe(l,F){if(1&l&&(e.ynx(0),e.YNc(1,at,2,0,"div",44)(2,Ae,2,0,"div",44),e.BQk()),2&l){const i=e.oxw(2);e.xp6(1),e.Q6J("ngIf",null==i.emailControl.errors?null:i.emailControl.errors.required),e.xp6(1),e.Q6J("ngIf",(null==i.emailControl.errors?null:i.emailControl.errors.minlength)||(null==i.emailControl.errors?null:i.emailControl.errors.maxlength))}}function Mt(l,F){1&l&&(e.TgZ(0,"div",43),e._uU(1,"\u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u5f37\u5ea6\u306f\u5145\u5206\u306b\u3057\u3066\u304f\u3060\u3055\u3044\u3002"),e.qZA())}function je(l,F){1&l&&(e.TgZ(0,"div",45),e._uU(1,"\u30d1\u30b9\u30ef\u30fc\u30c9\u306f\u5fc5\u9808\u3067\u3059\u3002"),e.qZA())}function Ct(l,F){1&l&&(e.TgZ(0,"div",45),e._uU(1,"\u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u9577\u3055\u304c\u8db3\u308a\u307e\u305b\u3093\u3002"),e.qZA())}function yt(l,F){if(1&l&&(e.ynx(0),e.YNc(1,je,2,0,"div",44)(2,Ct,2,0,"div",44),e.BQk()),2&l){const i=e.oxw(2);e.xp6(1),e.Q6J("ngIf",null==i.passwordControl.errors?null:i.passwordControl.errors.required),e.xp6(1),e.Q6J("ngIf",null==i.passwordControl.errors?null:i.passwordControl.errors.minlength)}}const ut=()=>["(\u5371\u967a)","(\u5f31\u3044)","(\u666e\u901a)","(\u5f37\u3044)","(\u5145\u5206\u306b\u5b89\u5168)"],Gt=()=>["#DD2C00","#FF6D00","#FFD600","#AEEA00","#00C853"];function ct(l,F){if(1&l){const i=e.EpF();e.ynx(0),e.TgZ(1,"div",1)(2,"form",2,3)(4,"h2",4),e._uU(5,"\u516c\u958b\u8a2d\u5b9a"),e._UZ(6,"img",5),e.qZA(),e.TgZ(7,"div")(8,"div",6)(9,"div",7)(10,"label",8),e._uU(11,"\u73fe\u5728\u306e\u753b\u50cf"),e.qZA(),e.YNc(12,ft,1,0,"ng-template",null,9,e.W1O)(14,Te,1,1,"img",10)(15,rt,8,1,"ng-container",0),e.ALo(16,"async"),e.qZA(),e.TgZ(17,"div",11),e._UZ(18,"input",12,13),e.TgZ(20,"button",14),e.NdJ("click",function(d){e.CHM(i);const T=e.oxw();return e.KtG(T.onClickUploadImage(d))}),e._uU(21,"Upload"),e.qZA()()(),e.TgZ(22,"div",15)(23,"label",16),e._uU(24,"\u30cb\u30c3\u30af\u30cd\u30fc\u30e0"),e._UZ(25,"img",17),e.qZA(),e._UZ(26,"input",18),e.TgZ(27,"button",14),e.NdJ("click",function(d){e.CHM(i);const T=e.oxw();return e.KtG(T.onClickUpdateNickname(d))}),e._uU(28,"\u66f4\u65b0"),e.qZA()(),e.YNc(29,We,1,0,"div",19)(30,st,3,2,"ng-container",0)(31,Ut,4,3,"ng-container",0),e.TgZ(32,"div",15)(33,"label",16),e._uU(34,"\u81ea\u5df1\u7d39\u4ecb"),e._UZ(35,"img",20),e.qZA(),e._UZ(36,"textarea",21),e.TgZ(37,"button",22),e.NdJ("click",function(d){e.CHM(i);const T=e.oxw();return e.KtG(T.onClickUpdateAbout(d))}),e._uU(38,"\u66f4\u65b0"),e.qZA()()(),e.YNc(39,De,1,0,"div",19)(40,Bt,2,1,"ng-container",0)(41,_t,3,2,"ng-container",0),e._UZ(42,"hr"),e.TgZ(43,"a",23),e.NdJ("click",function(d){e.CHM(i);const T=e.oxw();return e.KtG(T.onClickImportant(d))}),e._uU(44),e.qZA(),e.TgZ(45,"div",24,25)(47,"div",26)(48,"label",27),e._uU(49,"\u540d\u524d"),e._UZ(50,"img",28),e.qZA(),e._UZ(51,"input",29),e.qZA(),e.TgZ(52,"div",26)(53,"label",27),e._uU(54,"Email"),e._UZ(55,"img",30),e.qZA(),e._UZ(56,"input",31),e.TgZ(57,"button",32),e.NdJ("click",function(d){e.CHM(i);const T=e.oxw();return e.KtG(T.onClickUpdateEmail(d))}),e._uU(58,"\u66f4\u65b0"),e.qZA(),e.YNc(59,vt,1,0,"div",19)(60,Xe,3,2,"ng-container",0),e.qZA(),e.TgZ(61,"div",26)(62,"label",27),e._uU(63,"Password"),e._UZ(64,"img",33),e.qZA(),e._UZ(65,"input",34),e.TgZ(66,"button",32),e.NdJ("click",function(d){e.CHM(i);const T=e.oxw();return e.KtG(T.onClickUpdatePassword(d))}),e._uU(67,"\u66f4\u65b0"),e.qZA(),e._UZ(68,"ng9-password-strength-bar",35),e.ALo(69,"async"),e.YNc(70,Mt,2,0,"div",19)(71,yt,3,2,"ng-container",0),e.qZA(),e.TgZ(72,"h3",36),e._uU(73,"\u30a2\u30ab\u30a6\u30f3\u30c8\u306e\u7d42\u4e86"),e.qZA(),e.TgZ(74,"div",37)(75,"button",38),e.NdJ("click",function(d){e.CHM(i);const T=e.oxw();return e.KtG(T.onClickDeleteAccount(d))}),e._uU(76,"\u30a2\u30ab\u30a6\u30f3\u30c8\u3092\u524a\u9664"),e.qZA()()()()(),e.BQk()}if(2&l){const i=F.ngIf,s=e.MAs(13),d=e.oxw();e.xp6(2),e.Q6J("formGroup",d.inputForm),e.xp6(12),e.Q6J("ngIf",i.photoURL)("ngIfElse",s),e.xp6(1),e.Q6J("ngIf",e.lcZ(16,35,d.profileTempImage$)),e.xp6(5),e.Q6J("disabled",d.userIconControl.invalid||!d.userIconControl.dirty),e.xp6(2),e.ekj("was-validated",d.nicknameControl.dirty||d.nicknameControl.touched),e.xp6(5),e.Q6J("disabled",d.nicknameControl.invalid||!d.nicknameControl.dirty),e.xp6(2),e.Q6J("ngIf",!d.nicknameControl.invalid),e.xp6(1),e.Q6J("ngIf",d.nicknameResult),e.xp6(1),e.Q6J("ngIf",d.nicknameControl.invalid),e.xp6(1),e.ekj("was-validated",d.aboutControl.dirty||d.aboutControl.touched),e.xp6(5),e.Q6J("disabled",d.aboutControl.invalid||!d.aboutControl.dirty),e.xp6(2),e.Q6J("ngIf",!d.aboutControl.invalid),e.xp6(1),e.Q6J("ngIf",d.aboutControl.invalid),e.xp6(1),e.Q6J("ngIf",d.auth.isDeveloper),e.xp6(3),e.Oqu(d.isOpenOther?"\u518d\u8a8d\u8a3c":"\u305d\u306e\u4ed6\u306e\u8a2d\u5b9a"),e.xp6(7),e.Q6J("value",i.displayName),e.xp6(1),e.ekj("was-validated",d.emailControl.dirty||d.emailControl.touched),e.xp6(5),e.Q6J("disabled",d.emailControl.invalid||!d.emailControl.dirty),e.xp6(2),e.Q6J("ngIf",!d.emailControl.invalid),e.xp6(1),e.Q6J("ngIf",d.emailControl.invalid),e.xp6(1),e.ekj("was-validated",d.passwordControl.dirty||d.passwordControl.touched),e.xp6(5),e.Q6J("disabled",!d.passwordControl.value||d.passwordControl.invalid||!d.passwordControl.dirty),e.xp6(2),e.Udp("display",""===d.passwordControl.value?"none":null),e.Q6J("passwordToCheck",e.lcZ(69,37,d.passwordControl.valueChanges))("barLabel","\u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u5f37\u5ea6(\u76ee\u5b89): ")("strengthLabels",e.DdM(39,ut))("barColors",e.DdM(40,Gt)),e.xp6(2),e.Q6J("ngIf",!d.passwordControl.invalid),e.xp6(1),e.Q6J("ngIf",d.passwordControl.invalid)}}let Zt=(()=>{class l{auth;storage;funcs;store;toastr;router;dialog;localSession;destroy$=new m.x;currentUser;currentUser$;userPublic;userPrivate$=new m.x;profileTempImage$;inputForm;notificationForm;isOpenOther=!1;nicknameResult=null;protectedSettings;imageBox;pubUser;privUser;nicknameIndex;constructor(i,s,d,T,I,ge,Ke,Qe){this.auth=i,this.storage=s,this.funcs=d,this.store=T,this.toastr=I,this.router=ge,this.dialog=Ke,this.localSession=Qe,this.pubUser=this.store.collection("/users/v1/public"),this.privUser=this.store.collection("/users/v1/protected"),this.nicknameIndex=this.store.collection("/index/users/usernick"),this.currentUser$=this.auth.clientSideUser$,this.currentUser$.pipe((0,D.R)(this.destroy$)).subscribe(He=>{this.currentUser=He})}ngOnInit(){this.inputForm=new r.cw({}),this.inputForm.addControl("userIcon",new r.NI("",[r.kI.required])),this.inputForm.addControl("email",new r.NI({value:"",disabled:!1},[r.kI.required])),this.inputForm.addControl("password",new r.NI("",[])),this.inputForm.addControl("nickname",new r.NI({value:"",disabled:!0},[r.kI.required])),this.inputForm.addControl("about",new r.NI({value:"",disabled:!0},[])),this.notificationForm=new r.cw({}),this.inputForm.addControl("messaging",this.notificationForm)}ngAfterViewInit(){const i=this.currentUser$.pipe((0,k.q)(1),(0,B.h)(s=>!!s));i.pipe((0,ee.w)(s=>this.pubUser.doc(s.uid).valueChanges()),(0,D.R)(this.destroy$)).subscribe(s=>{this.userPublic=s,G(this.aboutControl,s.about),this.aboutControl.enable(),G(this.nicknameControl,s.nickname),this.nicknameControl.enable()}),i.pipe((0,ee.w)(s=>this.privUser.doc(s.uid).valueChanges()),(0,D.R)(this.destroy$)).subscribe(s=>{this.userPrivate$.next(s)}),i.pipe((0,D.R)(this.destroy$)).subscribe(s=>{this.emailControl.setValue(s.email)})}ngOnDestroy(){this.destroy$.next()}get emailControl(){return this.inputForm.get("email")}get passwordControl(){return this.inputForm.get("password")}get aboutControl(){return this.inputForm.get("about")}get nicknameControl(){return this.inputForm.get("nickname")}get userIconControl(){return this.inputForm.get("userIcon")}onClickDeleteAccount(i){this.dialog.createDefaultBuilder().prepareBody(se).setType(Q.iR.Warn).setSize(Q.PW.Default).setTitle("\u6700\u7d42\u78ba\u8a8d").okButton(()=>{this.doDeleteAccount()}).cancelButton(()=>{}).open()}doDeleteAccount(){var i=this;return(0,N.Z)(function*(){try{yield i.currentUser.delete(),(0,_.eM)("Account is deleted")}catch(d){(0,_.wb)("Error while delete account",d);const T=d instanceof Error?d.message:"Unknown error";return void i.toastr.error(`\u30a2\u30ab\u30a6\u30f3\u30c8\u3092\u524a\u9664\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002 ( ${T} )`)}i.localSession.unmarkLogin(),i.router.navigate(["/"])})()}updateError(i,s){(0,_.wb)(`Error while update tag:${i}`,s);const d=s instanceof Error?s.message:"Unknown error";this.toastr.error(`${i} \u306e\u66f4\u65b0\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002 ( ${d} )`)}updateSucceeded(i,s){this.toastr.success(`${i} \u3092 "${s}" \u306b\u66f4\u65b0\u3057\u307e\u3057\u305f\u3002`)}updateProfileImage(i){var s=this;return(0,N.Z)(function*(){if(""===i)return;const d="\u30d7\u30ed\u30d5\u30a3\u30fc\u30eb\u753b\u50cf";try{yield s.currentUser.updateProfile({photoURL:i});const I={photoURL:i,updatedAt:le.Z.firestore.FieldValue.serverTimestamp()};yield s.pubUser.doc(s.currentUser.uid).update(I),s.updateSucceeded(d,"Upload \u3057\u305f\u753b\u50cf"),s.getProfileRef("temp_profile").delete(),s.profileTempImage$=null,s.userIconControl.setValue(""),M(s.userIconControl)}catch(T){s.updateError(d,T)}})()}onClickUpdateNickname(i){var s=this;return(0,N.Z)(function*(){if(s.nicknameControl.invalid)return;const d=s.nicknameControl.value;if(d===s.userPublic.nickname)return;const T="\u30cb\u30c3\u30af\u30cd\u30fc\u30e0";try{const I={nickname:d};s.nicknameResult=yield s.funcs.call("updateNickname",I),s.updateSucceeded(T,d),M(s.nicknameControl)}catch(I){s.updateError(T,I)}})()}onClickUpdateAbout(i){var s=this;return(0,N.Z)(function*(){if(s.aboutControl.invalid)return;const d=s.aboutControl.value;if(d===s.userPublic.about)return;const T="\u81ea\u5df1\u7d39\u4ecb";try{const I={about:d};yield s.funcs.call("updateAbout",I),s.updateSucceeded(T,d),M(s.aboutControl)}catch(I){s.updateError(T,I)}})()}onClickUpdateEmail(i){var s=this;return(0,N.Z)(function*(){if(s.emailControl.invalid)return;const d=s.emailControl.value;d!==s.currentUser.email&&s.dialog.createSimpleBuilder().setType(Q.iR.Warn).setSize(Q.PW.Default).setMessage("\u767b\u9332\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u3092\u5909\u66f4\u3057\u307e\u3059\u3002\u3088\u308d\u3057\u3044\u3067\u3059\u304b\uff1f").setTitle("\u78ba\u8a8d").okButton(()=>{s.doChangeEmail(d)}).cancelButton(()=>{}).open()})()}doChangeEmail(i){var s=this;return(0,N.Z)(function*(){const d="Email";try{yield s.currentUser.updateEmail(i),yield s.currentUser.sendEmailVerification(),s.updateSucceeded(d,i),M(s.emailControl),s.toastr.info("\u78ba\u8a8d\u306e\u30e1\u30fc\u30eb\u3092\u9001\u4fe1\u3057\u307e\u3057\u305f\u3002")}catch(T){s.updateError(d,T)}})()}onClickUpdatePassword(i){var s=this;return(0,N.Z)(function*(){if(s.passwordControl.invalid)return;const d=s.passwordControl.value;if(""===d)return;const T="\u30d1\u30b9\u30ef\u30fc\u30c9";try{yield s.currentUser.updatePassword(d),s.updateSucceeded(T,"********"),M(s.passwordControl)}catch(I){s.updateError(T,I)}finally{s.passwordControl.setValue("")}})()}listProvider(){}ensureImageFile(){const i=this.imageBox.nativeElement;if(0===i.files.length)return this.toastr.error("\u30d5\u30a1\u30a4\u30eb\u3092\u9078\u629e\u3057\u3066\u304f\u3060\u3055\u3044\u3002"),null;const s=i.files[0];return s.size>=524288?(this.toastr.error("\u30d5\u30a1\u30a4\u30eb\u306e\u30b5\u30a4\u30ba\u304c\u5927\u304d\u3059\u304e\u307e\u3059\u3002(\u7d04 500kb \u307e\u3067)"),null):s}getProfileRef(i){return this.storage.ref(`/image/${this.currentUser.uid}/profile/${i}`)}onClickUploadImage(i){var s=this;return(0,N.Z)(function*(){const d=s.ensureImageFile();if(!d)return;const T=yield s.uploadProfileImage("temp_profile",d);s.profileTempImage$=T.ref.getDownloadURL()})()}uploadProfileImage(i,s){var d=this;return(0,N.Z)(function*(){return yield d.getProfileRef(i).put(s)})()}doChangePhoto(i){var s=this;return(0,N.Z)(function*(){const T=yield(yield s.uploadProfileImage("profile",i)).ref.getDownloadURL();s.updateProfileImage(T)})()}initializeReauth(i){i.currentUser=this.currentUser,i.reauthed.subscribe(()=>{new S.UO(this.protectedSettings.nativeElement).show(),this.isOpenOther=!0})}constructReauth(){return i=>{}}onClickImportant(i){(0,_.eM)("onClickImportant()"),this.dialog.createDefaultBuilder().prepareBody(z,d=>this.initializeReauth(d)).setupChild(this.constructReauth()).setType(Q.iR.Info).setSize(Q.PW.Default).setTitle("\u518d\u8a8d\u8a3c").cancelButton(()=>{}).closeButton(()=>{}).open()}onClickOkImage(i,s){const d=this.ensureImageFile();d&&this.dialog.createSimpleBuilder().setType(Q.iR.Info).setSize(Q.PW.Default).setMessage("\u753b\u50cf\u306f\u516c\u958b\u3055\u308c\u307e\u3059\u3002\u3088\u308d\u3057\u3044\u3067\u3059\u304b\uff1f").setTitle("\u78ba\u8a8d").okButton(()=>{this.doChangePhoto(d)}).cancelButton(()=>{}).open()}static \u0275fac=function(s){return new(s||l)(e.Y36(re.e),e.Y36(ce.Q1),e.Y36(Le.c),e.Y36(oe.ST),e.Y36(y._W),e.Y36(Ve.Z),e.Y36(Q.xA),e.Y36($e.m))};static \u0275cmp=e.Xpm({type:l,selectors:[["ng-component"]],viewQuery:function(s,d){if(1&s&&(e.Gf(ht,5),e.Gf(Ot,5)),2&s){let T;e.iGM(T=e.CRH())&&(d.protectedSettings=T.first),e.iGM(T=e.CRH())&&(d.imageBox=T.first)}},decls:1,vars:1,consts:[[4,"ngIf"],[1,"container"],[3,"formGroup"],["configForm",""],[1,"mb-3"],["title","\u4e00\u822c\u516c\u958b\u3055\u308c\u308b\u60c5\u5831\u3092\u7de8\u96c6\u3067\u304d\u307e\u3059\u3002","src","/assets/octicons/question.svg",1,"m-3","octicon-info","help-icon"],[1,"my-2"],[1,"input-group","my-1"],[1,"visually-hidden"],["noPhoto",""],["class","user-settings-profile-image rounded","alt","Profile \u753b\u50cf",3,"src",4,"ngIf","ngIfElse"],[1,"input-group"],["id","appGitfireInputIconFileInput","name","userIcon","formControlName","userIcon","type","file","placeholder","\u30a2\u30a4\u30b3\u30f3\u3092\u9078\u629e","accept","image/*",1,"form-control"],["imageBox",""],[1,"btn","btn-primary",3,"disabled","click"],[1,"input-group","my-2"],[1,"input-group-text"],["title","\u30e1\u30c3\u30bb\u30fc\u30b8\u4e0a\u306b\u8868\u793a\u3055\u308c\u308b\u3042\u306a\u305f\u306e\u540d\u524d\u3067\u3059\u3002","src","/assets/octicons/question.svg",1,"m-1","octicon-info","help-icon"],["name","nickname","placeholder","\u4f8b: hogehoge1032","formControlName","nickname","autofocus","","type","text","maxlength","19","minlength","4","required","",1,"form-control"],["class","valid-feedback",4,"ngIf"],["title","\u30d5\u30ea\u30fc\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u3067\u3059\u3002","src","/assets/octicons/question.svg",1,"m-1","octicon-info","help-icon"],["name","about","placeholder","\u4f8b: Ingress: kagura2718 (RES) \u30dd\u30b1\u30e2\u30f3go: kagura271(\u8d64)","formControlName","about","maxlength","200","type","text",1,"form-control"],["type","button",1,"btn","btn-primary",3,"disabled","click"],["role","button","aria-expanded","false",1,"btn","btn-secondary","collapsed",3,"click"],["id","appGitfireUserSettingsSecretContainer",1,"collapse","m-3"],["protectedSettings",""],[1,"row","input-group","m-3"],[1,"col-2","text-md-end","col-form-label"],["title","\u8a8d\u8a3c\u30d7\u30ed\u30d0\u30a4\u30c0\u304b\u3089\u63d0\u4f9b\u3055\u308c\u305f\u540d\u524d\u3067\u3059\u3002(\u975e\u516c\u958b)","src","/assets/octicons/question.svg",1,"m-1","octicon-info","help-icon"],["name","displayname","placeholder","\u4f8b: hogehoge1032","type","text","disabled","",1,"col-10","form-control",3,"value"],["title","\u8a8d\u8a3c\u306b\u4f7f\u308f\u308c\u308b\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u3067\u3059\u3002(\u975e\u516c\u958b)","src","/assets/octicons/question.svg",1,"m-1","octicon-info","help-icon"],["name","email","placeholder","email@example.com","formControlName","email","autocomplete","email","type","email","required","","autofill","","maxlength","1024","minlength","5",1,"col-8","form-control"],[1,"btn","btn-primary","col-2",3,"disabled","click"],["title","\u30ed\u30b0\u30a4\u30f3\u6642\u306e\u30d1\u30b9\u30ef\u30fc\u30c9\u3067\u3059\u3002\u4ed6\u4eba\u306b\u63a8\u6e2c\u3055\u308c\u306a\u3044\u3082\u306e\u3092\u4f7f\u7528\u3057\u3066\u304f\u3060\u3055\u3044\u3002(\u975e\u516c\u958b)","src","/assets/octicons/question.svg",1,"m-1","octicon-info","help-icon"],["name","password","placeholder","\u5909\u66f4\u306a\u3057","formControlName","password","type","password","autocomplete","new-password","maxlength","256","minlength","6",1,"col-8","form-control"],[1,"col-lg-5","col-form-label",3,"passwordToCheck","barLabel","strengthLabels","barColors"],[1,"m-3"],[1,"input-group","m-3"],["tabindex","-1",1,"btn","btn-warning",3,"click"],["alt","Profile \u753b\u50cf",1,"user-settings-profile-image","rounded",3,"src"],[1,"p-3"],["alt","\u65b0\u3057\u3044 Profile \u753b\u50cf",1,"user-settings-profile-image","rounded",3,"src"],[1,"btn","btn-primary",3,"click"],[1,"valid-feedback"],["class","invalid-feedback",4,"ngIf"],[1,"invalid-feedback"],[3,"mainForm","userPrivStore$"]],template:function(s,d){1&s&&e.YNc(0,ct,77,41,"ng-container",0),2&s&&e.Q6J("ngIf",d.currentUser)},dependencies:[O.O5,r._Y,r.Fj,r.JJ,r.JL,r.Q7,r.wO,r.nD,r.sg,r.u,A.e,xt,O.Ov],styles:[".user-settings-profile-image[_ngcontent-%COMP%]{width:80px;height:80px}.help-icon[_ngcontent-%COMP%]{width:20px;height:20px}"]})}return l})();function bt(l,F){if(1&l&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&l){const i=e.oxw().$implicit;e.xp6(1),e.hij("URL: ",i.url,"")}}function Nt(l,F){if(1&l&&(e.TgZ(0,"div")(1,"div")(2,"div"),e._uU(3),e.qZA(),e.YNc(4,bt,2,1,"div",0),e.TgZ(5,"div"),e._uU(6),e.qZA(),e.TgZ(7,"div"),e._uU(8),e.ALo(9,"date"),e.qZA()(),e._UZ(10,"hr"),e.TgZ(11,"div"),e._uU(12),e.qZA()()),2&l){const i=F.$implicit;e.xp6(3),e.hij("Title: ",i.title,""),e.xp6(1),e.Q6J("ngIf",i.url),e.xp6(2),e.hij("Done: ",i.hasRead,""),e.xp6(2),e.hij("Date: ",e.xi3(9,5,i.createdAt.toDate(),"yyyy-MM-dd hh:mm:ss"),""),e.xp6(4),e.Oqu(i.body)}}let Tt=(()=>{class l{auth;route;store;destroy$=new m.x;id$;trayStore;constructor(i,s,d){this.auth=i,this.route=s,this.store=d}ngOnDestroy(){this.destroy$.next()}ngOnInit(){(0,_.eM)("UserTrayMessageComponent.OnInit()",this.route.snapshot),this.id$=this.route.queryParams.pipe((0,B.h)(i=>"id"in i),(0,_e.U)(i=>i.id)),this.id$.pipe((0,ee.w)(i=>(0,Fe.a)((0,ye.of)(i),this.auth.clientSideUser$)),(0,B.h)(([i,s])=>null!==s),(0,ee.w)(([i,s])=>this.store.doc(`/users/v1/protected/${s.uid}/tray/${i}`).valueChanges({idField:"id"}).pipe((0,k.q)(1))),(0,D.R)(this.destroy$)).subscribe(i=>{this.trayStore=i})}static \u0275fac=function(s){return new(s||l)(e.Y36(re.e),e.Y36(R.gz),e.Y36(oe.ST))};static \u0275cmp=e.Xpm({type:l,selectors:[["app-user-tray-message"]],decls:1,vars:1,consts:[[4,"ngIf"]],template:function(s,d){1&s&&e.YNc(0,Nt,13,8,"div",0),2&s&&e.Q6J("ngIf",d.trayStore)},dependencies:[O.O5,O.uU]})}return l})(),c=(()=>{class l{auth;localSession;router;constructor(i,s,d){this.auth=i,this.localSession=s,this.router=d,(0,_.eM)("AuthGuard.constructor")}canActivate(i,s){return this.auth.clientSideUser$.pipe((0,_e.U)(d=>{if((0,_.H_)("AuthGuard",d),d)return!0;const T={queryParams:{redirectPath:s.url}};return(0,_.eM)("auth.guard Prepare to redirect",T),this.router.createUrlTree(["/Gitfire/login"],T)}))}static \u0275fac=function(s){return new(s||l)(e.LFG(re.e),e.LFG($e.m),e.LFG(R.F0))};static \u0275prov=e.Yz7({token:l,factory:l.\u0275fac,providedIn:"root"})}return l})(),h=(()=>{class l{auth;localSession;router;constructor(i,s,d){this.auth=i,this.localSession=s,this.router=d}canActivate(i,s){return this.auth.authState.pipe((0,_e.U)(d=>((0,_.H_)("LoginGuard",d),!d||this.router.createUrlTree(["/"]))))}static \u0275fac=function(s){return new(s||l)(e.LFG(he.zQ),e.LFG($e.m),e.LFG(R.F0))};static \u0275prov=e.Yz7({token:l,factory:l.\u0275fac,providedIn:"root"})}return l})();const P=[{path:"login.htm",loadChildren:()=>Promise.resolve().then(f.bind(f,3128)).then(l=>l.GitfireLoginModule),data:{mode:"login"},canActivate:[h]},{path:"login",redirectTo:"login.htm"},{path:"signup.htm",loadChildren:()=>Promise.resolve().then(f.bind(f,3128)).then(l=>l.GitfireLoginModule),data:{mode:"signup"},canActivate:[h]},{path:"signup",redirectTo:"signup.htm"},{path:"reset.htm",loadChildren:()=>Promise.resolve().then(f.bind(f,3128)).then(l=>l.GitfireLoginModule),data:{mode:"reset"}},{path:"reset",redirectTo:"reset.htm"},{path:"chat.htm",loadChildren:()=>Promise.all([f.e(592),f.e(918)]).then(f.bind(f,5918)).then(l=>l.GitfireChatModule),canActivate:[c]},{path:"chat",redirectTo:"chat.htm"},{path:"post.htm",loadChildren:()=>f.e(284).then(f.bind(f,3284)).then(l=>l.GitfirePostModule),canActivate:[c]},{path:"post",redirectTo:"post.htm"},{path:"settings.htm",component:Zt,canActivate:[c]},{path:"settings",redirectTo:"settings.htm"},{path:"tray.htm",component:Tt,canActivate:[c]},{path:"tray",redirectTo:"tray.htm"}];let L=(()=>{class l{static \u0275fac=function(s){return new(s||l)};static \u0275mod=e.oAB({type:l});static \u0275inj=e.cJS({imports:[R.Bz.forChild(P),R.Bz]})}return l})();var H=f(3128),u=f(1134),g=f(6450),w=f(7910);let q=(()=>{class l{static \u0275fac=function(s){return new(s||l)};static \u0275mod=e.oAB({type:l});static \u0275inj=e.cJS({providers:[w.K,g.F],imports:[O.ez,r.u5,r.UX,u.M]})}return l})();var de=f(5101);let ie=(()=>{class l{constructor(){(0,_.H_)("Dynamically loaded GitfireModule")}static \u0275fac=function(s){return new(s||l)};static \u0275mod=e.oAB({type:l});static \u0275inj=e.cJS({providers:[y._W,re.e,c,h,Le.c,{provide:ue.Xz,useValue:_.NZ.FirebaseCloudFunctionsRegion},{provide:U,useValue:_.NZ.firebaseVapidKey}],imports:[O.ez,r.u5,r.UX,L,H.GitfireLoginModule,q,A._,y.Rh.forRoot(_.NZ.toastrConfig),K.hO.initializeApp(_.NZ.firebaseConfig),oe.yb,he.ww,ce.TE,ue.Qv,b,de.R]})}return l})()},3128:(It,xe,f)=>{f.r(xe),f.d(xe,{GitfireLoginModule:()=>R});var O=f(6814),r=f(5739),K=f(7217),ue=f(5579),oe=f(434),he=f(2425),ce=f(5187),N=f(553),e=f(9212),Pe=f(8645),me=f(8337);let ye=(()=>{class m{router;destroy$=new Pe.x;constructor(k){this.router=k}ngOnInit(){(0,N.eM)("LoginComponent.OnInit()")}ngOnDestroy(){this.destroy$.next()}static \u0275fac=function(B){return new(B||m)(e.Y36(ce.F0))};static \u0275cmp=e.Xpm({type:m,selectors:[["gitfire-login"]],decls:12,vars:1,consts:[[1,"h3","mb-3","fw-normal"],[3,"isLogin"],["routerLink","/Gitfire/signup"],["routerLink","/Gitfire/reset"],["routerLink","/"]],template:function(B,_){1&B&&(e.TgZ(0,"h1",0),e._uU(1,"\u30ed\u30b0\u30a4\u30f3\u60c5\u5831"),e.qZA(),e._UZ(2,"gitfire-login-input-auth",1),e.TgZ(3,"div")(4,"a",2),e._uU(5,"\u30a2\u30ab\u30a6\u30f3\u30c8\u3092\u4f5c\u6210\u3059\u308b"),e.qZA()(),e.TgZ(6,"div")(7,"a",3),e._uU(8,"\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u5fd8\u308c\u305f\u5834\u5408"),e.qZA()(),e.TgZ(9,"div")(10,"a",4),e._uU(11,"Top"),e.qZA()()),2&B&&(e.xp6(2),e.Q6J("isLogin",!0))},dependencies:[ce.rH,me.InputAuthComponent]})}return m})();var fe=f(3867);const Re=["app-cookie-confirm",""];function Ze(m,D){if(1&m){const k=e.EpF();e.TgZ(0,"button",4),e.NdJ("click",function(){e.CHM(k);const _=e.oxw();return e.KtG(_.remove())}),e.TgZ(1,"span",5),e._uU(2,"\xd7"),e.qZA()()}}let X=(()=>{class m extends he.FN{toastr;toastPackage;localSession;constructor(k,B,_){super(k,B),this.toastr=k,this.toastPackage=B,this.localSession=_}ngOnInit(){(0,N.eM)("CookieConfirmComponent.OnInit()")}onClickDeny(k){this.localSession.declineAccess(),this.remove()}onClickGrant(k){this.localSession.grantAccess(),this.remove()}static \u0275fac=function(B){return new(B||m)(e.Y36(he._W),e.Y36(he.PR),e.Y36(fe.m))};static \u0275cmp=e.Xpm({type:m,selectors:[["","app-cookie-confirm",""]],features:[e.qOj],attrs:Re,decls:12,vars:4,consts:[["class","toast-close-button","aria-label","Close",3,"click",4,"ngIf"],["role","alertdialog","aria-live","polite"],["href","/terms.htm"],[1,"btn","btn-outline-primary",3,"click"],["aria-label","Close",1,"toast-close-button",3,"click"],["aria-hidden","true"]],template:function(B,_){1&B&&(e.YNc(0,Ze,3,0,"button",0),e.TgZ(1,"div",1)(2,"p"),e._uU(3,"\u5f53\u30b5\u30a4\u30c8\u3067\u306f\u5229\u7528\u8005\u306e\u5229\u4fbf\u6027\u306e\u305f\u3081\u306b\u30af\u30c3\u30ad\u30fc (Cookies) \u3092\u4f7f\u7528\u3057\u307e\u3059\u3002\u8a73\u3057\u304f\u306f"),e.TgZ(4,"a",2),e._uU(5," [\u5229\u7528\u898f\u7d04] "),e.qZA(),e._uU(6,"\u3092\u3054\u89a7\u304f\u3060\u3055\u3044\u3002"),e.qZA(),e.TgZ(7,"div")(8,"button",3),e.NdJ("click",function(pe){return _.onClickGrant(pe)}),e._uU(9,"\u8a31\u53ef\u3059\u308b"),e.qZA(),e.TgZ(10,"button",3),e.NdJ("click",function(pe){return _.onClickDeny(pe)}),e._uU(11,"\u62d2\u5426\u3059\u308b"),e.qZA()()()),2&B&&(e.Q6J("ngIf",_.options.closeButton),e.xp6(1),e.Tol(_.options.messageClass),e.uIk("aria-label",_.message))},styles:["[_nghost-%COMP%]{background:#eefef0;width:100%;height:100%}a[_ngcontent-%COMP%]:link{color:red}a[_ngcontent-%COMP%]:visited{color:#a00}a[_ngcontent-%COMP%]:hover{color:red}a[_ngcontent-%COMP%]:active{color:#ff8000}"]})}return m})(),ae=(()=>{class m{toastr;localSession;constructor(k,B){this.toastr=k,this.localSession=B}ngOnInit(){(0,N.eM)("SignupComponent.OnInit()")}ngAfterViewInit(){this.maybeConfirm()}maybeConfirm(){this.localSession.shouldConfirm()&&this.toastr.info(void 0,void 0,{toastComponent:X,disableTimeOut:!0,tapToDismiss:!1,preventDuplicates:!0})}static \u0275fac=function(B){return new(B||m)(e.Y36(he._W),e.Y36(fe.m))};static \u0275cmp=e.Xpm({type:m,selectors:[["gitfire-signup"]],decls:9,vars:1,consts:[[1,"h3","mb-3","fw-normal"],[3,"isSignup"],["routerLink","/Gitfire/login"],["routerLink","/"]],template:function(B,_){1&B&&(e.TgZ(0,"h1",0),e._uU(1,"\u30a2\u30ab\u30a6\u30f3\u30c8\u306e\u4f5c\u6210"),e.qZA(),e._UZ(2,"gitfire-login-input-auth",1),e.TgZ(3,"div")(4,"a",2),e._uU(5,"\u30ed\u30b0\u30a4\u30f3"),e.qZA()(),e.TgZ(6,"div")(7,"a",3),e._uU(8,"Top"),e.qZA()()),2&B&&(e.xp6(2),e.Q6J("isSignup",!0))},dependencies:[ce.rH,me.InputAuthComponent]})}return m})();var ee=f(5861),_e=f(7319),Y=f(103);const V=["resetForm"];function Oe(m,D){1&m&&(e.TgZ(0,"div",11),e._uU(1,"E \u30e1\u30fc\u30eb\u306f\u5fc5\u9808\u3067\u3059\u3002"),e.qZA())}function Ie(m,D){1&m&&(e.TgZ(0,"div",11),e._uU(1,"E \u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044\u3002"),e.qZA())}function Se(m,D){if(1&m&&(e.ynx(0),e.YNc(1,Oe,2,0,"div",10)(2,Ie,2,0,"div",10),e.BQk()),2&m){e.oxw();const k=e.MAs(6);e.xp6(1),e.Q6J("ngIf",null==k.errors?null:k.errors.required),e.xp6(1),e.Q6J("ngIf",null==k.errors?null:k.errors.minlength)}}let le=(()=>{class m{auth;dialog;toastr;emailInput="";resetForm;constructor(k,B,_){this.auth=k,this.dialog=B,this.toastr=_}ngOnInit(){(0,N.eM)("ResetPasswordComponent.OnInit()")}onClickReset(k){this.dialog.createSimpleBuilder().setType(_e.iR.Warn).setSize(_e.PW.Default).setTitle("\u78ba\u8a8d").setMessage(`\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u306f\u6b63\u3057\u3044\u3067\u3059\u304b\uff1f ${this.emailInput}`).okButton(()=>{this.tryResetPassword(this.emailInput)}).cancelButton(()=>{}).open()}tryResetPassword(k){var B=this;return(0,ee.Z)(function*(){try{yield B.auth.sendPasswordResetEmail(k),B.toastr.info("\u30e1\u30fc\u30eb\u3092\u9001\u4fe1\u3057\u307e\u3057\u305f\u3002")}catch(_){(0,N.wb)("Error while sent reset mail",_),Error,B.toastr.error("\u5931\u6557\u3057\u307e\u3057\u305f\u3002( ${errmsg} )")}})()}static \u0275fac=function(B){return new(B||m)(e.Y36(oe.zQ),e.Y36(Y.xA),e.Y36(he._W))};static \u0275cmp=e.Xpm({type:m,selectors:[["gitfire-login-reset-password"]],viewQuery:function(B,_){if(1&B&&e.Gf(V,5),2&B){let Q;e.iGM(Q=e.CRH())&&(_.resetForm=Q.first)}},decls:19,vars:5,consts:[["resetForm",""],[1,"row","p-3"],[1,"visually-hidden"],["autofocus","","type","email","name","email","placeholder","Email address","required","","autofill","","maxlength","1024","minlength","5",1,"form-control","col-8",3,"ngModel","ngModelChange"],["email","ngModel"],[1,"btn","btn-warning",3,"disabled","click"],[4,"ngIf"],["routerLink","/"],["routerLink","/Gitfire/signup"],["routerLink","/Gitfire/login"],["class","invalid-feedback",4,"ngIf"],[1,"invalid-feedback"]],template:function(B,_){if(1&B&&(e.TgZ(0,"form",null,0)(2,"div",1)(3,"label",2),e._uU(4,"Email"),e.qZA(),e.TgZ(5,"input",3,4),e.NdJ("ngModelChange",function(pe){return _.emailInput=pe}),e.qZA(),e.TgZ(7,"button",5),e.NdJ("click",function(pe){return _.onClickReset(pe)}),e._uU(8,"\u30d1\u30b9\u30ef\u30fc\u30c9\u30ea\u30bb\u30c3\u30c8"),e.qZA(),e.YNc(9,Se,3,2,"ng-container",6),e.qZA()(),e.TgZ(10,"div")(11,"a",7),e._uU(12,"Top"),e.qZA()(),e.TgZ(13,"div")(14,"a",8),e._uU(15,"\u30a2\u30ab\u30a6\u30f3\u30c8\u3092\u4f5c\u6210\u3059\u308b"),e.qZA()(),e.TgZ(16,"div")(17,"a",9),e._uU(18,"\u30ed\u30b0\u30a4\u30f3"),e.qZA()()),2&B){const Q=e.MAs(6);e.xp6(2),e.ekj("was-validated",Q.dirty||Q.touched),e.xp6(3),e.Q6J("ngModel",_.emailInput),e.xp6(2),e.Q6J("disabled",!Q.valid),e.xp6(2),e.Q6J("ngIf",Q.invalid)}},dependencies:[O.O5,r._Y,r.Fj,r.JJ,r.JL,r.Q7,r.wO,r.nD,r.On,r.F,ce.rH]})}return m})();function x(m,D){1&m&&e._UZ(0,"gitfire-signup")}function U(m,D){1&m&&e._UZ(0,"gitfire-login")}function j(m,D){1&m&&e._UZ(0,"gitfire-login-reset-password")}const b=[{path:"",component:(()=>{class m{route;mode;constructor(k){this.route=k,this.mode=k.snapshot.data.mode}ngOnInit(){(0,N.eM)("LoginRouterComponent.OnInit()")}static \u0275fac=function(B){return new(B||m)(e.Y36(ce.gz))};static \u0275cmp=e.Xpm({type:m,selectors:[["ng-component"]],decls:4,vars:4,consts:[[3,"ngSwitch"],[4,"ngSwitchCase"]],template:function(B,_){1&B&&(e.ynx(0,0),e.YNc(1,x,1,0,"gitfire-signup",1)(2,U,1,0,"gitfire-login",1)(3,j,1,0,"gitfire-login-reset-password",1),e.BQk()),2&B&&(e.Q6J("ngSwitch",_.mode),e.xp6(1),e.Q6J("ngSwitchCase","signup"),e.xp6(1),e.Q6J("ngSwitchCase","login"),e.xp6(1),e.Q6J("ngSwitchCase","reset"))},dependencies:[O.RF,O.n9,ye,ae,le]})}return m})()}];let y=(()=>{class m{static \u0275fac=function(B){return new(B||m)};static \u0275mod=e.oAB({type:m});static \u0275inj=e.cJS({imports:[ce.Bz.forChild(b),ce.Bz]})}return m})();var A=f(2589);let R=(()=>{class m{static \u0275fac=function(B){return new(B||m)};static \u0275mod=e.oAB({type:m});static \u0275inj=e.cJS({providers:[he._W],imports:[O.ez,r.u5,r.UX,y,he.Rh.forRoot(N.NZ.toastrConfig),K.hO.initializeApp(N.NZ.firebaseConfig),ue.yb,oe.ww,A._]})}return m})()},8337:(It,xe,f)=>{f.r(xe),f.d(xe,{InputAuthComponent:()=>qe});var O=f(5861),r=f(9212),K=f(5739),ue=f(8645),oe=f(5619),he=f(2459),ce=f(9773),N=f(8180),e=f(7142),me=(f(752),f(553)),ye=f(434),fe=f(2425),Re=f(5187),Ze=f(6814),X=f(2589),ae=f(9240);const ee=["mainForm"],_e=["confirmPasswordInput"];function Y(Z,z){1&Z&&(r.TgZ(0,"div",15),r._uU(1,"OK!"),r.qZA())}function V(Z,z){1&Z&&(r.TgZ(0,"div",17),r._uU(1,"E \u30e1\u30fc\u30eb\u306f\u5fc5\u9808\u3067\u3059\u3002"),r.qZA())}function Oe(Z,z){1&Z&&(r.TgZ(0,"div",17),r._uU(1,"E \u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044\u3002"),r.qZA())}function Ie(Z,z){if(1&Z&&(r.ynx(0),r.YNc(1,V,2,0,"div",16)(2,Oe,2,0,"div",16),r.BQk()),2&Z){const S=r.oxw();r.xp6(1),r.Q6J("ngIf",null==S.emailControl.errors?null:S.emailControl.errors.required),r.xp6(1),r.Q6J("ngIf",null==S.emailControl.errors?null:S.emailControl.errors.minlength)}}function Se(Z,z){1&Z&&(r.TgZ(0,"div",15),r._uU(1,"\u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u5f37\u5ea6\u306f\u5145\u5206\u306b\u3057\u3066\u304f\u3060\u3055\u3044\u3002"),r.qZA())}function le(Z,z){1&Z&&(r.TgZ(0,"div",17),r._uU(1,"\u30d1\u30b9\u30ef\u30fc\u30c9\u306f\u5fc5\u9808\u3067\u3059\u3002"),r.qZA())}function x(Z,z){1&Z&&(r.TgZ(0,"div",17),r._uU(1,"\u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u9577\u3055\u304c\u8db3\u308a\u307e\u305b\u3093\u3002"),r.qZA())}function U(Z,z){if(1&Z&&(r.ynx(0,18),r.YNc(1,le,2,0,"div",16)(2,x,2,0,"div",16),r.BQk()),2&Z){const S=r.oxw();r.xp6(1),r.Q6J("ngIf",null==S.passwordControl.errors?null:S.passwordControl.errors.required),r.xp6(1),r.Q6J("ngIf",null==S.passwordControl.errors?null:S.passwordControl.errors.minlength)}}const j=()=>["(\u5371\u967a)","(\u5f31\u3044)","(\u666e\u901a)","(\u5f37\u3044)","(\u5145\u5206\u306b\u5b89\u5168)"],C=()=>["#DD2C00","#FF6D00","#FFD600","#AEEA00","#00C853"];function b(Z,z){if(1&Z&&(r._UZ(0,"ng9-password-strength-bar",19),r.ALo(1,"async")),2&Z){const S=r.oxw();r.Q6J("passwordToCheck",r.lcZ(1,4,S.passwordControl.valueChanges))("barLabel","\u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u5f37\u5ea6(\u76ee\u5b89): ")("strengthLabels",r.DdM(6,j))("barColors",r.DdM(7,C))}}function y(Z,z){1&Z&&(r.TgZ(0,"div",15),r._uU(1,"\u4e00\u81f4\u3057\u307e\u3057\u305f\uff01"),r.qZA())}function A(Z,z){1&Z&&(r.TgZ(0,"div",17),r._uU(1,"\u30d1\u30b9\u30ef\u30fc\u30c9\u306f\u5fc5\u9808\u3067\u3059\u3002"),r.qZA())}function R(Z,z){1&Z&&(r.TgZ(0,"div",17),r._uU(1,"\u30d1\u30b9\u30ef\u30fc\u30c9\u304c\u4e00\u81f4\u3057\u307e\u305b\u3093\u3002"),r.qZA())}function m(Z,z){if(1&Z&&(r.ynx(0),r.YNc(1,A,2,0,"div",16)(2,R,2,0,"div",16),r.BQk()),2&Z){const S=r.oxw(2);r.xp6(1),r.Q6J("ngIf",null==S.confirmPasswordControl.errors?null:S.confirmPasswordControl.errors.required),r.xp6(1),r.Q6J("ngIf",null==S.confirmPasswordControl.errors?null:S.confirmPasswordControl.errors.passwordMisMatch)}}function D(Z,z){if(1&Z&&(r.TgZ(0,"div",2)(1,"label",20),r._uU(2,"Confirm Password"),r.qZA(),r._UZ(3,"input",21,22),r.YNc(5,y,2,0,"div",5)(6,m,3,2,"ng-container",6),r.qZA()),2&Z){const S=r.oxw();r.ekj("was-validated",S.confirmPasswordControl.dirty||S.confirmPasswordControl.touched),r.xp6(3),r.Q6J("autocomplete",S.passwordAutocomplete),r.xp6(2),r.Q6J("ngIf",!S.confirmPasswordControl.invalid),r.xp6(1),r.Q6J("ngIf",S.confirmPasswordControl.invalid)}}function k(Z,z){1&Z&&(r.TgZ(0,"div",29),r._uU(1,"OK!"),r.qZA())}function B(Z,z){1&Z&&(r.TgZ(0,"div",31),r._uU(1,"\u898f\u7d04\u306b\u540c\u610f\u3057\u3066\u3044\u305f\u3060\u304f\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002"),r.qZA())}function _(Z,z){if(1&Z&&(r.ynx(0),r.YNc(1,B,2,0,"div",30),r.BQk()),2&Z){const S=r.oxw(2);r.xp6(1),r.Q6J("ngIf",null==S.agreeTosControl.errors?null:S.agreeTosControl.errors.required)}}function Q(Z,z){if(1&Z&&(r.TgZ(0,"div",23)(1,"label",24),r._uU(2,"\u898f\u7d04\u306b\u540c\u610f\u3059\u308b"),r.qZA(),r._UZ(3,"input",25),r.TgZ(4,"a",26),r._uU(5," [\u5229\u7528\u898f\u7d04] "),r.qZA(),r.TgZ(6,"span",27),r._uU(7,"\u306b\u540c\u610f\u3057\u307e\u3059\u3002"),r.qZA(),r.YNc(8,k,2,0,"div",28)(9,_,2,1,"ng-container",6),r.qZA()),2&Z){const S=r.oxw();r.ekj("was-validated",S.agreeTosControl.dirty||S.agreeTosControl.touched),r.xp6(8),r.Q6J("ngIf",!S.agreeTosControl.invalid),r.xp6(1),r.Q6J("ngIf",S.agreeTosControl.invalid)}}function pe(Z,z){if(1&Z){const S=r.EpF();r.TgZ(0,"button",32),r.NdJ("click",function(M){r.CHM(S);const re=r.oxw();return r.KtG(re.onClickSignup(M))}),r._uU(1,"\u30a2\u30ab\u30a6\u30f3\u30c8\u4f5c\u6210"),r.qZA()}if(2&Z){const S=r.oxw();r.Q6J("disabled",!S.inputAuthForm.valid)}}function se(Z,z){if(1&Z){const S=r.EpF();r.TgZ(0,"button",32),r.NdJ("click",function(M){r.CHM(S);const re=r.oxw();return r.KtG(re.onClickLogin(M))}),r._UZ(1,"img",33),r._uU(2,"\u30ed\u30b0\u30a4\u30f3"),r.qZA()}if(2&Z){const S=r.oxw();r.Q6J("disabled",!S.inputAuthForm.valid)}}function be(Z,z){if(1&Z){const S=r.EpF();r.TgZ(0,"button",32),r.NdJ("click",function(M){r.CHM(S);const re=r.oxw();return r.KtG(re.onClickReauth(M))}),r._UZ(1,"img",33),r._uU(2,"\u518d\u8a8d\u8a3c"),r.qZA()}if(2&Z){const S=r.oxw();r.Q6J("disabled",!S.inputAuthForm.valid)}}function te(Z,z){if(1&Z){const S=r.EpF();r.TgZ(0,"app-oauth-federations",34),r.NdJ("loginSucceeded",function(){r.CHM(S);const M=r.oxw();return r.KtG(M.onOauthLoginSucceeded())})("loginFailed",function(M){r.CHM(S);const re=r.oxw();return r.KtG(re.onOauthLoginFailed(M))}),r.qZA()}}let qe=(()=>{class Z{auth;toastr;router;route;isLogin=!1;isReauth=!1;reauthUser=null;isSignup=!1;showFederations=!0;reauthed=new r.vpe;destroy$=new ue.x;inputAuthForm;loginUser$=new oe.X(null);passwordAutocomplete;mainForm;confirmPasswordInput;constructor(S,G,M,re){this.auth=S,this.toastr=G,this.router=M,this.route=re}ngOnInit(){this.passwordAutocomplete=this.isSignup?"new-password":"current-password",this.inputAuthForm=new K.cw({}),this.inputAuthForm.addControl("email",new K.NI("")),this.inputAuthForm.addControl("password",new K.NI("")),this.isSignup&&(this.inputAuthForm.addControl("retypePassword",new K.NI("")),this.inputAuthForm.addControl("agreeTosCheck",new K.NI(!1)),this.inputAuthForm.setValidators([this.validateXFPassword.bind(this)])),this.inputAuthForm.disable(),this.initializeAuthForm()}ngOnDestroy(){this.destroy$.next()}ngAfterViewInit(){this.auth.authState.pipe((0,ce.R)(this.destroy$)).subscribe(S=>{this.loginUser$.next(S)})}navigateAfterSucceeded(){this.route.queryParams.pipe((0,ce.R)(this.destroy$),(0,N.q)(1)).subscribe(S=>{const G=S.redirectPath;this.router.navigate(G?[G]:["/"])})}erroredConnected(S){(0,me.wb)("error while connecting account",S);const G=S instanceof Error?S.message:"Unknown error";this.toastr.error(`Login \u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002 \n ( ${G} )`)}loginSucceeded(){this.toastr.success("Login \u3057\u307e\u3057\u305f\u3002"),this.navigateAfterSucceeded()}connectSucceeded(S){this.toastr.success("Sign-up \u3057\u307e\u3057\u305f\u3002"),this.navigateAfterSucceeded()}get emailControl(){return this.inputAuthForm.get("email")}get passwordControl(){return this.inputAuthForm.get("password")}get confirmPasswordControl(){return this.inputAuthForm.get("retypePassword")}get agreeTosControl(){return this.inputAuthForm.get("agreeTosCheck")}validateXFPassword(S){const G=S.get("password"),M=S.get("retypePassword");return G.value!==M.value?(M.setErrors({passwordMisMatch:!0}),this.confirmPasswordInput&&this.confirmPasswordInput.nativeElement.setCustomValidity("create error state"),null):(this.confirmPasswordInput&&this.confirmPasswordInput.nativeElement.setCustomValidity(""),M.setErrors(null),null)}validateAuthForm(){return this.inputAuthForm.markAllAsTouched(),!this.inputAuthForm.invalid||((0,me.wb)("Assert! Button should be disabled."),!1)}initializeAuthForm(){(0,he.D)(this.auth.setPersistence(e.Z.auth.Auth.Persistence.SESSION)).pipe((0,N.q)(1),(0,ce.R)(this.destroy$)).subscribe({next:()=>{this.inputAuthForm.enable()},error:S=>{this.toastr.error("\u8a8d\u8a3c Server \u3092\u521d\u671f\u5316\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002")}})}onClickSignup(S){var G=this;return(0,O.Z)(function*(){if(S.preventDefault(),G.validateAuthForm())try{const M=yield G.auth.createUserWithEmailAndPassword(G.emailControl.value,G.passwordControl.value);G.toastr.info("\u30a2\u30ab\u30a6\u30f3\u30c8\u3092\u4f5c\u6210\u3057\u307e\u3057\u305f\u3002\u30e1\u30fc\u30eb\u3092\u78ba\u8a8d\u3057\u3066\u304f\u3060\u3055\u3044\u3002"),yield M.user.sendEmailVerification(),G.navigateAfterSucceeded()}catch(M){(0,me.wb)("Error while reject",M);const re=M instanceof Error?M.message:"Unknown error";G.toastr.error(`\u30a2\u30ab\u30a6\u30f3\u30c8\u306e\u4f5c\u6210\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002\u6700\u521d\u304b\u3089\u3084\u308a\u76f4\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n ( ${re} )`)}})()}onClickLogin(S){var G=this;return(0,O.Z)(function*(){if(S.preventDefault(),G.validateAuthForm())try{yield G.auth.signInWithEmailAndPassword(G.emailControl.value,G.passwordControl.value),G.loginSucceeded()}catch(M){G.erroredConnected(M)}})()}onClickReauth(S){var G=this;return(0,O.Z)(function*(){if(S.preventDefault(),G.validateAuthForm())try{const M=e.Z.auth.EmailAuthProvider.credential(G.emailControl.value,G.passwordControl.value);yield G.reauthUser.reauthenticateWithCredential(M),G.reauthed.next()}catch(M){G.erroredConnected(M)}})()}onOauthLoginFailed(S){this.erroredConnected(S)}onOauthLoginSucceeded(){this.loginSucceeded()}static \u0275fac=function(G){return new(G||Z)(r.Y36(ye.zQ),r.Y36(fe._W),r.Y36(Re.F0),r.Y36(Re.gz))};static \u0275cmp=r.Xpm({type:Z,selectors:[["gitfire-login-input-auth"]],viewQuery:function(G,M){if(1&G&&(r.Gf(ee,5),r.Gf(_e,5)),2&G){let re;r.iGM(re=r.CRH())&&(M.mainForm=re.first),r.iGM(re=r.CRH())&&(M.confirmPasswordInput=re.first)}},inputs:{isLogin:"isLogin",isReauth:"isReauth",reauthUser:"reauthUser",isSignup:"isSignup",showFederations:"showFederations"},outputs:{reauthed:"reauthed"},decls:22,vars:17,consts:[[3,"formGroup"],["mainForm",""],[1,"row","m-3"],["for","appGitfireLoginEmailInput",1,"visually-hidden"],["id","appGitfireLoginEmailInput","name","email","formControlName","email","placeholder","email@example.com","autocomplete","email","type","email","required","","autofill","","autofocus","","maxlength","1024","minlength","5",1,"form-control","col-12"],["class","valid-feedback",4,"ngIf"],[4,"ngIf"],["for","appGitfireLoginPasswordInput",1,"visually-hidden"],["id","appGitfireLoginPasswordInput","type","password","name","password","formControlName","password","placeholder","Password","required","","autofill","","maxlength","256","minlength","6",1,"form-control","col-12",3,"autocomplete"],["class"," ",4,"ngIf"],["class","col-12 m-3",3,"passwordToCheck","barLabel","strengthLabels","barColors",4,"ngIf"],["class","row m-3",3,"was-validated",4,"ngIf"],["class","row custom-control custom-checkbox m-5 text-center",3,"was-validated",4,"ngIf"],["class","btn btn-lg btn-primary btn-block",3,"disabled","click",4,"ngIf"],[3,"loginSucceeded","loginFailed",4,"ngIf"],[1,"valid-feedback"],["class","invalid-feedback",4,"ngIf"],[1,"invalid-feedback"],[1,""],[1,"col-12","m-3",3,"passwordToCheck","barLabel","strengthLabels","barColors"],["for","appGitfireSignupPasswordConfirmInput",1,"visually-hidden"],["id","appGitfireSignupPasswordConfirmInput","type","password","name","password_confirm","formControlName","retypePassword","placeholder","Confirm password","required","",1,"form-control","col-12",3,"autocomplete"],["confirmPasswordInput",""],[1,"row","custom-control","custom-checkbox","m-5","text-center"],["for","appGitfireAgreeTosCheck",1,"col-auto","visually-hidden"],["id","col-auto appGitfireAgreeTosCheck","formControlName","agreeTosCheck","type","checkbox","required","",1,"form-check-input"],["tabindex","-1","about","_blank","href","/terms.htm",1,"col-auto"],[1,"col-auto"],["class","valid-feedback col-auto",4,"ngIf"],[1,"valid-feedback","col-auto"],["class","invalid-feedback col-auto",4,"ngIf"],[1,"invalid-feedback","col-auto"],[1,"btn","btn-lg","btn-primary","btn-block",3,"disabled","click"],["src","/assets/octicons/sign-in.svg",1,"m-1","gitfire-link-icon","octicon-info"],[3,"loginSucceeded","loginFailed"]],template:function(G,M){1&G&&(r.TgZ(0,"form",0,1)(2,"div",2)(3,"label",3),r._uU(4,"Email"),r.qZA(),r._UZ(5,"input",4),r.YNc(6,Y,2,0,"div",5)(7,Ie,3,2,"ng-container",6),r.qZA(),r.TgZ(8,"div",2)(9,"label",7),r._uU(10,"Password"),r.qZA(),r._UZ(11,"input",8),r.YNc(12,Se,2,0,"div",5)(13,U,3,2,"ng-container",9)(14,b,2,8,"ng9-password-strength-bar",10),r.qZA(),r.YNc(15,D,7,5,"div",11)(16,Q,10,4,"div",12),r.TgZ(17,"div",2),r.YNc(18,pe,2,1,"button",13)(19,se,3,1,"button",13)(20,be,3,1,"button",13),r.qZA(),r.YNc(21,te,1,0,"app-oauth-federations",14),r.qZA()),2&G&&(r.Q6J("formGroup",M.inputAuthForm),r.xp6(2),r.ekj("was-validated",M.emailControl.dirty||M.emailControl.touched),r.xp6(4),r.Q6J("ngIf",!M.emailControl.invalid),r.xp6(1),r.Q6J("ngIf",M.emailControl.invalid),r.xp6(1),r.ekj("was-validated",M.passwordControl.dirty||M.passwordControl.touched),r.xp6(3),r.Q6J("autocomplete",M.passwordAutocomplete),r.xp6(1),r.Q6J("ngIf",M.isSignup&&!M.passwordControl.invalid),r.xp6(1),r.Q6J("ngIf",M.passwordControl.invalid),r.xp6(1),r.Q6J("ngIf",M.isSignup),r.xp6(1),r.Q6J("ngIf",M.isSignup),r.xp6(1),r.Q6J("ngIf",M.isSignup),r.xp6(2),r.Q6J("ngIf",M.isSignup),r.xp6(1),r.Q6J("ngIf",M.isLogin),r.xp6(1),r.Q6J("ngIf",M.isReauth),r.xp6(1),r.Q6J("ngIf",M.showFederations))},dependencies:[Ze.O5,K._Y,K.Fj,K.Wl,K.JJ,K.JL,K.Q7,K.wO,K.nD,K.Zs,K.sg,K.u,X.e,ae.x,Ze.Ov]})}return Z})()},1134:(It,xe,f)=>{f.d(xe,{M:()=>K});var O=f(6814),r=f(9212);let K=(()=>{class ue{static \u0275fac=function(ce){return new(ce||ue)};static \u0275mod=r.oAB({type:ue});static \u0275inj=r.cJS({imports:[O.ez]})}return ue})()},2589:(It,xe,f)=>{function oe(C,b,y,A){var D,R=arguments.length,m=R<3?b:null===A?A=Object.getOwnPropertyDescriptor(b,y):A;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)m=Reflect.decorate(C,b,y,A);else for(var k=C.length-1;k>=0;k--)(D=C[k])&&(m=(R<3?D(m):R>3?D(b,y,m):D(b,y))||m);return R>3&&m&&Object.defineProperty(b,y,m),m}f.d(xe,{e:()=>U,_:()=>j});var x,le=f(9212);let U=x=class{constructor(){this.onStrengthChanged=new le.vpe,this.defaultColors=["#F00","#F90","#FF0","#9F0","#0F0"],this.defaultThresholds=[90,70,40,20],this.defaultBaseColor="#DDD",this.colors=this.defaultColors,this.thresholds=this.defaultThresholds}static measureStrength(b){let y=0;const A={};for(let D=0;D<b.length;D++)A[b[D]]=(A[b[D]]||0)+1,y+=5/A[b[D]];const R={digits:/\d/.test(b),lower:/[a-z]/.test(b),upper:/[A-Z]/.test(b),nonWords:/\W/.test(b)};let m=0;for(let D in R)m+=R[D]?1:0;return y+=10*(m-1),Math.trunc(y)}checkBarColors(){this.colors=this.barColors&&5===this.barColors.length?this.barColors.slice():this.defaultColors,this.strengths=this.strengthLabels&&5===this.strengthLabels.length?this.strengthLabels.slice():null,this.setStrengthLabel(0),/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(this.baseColor)||(this.baseColor=this.defaultBaseColor)}checkThresholds(){this.thresholds=this.customThresholds&&4===this.customThresholds.length?this.customThresholds.slice():this.defaultThresholds}getColor(b){let y=0;return b>this.thresholds[0]?y=4:b>this.thresholds[1]?y=3:b>=this.thresholds[2]?y=2:b>=this.thresholds[3]&&(y=1),{idx:y+1,col:this.colors[y]}}getStrengthIndexAndColor(b){return this.getColor(x.measureStrength(b))}ngOnChanges(b){if(!b.passwordToCheck)return;const y=b.passwordToCheck.currentValue;this.checkBarColors(),this.checkThresholds(),this.setBarColors(5,this.baseColor);let A=0;if(y){const R=this.getStrengthIndexAndColor(y);A=R.idx-1,this.setStrengthLabel(A),this.setBarColors(R.idx,R.col)}this.onStrengthChanged.emit(A)}setBarColors(b,y){for(let A=0;A<b;A++)this["bar"+A]=y}setStrengthLabel(b){this.strengths&&(this.strengthLabel=this.strengths[b])}};oe([(0,le.IIB)()],U.prototype,"passwordToCheck",void 0),oe([(0,le.IIB)()],U.prototype,"barLabel",void 0),oe([(0,le.IIB)()],U.prototype,"barColors",void 0),oe([(0,le.IIB)()],U.prototype,"baseColor",void 0),oe([(0,le.IIB)()],U.prototype,"strengthLabels",void 0),oe([(0,le.IIB)()],U.prototype,"customThresholds",void 0),oe([(0,le.r_U)()],U.prototype,"onStrengthChanged",void 0),U=x=oe([(0,le.wA2)({selector:"ng9-password-strength-bar",template:'\n    <div id="strength" #strength>\n      <small>{{barLabel}}</small>\n      <ul id="strengthBar" class="strengthBar">\n        <li id="bar0" class="point" [style.background-color]="bar0"></li>\n        <li class="point" [style.background-color]="bar1"></li>\n        <li class="point" [style.background-color]="bar2"></li>\n        <li class="point" [style.background-color]="bar3"></li>\n        <li class="point" [style.background-color]="bar4"></li>\n      </ul>\n      <small [hidden]="!strengths" class="pre">  {{strengthLabel}}</small>\n    </div>\n  ',styles:["\n    .strengthBar {\n      display: inline;\n      list-style: none;\n      margin: 0 0 0 15px;\n      padding: 0;\n      vertical-align: 2px;\n    }\n\n    .strengthBar .point {\n      background: #DDD;\n      border-radius: 2px;\n      display: inline-block;\n      height: 5px;\n      margin-right: 1px;\n      width: 20px;\n    }\n\n    .strengthBar .point:last-child {\n      margin: 0;\n    }\n    .pre {\n      white-space: pre;\n    }\n  "]})],U);let j=(()=>{let C=class{};return C=oe([(0,le.LVF)({declarations:[U],imports:[],exports:[U]})],C),C})()},4186:(It,xe,f)=>{f.d(xe,{Q1:()=>_n,TE:()=>io});var O=f(8326),r=f(5592),K=f(2096),ue=f(2459),oe=f(3620),he=f(7398),ce=f(4664),N=f(9212),e=f(7217),Pe=f(3106),me=f(5861),ye=f(6122),fe=f(9058),Re=f(4537);const Ze="firebasestorage.googleapis.com",X="storageBucket";class Y extends fe.ZR{constructor(t,o,a=0){super(Oe(t),`Firebase Storage: ${o} (${Oe(t)})`),this.status_=a,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Y.prototype)}get status(){return this.status_}set status(t){this.status_=t}_codeEquals(t){return Oe(t)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(t){this.customData.serverResponse=t,this.message=this.customData.serverResponse?`${this._baseMessage}\n${this.customData.serverResponse}`:this._baseMessage}}var V=function(n){return n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment",n}(V||{});function Oe(n){return"storage/"+n}function Ie(){return new Y(V.UNKNOWN,"An unknown error occurred, please check the error payload for server response.")}function C(){return new Y(V.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function b(){return new Y(V.CANCELED,"User canceled the upload/download.")}function m(){return new Y(V.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function _(n){return new Y(V.INVALID_ARGUMENT,n)}function Q(){return new Y(V.APP_DELETED,"The Firebase app was deleted.")}function pe(n){return new Y(V.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function se(n,t){return new Y(V.INVALID_FORMAT,"String does not match format '"+n+"': "+t)}function be(n){throw new Y(V.INTERNAL_ERROR,"Internal error: "+n)}class te{constructor(t,o){this.bucket=t,this.path_=o}get path(){return this.path_}get isRoot(){return 0===this.path.length}fullServerUrl(){const t=encodeURIComponent;return"/b/"+t(this.bucket)+"/o/"+t(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(t,o){let a;try{a=te.makeFromUrl(t,o)}catch{return new te(t,"")}if(""===a.path)return a;throw function A(n){return new Y(V.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}(t)}static makeFromUrl(t,o){let a=null;const p="([A-Za-z0-9.\\-_]+)",J=new RegExp("^gs://"+p+"(/(.*))?$","i");function W(Me){Me.path_=decodeURIComponent(Me.path)}const we=o.replace(/[.]/g,"\\."),Ne=[{regex:J,indices:{bucket:1,path:3},postModify:function v(Me){"/"===Me.path.charAt(Me.path.length-1)&&(Me.path_=Me.path_.slice(0,-1))}},{regex:new RegExp(`^https?://${we}/v[A-Za-z0-9_]+/b/${p}/o(/([^?#]*).*)?$`,"i"),indices:{bucket:1,path:3},postModify:W},{regex:new RegExp(`^https?://${o===Ze?"(?:storage.googleapis.com|storage.cloud.google.com)":o}/${p}/([^?#]*)`,"i"),indices:{bucket:1,path:2},postModify:W}];for(let Me=0;Me<Ne.length;Me++){const qt=Ne[Me],Jt=qt.regex.exec(t);if(Jt){let jt=Jt[qt.indices.path];jt||(jt=""),a=new te(Jt[qt.indices.bucket],jt),qt.postModify(a);break}}if(null==a)throw function y(n){return new Y(V.INVALID_URL,"Invalid URL '"+n+"'.")}(t);return a}}class qe{constructor(t){this.promise_=Promise.reject(t)}getPromise(){return this.promise_}cancel(t=!1){}}function re(n){return"string"==typeof n||n instanceof String}function Le(n){return Ve()&&n instanceof Blob}function Ve(){return typeof Blob<"u"&&!(0,fe.UG)()}function $e(n,t,o,a){if(a<t)throw _(`Invalid value for '${n}'. Expected ${t} or greater.`);if(a>o)throw _(`Invalid value for '${n}'. Expected ${o} or less.`)}function Fe(n,t,o){let a=t;return null==o&&(a=`https://${t}`),`${o}://${a}/v0${n}`}function Je(n){const t=encodeURIComponent;let o="?";for(const a in n)n.hasOwnProperty(a)&&(o=o+(t(a)+"=")+t(n[a])+"&");return o=o.slice(0,-1),o}var Ge=function(n){return n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT",n}(Ge||{});function Ye(n,t){const o=n>=500&&n<600,p=-1!==[408,429].indexOf(n),v=-1!==t.indexOf(n);return o||p||v}class lt{constructor(t,o,a,p,v,E,J,$,W,ne,we,ve=!0){this.url_=t,this.method_=o,this.headers_=a,this.body_=p,this.successCodes_=v,this.additionalRetryCodes_=E,this.callback_=J,this.errorCallback_=$,this.timeout_=W,this.progressCallback_=ne,this.connectionFactory_=we,this.retry=ve,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((Ce,Ee)=>{this.resolve_=Ce,this.reject_=Ee,this.start_()})}start_(){const o=(a,p)=>{const v=this.resolve_,E=this.reject_,J=p.connection;if(p.wasSuccessCode)try{const $=this.callback_(J,J.getResponse());!function S(n){return void 0!==n}($)?v():v($)}catch($){E($)}else if(null!==J){const $=Ie();$.serverResponse=J.getErrorText(),E(this.errorCallback_?this.errorCallback_(J,$):$)}else E(p.canceled?this.appDelete_?Q():b():C())};this.canceled_?o(0,new ze(!1,null,!0)):this.backoffId_=function Z(n,t,o){let a=1,p=null,v=null,E=!1,J=0;function $(){return 2===J}let W=!1;function ne(...ke){W||(W=!0,t.apply(null,ke))}function we(ke){p=setTimeout(()=>{p=null,n(Ce,$())},ke)}function ve(){v&&clearTimeout(v)}function Ce(ke,...wt){if(W)return void ve();if(ke)return ve(),void ne.call(null,ke,...wt);if($()||E)return ve(),void ne.call(null,ke,...wt);let Ne;a<64&&(a*=2),1===J?(J=2,Ne=0):Ne=1e3*(a+Math.random()),we(Ne)}let Ee=!1;function et(ke){Ee||(Ee=!0,ve(),!W&&(null!==p?(ke||(J=2),clearTimeout(p),we(0)):ke||(J=1)))}return we(0),v=setTimeout(()=>{E=!0,et(!0)},o),et}((a,p)=>{if(p)return void a(!1,new ze(!1,null,!0));const v=this.connectionFactory_();this.pendingConnection_=v;const E=J=>{null!==this.progressCallback_&&this.progressCallback_(J.loaded,J.lengthComputable?J.total:-1)};null!==this.progressCallback_&&v.addUploadProgressListener(E),v.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{null!==this.progressCallback_&&v.removeUploadProgressListener(E),this.pendingConnection_=null;const J=v.getErrorCode()===Ge.NO_ERROR,$=v.getStatus();if(!J||Ye($,this.additionalRetryCodes_)&&this.retry){const ne=v.getErrorCode()===Ge.ABORT;return void a(!1,new ze(!1,null,ne))}const W=-1!==this.successCodes_.indexOf($);a(!0,new ze(W,v))})},o,this.timeout_)}getPromise(){return this.promise_}cancel(t){this.canceled_=!0,this.appDelete_=t||!1,null!==this.backoffId_&&function z(n){n(!1)}(this.backoffId_),null!==this.pendingConnection_&&this.pendingConnection_.abort()}}class ze{constructor(t,o,a){this.wasSuccessCode=t,this.connection=o,this.canceled=!!a}}function ht(...n){const t=function xt(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}();if(void 0!==t){const o=new t;for(let a=0;a<n.length;a++)o.append(n[a]);return o.getBlob()}if(Ve())return new Blob(n);throw new Y(V.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}const Te={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class rt{constructor(t,o){this.data=t,this.contentType=o||null}}function We(n,t){switch(n){case Te.RAW:return new rt(it(t));case Te.BASE64:case Te.BASE64URL:return new rt(st(n,t));case Te.DATA_URL:return new rt(function Rt(n){const t=new tt(n);return t.base64?st(Te.BASE64,t.rest):function gt(n){let t;try{t=decodeURIComponent(n)}catch{throw se(Te.DATA_URL,"Malformed data URL.")}return it(t)}(t.rest)}(t),function nt(n){return new tt(n).contentType}(t))}throw Ie()}function it(n){const t=[];for(let o=0;o<n.length;o++){let a=n.charCodeAt(o);a<=127?t.push(a):a<=2047?t.push(192|a>>6,128|63&a):55296==(64512&a)?o<n.length-1&&56320==(64512&n.charCodeAt(o+1))?(a=65536|(1023&a)<<10|1023&n.charCodeAt(++o),t.push(240|a>>18,128|a>>12&63,128|a>>6&63,128|63&a)):t.push(239,191,189):56320==(64512&a)?t.push(239,191,189):t.push(224|a>>12,128|a>>6&63,128|63&a)}return new Uint8Array(t)}function st(n,t){switch(n){case Te.BASE64:{const p=-1!==t.indexOf("-"),v=-1!==t.indexOf("_");if(p||v)throw se(n,"Invalid character '"+(p?"-":"_")+"' found: is it base64url encoded?");break}case Te.BASE64URL:{const p=-1!==t.indexOf("+"),v=-1!==t.indexOf("/");if(p||v)throw se(n,"Invalid character '"+(p?"+":"/")+"' found: is it base64 encoded?");t=t.replace(/-/g,"+").replace(/_/g,"/");break}}let o;try{o=function ft(n){if(typeof atob>"u")throw function B(n){return new Y(V.UNSUPPORTED_ENVIRONMENT,`${n} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}("base-64");return atob(n)}(t)}catch(p){throw p.message.includes("polyfill")?p:se(n,"Invalid character found")}const a=new Uint8Array(o.length);for(let p=0;p<o.length;p++)a[p]=o.charCodeAt(p);return a}class tt{constructor(t){this.base64=!1,this.contentType=null;const o=t.match(/^data:([^,]+)?,/);if(null===o)throw se(Te.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const a=o[1]||null;null!=a&&(this.base64=function Ut(n,t){return n.length>=t.length&&n.substring(n.length-t.length)===t}(a,";base64"),this.contentType=this.base64?a.substring(0,a.length-7):a),this.rest=t.substring(t.indexOf(",")+1)}}class De{constructor(t,o){let a=0,p="";Le(t)?(this.data_=t,a=t.size,p=t.type):t instanceof ArrayBuffer?(o?this.data_=new Uint8Array(t):(this.data_=new Uint8Array(t.byteLength),this.data_.set(new Uint8Array(t))),a=this.data_.length):t instanceof Uint8Array&&(o?this.data_=t:(this.data_=new Uint8Array(t.length),this.data_.set(t)),a=t.length),this.size_=a,this.type_=p}size(){return this.size_}type(){return this.type_}slice(t,o){if(Le(this.data_)){const p=function Ot(n,t,o){return n.webkitSlice?n.webkitSlice(t,o):n.mozSlice?n.mozSlice(t,o):n.slice?n.slice(t,o):null}(this.data_,t,o);return null===p?null:new De(p)}{const a=new Uint8Array(this.data_.buffer,t,o-t);return new De(a,!0)}}static getBlob(...t){if(Ve()){const o=t.map(a=>a instanceof De?a.data_:a);return new De(ht.apply(null,o))}{const o=t.map(E=>re(E)?We(Te.RAW,E).data:E.data_);let a=0;o.forEach(E=>{a+=E.byteLength});const p=new Uint8Array(a);let v=0;return o.forEach(E=>{for(let J=0;J<E.length;J++)p[v++]=E[J]}),new De(p,!0)}}uploadData(){return this.data_}}function mt(n){let t;try{t=JSON.parse(n)}catch{return null}return function M(n){return"object"==typeof n&&!Array.isArray(n)}(t)?t:null}function vt(n){const t=n.lastIndexOf("/",n.length-2);return-1===t?n:n.slice(t+1)}function at(n,t){return t}class Ae{constructor(t,o,a,p){this.server=t,this.local=o||t,this.writable=!!a,this.xform=p||at}}let Xe=null;function je(){if(Xe)return Xe;const n=[];n.push(new Ae("bucket")),n.push(new Ae("generation")),n.push(new Ae("metageneration")),n.push(new Ae("name","fullPath",!0));const o=new Ae("name");o.xform=function t(v,E){return function Mt(n){return!re(n)||n.length<2?n:vt(n)}(E)},n.push(o);const p=new Ae("size");return p.xform=function a(v,E){return void 0!==E?Number(E):E},n.push(p),n.push(new Ae("timeCreated")),n.push(new Ae("updated")),n.push(new Ae("md5Hash",null,!0)),n.push(new Ae("cacheControl",null,!0)),n.push(new Ae("contentDisposition",null,!0)),n.push(new Ae("contentEncoding",null,!0)),n.push(new Ae("contentLanguage",null,!0)),n.push(new Ae("contentType",null,!0)),n.push(new Ae("metadata","customMetadata",!0)),Xe=n,Xe}function ut(n,t,o){const a=mt(t);return null===a?null:function yt(n,t,o){const a={type:"file"},p=o.length;for(let v=0;v<p;v++){const E=o[v];a[E.local]=E.xform(a,t[E.server])}return function Ct(n,t){Object.defineProperty(n,"ref",{get:function o(){const v=new te(n.bucket,n.fullPath);return t._makeStorageReference(v)}})}(a,n),a}(n,a,o)}function ct(n,t){const o={},a=t.length;for(let p=0;p<a;p++){const v=t[p];v.writable&&(o[v.server]=n[v.local])}return JSON.stringify(o)}const Zt="prefixes",bt="items";class c{constructor(t,o,a,p){this.url=t,this.method=o,this.handler=a,this.timeout=p,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}function h(n){if(!n)throw Ie()}function P(n,t){return function o(a,p){const v=ut(n,p,t);return h(null!==v),v}}function u(n){return function t(o,a){let p;return p=401===o.getStatus()?o.getErrorText().includes("Firebase App Check token is invalid")?function U(){return new Y(V.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}():function x(){return new Y(V.UNAUTHENTICATED,"User is not authenticated, please authenticate using Firebase Authentication and try again.")}():402===o.getStatus()?function le(n){return new Y(V.QUOTA_EXCEEDED,"Quota for bucket '"+n+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}(n.bucket):403===o.getStatus()?function j(n){return new Y(V.UNAUTHORIZED,"User does not have permission to access '"+n+"'.")}(n.path):a,p.status=o.getStatus(),p.serverResponse=a.serverResponse,p}}function g(n){const t=u(n);return function o(a,p){let v=t(a,p);return 404===a.getStatus()&&(v=function Se(n){return new Y(V.OBJECT_NOT_FOUND,"Object '"+n+"' does not exist.")}(n.path)),v.serverResponse=p.serverResponse,v}}function w(n,t,o){const p=Fe(t.fullServerUrl(),n.host,n._protocol),E=n.maxOperationRetryTime,J=new c(p,"GET",P(n,o),E);return J.errorHandler=g(t),J}function q(n,t,o,a,p){const v={};v.prefix=t.isRoot?"":t.path+"/",o&&o.length>0&&(v.delimiter=o),a&&(v.pageToken=a),p&&(v.maxResults=p);const J=Fe(t.bucketOnlyServerUrl(),n.host,n._protocol),W=n.maxOperationRetryTime,ne=new c(J,"GET",function L(n,t){return function o(a,p){const v=function Tt(n,t,o){const a=mt(o);return null===a?null:function Nt(n,t,o){const a={prefixes:[],items:[],nextPageToken:o.nextPageToken};if(o[Zt])for(const p of o[Zt]){const v=p.replace(/\/$/,""),E=n._makeStorageReference(new te(t,v));a.prefixes.push(E)}if(o[bt])for(const p of o[bt]){const v=n._makeStorageReference(new te(t,p.name));a.items.push(v)}return a}(n,t,a)}(n,t,p);return h(null!==v),v}}(n,t.bucket),W);return ne.urlParams=v,ne.errorHandler=u(t),ne}function s(n,t,o){const a=Object.assign({},o);return a.fullPath=n.path,a.size=t.size(),a.contentType||(a.contentType=function i(n,t){return n&&n.contentType||t&&t.type()||"application/octet-stream"}(null,t)),a}class T{constructor(t,o,a,p){this.current=t,this.total=o,this.finalized=!!a,this.metadata=p||null}}function I(n,t){let o=null;try{o=n.getResponseHeader("X-Goog-Upload-Status")}catch{h(!1)}return h(!!o&&-1!==(t||["active"]).indexOf(o)),o}const Lt={STATE_CHANGED:"state_changed"},Ue={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function Be(n){switch(n){case"running":case"pausing":case"canceling":return Ue.RUNNING;case"paused":return Ue.PAUSED;case"success":return Ue.SUCCESS;case"canceled":return Ue.CANCELED;default:return Ue.ERROR}}class St{constructor(t,o,a){if(function G(n){return"function"==typeof n}(t)||null!=o||null!=a)this.next=t,this.error=o??void 0,this.complete=a??void 0;else{const v=t;this.next=v.next,this.error=v.error,this.complete=v.complete}}}function Ft(n){return(...t)=>{Promise.resolve().then(()=>n(...t))}}let zt=null;class vn{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Ge.NO_ERROR,this.sendPromise_=new Promise(t=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=Ge.ABORT,t()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=Ge.NETWORK_ERROR,t()}),this.xhr_.addEventListener("load",()=>{t()})})}send(t,o,a,p){if(this.sent_)throw be("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(o,t,!0),void 0!==p)for(const v in p)p.hasOwnProperty(v)&&this.xhr_.setRequestHeader(v,p[v].toString());return void 0!==a?this.xhr_.send(a):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw be("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw be("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw be("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw be("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(t){return this.xhr_.getResponseHeader(t)}addUploadProgressListener(t){null!=this.xhr_.upload&&this.xhr_.upload.addEventListener("progress",t)}removeUploadProgressListener(t){null!=this.xhr_.upload&&this.xhr_.upload.removeEventListener("progress",t)}}class Cn extends vn{initXhr(){this.xhr_.responseType="text"}}function ot(){return zt?zt():new Cn}class Xt{constructor(t,o,a=null){this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=t,this._blob=o,this._metadata=a,this._mappings=je(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=p=>{if(this._request=void 0,this._chunkMultiplier=1,p._codeEquals(V.CANCELED))this._needToFetchStatus=!0,this.completeTransitions_();else{const v=this.isExponentialBackoffExpired();if(Ye(p.status,[])){if(!v)return this.sleepTime=Math.max(2*this.sleepTime,1e3),this._needToFetchStatus=!0,void this.completeTransitions_();p=C()}this._error=p,this._transition("error")}},this._metadataErrorHandler=p=>{this._request=void 0,p._codeEquals(V.CANCELED)?this.completeTransitions_():(this._error=p,this._transition("error"))},this.sleepTime=0,this.maxSleepTime=this._ref.storage.maxUploadRetryTime,this._promise=new Promise((p,v)=>{this._resolve=p,this._reject=v,this._start()}),this._promise.then(null,()=>{})}isExponentialBackoffExpired(){return this.sleepTime>this.maxSleepTime}_makeProgressCallback(){const t=this._transferred;return o=>this._updateProgress(t+o)}_shouldDoResumable(t){return t.size()>262144}_start(){"running"===this._state&&void 0===this._request&&(this._resumable?void 0===this._uploadUrl?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this.pendingTimeout=setTimeout(()=>{this.pendingTimeout=void 0,this._continueUpload()},this.sleepTime):this._oneShotUpload())}_resolveToken(t){Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then(([o,a])=>{switch(this._state){case"running":t(o,a);break;case"canceling":this._transition("canceled");break;case"pausing":this._transition("paused")}})}_createResumable(){this._resolveToken((t,o)=>{const a=function ge(n,t,o,a,p){const v=t.bucketOnlyServerUrl(),E=s(t,a,p),J={name:E.fullPath},$=Fe(v,n.host,n._protocol),ne={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${a.size()}`,"X-Goog-Upload-Header-Content-Type":E.contentType,"Content-Type":"application/json; charset=utf-8"},we=ct(E,o),Ee=new c($,"POST",function Ce(et){let ke;I(et);try{ke=et.getResponseHeader("X-Goog-Upload-URL")}catch{h(!1)}return h(re(ke)),ke},n.maxUploadRetryTime);return Ee.urlParams=J,Ee.headers=ne,Ee.body=we,Ee.errorHandler=u(t),Ee}(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),p=this._ref.storage._makeRequest(a,ot,t,o);this._request=p,p.getPromise().then(v=>{this._request=void 0,this._uploadUrl=v,this._needToFetchStatus=!1,this.completeTransitions_()},this._errorHandler)})}_fetchStatus(){const t=this._uploadUrl;this._resolveToken((o,a)=>{const p=function Ke(n,t,o,a){const $=new c(o,"POST",function v(W){const ne=I(W,["active","final"]);let we=null;try{we=W.getResponseHeader("X-Goog-Upload-Size-Received")}catch{h(!1)}we||h(!1);const ve=Number(we);return h(!isNaN(ve)),new T(ve,a.size(),"final"===ne)},n.maxUploadRetryTime);return $.headers={"X-Goog-Upload-Command":"query"},$.errorHandler=u(t),$}(this._ref.storage,this._ref._location,t,this._blob),v=this._ref.storage._makeRequest(p,ot,o,a);this._request=v,v.getPromise().then(E=>{this._request=void 0,this._updateProgress(E.current),this._needToFetchStatus=!1,E.finalized&&(this._needToFetchMetadata=!0),this.completeTransitions_()},this._errorHandler)})}_continueUpload(){const t=262144*this._chunkMultiplier,o=new T(this._transferred,this._blob.size()),a=this._uploadUrl;this._resolveToken((p,v)=>{let E;try{E=function He(n,t,o,a,p,v,E,J){const $=new T(0,0);if(E?($.current=E.current,$.total=E.total):($.current=0,$.total=a.size()),a.size()!==$.total)throw function D(){return new Y(V.SERVER_FILE_WRONG_SIZE,"Server recorded incorrect upload file size, please retry the upload.")}();const W=$.total-$.current;let ne=W;p>0&&(ne=Math.min(ne,p));const we=$.current;let Ce="";Ce=0===ne?"finalize":W===ne?"upload, finalize":"upload";const Ee={"X-Goog-Upload-Command":Ce,"X-Goog-Upload-Offset":`${$.current}`},et=a.slice(we,we+ne);if(null===et)throw m();const Ne=new c(o,"POST",function ke(Me,qt){const Jt=I(Me,["active","final"]),Vt=$.current+ne,jt=a.size();let Yt;return Yt="final"===Jt?P(t,v)(Me,qt):null,new T(Vt,jt,"final"===Jt,Yt)},t.maxUploadRetryTime);return Ne.headers=Ee,Ne.body=et.uploadData(),Ne.progressCallback=J||null,Ne.errorHandler=u(n),Ne}(this._ref._location,this._ref.storage,a,this._blob,t,this._mappings,o,this._makeProgressCallback())}catch($){return this._error=$,void this._transition("error")}const J=this._ref.storage._makeRequest(E,ot,p,v,!1);this._request=J,J.getPromise().then($=>{this._increaseMultiplier(),this._request=void 0,this._updateProgress($.current),$.finalized?(this._metadata=$.metadata,this._transition("success")):this.completeTransitions_()},this._errorHandler)})}_increaseMultiplier(){262144*this._chunkMultiplier*2<33554432&&(this._chunkMultiplier*=2)}_fetchMetadata(){this._resolveToken((t,o)=>{const a=w(this._ref.storage,this._ref._location,this._mappings),p=this._ref.storage._makeRequest(a,ot,t,o);this._request=p,p.getPromise().then(v=>{this._request=void 0,this._metadata=v,this._transition("success")},this._metadataErrorHandler)})}_oneShotUpload(){this._resolveToken((t,o)=>{const a=function d(n,t,o,a,p){const v=t.bucketOnlyServerUrl(),E={"X-Goog-Upload-Protocol":"multipart"},$=function J(){let Ne="";for(let Me=0;Me<2;Me++)Ne+=Math.random().toString().slice(2);return Ne}();E["Content-Type"]="multipart/related; boundary="+$;const W=s(t,a,p),ne=ct(W,o),Ce=De.getBlob("--"+$+"\r\nContent-Type: application/json; charset=utf-8\r\n\r\n"+ne+"\r\n--"+$+"\r\nContent-Type: "+W.contentType+"\r\n\r\n",a,"\r\n--"+$+"--");if(null===Ce)throw m();const Ee={name:W.fullPath},et=Fe(v,n.host,n._protocol),wt=n.maxUploadRetryTime,Et=new c(et,"POST",P(n,o),wt);return Et.urlParams=Ee,Et.headers=E,Et.body=Ce.uploadData(),Et.errorHandler=u(t),Et}(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),p=this._ref.storage._makeRequest(a,ot,t,o);this._request=p,p.getPromise().then(v=>{this._request=void 0,this._metadata=v,this._updateProgress(this._blob.size()),this._transition("success")},this._errorHandler)})}_updateProgress(t){const o=this._transferred;this._transferred=t,this._transferred!==o&&this._notifyObservers()}_transition(t){if(this._state!==t)switch(t){case"canceling":case"pausing":this._state=t,void 0!==this._request?this._request.cancel():this.pendingTimeout&&(clearTimeout(this.pendingTimeout),this.pendingTimeout=void 0,this.completeTransitions_());break;case"running":const o="paused"===this._state;this._state=t,o&&(this._notifyObservers(),this._start());break;case"paused":case"error":case"success":this._state=t,this._notifyObservers();break;case"canceled":this._error=b(),this._state=t,this._notifyObservers()}}completeTransitions_(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start()}}get snapshot(){const t=Be(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:t,metadata:this._metadata,task:this,ref:this._ref}}on(t,o,a,p){const v=new St(o||void 0,a||void 0,p||void 0);return this._addObserver(v),()=>{this._removeObserver(v)}}then(t,o){return this._promise.then(t,o)}catch(t){return this.then(null,t)}_addObserver(t){this._observers.push(t),this._notifyObserver(t)}_removeObserver(t){const o=this._observers.indexOf(t);-1!==o&&this._observers.splice(o,1)}_notifyObservers(){this._finishPromise(),this._observers.slice().forEach(o=>{this._notifyObserver(o)})}_finishPromise(){if(void 0!==this._resolve){let t=!0;switch(Be(this._state)){case Ue.SUCCESS:Ft(this._resolve.bind(null,this.snapshot))();break;case Ue.CANCELED:case Ue.ERROR:Ft(this._reject.bind(null,this._error))();break;default:t=!1}t&&(this._resolve=void 0,this._reject=void 0)}}_notifyObserver(t){switch(Be(this._state)){case Ue.RUNNING:case Ue.PAUSED:t.next&&Ft(t.next.bind(t,this.snapshot))();break;case Ue.SUCCESS:t.complete&&Ft(t.complete.bind(t))();break;default:t.error&&Ft(t.error.bind(t,this._error))()}}resume(){const t="paused"===this._state||"pausing"===this._state;return t&&this._transition("running"),t}pause(){const t="running"===this._state;return t&&this._transition("pausing"),t}cancel(){const t="running"===this._state||"pausing"===this._state;return t&&this._transition("canceling"),t}}class $t{constructor(t,o){this._service=t,this._location=o instanceof te?o:te.makeFromUrl(o,t.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(t,o){return new $t(t,o)}get root(){const t=new te(this._location.bucket,"");return this._newRef(this._service,t)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return vt(this._location.path)}get storage(){return this._service}get parent(){const t=function Bt(n){if(0===n.length)return null;const t=n.lastIndexOf("/");return-1===t?"":n.slice(0,t)}(this._location.path);if(null===t)return null;const o=new te(this._location.bucket,t);return new $t(this._service,o)}_throwIfRoot(t){if(""===this._location.path)throw pe(t)}}function tn(n,t,o){return Wt.apply(this,arguments)}function Wt(){return(Wt=(0,me.Z)(function*(n,t,o){const p=yield nn(n,{pageToken:o});t.prefixes.push(...p.prefixes),t.items.push(...p.items),null!=p.nextPageToken&&(yield tn(n,t,p.nextPageToken))})).apply(this,arguments)}function nn(n,t){null!=t&&"number"==typeof t.maxResults&&$e("options.maxResults",1,1e3,t.maxResults);const o=t||{},a=q(n.storage,n._location,"/",o.pageToken,o.maxResults);return n.storage.makeRequestWithTokens(a,ot)}function Sn(n){n._throwIfRoot("getDownloadURL");const t=function ie(n,t,o){const p=Fe(t.fullServerUrl(),n.host,n._protocol),E=n.maxOperationRetryTime,J=new c(p,"GET",function H(n,t){return function o(a,p){const v=ut(n,p,t);return h(null!==v),function Gt(n,t,o,a){const p=mt(t);if(null===p||!re(p.downloadTokens))return null;const v=p.downloadTokens;if(0===v.length)return null;const E=encodeURIComponent;return v.split(",").map(W=>{const we=n.fullPath;return Fe("/b/"+E(n.bucket)+"/o/"+E(we),o,a)+Je({alt:"media",token:W})})[0]}(v,p,n.host,n._protocol)}}(n,o),E);return J.errorHandler=g(t),J}(n.storage,n._location,je());return n.storage.makeRequestWithTokens(t,ot).then(o=>{if(null===o)throw function k(){return new Y(V.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}();return o})}function on(n,t){const o=function _t(n,t){const o=t.split("/").filter(a=>a.length>0).join("/");return 0===n.length?o:n+"/"+o}(n._location.path,t),a=new te(n._location.bucket,o);return new $t(n.storage,a)}function rn(n,t){if(n instanceof Kt){const o=n;if(null==o._bucket)throw function R(){return new Y(V.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+X+"' property when initializing the app?")}();const a=new $t(o,o._bucket);return null!=t?rn(a,t):a}return void 0!==t?on(n,t):n}function On(n,t){if(t&&function Dn(n){return/^[A-Za-z]+:\/\//.test(n)}(t)){if(n instanceof Kt)return function Pn(n,t){return new $t(n,t)}(n,t);throw _("To use ref(service, url), the first argument must be a Storage instance.")}return rn(n,t)}function sn(n,t){const o=t?.[X];return null==o?null:te.makeFromBucketSpec(o,n)}class Kt{constructor(t,o,a,p,v){this.app=t,this._authProvider=o,this._appCheckProvider=a,this._url=p,this._firebaseVersion=v,this._bucket=null,this._host=Ze,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=12e4,this._maxUploadRetryTime=6e5,this._requests=new Set,this._bucket=null!=p?te.makeFromBucketSpec(p,this._host):sn(this._host,this.app.options)}get host(){return this._host}set host(t){this._host=t,this._bucket=null!=this._url?te.makeFromBucketSpec(this._url,t):sn(t,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(t){$e("time",0,Number.POSITIVE_INFINITY,t),this._maxUploadRetryTime=t}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(t){$e("time",0,Number.POSITIVE_INFINITY,t),this._maxOperationRetryTime=t}_getAuthToken(){var t=this;return(0,me.Z)(function*(){if(t._overrideAuthToken)return t._overrideAuthToken;const o=t._authProvider.getImmediate({optional:!0});if(o){const a=yield o.getToken();if(null!==a)return a.accessToken}return null})()}_getAppCheckToken(){var t=this;return(0,me.Z)(function*(){const o=t._appCheckProvider.getImmediate({optional:!0});return o?(yield o.getToken()).token:null})()}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(t=>t.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(t){return new $t(this,t)}_makeRequest(t,o,a,p,v=!0){if(this._deleted)return new qe(Q());{const E=function pt(n,t,o,a,p,v,E=!0){const J=Je(n.urlParams),$=n.url+J,W=Object.assign({},n.headers);return function dt(n,t){t&&(n["X-Firebase-GMPID"]=t)}(W,t),function Dt(n,t){null!==t&&t.length>0&&(n.Authorization="Firebase "+t)}(W,o),function kt(n,t){n["X-Firebase-Storage-Version"]="webjs/"+(t??"AppManager")}(W,v),function Pt(n,t){null!==t&&(n["X-Firebase-AppCheck"]=t)}(W,a),new lt($,n.method,W,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,p,E)}(t,this._appId,a,p,o,this._firebaseVersion,v);return this._requests.add(E),E.getPromise().then(()=>this._requests.delete(E),()=>this._requests.delete(E)),E}}makeRequestWithTokens(t,o){var a=this;return(0,me.Z)(function*(){const[p,v]=yield Promise.all([a._getAuthToken(),a._getAppCheckToken()]);return a._makeRequest(t,o,p,v).getPromise()})()}}const an="@firebase/storage";function ln(n,t){return On(n=(0,fe.m9)(n),t)}function jn(n,{instanceIdentifier:t}){const o=n.getProvider("app").getImmediate(),a=n.getProvider("auth-internal"),p=n.getProvider("app-check-internal");return new Kt(o,a,p,t,ye.SDK_VERSION)}!function Qn(){(0,ye._registerComponent)(new Re.wA("storage",jn,"PUBLIC").setMultipleInstances(!0)),(0,ye.registerVersion)(an,"0.11.2",""),(0,ye.registerVersion)(an,"0.11.2","esm2017")}();class Qt{constructor(t,o,a){this._delegate=t,this.task=o,this.ref=a}get bytesTransferred(){return this._delegate.bytesTransferred}get metadata(){return this._delegate.metadata}get state(){return this._delegate.state}get totalBytes(){return this._delegate.totalBytes}}class pn{constructor(t,o){this._delegate=t,this._ref=o,this.cancel=this._delegate.cancel.bind(this._delegate),this.catch=this._delegate.catch.bind(this._delegate),this.pause=this._delegate.pause.bind(this._delegate),this.resume=this._delegate.resume.bind(this._delegate)}get snapshot(){return new Qt(this._delegate.snapshot,this,this._ref)}then(t,o){return this._delegate.then(a=>{if(t)return t(new Qt(a,this,this._ref))},o)}on(t,o,a,p){let v;return o&&(v="function"==typeof o?E=>o(new Qt(E,this,this._ref)):{next:o.next?E=>o.next(new Qt(E,this,this._ref)):void 0,complete:o.complete||void 0,error:o.error||void 0}),this._delegate.on(t,v,a||void 0,p||void 0)}}class hn{constructor(t,o){this._delegate=t,this._service=o}get prefixes(){return this._delegate.prefixes.map(t=>new At(t,this._service))}get items(){return this._delegate.items.map(t=>new At(t,this._service))}get nextPageToken(){return this._delegate.nextPageToken||null}}class At{constructor(t,o){this._delegate=t,this.storage=o}get name(){return this._delegate.name}get bucket(){return this._delegate.bucket}get fullPath(){return this._delegate.fullPath}toString(){return this._delegate.toString()}child(t){const o=function Jn(n,t){return on(n,t)}(this._delegate,t);return new At(o,this.storage)}get root(){return new At(this._delegate.root,this.storage)}get parent(){const t=this._delegate.parent;return null==t?null:new At(t,this.storage)}put(t,o){return this._throwIfRoot("put"),new pn(function Mn(n,t,o){return function In(n,t,o){return n._throwIfRoot("uploadBytesResumable"),new Xt(n,new De(t),o)}(n=(0,fe.m9)(n),t,o)}(this._delegate,t,o),this)}putString(t,o=Te.RAW,a){this._throwIfRoot("putString");const p=We(o,t),v=Object.assign({},a);return null==v.contentType&&null!=p.contentType&&(v.contentType=p.contentType),new pn(new Xt(this._delegate,new De(p.data,!0),v),this)}listAll(){return function $n(n){return function xn(n){const t={prefixes:[],items:[]};return tn(n,t).then(()=>t)}(n=(0,fe.m9)(n))}(this._delegate).then(t=>new hn(t,this.storage))}list(t){return function Ln(n,t){return nn(n=(0,fe.m9)(n),t)}(this._delegate,t||void 0).then(o=>new hn(o,this.storage))}getMetadata(){return function Zn(n){return function Rn(n){n._throwIfRoot("getMetadata");const t=w(n.storage,n._location,je());return n.storage.makeRequestWithTokens(t,ot)}(n=(0,fe.m9)(n))}(this._delegate)}updateMetadata(t){return function Nn(n,t){return function Un(n,t){n._throwIfRoot("updateMetadata");const o=function l(n,t,o,a){const v=Fe(t.fullServerUrl(),n.host,n._protocol),J=ct(o,a),W=n.maxOperationRetryTime,ne=new c(v,"PATCH",P(n,a),W);return ne.headers={"Content-Type":"application/json; charset=utf-8"},ne.body=J,ne.errorHandler=g(t),ne}(n.storage,n._location,t,je());return n.storage.makeRequestWithTokens(o,ot)}(n=(0,fe.m9)(n),t)}(this._delegate,t)}getDownloadURL(){return function Gn(n){return Sn(n=(0,fe.m9)(n))}(this._delegate)}delete(){return this._throwIfRoot("delete"),function qn(n){return function Fn(n){n._throwIfRoot("deleteObject");const t=function F(n,t){const a=Fe(t.fullServerUrl(),n.host,n._protocol),J=new c(a,"DELETE",function E($,W){},n.maxOperationRetryTime);return J.successCodes=[200,204],J.errorHandler=g(t),J}(n.storage,n._location);return n.storage.makeRequestWithTokens(t,ot)}(n=(0,fe.m9)(n))}(this._delegate)}_throwIfRoot(t){if(""===this._delegate._location.path)throw pe(t)}}class fn{constructor(t,o){this.app=t,this._delegate=o}get maxOperationRetryTime(){return this._delegate.maxOperationRetryTime}get maxUploadRetryTime(){return this._delegate.maxUploadRetryTime}ref(t){if(gn(t))throw _("ref() expected a child path but got a URL, use refFromURL instead.");return new At(ln(this._delegate,t),this)}refFromURL(t){if(!gn(t))throw _("refFromURL() expected a full URL but got a child path, use ref() instead.");try{te.makeFromUrl(t,this._delegate.host)}catch{throw _("refFromUrl() expected a valid full URL but got an invalid one.")}return new At(ln(this._delegate,t),this)}setMaxUploadRetryTime(t){this._delegate.maxUploadRetryTime=t}setMaxOperationRetryTime(t){this._delegate.maxOperationRetryTime=t}useEmulator(t,o,a={}){!function dn(n,t,o,a={}){!function Bn(n,t,o,a={}){n.host=`${t}:${o}`,n._protocol="http";const{mockUserToken:p}=a;p&&(n._overrideAuthToken="string"==typeof p?p:(0,fe.Sg)(p,n.app.options.projectId))}(n,t,o,a)}(this._delegate,t,o,a)}}function gn(n){return/^[A-Za-z]+:\/\//.test(n)}function Vn(n,{instanceIdentifier:t}){const o=n.getProvider("app-compat").getImmediate(),a=n.getProvider("storage").getImmediate({identifier:t});return new fn(o,a)}!function Yn(n){const t={TaskState:Ue,TaskEvent:Lt,StringFormat:Te,Storage:fn,Reference:At};n.INTERNAL.registerComponent(new Re.wA("storage-compat",Vn,"PUBLIC").setServiceProps(t).setMultipleInstances(!0)),n.registerVersion("@firebase/storage-compat","0.3.2")}(Pe.Z);var zn=f(7142);function mn(n){const t=function Xn(n){return new r.y(t=>{const o=E=>t.next(E);o(n.snapshot);const v=n.on("state_changed",o);return n.then(E=>{o(E),t.complete()},E=>{o(n.snapshot),(E=>{t.error(E)})(E)}),function(){v()}}).pipe((0,oe.b)(0))}(n);return{task:n,then:n.then.bind(n),catch:n.catch.bind(n),pause:n.pause.bind(n),cancel:n.cancel.bind(n),resume:n.resume.bind(n),snapshotChanges:()=>t,percentageChanges:()=>t.pipe((0,he.U)(o=>o.bytesTransferred/o.totalBytes*100))}}function Ht(n){return{getDownloadURL:()=>(0,K.of)(void 0).pipe(O.fc,(0,ce.w)(()=>n.getDownloadURL()),O.iC),getMetadata:()=>(0,K.of)(void 0).pipe(O.fc,(0,ce.w)(()=>n.getMetadata()),O.iC),delete:()=>(0,ue.D)(n.delete()),child:t=>Ht(n.child(t)),updateMetadata:t=>(0,ue.D)(n.updateMetadata(t)),put:(t,o)=>mn(n.put(t,o)),putString:(t,o,a)=>mn(n.putString(t,o,a)),list:t=>(0,ue.D)(n.list(t)),listAll:()=>(0,ue.D)(n.listAll())}}const eo=new N.OlP("angularfire2.storageBucket"),to=new N.OlP("angularfire2.storage.maxUploadRetryTime"),no=new N.OlP("angularfire2.storage.maxOperationRetryTime"),oo=new N.OlP("angularfire2.storage.use-emulator");let _n=(()=>{class n{storage;constructor(o,a,p,v,E,J,$,W,ne,we){const ve=(0,e.on)(o,E,a);this.storage=(0,e.cc)(`${ve.name}.storage.${p}`,"AngularFireStorage",ve.name,()=>{const Ce=E.runOutsideAngular(()=>ve.storage(p||void 0)),Ee=ne;return Ee&&Ce.useEmulator(...Ee),$&&Ce.setMaxUploadRetryTime($),W&&Ce.setMaxOperationRetryTime(W),Ce},[$,W])}ref(o){return Ht(this.storage.ref(o))}refFromURL(o){return Ht(this.storage.refFromURL(o))}upload(o,a,p){return Ht(this.storage.ref(o)).put(a,p)}static \u0275fac=function(a){return new(a||n)(N.LFG(e.Dh),N.LFG(e.xv,8),N.LFG(eo,8),N.LFG(N.Lbi),N.LFG(N.R0b),N.LFG(O.HU),N.LFG(to,8),N.LFG(no,8),N.LFG(oo,8),N.LFG(O.Rf,8))};static \u0275prov=N.Yz7({token:n,factory:n.\u0275fac,providedIn:"any"})}return n})(),ro=(()=>{class n{static \u0275fac=function(a){return new(a||n)};static \u0275mod=N.oAB({type:n});static \u0275inj=N.cJS({})}return n})(),io=(()=>{class n{constructor(){zn.Z.registerVersion("angularfire",O.q4.full,"gcs-compat")}static \u0275fac=function(a){return new(a||n)};static \u0275mod=N.oAB({type:n});static \u0275inj=N.cJS({providers:[_n],imports:[ro]})}return n})()},8812:(It,xe,f)=>{var O=f(5861),r=f(6122),K=f(4537),ue=f(9058),oe=f(1878);const he="@firebase/installations",ce="0.6.4",N=1e4,e=`w:${ce}`,Pe="FIS_v2",me="https://firebaseinstallations.googleapis.com/v1",ye=36e5,X=new ue.LL("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function ae(u){return u instanceof ue.ZR&&u.code.includes("request-failed")}function ee({projectId:u}){return`${me}/projects/${u}/installations`}function _e(u){return{token:u.token,requestStatus:2,expiresIn:x(u.expiresIn),creationTime:Date.now()}}function Y(u,g){return V.apply(this,arguments)}function V(){return(V=(0,O.Z)(function*(u,g){const q=(yield g.json()).error;return X.create("request-failed",{requestName:u,serverCode:q.code,serverMessage:q.message,serverStatus:q.status})})).apply(this,arguments)}function Oe({apiKey:u}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":u})}function Se(u){return le.apply(this,arguments)}function le(){return(le=(0,O.Z)(function*(u){const g=yield u();return g.status>=500&&g.status<600?u():g})).apply(this,arguments)}function x(u){return Number(u.replace("s","000"))}function C(){return(C=(0,O.Z)(function*({appConfig:u,heartbeatServiceProvider:g},{fid:w}){const q=ee(u),de=Oe(u),ie=g.getImmediate({optional:!0});if(ie){const s=yield ie.getHeartbeatsHeader();s&&de.append("x-firebase-client",s)}const F={method:"POST",headers:de,body:JSON.stringify({fid:w,authVersion:Pe,appId:u.appId,sdkVersion:e})},i=yield Se(()=>fetch(q,F));if(i.ok){const s=yield i.json();return{fid:s.fid||w,registrationStatus:2,refreshToken:s.refreshToken,authToken:_e(s.authToken)}}throw yield Y("Create Installation",i)})).apply(this,arguments)}function b(u){return new Promise(g=>{setTimeout(g,u)})}const A=/^[cdef][\w-]{21}$/,R="";function m(){try{const u=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(u),u[0]=112+u[0]%16;const w=function D(u){return function y(u){return btoa(String.fromCharCode(...u)).replace(/\+/g,"-").replace(/\//g,"_")}(u).substr(0,22)}(u);return A.test(w)?w:R}catch{return R}}function k(u){return`${u.appName}!${u.appId}`}const B=new Map;function _(u,g){const w=k(u);se(w,g),function be(u,g){const w=function qe(){return!te&&"BroadcastChannel"in self&&(te=new BroadcastChannel("[Firebase] FID Change"),te.onmessage=u=>{se(u.data.key,u.data.fid)}),te}();w&&w.postMessage({key:u,fid:g}),function Z(){0===B.size&&te&&(te.close(),te=null)}()}(w,g)}function se(u,g){const w=B.get(u);if(w)for(const q of w)q(g)}let te=null;const z="firebase-installations-database",S=1,G="firebase-installations-store";let M=null;function re(){return M||(M=(0,oe.X3)(z,S,{upgrade:(u,g)=>{0===g&&u.createObjectStore(G)}})),M}function Le(u,g){return Ve.apply(this,arguments)}function Ve(){return(Ve=(0,O.Z)(function*(u,g){const w=k(u),de=(yield re()).transaction(G,"readwrite"),ie=de.objectStore(G),l=yield ie.get(w);return yield ie.put(g,w),yield de.done,(!l||l.fid!==g.fid)&&_(u,g.fid),g})).apply(this,arguments)}function $e(u){return Fe.apply(this,arguments)}function Fe(){return(Fe=(0,O.Z)(function*(u){const g=k(u),q=(yield re()).transaction(G,"readwrite");yield q.objectStore(G).delete(g),yield q.done})).apply(this,arguments)}function Je(u,g){return Ge.apply(this,arguments)}function Ge(){return(Ge=(0,O.Z)(function*(u,g){const w=k(u),de=(yield re()).transaction(G,"readwrite"),ie=de.objectStore(G),l=yield ie.get(w),F=g(l);return void 0===F?yield ie.delete(w):yield ie.put(F,w),yield de.done,F&&(!l||l.fid!==F.fid)&&_(u,F.fid),F})).apply(this,arguments)}function Ye(u){return lt.apply(this,arguments)}function lt(){return lt=(0,O.Z)(function*(u){let g;const w=yield Je(u.appConfig,q=>{const de=function ze(u){return ht(u||{fid:m(),registrationStatus:0})}(q),ie=function Dt(u,g){if(0===g.registrationStatus){if(!navigator.onLine)return{installationEntry:g,registrationPromise:Promise.reject(X.create("app-offline"))};const w={fid:g.fid,registrationStatus:1,registrationTime:Date.now()},q=function kt(u,g){return dt.apply(this,arguments)}(u,w);return{installationEntry:w,registrationPromise:q}}return 1===g.registrationStatus?{installationEntry:g,registrationPromise:Pt(u)}:{installationEntry:g}}(u,de);return g=ie.registrationPromise,ie.installationEntry});return w.fid===R?{installationEntry:yield g}:{installationEntry:w,registrationPromise:g}}),lt.apply(this,arguments)}function dt(){return dt=(0,O.Z)(function*(u,g){try{const w=yield function j(u,g){return C.apply(this,arguments)}(u,g);return Le(u.appConfig,w)}catch(w){throw ae(w)&&409===w.customData.serverCode?yield $e(u.appConfig):yield Le(u.appConfig,{fid:g.fid,registrationStatus:0}),w}}),dt.apply(this,arguments)}function Pt(u){return pt.apply(this,arguments)}function pt(){return(pt=(0,O.Z)(function*(u){let g=yield xt(u.appConfig);for(;1===g.registrationStatus;)yield b(100),g=yield xt(u.appConfig);if(0===g.registrationStatus){const{installationEntry:w,registrationPromise:q}=yield Ye(u);return q||w}return g})).apply(this,arguments)}function xt(u){return Je(u,g=>{if(!g)throw X.create("installation-not-found");return ht(g)})}function ht(u){return function Ot(u){return 1===u.registrationStatus&&u.registrationTime+N<Date.now()}(u)?{fid:u.fid,registrationStatus:0}:u}function Te(){return(Te=(0,O.Z)(function*({appConfig:u,heartbeatServiceProvider:g},w){const q=function rt(u,{fid:g}){return`${ee(u)}/${g}/authTokens:generate`}(u,w),de=function Ie(u,{refreshToken:g}){const w=Oe(u);return w.append("Authorization",function U(u){return`${Pe} ${u}`}(g)),w}(u,w),ie=g.getImmediate({optional:!0});if(ie){const s=yield ie.getHeartbeatsHeader();s&&de.append("x-firebase-client",s)}const F={method:"POST",headers:de,body:JSON.stringify({installation:{sdkVersion:e,appId:u.appId}})},i=yield Se(()=>fetch(q,F));if(i.ok)return _e(yield i.json());throw yield Y("Generate Auth Token",i)})).apply(this,arguments)}function We(u){return it.apply(this,arguments)}function it(){return it=(0,O.Z)(function*(u,g=!1){let w;const q=yield Je(u.appConfig,ie=>{if(!Ut(ie))throw X.create("not-registered");const l=ie.authToken;if(!g&&function De(u){return 2===u.requestStatus&&!function mt(u){const g=Date.now();return g<u.creationTime||u.creationTime+u.expiresIn<g+ye}(u)}(l))return ie;if(1===l.requestStatus)return w=function gt(u,g){return st.apply(this,arguments)}(u,g),ie;{if(!navigator.onLine)throw X.create("app-offline");const F=function Bt(u){const g={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},u),{authToken:g})}(ie);return w=function Rt(u,g){return nt.apply(this,arguments)}(u,F),F}});return w?yield w:q.authToken}),it.apply(this,arguments)}function st(){return(st=(0,O.Z)(function*(u,g){let w=yield tt(u.appConfig);for(;1===w.authToken.requestStatus;)yield b(100),w=yield tt(u.appConfig);const q=w.authToken;return 0===q.requestStatus?We(u,g):q})).apply(this,arguments)}function tt(u){return Je(u,g=>{if(!Ut(g))throw X.create("not-registered");return function _t(u){return 1===u.requestStatus&&u.requestTime+N<Date.now()}(g.authToken)?Object.assign(Object.assign({},g),{authToken:{requestStatus:0}}):g})}function nt(){return nt=(0,O.Z)(function*(u,g){try{const w=yield function ft(u,g){return Te.apply(this,arguments)}(u,g),q=Object.assign(Object.assign({},g),{authToken:w});return yield Le(u.appConfig,q),w}catch(w){if(!ae(w)||401!==w.customData.serverCode&&404!==w.customData.serverCode){const q=Object.assign(Object.assign({},g),{authToken:{requestStatus:0}});yield Le(u.appConfig,q)}else yield $e(u.appConfig);throw w}}),nt.apply(this,arguments)}function Ut(u){return void 0!==u&&2===u.registrationStatus}function at(){return(at=(0,O.Z)(function*(u){const g=u,{installationEntry:w,registrationPromise:q}=yield Ye(g);return q?q.catch(console.error):We(g).catch(console.error),w.fid})).apply(this,arguments)}function Xe(){return Xe=(0,O.Z)(function*(u,g=!1){const w=u;return yield function Mt(u){return je.apply(this,arguments)}(w),(yield We(w,g)).token}),Xe.apply(this,arguments)}function je(){return(je=(0,O.Z)(function*(u){const{registrationPromise:g}=yield Ye(u);g&&(yield g)})).apply(this,arguments)}function Tt(u){return X.create("missing-app-config-values",{valueName:u})}const c="installations",P=u=>{const g=u.getProvider("app").getImmediate(),w=function Nt(u){if(!u||!u.options)throw Tt("App Configuration");if(!u.name)throw Tt("App Name");const g=["projectId","apiKey","appId"];for(const w of g)if(!u.options[w])throw Tt(w);return{appName:u.name,projectId:u.options.projectId,apiKey:u.options.apiKey,appId:u.options.appId}}(g);return{app:g,appConfig:w,heartbeatServiceProvider:(0,r._getProvider)(g,"heartbeat"),_delete:()=>Promise.resolve()}},L=u=>{const g=u.getProvider("app").getImmediate(),w=(0,r._getProvider)(g,c).getImmediate();return{getId:()=>function vt(u){return at.apply(this,arguments)}(w),getToken:de=>function Ae(u){return Xe.apply(this,arguments)}(w,de)}};(function H(){(0,r._registerComponent)(new K.wA(c,P,"PUBLIC")),(0,r._registerComponent)(new K.wA("installations-internal",L,"PRIVATE"))})(),(0,r.registerVersion)(he,ce),(0,r.registerVersion)(he,ce,"esm2017")},2650:(It,xe,f)=>{f.d(xe,{Gb:()=>je,LP:()=>Zt,pQ:()=>Nt,ps:()=>Tt});var O=f(5861),K=(f(8812),f(4537)),ue=f(1878),oe=f(9058),he=f(6122);const ce="/firebase-messaging-sw.js",N="/firebase-cloud-messaging-push-scope",e="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",Pe="https://fcmregistrations.googleapis.com/v1",me="google.c.a.c_id",ye="google.c.a.c_l",fe="google.c.a.ts";var X=function(c){return c.PUSH_RECEIVED="push-received",c.NOTIFICATION_CLICKED="notification-clicked",c}(X||{});function ae(c){const h=new Uint8Array(c);return btoa(String.fromCharCode(...h)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function ee(c){const P=(c+"=".repeat((4-c.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),L=atob(P),H=new Uint8Array(L.length);for(let u=0;u<L.length;++u)H[u]=L.charCodeAt(u);return H}const _e="fcm_token_details_db",Y=5,V="fcm_token_object_Store";function Ie(){return Ie=(0,O.Z)(function*(c){if("databases"in indexedDB&&!(yield indexedDB.databases()).map(u=>u.name).includes(_e))return null;let h=null;return(yield(0,ue.X3)(_e,Y,{upgrade:(L=(0,O.Z)(function*(H,u,g,w){var q;if(u<2||!H.objectStoreNames.contains(V))return;const de=w.objectStore(V),ie=yield de.index("fcmSenderId").get(c);if(yield de.clear(),ie)if(2===u){const l=ie;if(!l.auth||!l.p256dh||!l.endpoint)return;h={token:l.fcmToken,createTime:null!==(q=l.createTime)&&void 0!==q?q:Date.now(),subscriptionOptions:{auth:l.auth,p256dh:l.p256dh,endpoint:l.endpoint,swScope:l.swScope,vapidKey:"string"==typeof l.vapidKey?l.vapidKey:ae(l.vapidKey)}}}else if(3===u){const l=ie;h={token:l.fcmToken,createTime:l.createTime,subscriptionOptions:{auth:ae(l.auth),p256dh:ae(l.p256dh),endpoint:l.endpoint,swScope:l.swScope,vapidKey:ae(l.vapidKey)}}}else if(4===u){const l=ie;h={token:l.fcmToken,createTime:l.createTime,subscriptionOptions:{auth:ae(l.auth),p256dh:ae(l.p256dh),endpoint:l.endpoint,swScope:l.swScope,vapidKey:ae(l.vapidKey)}}}}),function(u,g,w,q){return L.apply(this,arguments)})})).close(),yield(0,ue.Lj)(_e),yield(0,ue.Lj)("fcm_vapid_details_db"),yield(0,ue.Lj)("undefined"),function Se(c){if(!c||!c.subscriptionOptions)return!1;const{subscriptionOptions:h}=c;return"number"==typeof c.createTime&&c.createTime>0&&"string"==typeof c.token&&c.token.length>0&&"string"==typeof h.auth&&h.auth.length>0&&"string"==typeof h.p256dh&&h.p256dh.length>0&&"string"==typeof h.endpoint&&h.endpoint.length>0&&"string"==typeof h.swScope&&h.swScope.length>0&&"string"==typeof h.vapidKey&&h.vapidKey.length>0}(h)?h:null;var L}),Ie.apply(this,arguments)}const le="firebase-messaging-database",x=1,U="firebase-messaging-store";let j=null;function C(){return j||(j=(0,ue.X3)(le,x,{upgrade:(c,h)=>{0===h&&c.createObjectStore(U)}})),j}function b(c){return y.apply(this,arguments)}function y(){return y=(0,O.Z)(function*(c){const h=k(c),L=yield(yield C()).transaction(U).objectStore(U).get(h);if(L)return L;{const H=yield function Oe(c){return Ie.apply(this,arguments)}(c.appConfig.senderId);if(H)return yield A(c,H),H}}),y.apply(this,arguments)}function A(c,h){return R.apply(this,arguments)}function R(){return(R=(0,O.Z)(function*(c,h){const P=k(c),H=(yield C()).transaction(U,"readwrite");return yield H.objectStore(U).put(h,P),yield H.done,h})).apply(this,arguments)}function D(){return(D=(0,O.Z)(function*(c){const h=k(c),L=(yield C()).transaction(U,"readwrite");yield L.objectStore(U).delete(h),yield L.done})).apply(this,arguments)}function k({appConfig:c}){return c.appId}const _=new oe.LL("messaging","Messaging",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."});function Q(c,h){return pe.apply(this,arguments)}function pe(){return(pe=(0,O.Z)(function*(c,h){const P=yield z(c),L=G(h),H={method:"POST",headers:P,body:JSON.stringify(L)};let u;try{u=yield(yield fetch(Z(c.appConfig),H)).json()}catch(g){throw _.create("token-subscribe-failed",{errorInfo:g?.toString()})}if(u.error)throw _.create("token-subscribe-failed",{errorInfo:u.error.message});if(!u.token)throw _.create("token-subscribe-no-token");return u.token})).apply(this,arguments)}function be(){return(be=(0,O.Z)(function*(c,h){const P=yield z(c),L=G(h.subscriptionOptions),H={method:"PATCH",headers:P,body:JSON.stringify(L)};let u;try{u=yield(yield fetch(`${Z(c.appConfig)}/${h.token}`,H)).json()}catch(g){throw _.create("token-update-failed",{errorInfo:g?.toString()})}if(u.error)throw _.create("token-update-failed",{errorInfo:u.error.message});if(!u.token)throw _.create("token-update-no-token");return u.token})).apply(this,arguments)}function te(c,h){return qe.apply(this,arguments)}function qe(){return(qe=(0,O.Z)(function*(c,h){const L={method:"DELETE",headers:yield z(c)};try{const u=yield(yield fetch(`${Z(c.appConfig)}/${h}`,L)).json();if(u.error)throw _.create("token-unsubscribe-failed",{errorInfo:u.error.message})}catch(H){throw _.create("token-unsubscribe-failed",{errorInfo:H?.toString()})}})).apply(this,arguments)}function Z({projectId:c}){return`${Pe}/projects/${c}/registrations`}function z(c){return S.apply(this,arguments)}function S(){return(S=(0,O.Z)(function*({appConfig:c,installations:h}){const P=yield h.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":c.apiKey,"x-goog-firebase-installations-auth":`FIS ${P}`})})).apply(this,arguments)}function G({p256dh:c,auth:h,endpoint:P,vapidKey:L}){const H={web:{endpoint:P,auth:h,p256dh:c}};return L!==e&&(H.web.applicationPubKey=L),H}const M=6048e5;function Le(){return Le=(0,O.Z)(function*(c){const h=yield function lt(c,h){return ze.apply(this,arguments)}(c.swRegistration,c.vapidKey),P={vapidKey:c.vapidKey,swScope:c.swRegistration.scope,endpoint:h.endpoint,auth:ae(h.getKey("auth")),p256dh:ae(h.getKey("p256dh"))},L=yield b(c.firebaseDependencies);if(L){if(function Dt(c,h){return h.vapidKey===c.vapidKey&&h.endpoint===c.endpoint&&h.auth===c.auth&&h.p256dh===c.p256dh}(L.subscriptionOptions,P))return Date.now()>=L.createTime+M?function Fe(c,h){return Je.apply(this,arguments)}(c,{token:L.token,createTime:Date.now(),subscriptionOptions:P}):L.token;try{yield te(c.firebaseDependencies,L.token)}catch(H){console.warn(H)}return Ge(c.firebaseDependencies,P)}return Ge(c.firebaseDependencies,P)}),Le.apply(this,arguments)}function Ve(c){return $e.apply(this,arguments)}function $e(){return $e=(0,O.Z)(function*(c){const h=yield b(c.firebaseDependencies);h&&(yield te(c.firebaseDependencies,h.token),yield function m(c){return D.apply(this,arguments)}(c.firebaseDependencies));const P=yield c.swRegistration.pushManager.getSubscription();return!P||P.unsubscribe()}),$e.apply(this,arguments)}function Je(){return Je=(0,O.Z)(function*(c,h){try{const P=yield function se(c,h){return be.apply(this,arguments)}(c.firebaseDependencies,h),L=Object.assign(Object.assign({},h),{token:P,createTime:Date.now()});return yield A(c.firebaseDependencies,L),P}catch(P){throw yield Ve(c),P}}),Je.apply(this,arguments)}function Ge(c,h){return Ye.apply(this,arguments)}function Ye(){return(Ye=(0,O.Z)(function*(c,h){const L={token:yield Q(c,h),createTime:Date.now(),subscriptionOptions:h};return yield A(c,L),L.token})).apply(this,arguments)}function ze(){return(ze=(0,O.Z)(function*(c,h){return(yield c.pushManager.getSubscription())||c.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:ee(h)})})).apply(this,arguments)}function kt(c){const h={from:c.from,collapseKey:c.collapse_key,messageId:c.fcmMessageId};return function dt(c,h){if(!h.notification)return;c.notification={};const P=h.notification.title;P&&(c.notification.title=P);const L=h.notification.body;L&&(c.notification.body=L);const H=h.notification.image;H&&(c.notification.image=H);const u=h.notification.icon;u&&(c.notification.icon=u)}(h,c),function Pt(c,h){h.data&&(c.data=h.data)}(h,c),function pt(c,h){var P,L,H,u,g;if(!(h.fcmOptions||null!==(P=h.notification)&&void 0!==P&&P.click_action))return;c.fcmOptions={};const w=null!==(H=null===(L=h.fcmOptions)||void 0===L?void 0:L.link)&&void 0!==H?H:null===(u=h.notification)||void 0===u?void 0:u.click_action;w&&(c.fcmOptions.link=w);const q=null===(g=h.fcmOptions)||void 0===g?void 0:g.analytics_label;q&&(c.fcmOptions.analyticsLabel=q)}(h,c),h}function ht(c,h){const P=[];for(let L=0;L<c.length;L++)P.push(c.charAt(L)),L<h.length&&P.push(h.charAt(L));return P.join("")}function ft(c){return _.create("missing-app-config-values",{valueName:c})}ht("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),ht("AzSCbw63g1R0nCw85jG8","Iaya3yLKwmgvh7cF0q4");class Te{constructor(h,P,L){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const H=function Ot(c){if(!c||!c.options)throw ft("App Configuration Object");if(!c.name)throw ft("App Name");const h=["projectId","apiKey","appId","messagingSenderId"],{options:P}=c;for(const L of h)if(!P[L])throw ft(L);return{appName:c.name,projectId:P.projectId,apiKey:P.apiKey,appId:P.appId,senderId:P.messagingSenderId}}(h);this.firebaseDependencies={app:h,appConfig:H,installations:P,analyticsProvider:L}}_delete(){return Promise.resolve()}}function rt(c){return We.apply(this,arguments)}function We(){return(We=(0,O.Z)(function*(c){try{c.swRegistration=yield navigator.serviceWorker.register(ce,{scope:N}),c.swRegistration.update().catch(()=>{})}catch(h){throw _.create("failed-service-worker-registration",{browserErrorMessage:h?.message})}})).apply(this,arguments)}function gt(){return(gt=(0,O.Z)(function*(c,h){if(!h&&!c.swRegistration&&(yield rt(c)),h||!c.swRegistration){if(!(h instanceof ServiceWorkerRegistration))throw _.create("invalid-sw-registration");c.swRegistration=h}})).apply(this,arguments)}function tt(){return(tt=(0,O.Z)(function*(c,h){h?c.vapidKey=h:c.vapidKey||(c.vapidKey=e)})).apply(this,arguments)}function Rt(c,h){return nt.apply(this,arguments)}function nt(){return nt=(0,O.Z)(function*(c,h){if(!navigator)throw _.create("only-available-in-window");if("default"===Notification.permission&&(yield Notification.requestPermission()),"granted"!==Notification.permission)throw _.create("permission-blocked");return yield function st(c,h){return tt.apply(this,arguments)}(c,h?.vapidKey),yield function it(c,h){return gt.apply(this,arguments)}(c,h?.serviceWorkerRegistration),function re(c){return Le.apply(this,arguments)}(c)}),nt.apply(this,arguments)}function De(){return(De=(0,O.Z)(function*(c,h,P){const L=function mt(c){switch(c){case X.NOTIFICATION_CLICKED:return"notification_open";case X.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}(h);(yield c.firebaseDependencies.analyticsProvider.get()).logEvent(L,{message_id:P[me],message_name:P[ye],message_time:P[fe],message_device_time:Math.floor(Date.now()/1e3)})})).apply(this,arguments)}function _t(){return _t=(0,O.Z)(function*(c,h){const P=h.data;if(!P.isFirebaseMessaging)return;c.onMessageHandler&&P.messageType===X.PUSH_RECEIVED&&("function"==typeof c.onMessageHandler?c.onMessageHandler(kt(P)):c.onMessageHandler.next(kt(P)));const L=P.data;(function xt(c){return"object"==typeof c&&!!c&&me in c})(L)&&"1"===L["google.c.a.e"]&&(yield function Ut(c,h,P){return De.apply(this,arguments)}(c,P.messageType,L))}),_t.apply(this,arguments)}const vt="@firebase/messaging",Ae=c=>{const h=new Te(c.getProvider("app").getImmediate(),c.getProvider("installations-internal").getImmediate(),c.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",P=>function Bt(c,h){return _t.apply(this,arguments)}(h,P)),h},Xe=c=>{const h=c.getProvider("messaging").getImmediate();return{getToken:L=>Rt(h,L)}};function je(){return Ct.apply(this,arguments)}function Ct(){return(Ct=(0,O.Z)(function*(){try{yield(0,oe.eu)()}catch{return!1}return typeof window<"u"&&(0,oe.hl)()&&(0,oe.zI)()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")})).apply(this,arguments)}function ut(){return(ut=(0,O.Z)(function*(c){if(!navigator)throw _.create("only-available-in-window");return c.swRegistration||(yield rt(c)),Ve(c)})).apply(this,arguments)}function Zt(c,h){return bt.apply(this,arguments)}function bt(){return(bt=(0,O.Z)(function*(c,h){return Rt(c=(0,oe.m9)(c),h)})).apply(this,arguments)}function Nt(c){return function yt(c){return ut.apply(this,arguments)}(c=(0,oe.m9)(c))}function Tt(c,h){return function Gt(c,h){if(!navigator)throw _.create("only-available-in-window");return c.onMessageHandler=h,()=>{c.onMessageHandler=null}}(c=(0,oe.m9)(c),h)}!function Mt(){(0,he._registerComponent)(new K.wA("messaging",Ae,"PUBLIC")),(0,he._registerComponent)(new K.wA("messaging-internal",Xe,"PRIVATE")),(0,he.registerVersion)(vt,"0.12.4"),(0,he.registerVersion)(vt,"0.12.4","esm2017")}()},1878:(It,xe,f)=>{f.d(xe,{Lj:()=>V,X3:()=>Y});var O=f(5861);const r=(x,U)=>U.some(j=>x instanceof j);let K,ue;const ce=new WeakMap,N=new WeakMap,e=new WeakMap,Pe=new WeakMap,me=new WeakMap;let Re={get(x,U,j){if(x instanceof IDBTransaction){if("done"===U)return N.get(x);if("objectStoreNames"===U)return x.objectStoreNames||e.get(x);if("store"===U)return j.objectStoreNames[1]?void 0:j.objectStore(j.objectStoreNames[0])}return ee(x[U])},set:(x,U,j)=>(x[U]=j,!0),has:(x,U)=>x instanceof IDBTransaction&&("done"===U||"store"===U)||U in x};function ae(x){return"function"==typeof x?function X(x){return x!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?function he(){return ue||(ue=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}().includes(x)?function(...U){return x.apply(_e(this),U),ee(ce.get(this))}:function(...U){return ee(x.apply(_e(this),U))}:function(U,...j){const C=x.call(_e(this),U,...j);return e.set(C,U.sort?U.sort():[U]),ee(C)}}(x):(x instanceof IDBTransaction&&function fe(x){if(N.has(x))return;const U=new Promise((j,C)=>{const b=()=>{x.removeEventListener("complete",y),x.removeEventListener("error",A),x.removeEventListener("abort",A)},y=()=>{j(),b()},A=()=>{C(x.error||new DOMException("AbortError","AbortError")),b()};x.addEventListener("complete",y),x.addEventListener("error",A),x.addEventListener("abort",A)});N.set(x,U)}(x),r(x,function oe(){return K||(K=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}())?new Proxy(x,Re):x)}function ee(x){if(x instanceof IDBRequest)return function ye(x){const U=new Promise((j,C)=>{const b=()=>{x.removeEventListener("success",y),x.removeEventListener("error",A)},y=()=>{j(ee(x.result)),b()},A=()=>{C(x.error),b()};x.addEventListener("success",y),x.addEventListener("error",A)});return U.then(j=>{j instanceof IDBCursor&&ce.set(j,x)}).catch(()=>{}),me.set(U,x),U}(x);if(Pe.has(x))return Pe.get(x);const U=ae(x);return U!==x&&(Pe.set(x,U),me.set(U,x)),U}const _e=x=>me.get(x);function Y(x,U,{blocked:j,upgrade:C,blocking:b,terminated:y}={}){const A=indexedDB.open(x,U),R=ee(A);return C&&A.addEventListener("upgradeneeded",m=>{C(ee(A.result),m.oldVersion,m.newVersion,ee(A.transaction))}),j&&A.addEventListener("blocked",()=>j()),R.then(m=>{y&&m.addEventListener("close",()=>y()),b&&m.addEventListener("versionchange",()=>b())}).catch(()=>{}),R}function V(x,{blocked:U}={}){const j=indexedDB.deleteDatabase(x);return U&&j.addEventListener("blocked",()=>U()),ee(j).then(()=>{})}const Oe=["get","getKey","getAll","getAllKeys","count"],Ie=["put","add","delete","clear"],Se=new Map;function le(x,U){if(!(x instanceof IDBDatabase)||U in x||"string"!=typeof U)return;if(Se.get(U))return Se.get(U);const j=U.replace(/FromIndex$/,""),C=U!==j,b=Ie.includes(j);if(!(j in(C?IDBIndex:IDBObjectStore).prototype)||!b&&!Oe.includes(j))return;const y=function(){var A=(0,O.Z)(function*(R,...m){const D=this.transaction(R,b?"readwrite":"readonly");let k=D.store;return C&&(k=k.index(m.shift())),(yield Promise.all([k[j](...m),b&&D.done]))[0]});return function(m){return A.apply(this,arguments)}}();return Se.set(U,y),y}!function Ze(x){Re=x(Re)}(x=>({...x,get:(U,j,C)=>le(U,j)||x.get(U,j,C),has:(U,j)=>!!le(U,j)||x.has(U,j)}))}}]);