"use strict";(self.webpackChunkKaguraGithubPages=self.webpackChunkKaguraGithubPages||[]).push([[406],{2994:(V,P,u)=>{u.d(P,{Y:()=>A});var n=u(1180),x=u(5879),w=u(553);let A=(()=>{var e;class c{constructor(){(0,n.Z)(this,"after",new x.vpe),(0,w.eM)("AfterIfDirective")}ngAfterContentInit(){(0,w.eM)("AfterIfDirective.ngAfterContentInit()"),setTimeout(()=>this.after.next())}}return e=c,(0,n.Z)(c,"\u0275fac",function(b){return new(b||e)}),(0,n.Z)(c,"\u0275dir",x.lG2({type:e,selectors:[["","appAfterIf",""]],outputs:{after:"appAfterIf"}})),c})()},2406:(V,P,u)=>{u.r(P),u.d(P,{GitweeModule:()=>_t});var n=u(1180),x=u(6814),w=u(5187),A=u(5861),e=u(5879),c=u(6825),Z=u(8645),b=u(5619),M=u(2572),ee=u(3019),E=u(2096),J=u(2438),te=u(1687),B=u(8180),y=u(7398),N=u(7081),C=u(9773),D=u(3997),ie=u(6699);class R{constructor(){(0,n.Z)(this,"entries",void 0),(0,n.Z)(this,"timelineUrl",void 0),(0,n.Z)(this,"navigationFrom","click")}}class k extends R{constructor(...a){super(...a),(0,n.Z)(this,"urlLink",void 0),(0,n.Z)(this,"title",void 0),(0,n.Z)(this,"indexUrl",void 0),(0,n.Z)(this,"updated",void 0),(0,n.Z)(this,"updatedAt",void 0)}}class ne extends k{}class H{constructor(){(0,n.Z)(this,"key",void 0),(0,n.Z)(this,"urlKey",void 0),(0,n.Z)(this,"urlLink",void 0),(0,n.Z)(this,"monthPage",void 0),(0,n.Z)(this,"monthIndex",void 0),(0,n.Z)(this,"isSelected",!1),(0,n.Z)(this,"count",void 0),(0,n.Z)(this,"page$",void 0),(0,n.Z)(this,"isNationalHoliday$",void 0),(0,n.Z)(this,"nationalHoliday$",void 0)}}class oe extends k{constructor(...a){super(...a),(0,n.Z)(this,"urlPrefix",void 0),(0,n.Z)(this,"lastDays",void 0),(0,n.Z)(this,"firstWeekday",void 0),(0,n.Z)(this,"days",void 0),(0,n.Z)(this,"dayEntries",{})}}class re{constructor(){(0,n.Z)(this,"key",void 0),(0,n.Z)(this,"urlKey",void 0),(0,n.Z)(this,"urlLink",void 0),(0,n.Z)(this,"yearPage",void 0),(0,n.Z)(this,"yearIndex",void 0),(0,n.Z)(this,"count",void 0),(0,n.Z)(this,"page$",void 0)}}class se extends k{constructor(...a){super(...a),(0,n.Z)(this,"urlPrefix",void 0),(0,n.Z)(this,"monthEntries",[])}}class ae{constructor(){(0,n.Z)(this,"key",void 0),(0,n.Z)(this,"urlKey",void 0),(0,n.Z)(this,"urlLink",void 0),(0,n.Z)(this,"topPage",void 0),(0,n.Z)(this,"count",void 0),(0,n.Z)(this,"page$",void 0)}}class de extends k{constructor(...a){super(...a),(0,n.Z)(this,"urlPrefix",void 0),(0,n.Z)(this,"yearEntries",[])}}class le{constructor(){(0,n.Z)(this,"ns",void 0),(0,n.Z)(this,"category",void 0),(0,n.Z)(this,"navigators",void 0),(0,n.Z)(this,"fragment",void 0)}}class ce extends k{constructor(...a){super(...a),(0,n.Z)(this,"tagkey",void 0)}}var p=u(553),F=u(271),Q=u(9339),T=u(4664);function S(r,a,o="0"){const t=`${r}`;return t.length>=a?t:t.padStart(a,o)}function Y(r){const a=+r;return Number.isNaN(a)?null:a}var j=u(9798);let $=(()=>{var r;class a{constructor(t,i){(0,n.Z)(this,"dom",void 0),(0,n.Z)(this,"http",void 0),(0,n.Z)(this,"holidays",{}),(0,n.Z)(this,"isInitialized",!1),this.dom=t,this.http=i,(0,p.eM)("IndexService.constructor()")}initialized(){this.isInitialized=!0}getNavigationFrom(t){return t?t.isReload?"reload":"url":"click"}indexRepPrefix$(t){const s=this.dom.getBaseHref()+p.NZ.GITWEE_DATA;return t.data?t.data.pipe((0,y.U)(d=>s+"/"+(d?.gitweeNamespace||""))):(0,E.of)(s)}buildConfigUrl$(t){return this.indexRepPrefix$(t).pipe((0,y.U)(i=>`${i}/config/main.json`))}buildTagIndex$(t,i){return this.indexRepPrefix$(t).pipe((0,y.U)(s=>s+"/tag/"+(i?`${i}/`:"")+"index.json"))}fetchConfig$(t){return this.buildConfigUrl$(t).pipe((0,T.w)(s=>this.http.fetchGhJson(s)))}readYearHoliday$(t){return this.http.fetchJson(`https://holidays-jp.github.io/api/v1/${t}/date.json`).pipe((0,y.U)(i=>{const s={};for(const d in i){const l=i[d],h={date:new Date(d),name:l};let f=s[h.date.getMonth()];if(f||(f={},s[h.date.getMonth()]=f),f[h.date.getDate()])throw new Error(`Not a valid date entry at ${h.date}`);f[h.date.getDate()]=h}return s}),(0,N.d)(1))}getNationalHoliday$(t){const i=t.getFullYear();let s=this.holidays[i];return s||(s=this.readYearHoliday$(i),this.holidays[i]=s),s.pipe((0,y.U)(d=>{if(!(t.getMonth()in d))return null;const l=d[t.getMonth()];return t.getDate()in l?l[t.getDate()].name:null}))}isNationalHoliday$(t){return this.getNationalHoliday$(t).pipe((0,y.U)(i=>null!==i))}buildIndex$(t,i,s,d){return this.indexRepPrefix$(t).pipe((0,y.U)(l=>l+"/date/"+(i?`${i}/`:"")+(s?`${s}/`:"")+(d?`${d}/`:"")+"index.json"))}fetchWeeklyIndex$(t){return this.http.fetchGhJson(t).pipe()}fetchTagIndexInternal$(t,i){return this.http.fetchGhJson(t).pipe((0,y.U)(s=>{const d=new ce;return d.indexUrl=t,d.title=s.title,d.entries=s.defaultEntries,d.timelineUrl=s.fuzzyIndexUrl,d.tagkey=i.tagkey,d.urlLink=`tag/${i.tagkey}`,d.navigationFrom=this.getNavigationFrom(i),d.updated=s.updated,d}))}fetchTagIndex$(t,i){return this.buildTagIndex$(t,i.tagkey).pipe((0,T.w)(d=>this.fetchTagIndexInternal$(d,i)))}fetchTagListInternal$(t){return this.http.fetchGhJson(t).pipe()}fetchTagList$(t){return this.buildTagIndex$(t).pipe((0,T.w)(s=>this.fetchTagListInternal$(s)))}fetchIndexInternal$(t,i,s){return this.http.fetchGhJson(i).pipe((0,y.U)(d=>{const l=new de;l.indexUrl=i,l.urlPrefix="timeline/",l.urlLink="",l.entries=d.defaultEntries,l.title=d.title,l.timelineUrl=d.fuzzyIndexUrl,l.navigationFrom=this.getNavigationFrom(s),l.updated=d.updated;for(const h in d.values){const f=Number(h),g=d.values[h],m=new ae;m.key=f,m.topPage=l,m.urlKey=S(f,4),m.urlLink=`${l.urlPrefix}${m.urlKey}`,m.count=g.count,m.page$=null,s?.year===f&&(m.page$=this.openYearPage$(t,m,s)),l.yearEntries.unshift(m)}return l}))}fetchIndex$(t,i){return this.buildIndex$(t).pipe((0,T.w)(d=>this.fetchIndexInternal$(t,d,i)))}openYearPageInternal$(t,i,s,d){return this.http.fetchGhJson(i).pipe((0,y.U)(l=>{const h=new se;h.urlLink=s.urlLink,h.urlPrefix=`${h.urlLink}/`,h.entries=l.defaultEntries,h.title=l.title,h.timelineUrl=l.fuzzyIndexUrl,h.navigationFrom=this.getNavigationFrom(d),h.updated=l.updated;for(const f in l.values){const g=Number(f),m=l.values[f],v=new re;v.key=g,v.urlKey=S(g,2),v.urlLink=`${h.urlPrefix}${v.urlKey}`,v.yearPage=h,v.yearIndex=s,v.count=m.count,v.page$=null,d?.year===s.key&&d?.month===g&&(v.page$=this.openMonthPage$(t,v,d)),h.monthEntries.unshift(v)}return h}))}openYearPage$(t,i,s){return this.buildIndex$(t,i.urlKey).pipe((0,T.w)(l=>this.openYearPageInternal$(t,l,i,s)))}openMonthPageInternal$(t,i,s,d){const l=s.yearIndex;return this.http.fetchGhJson(i).pipe((0,y.U)(h=>{const f=new oe;f.indexUrl=i,f.urlLink=s.urlLink,f.urlPrefix=`${f.urlLink}/`,f.lastDays=h.lastMonthDays,f.firstWeekday=h.firstWeekday,f.days=h.days,f.entries=h.defaultEntries,f.title=h.title,f.timelineUrl=h.fuzzyIndexUrl,f.navigationFrom=this.getNavigationFrom(d),f.updated=h.updated;for(const g in h.values){const m=Number(g),v=h.values[g],_=new H,I=new Date(Number(l.key),Number(s.key)-1,m);_.key=m,_.urlKey=S(m,2),_.urlLink=`${f.urlPrefix}${_.urlKey}`,_.monthPage=f,_.monthIndex=s,_.isSelected=!1,_.count=v.count,_.page$=null,_.isNationalHoliday$=this.isNationalHoliday$(I),_.nationalHoliday$=this.getNationalHoliday$(I),d?.year===l.key&&d?.month===s.key&&d?.day===m&&(_.isSelected=!0,_.page$=this.openDayIndexPage$(t,_.monthIndex,_,d)),f.dayEntries[m]=_}return f}))}openMonthPage$(t,i,s){return this.buildIndex$(t,i.yearIndex.urlKey,i.urlKey).pipe((0,T.w)(h=>this.openMonthPageInternal$(t,h,i,s)))}openDayIndexPageInternal$(t,i,s){return this.http.fetchGhJson(t).pipe((0,y.U)(d=>{const l=new ne;return l.indexUrl=t,l.urlLink=i.urlLink,l.title=d.title,l.entries=d.entries,l.navigationFrom=this.getNavigationFrom(s),l.updated=d.updated,l}))}openDayIndexPage$(t,i,s,d){return this.buildIndex$(t,i.yearIndex.urlKey,i.urlKey,s.urlKey).pipe((0,T.w)(h=>this.openDayIndexPageInternal$(h,s,d)))}}return r=a,(0,n.Z)(a,"\u0275fac",function(t){return new(t||r)(e.LFG(F.v),e.LFG(j.OE))}),(0,n.Z)(a,"\u0275prov",e.Yz7({token:r,factory:r.\u0275fac})),a})();var ue=u(353),pe=u(3867),L=u(2994),z=u(3620),ge=u(9026),fe=u(757),O=u(6223),me=u(8770);function ve(r,a){1&r&&(e.ynx(0),e._uU(1,","),e.BQk())}function xe(r,a){if(1&r&&(e.ynx(0),e.TgZ(1,"a",2),e._uU(2),e.qZA(),e.YNc(3,ve,2,0,"ng-container",0),e.BQk()),2&r){const o=a.$implicit,t=a.last;e.xp6(1),e.MGl("routerLink","./tag/",o.tagkey,""),e.xp6(1),e.Oqu(o.title),e.xp6(1),e.Q6J("ngIf",!t)}}function _e(r,a){if(1&r&&(e.ynx(0),e._UZ(1,"hr"),e.TgZ(2,"p"),e._uU(3,"Tag: "),e.YNc(4,xe,4,3,"ng-container",1),e.qZA(),e.BQk()),2&r){const o=e.oxw();e.xp6(4),e.Q6J("ngForOf",o.tags)}}let ye=(()=>{var r;class a{constructor(){(0,n.Z)(this,"tags",void 0)}ngOnInit(){(0,p.eM)("TagFooterComponent.OnInit()")}}return r=a,(0,n.Z)(a,"\u0275fac",function(t){return new(t||r)}),(0,n.Z)(a,"\u0275cmp",e.Xpm({type:r,selectors:[["gitwee-tag-footer"]],inputs:{tags:"tags"},decls:1,vars:1,consts:[[4,"ngIf"],[4,"ngFor","ngForOf"],[1,"p-1",3,"routerLink"]],template:function(t,i){1&t&&e.YNc(0,_e,5,1,"ng-container",0),2&t&&e.Q6J("ngIf",i.tags&&i.tags.length>0)},dependencies:[x.sg,x.O5,w.rH]})),a})();function Ce(r,a){if(1&r&&e._uU(0),2&r){const o=e.oxw().$implicit;e.Oqu(o.title)}}function we(r,a){if(1&r&&(e.TgZ(0,"a",16),e._uU(1),e.qZA()),2&r){const o=e.oxw().$implicit;e.Q6J("routerLink",o.anchorLink)("fragment",o.anchorId),e.xp6(1),e.Oqu(o.title)}}function Ze(r,a){if(1&r){const o=e.EpF();e.TgZ(0,"button",17),e.NdJ("click",function(){e.CHM(o);const i=e.oxw().$implicit,s=e.oxw();return e.KtG(s.toggleCensored(i))}),e._UZ(1,"img",18),e.qZA()}if(2&r){const o=e.oxw().$implicit;e.Q2q("data-bs-target","#gitweeTimelineItem-",o.anchorId,"")("aria-controls","#gitweeTimelineItem-",o.anchorId,""),e.xp6(1),e.Udp("transform",o.isOpened?"rotate(-90deg)":"none"),e.Q6J("@censorButtonTrigger",o.isOpened)}}function Te(r,a){if(1&r){const o=e.EpF();e.TgZ(0,"div",19,20),e.NdJ("appAfterIf",function(){e.CHM(o);const i=e.MAs(1);e.oxw();const s=e.MAs(1),d=e.oxw();return e.KtG(d.computeBottomFade(s,i))}),e.TgZ(2,"span",21)(3,"a",22),e._uU(4,"\u7d9a\u304d\u3092\u8aad\u3080"),e.qZA()()()}if(2&r){const o=e.oxw().$implicit;e.Udp("bottom",o.tags.length>0?140:80,"px"),e.xp6(3),e.s9C("routerLink",o.anchorLink)}}function $e(r,a){if(1&r&&e._UZ(0,"gitwee-tag-footer",23),2&r){const o=e.oxw().$implicit;e.Q6J("tags",o.tags)}}function Ie(r,a){if(1&r){const o=e.EpF();e.TgZ(0,"div",2,3)(2,"div",4)(3,"div",5),e.YNc(4,Ce,1,1,"ng-template",null,6,e.W1O),e.YNc(6,we,2,3,"a",7),e.qZA(),e.YNc(7,Ze,2,5,"button",8),e.qZA(),e.TgZ(8,"div",9)(9,"app-page-path",10,11),e.NdJ("loadPageBody",function(){e.CHM(o);const i=e.oxw();return e.KtG(i.onPageBodyRetrieved())})("fatalError",function(i){const d=e.CHM(o).$implicit,l=e.oxw();return e.KtG(l.onFatalError(d,i))})("loadPageJson",function(i){const s=e.CHM(o),d=s.$implicit,l=s.last,h=e.oxw();return e.KtG(h.onLoaded(d,i,l))})("loadError",function(i){const d=e.CHM(o).$implicit,l=e.oxw();return e.KtG(l.onErrorDraw(d,i))}),e.qZA(),e.YNc(11,Te,5,3,"div",12),e.YNc(12,$e,1,1,"gitwee-tag-footer",13),e.qZA(),e.TgZ(13,"div",14)(14,"small",15),e._uU(15),e.ALo(16,"date"),e.qZA()()()}if(2&r){const o=a.$implicit,t=e.MAs(5);e.Q6J("@timelineEntryTrigger",void 0),e.xp6(3),e.MGl("id","gitweeTimelinePage-",o.anchorId,""),e.xp6(3),e.Q6J("ngIf",o.anchorLink)("ngIfElse",t),e.xp6(1),e.Q6J("ngIf",o.isCensored),e.xp6(1),e.MGl("id","gitweeTimelineItem-",o.anchorId,""),e.Q6J("ngClass",o.isCensored?"collapse":"show"),e.xp6(1),e.Q6J("pagePath$",o.path$),e.xp6(2),e.Q6J("ngIf",o.hasMain),e.xp6(1),e.Q6J("ngIf",o.tags),e.xp6(3),e.hij("Updated: ",e.xi3(16,11,o.updated,"yyyy-MM-dd"),"")}}function be(r,a){1&r&&(e.TgZ(0,"div",28)(1,"div")(2,"strong"),e._uU(3,"\u8aad\u307f\u8fbc\u307f\u5931\u6557"),e.qZA()(),e.TgZ(4,"div"),e._uU(5,"\u6642\u9593\u3092\u958b\u3051\u3066\u304b\u3089\u518d\u5ea6\u304a\u8a66\u3057\u304f\u3060\u3055\u3044\u3002"),e.qZA(),e.TgZ(6,"button",29)(7,"span",30),e._uU(8,"\xd7"),e.qZA()()())}function Me(r,a){1&r&&(e.TgZ(0,"div"),e._UZ(1,"span",31),e.TgZ(2,"span"),e._uU(3,"Loading..."),e.qZA()())}function Ne(r,a){1&r&&(e.TgZ(0,"div"),e._uU(1,"\u3055\u3089\u306b\u8aad\u307f\u8fbc\u3080"),e.qZA())}function ke(r,a){if(1&r){const o=e.EpF();e.TgZ(0,"div",24),e.YNc(1,be,9,0,"div",25),e.TgZ(2,"button",26),e.NdJ("click",function(){e.CHM(o);const i=e.oxw();return e.KtG(i.onClickTrackback(i.streamPrevUrl))}),e.YNc(3,Me,4,0,"div",27),e.YNc(4,Ne,2,0,"div",27),e.qZA()()}if(2&r){const o=e.oxw();e.xp6(1),e.Q6J("ngIf",o.isLoadingError),e.xp6(1),e.Q6J("disabled",o.isLoadingPrevious),e.xp6(1),e.Q6J("ngIf",o.isLoadingPrevious),e.xp6(1),e.Q6J("ngIf",!o.isLoadingPrevious)}}class Pe{constructor(a,o,t){(0,n.Z)(this,"path$",void 0),(0,n.Z)(this,"keyPath",void 0),(0,n.Z)(this,"pageRelPath",void 0),(0,n.Z)(this,"title",void 0),(0,n.Z)(this,"anchorLink",void 0),(0,n.Z)(this,"anchorId",void 0),(0,n.Z)(this,"updated",void 0),(0,n.Z)(this,"isCensored",void 0),(0,n.Z)(this,"isOpened",void 0),(0,n.Z)(this,"hasMain",void 0),(0,n.Z)(this,"tags",void 0),this.path$=a,this.keyPath=o,this.pageRelPath=t}}class K{constructor(a,o=[]){(0,n.Z)(this,"url",void 0),(0,n.Z)(this,"entries",void 0),(0,n.Z)(this,"reloadId",void 0),(0,n.Z)(this,"refreshEvent",void 0),this.url=a,this.entries=o}}class Ae{constructor(a,o){(0,n.Z)(this,"obj",void 0),(0,n.Z)(this,"key",void 0),(0,n.Z)(this,"lastAccessAt",void 0),(0,n.Z)(this,"createdAt",void 0),this.obj=a,this.key=o,this.lastAccessAt=Date.now(),this.createdAt=Date.now()}}let Ee=(()=>{var r;class a{updateTimeline(){const t=[],i=this.dom.getBaseHref();for(const s of this.timelineIndicesOrdered){const d=this.timelineIndices[s];for(const l of d.entries){const h=`${i}${p.NZ.PAGE_DATA}/${l}`;let f=this.getTimelineCache(h);if(f){t.includes(f)||t.push(f);continue}const g=new fe._;g.jsonPath=h,f=new Pe((0,E.of)(g),g.jsonPath,l),t.push(f),this.putTimelineCache(f)}}this.timeline=t}constructor(t,i,s,d){(0,n.Z)(this,"router",void 0),(0,n.Z)(this,"index",void 0),(0,n.Z)(this,"dom",void 0),(0,n.Z)(this,"reloader",void 0),(0,n.Z)(this,"naviEntries$",void 0),(0,n.Z)(this,"trackbackEntries$",new Z.x),(0,n.Z)(this,"timeline",[]),(0,n.Z)(this,"timelineEntryCache",{}),(0,n.Z)(this,"MaxCacheItem",200),(0,n.Z)(this,"CacheExpireMS",36e5),(0,n.Z)(this,"timelineIndices",{}),(0,n.Z)(this,"timelineIndicesOrdered",[]),(0,n.Z)(this,"streamPrevUrl",void 0),(0,n.Z)(this,"isLoadingPrevious",!1),(0,n.Z)(this,"isLoadingError",!1),(0,n.Z)(this,"pendingAnchorNavi",void 0),(0,n.Z)(this,"backgroundFadeGradient$",void 0),(0,n.Z)(this,"destroy$",new Z.x),this.router=t,this.index=i,this.dom=s,this.reloader=d}ngOnDestroy(){(0,p.eM)("TimelineComponent.OnDestroy()"),this.cleanupTimelineIndices(),this.destroy$.next()}ngOnInit(){(0,p.eM)("TimelineComponent.OnInit()"),this.naviEntries$.pipe((0,z.b)(500),(0,C.R)(this.destroy$)).subscribe(t=>{switch(t.navigationFrom){case"click":case"url":{this.cleanupTimelineIndices();const i=new K(null,t.entries);this.timelineIndices.default=i,this.timelineIndicesOrdered.push("default")}break;case"reload":this.timelineIndices.default.entries=t.entries;break;default:throw new Error(`Not supported navigationFrom ${t.navigationFrom}`)}this.updateTimeline(),this.timelineIndices[t.timelineUrl]||(this.streamPrevUrl=t.timelineUrl),this.isLoadingPrevious=!1}),this.trackbackEntries$.pipe((0,C.R)(this.destroy$)).subscribe(t=>{if("click"!==t.navigationFrom)throw new Error("Not a supported navigationFrom ${page.navigationFrom}");this.updateTimeline(),this.isLoadingPrevious=!1}),this.router.currentFragment$.pipe((0,C.R)(this.destroy$)).subscribe(t=>{this.pendingAnchorNavi=t})}rgb2hex(t){const i=t.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/);return i?`#${i.slice(1).map(d=>parseInt(d,10).toString(16).padStart(2,"0")).join("")}`:null}computeBaseColor(t){const i=window.getComputedStyle(t);return"background-color"in i?this.rgb2hex(i["background-color"])||((0,p.wb)("Failed to parse background color for fade."),"#ffffff"):((0,p.wb)("Failed to compute background color for fade."),"#ffffff")}computeBottomFade(t,i){(0,p.eM)("Computing fade color");const s=this.computeBaseColor(t);i.style.background=`linear-gradient(to top, ${s}ff, 90%, ${s}00)`}onFatalError(t,i){(0,p.eM)("TimelineComponent.onFatalError()",i)}onErrorDraw(t,i){(0,p.eM)("TimelineComponent.onErrorDraw()")}onLoaded(t,i,s){(0,p.eM)("TimelineComponent.onLoaded()",t,i,s),t.title=i.title,t.anchorLink=i.anchorLink,t.anchorId=i.anchorId,t.updated=new Date(i.updatedAt||i.updated),t.isCensored=!!i.isDefaultClosed,t.isOpened=!t.isCensored,t.hasMain=i.hasMain||!1,t.tags=i.tags}toggleCensored(t){t.isOpened=!t.isOpened}onPageBodyRetrieved(){this.pendingAnchorNavi&&this.dom.scrollIntoView(`gitweeTimelinePage-${this.pendingAnchorNavi}`)&&(this.pendingAnchorNavi=null)}cleanupIndexItem(t){t.reloadId&&(this.reloader.unregister(t.reloadId),delete t.reloadId),t.refreshEvent&&(t.refreshEvent.unsubscribe(),delete t.refreshEvent)}expireTimelineCache(){const t=Object.keys(this.timelineEntryCache),i=t.length;if(i<=this.MaxCacheItem)return;(0,p.H_)(`Cleaning up timeline cache size: ${i}`);const s=Date.now()-this.CacheExpireMS;let d=[];for(const g of t){const m=this.timelineEntryCache[g];m.lastAccessAt>s||d.push(m)}d=d.sort((g,m)=>g.lastAccessAt===m.lastAccessAt?0:g.lastAccessAt<m.lastAccessAt?-1:1),(0,p.eM)("Target to expire.",d);const l=i-this.MaxCacheItem;for(let g=0;g<l&&g<d.length;g++)delete this.timelineEntryCache[d[g].key];const f=Object.keys(this.timelineEntryCache).length;(0,p.H_)(`Cache was cleaned up size: ${i} -> ${f}`)}getTimelineCache(t){const i=this.timelineEntryCache[t];return i?(i.lastAccessAt=Date.now(),i.obj):null}putTimelineCache(t){let i=this.timelineEntryCache[t.keyPath];i?i.lastAccessAt=Date.now():(i=new Ae(t,t.keyPath),this.timelineEntryCache[t.keyPath]=i)}cleanupTimelineIndices(){if(this.timelineIndices)for(const t in this.timelineIndices)this.cleanupIndexItem(this.timelineIndices[t]);this.expireTimelineCache(),this.timelineIndices={},this.timelineIndicesOrdered=[]}refreshIndex(t,i){let s=this.timelineIndices[t];s||(s=new K(t),this.timelineIndices[t]=s),s.entries=i.entries,this.cleanupIndexItem(s);const d=this.reloader.registerWatcher(t,new Date(i.updatedAt));s.reloadId=d,s.refreshEvent=this.reloader.refreshEvent(d).pipe((0,T.w)(()=>this.index.fetchWeeklyIndex$(t)),(0,C.R)(this.destroy$)).subscribe(l=>{this.refreshIndex(t,l)}),this.timelineIndicesOrdered.includes(t)||this.timelineIndicesOrdered.push(t)}onClickTrackback(t){(0,p.eM)("TimelineComponent.onClickTrackback()",t),this.isLoadingPrevious=!0,this.isLoadingError=!1;const i=new b.X(t);i.pipe((0,T.w)(d=>(0,ge.$)((0,E.of)(d),this.index.fetchWeeklyIndex$(d))),(0,N.d)(1)).pipe((0,C.R)(this.destroy$)).subscribe({next:([d,l])=>{if(this.refreshIndex(d,l),this.streamPrevUrl=l.previousIndexUrl,l.entries.length>0){const h=new R;return h.entries=l.entries,h.timelineUrl=l.previousIndexUrl,h.navigationFrom="click",void this.trackbackEntries$.next(h)}l.previousIndexUrl&&((0,p.eM)(`Continue retrieving ${l.previousIndexUrl} since empty.`),i.next(l.previousIndexUrl))},complete:()=>{(0,p.eM)("Successfully completed auto trackback loader"),this.isLoadingPrevious=!1},error:d=>{this.isLoadingError=!0,this.isLoadingPrevious=!1}})}}return r=a,(0,n.Z)(a,"\u0275fac",function(t){return new(t||r)(e.Y36(Q.Z),e.Y36($),e.Y36(F.v),e.Y36(O.f))}),(0,n.Z)(a,"\u0275cmp",e.Xpm({type:r,selectors:[["gitwee-timeline"]],inputs:{naviEntries$:"naviEntries$"},decls:2,vars:2,consts:[["class","card shadow-lg rounded m-2 gitwee-timeline-item",4,"ngFor","ngForOf"],["class","p-5",4,"ngIf"],[1,"card","shadow-lg","rounded","m-2","gitwee-timeline-item"],["timelineItemDiv",""],[1,"card-header"],[1,"float-start",3,"id"],["justTitle",""],[3,"routerLink","fragment",4,"ngIf","ngIfElse"],["class","btn float-end collapsed","data-bs-toggle","collapse","aria-expanded","false",3,"click",4,"ngIf"],[1,"card-body",3,"id","ngClass"],[1,"m-3","p-3",3,"pagePath$","loadPageBody","fatalError","loadPageJson","loadError"],["pagePathComponent",""],["class","timeline-fadeout-entry",3,"bottom","appAfterIf",4,"ngIf"],[3,"tags",4,"ngIf"],[1,"card-footer"],[1,"float-end","text-muted"],[3,"routerLink","fragment"],["data-bs-toggle","collapse","aria-expanded","false",1,"btn","float-end","collapsed",3,"click"],["src","/assets/octicons/chevron-left.svg"],[1,"timeline-fadeout-entry",3,"appAfterIf"],["bottomFaderDiv",""],[2,"position","absolute","bottom","0px"],[3,"routerLink"],[3,"tags"],[1,"p-5"],["class","alert alert-warning alert-dismissible fade show","role","alert",4,"ngIf"],["type","button",1,"btn","btn-outline-primary","btn-block",2,"width","100%",3,"disabled","click"],[4,"ngIf"],["role","alert",1,"alert","alert-warning","alert-dismissible","fade","show"],["type","button","data-bs-dismiss","alert","aria-label","Close",1,"btn-close"],["aria-hidden","true"],["role","status","aria-hidden","true",1,"spinner-border","text-primary"]],template:function(t,i){1&t&&(e.YNc(0,Ie,17,14,"div",0),e.YNc(1,ke,5,4,"div",1)),2&t&&(e.Q6J("ngForOf",i.timeline),e.xp6(1),e.Q6J("ngIf",i.streamPrevUrl))},dependencies:[x.mk,x.sg,x.O5,w.rH,L.Y,me.C,ye,x.uU],styles:[".timeline-fadeout-entry[_ngcontent-%COMP%]{position:absolute;width:100%;height:30%;left:0%;padding:2%}"],data:{animation:[(0,c.X$)("timelineEntryTrigger",[(0,c.eR)(":enter",[(0,c.oB)({opacity:0,transform:"translateY(10px)"}),(0,c.jt)("300ms 300ms ease-in-out",(0,c.oB)({transform:"none",opacity:1})),(0,c.pV)()]),(0,c.eR)(":leave",[(0,c.pV)(),(0,c.oB)({opacity:1,transform:"none"}),(0,c.jt)("300ms ease-in-out",(0,c.oB)({opacity:0,transform:"translateY(-10px)"}))])]),(0,c.X$)("censorButtonTrigger",[(0,c.eR)("false => true",[(0,c.oB)({transform:"none"}),(0,c.jt)("500ms ease-in-out",(0,c.oB)({transform:"rotate(-90deg)"}))]),(0,c.eR)("true => false",[(0,c.oB)({transform:"rotate(-90deg)"}),(0,c.jt)("500ms ease-in-out",(0,c.oB)({transform:"none"}))])])]}})),a})();function Fe(r,a){if(1&r&&(e.TgZ(0,"th")(1,"div"),e._uU(2),e.qZA()()),2&r){const o=a.$implicit;e.xp6(1),e.Gre("",o.clz," text-center"),e.xp6(1),e.Oqu(o.name)}}function Le(r,a){if(1&r&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&r){const o=e.oxw(2).$implicit;e.xp6(1),e.Oqu(o.key)}}function Ue(r,a){if(1&r){const o=e.EpF();e.ynx(0,12),e.NdJ("appAfterIf",function(){const s=e.CHM(o).ngIf,d=e.oxw(3).$implicit,l=e.oxw(2);return e.KtG(l.onPageRetrieved(d,s))}),e.BQk()}}function De(r,a){if(1&r){const o=e.EpF();e.TgZ(0,"div")(1,"a",9),e.NdJ("click",function(i){e.CHM(o);const s=e.oxw(2).$implicit,d=e.oxw(2);return e.KtG(d.onClickDay(i,s))}),e.TgZ(2,"span",10),e._uU(3),e.qZA()(),e.YNc(4,Ue,1,0,"ng-container",11),e.ALo(5,"async"),e.qZA()}if(2&r){const o=e.oxw(2).$implicit,t=e.oxw(2);e.xp6(1),e.MGl("title","",o.count," \u4ef6"),e.hYB("href","",t.urlPrefix,"/",o.urlLink,"",e.LSH),e.xp6(2),e.Oqu(o.key),e.xp6(1),e.Q6J("ngIf",e.lcZ(5,5,o.page$))}}const Se=function(){return["border-bottom","border-danger"]},W=function(){return[]};function Ye(r,a){if(1&r&&(e.TgZ(0,"div",6),e.ALo(1,"async"),e.YNc(2,Le,2,1,"ng-template",null,7,e.W1O),e.YNc(4,De,6,7,"div",8),e.qZA()),2&r){const o=e.MAs(3),t=e.oxw().$implicit,i=e.oxw(2);e.Q6J("ngClass",e.lcZ(1,3,t.isNationalHoliday$)?e.DdM(5,Se):e.DdM(6,W)),e.xp6(4),e.Q6J("ngIf",i.isIndexedDay(t))("ngIfElse",o)}}const Oe=function(){return["border-primary"]};function Ge(r,a){if(1&r&&(e.TgZ(0,"td",3)(1,"div",4),e.YNc(2,Ye,5,7,"div",5),e.qZA()()),2&r){const o=a.$implicit;e.xp6(1),e.Udp("border-color",null!=o&&o.isSelected?void 0:"transparent!important"),e.Q6J("ngClass",null!=o&&o.isSelected?e.DdM(4,Oe):e.DdM(5,W)),e.xp6(1),e.Q6J("ngIf",null!==o)}}function Je(r,a){if(1&r&&(e.TgZ(0,"tr"),e.YNc(1,Ge,3,6,"td",2),e.qZA()),2&r){const o=a.$implicit;e.xp6(1),e.Q6J("ngForOf",o)}}class X{constructor(a,o){(0,n.Z)(this,"date",void 0),(0,n.Z)(this,"index",void 0),(0,n.Z)(this,"key",void 0),(0,n.Z)(this,"count",0),(0,n.Z)(this,"isSelected",!1),(0,n.Z)(this,"isNationalHoliday$",void 0),this.date=a,this.index=o,this.key=a.getDate(),this.isNationalHoliday$=this.index.isNationalHoliday$(a)}}let Be=(()=>{var r;class a{constructor(t,i){(0,n.Z)(this,"route",void 0),(0,n.Z)(this,"index",void 0),(0,n.Z)(this,"month",void 0),(0,n.Z)(this,"monthIndex",void 0),(0,n.Z)(this,"urlPrefix",void 0),(0,n.Z)(this,"selected",new e.vpe),(0,n.Z)(this,"weekdays",[{name:"\u65e5",value:0,clz:"calendar-sunday"},{name:"\u6708",value:1},{name:"\u706b",value:2},{name:"\u6c34",value:3},{name:"\u6728",value:4},{name:"\u91d1",value:5},{name:"\u571f",value:6,clz:"calendar-saturday"}]),(0,n.Z)(this,"monthWeeks",void 0),(0,n.Z)(this,"selectedDay",void 0),this.route=t,this.index=i}ngOnInit(){(0,p.eM)("CalendarPageComponent.OnInit()");const t=(this.month.firstWeekday+(this.month.days-1))%7,i=(0===this.month.firstWeekday?0:7-this.month.firstWeekday)+this.month.days+(6===t?0:7-t),s=[];for(let f=0;f<i/7;f++){const g=new Array(7);g.fill(null),s.push(g)}const d=this.month.firstWeekday,l=Number(this.monthIndex.yearIndex.key),h=Number(this.monthIndex.key)-1;for(let f=0,g=d;f<this.month.days;f++,g++){const m=f+1,v=new Date(l,h,m);let _=this.month.dayEntries[m];_||(_=new X(v,this.index)),s[Math.floor(g/7)][g%7]=_}this.monthWeeks=s}ngOnDestroy(){(0,p.eM)("CalendarPageComponent.OnDestroy()")}unselect(){this.selectedDay=null}onClickNothing(t){(0,p.eM)("onClickNothing()",t),t.preventDefault(),t.stopPropagation()}onClickDay(t,i){(0,p.eM)("onClickDay()",t,i),t.preventDefault(),t.stopPropagation(),i.page$=this.index.openDayIndexPage$(this.route,this.monthIndex,i)}onPageRetrieved(t,i){this.selectedDay&&(this.selectedDay.page$=null,this.selectedDay.isSelected=!1),t.isSelected=!0,this.selectedDay=t,this.selected.emit({index:t,page:i})}isIndexedDay(t){return t instanceof H}isEmptyDay(t){return t instanceof X}}return r=a,(0,n.Z)(a,"\u0275fac",function(t){return new(t||r)(e.Y36(w.gz),e.Y36($))}),(0,n.Z)(a,"\u0275cmp",e.Xpm({type:r,selectors:[["gitwee-calendar-page"]],inputs:{month:"month",monthIndex:"monthIndex",urlPrefix:"urlPrefix"},outputs:{selected:"selected"},decls:3,vars:2,consts:[[1,"shadow","border","border-info","my-2",3,"click"],[4,"ngFor","ngForOf"],["class","text-center",4,"ngFor","ngForOf"],[1,"text-center"],[1,"border",3,"ngClass"],[3,"ngClass",4,"ngIf"],[3,"ngClass"],["justDay",""],[4,"ngIf","ngIfElse"],[3,"title","href","click"],[1,"gitwee-calendar-day"],[3,"appAfterIf",4,"ngIf"],[3,"appAfterIf"]],template:function(t,i){1&t&&(e.TgZ(0,"table",0),e.NdJ("click",function(d){return i.onClickNothing(d)}),e.YNc(1,Fe,3,4,"th",1),e.YNc(2,Je,2,1,"tr",1),e.qZA()),2&t&&(e.xp6(1),e.Q6J("ngForOf",i.weekdays),e.xp6(1),e.Q6J("ngForOf",i.monthWeeks))},dependencies:[x.mk,x.sg,x.O5,L.Y,x.Ov],styles:[".calendar-saturday[_ngcontent-%COMP%]{color:#00f}.calendar-sunday[_ngcontent-%COMP%]{color:red}",".gitwee-sidebar-node[_ngcontent-%COMP%]{transition:transform .5s}.gitwee-sidebar-node[_ngcontent-%COMP%]:hover{transform:scale(1.03);z-index:10000}.gitwee-navi-item[_ngcontent-%COMP%]{display:inline-block;text-overflow:ellipsis;overflow:hidden;white-space:nowrap;vertical-align:text-bottom}.gitwee-calendar-day[_ngcontent-%COMP%]{display:inline-block;white-space:nowrap}"],data:{animation:[]}})),a})();function Re(r,a){if(1&r){const o=e.EpF();e.TgZ(0,"div",2),e.NdJ("appAfterIf",function(){const s=e.CHM(o).ngIf,d=e.oxw().$implicit,l=e.oxw(4);return e.KtG(l.onMonthNodeExpanded(d,s))}),e.TgZ(1,"gitwee-calendar-page",11),e.NdJ("selected",function(i){e.CHM(o);const s=e.oxw(5);return e.KtG(s.onDaySelected(i))}),e.qZA()()}if(2&r){const o=a.ngIf,t=e.oxw().$implicit,i=e.oxw(4);e.Q6J("@slidedownTrigger",void 0),e.xp6(1),e.Q6J("urlPrefix",i.urlPrefix)("monthIndex",t)("month",o)}}function He(r,a){if(1&r){const o=e.EpF();e.TgZ(0,"li",6),e.NdJ("click",function(i){const d=e.CHM(o).$implicit,l=e.oxw(4);return e.KtG(l.onClickMonth(i,d))}),e.TgZ(1,"a",7)(2,"span",8),e._uU(3),e.qZA()(),e.TgZ(4,"span",9),e._uU(5),e.qZA(),e.YNc(6,Re,2,4,"div",1),e.ALo(7,"async"),e.qZA()}if(2&r){const o=a.$implicit,t=e.oxw(4);e.ekj("gitwee-sidebar-node",!t.selectedMonth||o!==t.selectedMonth),e.xp6(1),e.hYB("href","",t.urlPrefix,"/",o.urlLink,"",e.LSH),e.xp6(2),e.hij("",o.key," \u6708"),e.xp6(1),e.ekj("bg-primary",o===t.selectedMonth)("bg-secondary",o!==t.selectedMonth),e.xp6(1),e.Oqu(o.count),e.xp6(1),e.Q6J("ngIf",e.lcZ(7,11,o.page$))}}function Qe(r,a){if(1&r){const o=e.EpF();e.TgZ(0,"div",2),e.NdJ("appAfterIf",function(){const s=e.CHM(o).ngIf,d=e.oxw().$implicit,l=e.oxw(2);return e.KtG(l.onYearNodeExpanded(d,s))}),e.TgZ(1,"ul",10),e.YNc(2,He,8,13,"li",4),e.qZA()()}if(2&r){const o=a.ngIf;e.Q6J("@slidedownTrigger",void 0),e.xp6(2),e.Q6J("ngForOf",o.monthEntries)}}function je(r,a){if(1&r){const o=e.EpF();e.TgZ(0,"li",6),e.NdJ("click",function(i){const d=e.CHM(o).$implicit,l=e.oxw(2);return e.KtG(l.onClickYear(i,d))}),e.TgZ(1,"a",7)(2,"span",8),e._uU(3),e.qZA()(),e.TgZ(4,"span",9),e._uU(5),e.qZA(),e.YNc(6,Qe,3,2,"div",1),e.ALo(7,"async"),e.qZA()}if(2&r){const o=a.$implicit,t=e.oxw(2);e.ekj("gitwee-sidebar-node",!t.selectedYear||o!==t.selectedYear),e.Q6J("@calendarNodeTrigger",void 0),e.xp6(1),e.hYB("href","",t.urlPrefix,"/",o.urlLink,"",e.LSH),e.xp6(2),e.hij("",o.key," \u5e74"),e.xp6(1),e.ekj("bg-primary",o===t.selectedYear)("bg-secondary",o!==t.selectedYear),e.xp6(1),e.Oqu(o.count),e.xp6(1),e.Q6J("ngIf",e.lcZ(7,12,o.page$))}}function ze(r,a){if(1&r){const o=e.EpF();e.TgZ(0,"li",12),e.NdJ("click",function(i){e.CHM(o);const s=e.oxw(2);return e.KtG(s.onClickYearToggler(i))}),e.TgZ(1,"span"),e._uU(2),e.qZA()()}if(2&r){const o=e.oxw(2);e.Q6J("@calendarNodeTrigger",void 0),e.xp6(2),e.Oqu(o.yearShowAll?"\u6298\u308a\u305f\u305f\u3080":"\u8868\u793a\u3092\u5897\u3084\u3059")}}function Ke(r,a){if(1&r){const o=e.EpF();e.TgZ(0,"div",2),e.NdJ("appAfterIf",function(){const s=e.CHM(o).ngIf,d=e.oxw();return e.KtG(d.onTopNodeExpanded(s))}),e.TgZ(1,"ul",3),e.YNc(2,je,8,14,"li",4),e.YNc(3,ze,3,2,"li",5),e.qZA()()}if(2&r){const o=a.ngIf,t=e.oxw();e.Q6J("@calendarListTrigger",void 0),e.xp6(2),e.Q6J("ngForOf",o.yearEntries.slice(0,t.yearCount)),e.xp6(1),e.Q6J("ngIf",!t.showYearToggler)}}let We=(()=>{var r;class a{constructor(t,i,s){(0,n.Z)(this,"route",void 0),(0,n.Z)(this,"index",void 0),(0,n.Z)(this,"reloader",void 0),(0,n.Z)(this,"index$",void 0),(0,n.Z)(this,"nodeExpanded",new e.vpe),(0,n.Z)(this,"notFound",new e.vpe),(0,n.Z)(this,"route$",void 0),(0,n.Z)(this,"urlPrefix",void 0),(0,n.Z)(this,"reload$",new Z.x),(0,n.Z)(this,"reloadId",void 0),(0,n.Z)(this,"refreshSubscription",void 0),(0,n.Z)(this,"defaultYearCount",3),(0,n.Z)(this,"yearShowAll",!1),(0,n.Z)(this,"isNavigateDerived",!1),(0,n.Z)(this,"pendingFragment",null),(0,n.Z)(this,"destroy$",new Z.x),(0,n.Z)(this,"selectedYear",void 0),(0,n.Z)(this,"selectedMonth",void 0),(0,n.Z)(this,"selectedDay",void 0),(0,n.Z)(this,"naviMatcher",void 0),(0,n.Z)(this,"allowYearToggler",void 0),this.route=t,this.index=i,this.reloader=s,(0,p.eM)("CalendarNaviComponent.constructor()");const d="^([0-9]{4})(?:/([0-9]{2})(?:/([0-9]{2})/?)?)?$";this.naviMatcher=new RegExp(d),(0,p.eM)("CalendarNaviComponent URL Matcher",d)}unselect(t){t||(this.isNavigateDerived=!1),this.index$||(this.index$=this.index.fetchIndex$(this.route)),this.selectedYear&&(this.selectedYear.page$=null),this.selectedYear=null,this.selectedMonth&&(this.selectedMonth.page$=null),this.yearShowAll=!1,this.selectedMonth=null,this.selectedDay=null}get showYearToggler(){return this.allowYearToggler&&!!this.selectedYear}get yearCount(){if(!this.yearShowAll)return this.defaultYearCount}onNodeExpanded(t){(0,p.eM)("CalendarNaviComponent.onNodeExpanded()",t),this.pendingFragment&&(t.urlLink=`${t.urlLink}#${this.pendingFragment}`,delete this.pendingFragment),this.nodeExpanded.emit(t)}onTopNodeExpanded(t){(0,p.eM)("CalendarNaviComponent.onTopNodeExpanded()",t,this.isNavigateDerived),this.startWatching(t),this.allowYearToggler=this.defaultYearCount<t.yearEntries.length;for(const i of t.yearEntries)if(i.page$)return;this.isNavigateDerived&&this.onNodeExpanded(t)}onYearNodeExpanded(t,i){(0,p.eM)("CalendarNaviComponent.onYearNodeExpanded()",t),this.selectedYear&&(this.selectedYear.page$=null),this.selectedYear=t;for(const s of i.monthEntries)if(s.page$)return;this.onNodeExpanded(i)}onMonthNodeExpanded(t,i){(0,p.eM)("CalendarNaviComponent.onMonthNodeExpanded()",t),this.selectedMonth&&(this.selectedMonth.page$=null),this.selectedMonth=t;for(const s in i.dayEntries)if(i.dayEntries[s].page$)return;this.onNodeExpanded(i)}ensureUnregisterWathing(){this.reloadId&&(this.reloader.unregister(this.reloadId),this.reloadId=null),this.refreshSubscription&&this.refreshSubscription.unsubscribe()}startWatching(t){this.ensureUnregisterWathing();const i=this.reloader.registerWatcher(t.indexUrl,t.updated);this.reloadId=i,this.refreshSubscription=this.reloader.refreshEvent(i).pipe((0,C.R)(this.destroy$)).subscribe(()=>{this.reload$.next()})}ngOnInit(){(0,p.eM)("CalendarNaviComponent.OnInit()"),this.route$.pipe((0,C.R)(this.destroy$)).subscribe(t=>{if(this.isNavigateDerived="Calendar"===t.category,!this.isNavigateDerived)return void this.unselect();if(!t.navigators)return this.index$=null,void this.unselect(!0);const i=t.navigators.match(this.naviMatcher);if(!i)return(0,p.wb)("No route to",t),void this.unselect(!0);const s=Y(i[1]),d=Y(i[2]),l=Y(i[3]);if(function he(r,a,o){if(r){if(r<1900||9999<r)return!1}else if(a||o)return!1;if(a){if(a<1||12<a)return!1}else if(o)return!1;const t=new Date(r,a,o);return!(t.getFullYear()!==r||t.getMonth()!==a-1||t.getDate()!==o)}(s,d,l))return(0,p.wb)(`Invalidate Routing date ${s}-${d}-${l}`,t),void this.unselect(!0);(0,p.eM)(`CalendarNaviComponent detect routing ${s} ${d} ${l} ${t.fragment}`),this.pendingFragment=t.fragment;const h={year:s,month:d,day:l};this.yearShowAll=!!s,this.index$=this.index.fetchIndex$(this.route,h)}),this.reload$.pipe((0,C.R)(this.destroy$)).subscribe(()=>{const t={year:this.selectedYear?.key,month:this.selectedMonth?.key,day:this.selectedDay?.key,isReload:!0};(0,p.eM)("Reload is clicked on CalendarNaviComponent.",t),this.selectedDay=null,this.selectedMonth=null,this.selectedYear=null,this.index$=this.index.fetchIndex$(this.route,t)})}ngAfterViewInit(){(0,p.eM)("CalendarNaviComponent.AfterViewInit()")}ngOnDestroy(){(0,p.eM)("CalendarNaviComponent.OnDestroy()"),this.ensureUnregisterWathing(),this.destroy$.next()}onClickYearToggler(t){(0,p.eM)("CalendarNaviComponent.onClickYearToggler()",t),this.yearShowAll=!this.yearShowAll}onClickYear(t,i){if((0,p.eM)("CalendarNaviComponent.onClickYear()",t,i),t.preventDefault(),t.stopPropagation(),this.selectedMonth=null,this.selectedDay=null,this.selectedYear===i)return this.onNodeExpanded(i.topPage),i.page$=null,void(this.selectedYear=null);i.page$=this.index.openYearPage$(this.route,i)}onClickMonth(t,i){if((0,p.eM)("CalendarNaviComponent.onClickMonth()",t,i),t.preventDefault(),t.stopPropagation(),this.selectedDay=null,this.selectedMonth===i)return this.onNodeExpanded(i.yearPage),i.page$=null,void(this.selectedMonth=null);i.page$=this.index.openMonthPage$(this.route,i)}onDaySelected(t){(0,p.eM)("CalendarNaviComponent.onDaySelected()",t),this.selectedDay=t.index,this.onNodeExpanded(t.page)}}return r=a,(0,n.Z)(a,"\u0275fac",function(t){return new(t||r)(e.Y36(w.gz),e.Y36($),e.Y36(O.f))}),(0,n.Z)(a,"\u0275cmp",e.Xpm({type:r,selectors:[["gitwee-calendar-navi"]],inputs:{route$:"route$",urlPrefix:"urlPrefix"},outputs:{nodeExpanded:"nodeExpanded",notFound:"notFound"},decls:3,vars:3,consts:[["id","gitweeCalendarYearIndex"],[3,"appAfterIf",4,"ngIf"],[3,"appAfterIf"],[1,"list-group"],["class","list-group-item align-items-center row text-end shadow gitwee-listing-calendar",3,"gitwee-sidebar-node","click",4,"ngFor","ngForOf"],["id","gitweeCalendarNaviToggler","class","align-items-center row btn btn-secondary","role","button","tabindex","0",3,"click",4,"ngIf"],[1,"list-group-item","align-items-center","row","text-end","shadow","gitwee-listing-calendar",3,"click"],[1,"col-8",3,"href"],[1,"gitwee-navi-item"],[1,"badge","rounded-pill","col-4"],[1,"list-group","list-group-flush","my-2"],[3,"urlPrefix","monthIndex","month","selected"],["id","gitweeCalendarNaviToggler","role","button","tabindex","0",1,"align-items-center","row","btn","btn-secondary",3,"click"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0),e.YNc(1,Ke,4,3,"div",1),e.ALo(2,"async"),e.qZA()),2&t&&(e.xp6(1),e.Q6J("ngIf",e.lcZ(2,1,i.index$)))},dependencies:[x.sg,x.O5,L.Y,Be,x.Ov],styles:[".gitwee-listing-calendar[_ngcontent-%COMP%]{cursor:pointer}",".gitwee-sidebar-node[_ngcontent-%COMP%]{transition:transform .5s}.gitwee-sidebar-node[_ngcontent-%COMP%]:hover{transform:scale(1.03);z-index:10000}.gitwee-navi-item[_ngcontent-%COMP%]{display:inline-block;text-overflow:ellipsis;overflow:hidden;white-space:nowrap;vertical-align:text-bottom}.gitwee-calendar-day[_ngcontent-%COMP%]{display:inline-block;white-space:nowrap}"],data:{animation:[(0,c.X$)("calendarNodeTrigger",[(0,c.eR)(":enter",[(0,c.oB)({opacity:0,transform:"translateX(5px)"}),(0,c.jt)("500ms ease-in-out",(0,c.oB)({opacity:1,transform:"none"}))]),(0,c.eR)(":leave",[(0,c.jt)("500ms ease-in-out",(0,c.oB)({opacity:0,transform:"translateX(5px)"}))])]),(0,c.X$)("calendarListTrigger",[(0,c.eR)(":enter",[(0,c.oB)({opacity:0,transform:"translateX(5px)"}),(0,c.jt)("500ms 200ms ease-in-out",(0,c.oB)({opacity:1,transform:"none"}))]),(0,c.eR)(":leave",[(0,c.oB)({position:"absolute",width:"100%"}),(0,c.jt)("200ms ease-in-out",(0,c.oB)({opacity:0,transform:"translateX(5px)"}))])]),(0,c.X$)("slidedownTrigger",[(0,c.eR)(":enter",[(0,c.oB)({opacity:0,transform:"translateY(-5px)"}),(0,c.jt)("500ms ease-in-out",(0,c.oB)({opacity:1,transform:"none"}))]),(0,c.eR)(":leave",[(0,c.jt)("500ms ease-in-out",(0,c.oB)({opacity:0,transform:"translateY(-5px)"}))])])]}})),a})();var Xe=u(1748);function qe(r,a){if(1&r){const o=e.EpF();e.TgZ(0,"li",5),e.NdJ("click",function(i){const d=e.CHM(o).$implicit,l=e.oxw(2);return e.KtG(l.onClickTag(i,d))}),e.TgZ(1,"a",6)(2,"span",7),e._uU(3),e.qZA()(),e.TgZ(4,"span",8),e._uU(5),e.qZA()()}if(2&r){const o=a.$implicit,t=e.oxw(2);e.hYB("title","",o.title,"",o.noteTooltip?": "+o.noteTooltip:"",""),e.xp6(1),e.hYB("href","",t.urlPrefix,"/",o.urlLink,"",e.LSH),e.xp6(2),e.Oqu(o.title),e.xp6(1),e.ekj("bg-primary",(null==t.selectedPage?null:t.selectedPage.tagkey)===o.tagkey)("bg-secondary",(null==t.selectedPage?null:t.selectedPage.tagkey)!==o.tagkey),e.xp6(1),e.Oqu(o.count)}}function Ve(r,a){if(1&r){const o=e.EpF();e.TgZ(0,"span",14),e.NdJ("click",function(i){const d=e.CHM(o).$implicit,l=e.oxw(3);return e.KtG(l.onClickTag(i,d))}),e._uU(1),e.qZA()}if(2&r){const o=a.$implicit;e.hYB("title","",o.title,"",o.noteTooltip?": "+o.noteTooltip:"",""),e.xp6(1),e.AsE("",o.title," ( ",o.count," )")}}function et(r,a){if(1&r&&(e.TgZ(0,"li",9)(1,"div",10)(2,"button",11),e._uU(3,"\u305d\u306e\u4ed6"),e.qZA(),e.TgZ(4,"div",12),e.YNc(5,Ve,2,4,"span",13),e.qZA()()()),2&r){const o=e.oxw().ngIf,t=e.oxw();e.xp6(5),e.Q6J("ngForOf",o.entries.slice(t.TagDefaultCount,t.TagMaxCount))}}function tt(r,a){if(1&r&&(e.TgZ(0,"div",1)(1,"div")(2,"ul",2),e.YNc(3,qe,6,10,"li",3),e.YNc(4,et,6,1,"li",4),e.qZA()()()),2&r){const o=a.ngIf,t=e.oxw();e.Q6J("@tagListTrigger",void 0),e.xp6(3),e.Q6J("ngForOf",o.entries.slice(0,t.TagDefaultCount)),e.xp6(1),e.Q6J("ngIf",o.entries.length>t.TagDefaultCount)}}let it=(()=>{var r;class a{constructor(t,i,s){(0,n.Z)(this,"route",void 0),(0,n.Z)(this,"index",void 0),(0,n.Z)(this,"reloader",void 0),(0,n.Z)(this,"index$",void 0),(0,n.Z)(this,"route$",void 0),(0,n.Z)(this,"urlPrefix",void 0),(0,n.Z)(this,"tagSelected",new e.vpe),(0,n.Z)(this,"notFound",new e.vpe),(0,n.Z)(this,"TagDefaultCount",10),(0,n.Z)(this,"TagMaxCount",30),(0,n.Z)(this,"isNavigateDerived",!1),(0,n.Z)(this,"destroy$",new Z.x),(0,n.Z)(this,"indexSub",null),(0,n.Z)(this,"selectedPage",null),(0,n.Z)(this,"tagMatcher",void 0),(0,n.Z)(this,"reloadListId",void 0),(0,n.Z)(this,"refreshListSubscription",null),(0,n.Z)(this,"reloadId",null),(0,n.Z)(this,"refreshSubscription",null),this.route=t,this.index=i,this.reloader=s,(0,p.eM)("TagNaviComponent.constructor()");const d="^([-_a-zA-Z0-9]+)/?$";(0,p.eM)("TagNaviComponent URL Matcher",d),this.tagMatcher=new RegExp(d)}ngOnInit(){(0,p.eM)("TagNaviComponent.OnInit()"),this.index$=this.index.fetchTagList$(this.route),this.route$.pipe((0,C.R)(this.destroy$)).subscribe(t=>{if(this.isNavigateDerived="Tag"===t.category,!this.isNavigateDerived||!t.navigators)return void this.unselect(!0);const i=t.navigators.match(this.tagMatcher);if(!i)return void this.unselect(!0);const s=i[1];(0,p.eM)(`TagNaviComponent detect routing ${s}`),this.selectTag(s,!1)}),this.reloadListId=this.reloader.registerLoader(),this.refreshListSubscription=this.reloader.refreshEvent(this.reloadListId).pipe((0,C.R)(this.destroy$)).subscribe(()=>{(0,p.eM)("Reload is clicked on TagNaviComponent."),this.index$=this.index.fetchTagList$(this.route)})}ngOnDestroy(){this.refreshListSubscription&&(this.refreshListSubscription.unsubscribe(),this.refreshListSubscription=null),this.reloadListId&&this.reloader.unregister(this.reloadListId),this.ensureUnregisterTagWathing(),this.destroy$.next()}unselect(t){this.ensureUnregisterTagWathing(),t||(this.isNavigateDerived=!1),this.selectedPage=null,this.hideOtherDropdown()}selectTag(t,i,s){this.indexSub&&(this.indexSub.unsubscribe(),this.indexSub=null),this.indexSub=this.index.fetchTagIndex$(this.route,{tagkey:t,isReload:i,isClicked:s}).pipe((0,C.R)(this.destroy$)).subscribe(l=>{(0,p.eM)("TagNaviComponent Selected",l),this.startTagWatching(l),this.isNavigateDerived&&(this.selectedPage=l,this.tagSelected.emit(l))})}hideOtherDropdown(){const t=document.getElementById("gitweeTagNaviDropdownButton");t&&new Xe.Lt(t).hide()}onClickTag(t,i){(0,p.eM)("TagNaviComponent.onClickTag()",i),t.preventDefault(),t.stopPropagation(),this.hideOtherDropdown(),this.isNavigateDerived=!0,this.selectTag(i.tagkey,!1,!0)}ensureUnregisterTagWathing(){this.reloadId&&(this.reloader.unregister(this.reloadId),this.reloadId=null),this.refreshSubscription&&(this.refreshSubscription.unsubscribe(),this.refreshSubscription=null)}startTagWatching(t){this.ensureUnregisterTagWathing();const i=this.reloader.registerWatcher(t.indexUrl,t.updated);this.reloadId=i,this.refreshSubscription=this.reloader.refreshEvent(i).pipe((0,C.R)(this.destroy$)).subscribe(()=>{this.selectTag(t.tagkey,!0)})}}return r=a,(0,n.Z)(a,"\u0275fac",function(t){return new(t||r)(e.Y36(w.gz),e.Y36($),e.Y36(O.f))}),(0,n.Z)(a,"\u0275cmp",e.Xpm({type:r,selectors:[["gitwee-tag-navi"]],inputs:{route$:"route$",urlPrefix:"urlPrefix"},outputs:{tagSelected:"tagSelected",notFound:"notFound"},decls:2,vars:3,consts:[["id","gitweeTagNaviIndex",4,"ngIf"],["id","gitweeTagNaviIndex"],[1,"list-group"],["class","list-group-item align-items-center row text-end shadow row gitwee-listing-tag gitwee-sidebar-node",3,"title","click",4,"ngFor","ngForOf"],["class","list-group-item align-items-center row text-end shadow gitwee-listing-tag",4,"ngIf"],[1,"list-group-item","align-items-center","row","text-end","shadow","row","gitwee-listing-tag","gitwee-sidebar-node",3,"title","click"],[1,"col-8",3,"href"],[1,"gitwee-navi-item"],[1,"badge","rounded-pill","col-4"],[1,"list-group-item","align-items-center","row","text-end","shadow","gitwee-listing-tag"],[1,"btn-group","col-auto","dropdown"],["id","gitweeTagNaviDropdownButton","type","button","data-bs-toggle","dropdown","aria-haspopup","true","aria-expanded","false",1,"btn","btn-secondary","dropdown-toggle"],["id","gitweeTagNaviDropdownOthers",1,"dropdown-menu"],["class","dropdown-item","style","font-size: 0.7em;",3,"title","click",4,"ngFor","ngForOf"],[1,"dropdown-item",2,"font-size","0.7em",3,"title","click"]],template:function(t,i){1&t&&(e.YNc(0,tt,5,3,"div",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.index$))},dependencies:[x.sg,x.O5,x.Ov],styles:[".gitwee-listing-tag[_ngcontent-%COMP%]{cursor:pointer}",".gitwee-sidebar-node[_ngcontent-%COMP%]{transition:transform .5s}.gitwee-sidebar-node[_ngcontent-%COMP%]:hover{transform:scale(1.03);z-index:10000}.gitwee-navi-item[_ngcontent-%COMP%]{display:inline-block;text-overflow:ellipsis;overflow:hidden;white-space:nowrap;vertical-align:text-bottom}.gitwee-calendar-day[_ngcontent-%COMP%]{display:inline-block;white-space:nowrap}"],data:{animation:[(0,c.X$)("tagListTrigger",[(0,c.eR)(":enter",[(0,c.oB)({opacity:0,transform:"translateX(5px)"}),(0,c.jt)("500ms 200ms ease-in-out",(0,c.oB)({opacity:1,transform:"none"}))]),(0,c.eR)(":leave",[(0,c.oB)({position:"absolute",width:"100%"}),(0,c.jt)("200ms ease-in-out",(0,c.oB)({opacity:0,transform:"translateX(5px)"}))])])]}})),a})();var nt=u(4825),ot=u(6593);function rt(r,a){1&r&&e._UZ(0,"div",5),2&r&&e.Q6J("innerHTML",a.$implicit,e.oJD)}function st(r,a){if(1&r){const o=e.EpF();e.TgZ(0,"div")(1,"button",1),e.NdJ("click",function(i){e.CHM(o);const s=e.MAs(4),d=e.oxw();return e.KtG(d.onClickToggle(i,s))}),e._uU(2,"\u5916\u90e8\u30b5\u30a4\u30c8 (Banner)"),e.qZA(),e.TgZ(3,"div",2,3),e.YNc(5,rt,1,1,"div",4),e.qZA()()}if(2&r){const o=e.oxw();e.xp6(3),e.Udp("display","none"==o.shownState?"none":"block"),e.Q6J("@displayTrigger",o.shownState),e.xp6(2),e.Q6J("ngForOf",o.bannerList)}}let at=(()=>{var r;class a{constructor(t,i,s){(0,n.Z)(this,"http",void 0),(0,n.Z)(this,"sanitizer",void 0),(0,n.Z)(this,"dom",void 0),(0,n.Z)(this,"shownState","none"),(0,n.Z)(this,"destroy$",new Z.x),(0,n.Z)(this,"trustedScript$",void 0),(0,n.Z)(this,"refreshEvent$",new b.X(void 0)),(0,n.Z)(this,"banners$",void 0),(0,n.Z)(this,"bannerList",[]),(0,n.Z)(this,"isShown",!1),(0,n.Z)(this,"scriptIdList",[]),this.http=t,this.sanitizer=i,this.dom=s}ngOnDestroy(){this.purgeDynamicScripts(),this.destroy$.next()}ngOnInit(){this.trustedScript$=this.http.fetchGhJson("/UserData/trusted-script.json").pipe((0,y.U)(i=>{const s={};for(const d of i.scripts)s[d.href]=d;return s}),(0,N.d)(1));const t=this.refreshEvent$.pipe((0,z.b)(500));this.banners$=t.pipe((0,T.w)(()=>this.http.fetchGhJson("/UserData/banner.json").pipe((0,N.d)(1)))),(0,M.a)([this.banners$,this.trustedScript$]).pipe((0,C.R)(this.destroy$)).subscribe(([i,s])=>{const d=[];this.purgeDynamicScripts();for(const l of i.banners)if(d.push(this.sanitizer.bypassSecurityTrustHtml(l.bodyHtml)),l.scripts)for(const h of l.scripts){if(!(h in s)){(0,p.wb)(`Unable load insecure script from ${h}`);continue}const f=this.dom.ensureDynamicScript(h);this.scriptIdList.includes(f)||this.scriptIdList.push(f)}this.bannerList=d})}purgeDynamicScripts(){for(;this.scriptIdList.length>0;)this.dom.removeDynamicScript(this.scriptIdList[0]),this.scriptIdList.splice(0,1)}hackIFrame(t){const i=t.querySelectorAll("iframe");for(let s=0;s<i.length;s++)i[s].width="100%",s++}lazyCall(t,i){(0,nt.H)(t).pipe((0,B.q)(1)).subscribe(s=>{i()})}onClickToggle(t,i){this.isShown=!this.isShown,this.shownState="animating",this.lazyCall(400,this.isShown?()=>this.shownState="visible":()=>this.shownState="none"),this.isShown?this.hackIFrame(i):this.refreshEvent$.next()}}return r=a,(0,n.Z)(a,"\u0275fac",function(t){return new(t||r)(e.Y36(j.OE),e.Y36(ot.H7),e.Y36(F.v))}),(0,n.Z)(a,"\u0275cmp",e.Xpm({type:r,selectors:[["app-external-banner"]],decls:1,vars:1,consts:[[4,"ngIf"],[1,"btn","btn-secondary",2,"width","100%",3,"click"],[1,"app-external-banner-body","m-2"],["bodyNode",""],["class","m-1",3,"innerHTML",4,"ngFor","ngForOf"],[1,"m-1",3,"innerHTML"]],template:function(t,i){1&t&&e.YNc(0,st,6,4,"div",0),2&t&&e.Q6J("ngIf",i.bannerList&&i.bannerList.length>0)},dependencies:[x.sg,x.O5],styles:[".gitwee-sidebar-node[_ngcontent-%COMP%]{transition:transform .5s}.gitwee-sidebar-node[_ngcontent-%COMP%]:hover{transform:scale(1.03);z-index:10000}.gitwee-navi-item[_ngcontent-%COMP%]{display:inline-block;text-overflow:ellipsis;overflow:hidden;white-space:nowrap;vertical-align:text-bottom}.gitwee-calendar-day[_ngcontent-%COMP%]{display:inline-block;white-space:nowrap}"],data:{animation:[(0,c.X$)("displayTrigger",[(0,c.eR)("none => animating",[(0,c.oB)({opacity:0,transform:"translateY(-5px)"}),(0,c.jt)("500ms ease-in-out",(0,c.oB)({opacity:1,transform:"none"}))]),(0,c.eR)("visible => animating",[(0,c.oB)({opacity:1,transform:"none"}),(0,c.jt)("500ms ease-in-out",(0,c.oB)({opacity:0,transform:"translateY(-5px)"}))])])]}})),a})();const dt=["tagNavi"],lt=["sideNavigator"],ct=["gitweeFireGitweeContainer"];function ht(r,a){if(1&r){const o=e.EpF();e.TgZ(0,"div",16,17),e.NdJ("appAfterIf",function(){e.CHM(o);const i=e.oxw();return e.KtG(i.activatedFireGitwee())}),e.qZA()}}function ut(r,a){if(1&r){const o=e.EpF();e.TgZ(0,"div",18),e.NdJ("click",function(){e.CHM(o);const i=e.oxw();return e.KtG(i.doUnmask())}),e.TgZ(1,"div",19),e.O4$(),e.TgZ(2,"svg",20)(3,"defs")(4,"linearGradient",21),e._UZ(5,"stop",22)(6,"stop",23)(7,"stop",24),e.qZA()(),e.TgZ(8,"circle",25),e._UZ(9,"animateTransform",26),e.qZA(),e.TgZ(10,"text",27)(11,"tspan",28),e._uU(12,"G"),e._UZ(13,"animate",29),e.qZA(),e.TgZ(14,"tspan",30),e._uU(15,"i"),e._UZ(16,"animate",31),e.qZA(),e.TgZ(17,"tspan",32),e._uU(18,"t"),e._UZ(19,"animate",33),e.qZA(),e.TgZ(20,"tspan",34),e._uU(21,"w"),e._UZ(22,"animate",35),e.qZA(),e.TgZ(23,"tspan",36),e._uU(24,"e"),e._UZ(25,"animate",37),e.qZA(),e.TgZ(26,"tspan",38),e._uU(27,"e"),e._UZ(28,"animate",39),e.qZA()()()()()}2&r&&e.Q6J("@loadingTrigger",void 0)}let pt=(()=>{var r;class a{constructor(t,i,s,d,l,h){(0,n.Z)(this,"dom",void 0),(0,n.Z)(this,"route",void 0),(0,n.Z)(this,"router",void 0),(0,n.Z)(this,"index",void 0),(0,n.Z)(this,"loader",void 0),(0,n.Z)(this,"localSession",void 0),(0,n.Z)(this,"targetTimeline$",new Z.x),(0,n.Z)(this,"destroy$",new Z.x),(0,n.Z)(this,"isLoading",void 0),(0,n.Z)(this,"gitweeRoute$",void 0),(0,n.Z)(this,"defaultTopPage$",void 0),(0,n.Z)(this,"gitweeUrlPrefix",void 0),(0,n.Z)(this,"eventShowFireGitwee$",void 0),(0,n.Z)(this,"overrideStyleClass",void 0),(0,n.Z)(this,"selectedNavigator",void 0),(0,n.Z)(this,"tagNavi",void 0),(0,n.Z)(this,"sideNavigator",void 0),(0,n.Z)(this,"sidebarStickyTop$",new b.X(null)),(0,n.Z)(this,"gitweeFireGitweeContainer",void 0),this.dom=t,this.route=i,this.router=s,this.index=d,this.loader=l,this.localSession=h,this.isLoading=!this.index.isInitialized}extractGitweePath(t){const i=this.gitweeUrlPrefix;if(t!==i&&!t.startsWith(`${i}/`))throw new Error(`Unable parse a GitweePath URL: ${t}`);let s=t.substring(i.length);if(s.startsWith("/")&&(s=s.substring(1)),""===s)return["Calendar",null];const d=s.match(/^timeline(?:\/(.*))?$/);if(d)return["Calendar",d[1]];const l=s.match(/^tag(?:\/(.*))?$/);if(l)return["Tag",l[1]];throw new Error(`Unsupported Path of the Gitwee ${s}`)}ngOnInit(){(0,p.eM)("Gitwee.MainComponent.OnInit()",this.route,this.route.pathFromRoot),this.gitweeUrlPrefix="/"+this.route.pathFromRoot.reduce((g,m)=>m.routeConfig?.path?[m.routeConfig?.path,...g]:g,[]).join("/");const t=this.route.data.pipe((0,B.q)(1));this.gitweeRoute$=(0,M.a)([t,this.router.urlNavigation$]).pipe((0,y.U)(([g,m])=>{(0,p.eM)("MainComponent detect urlNavigation$",g,m);const v=new le;return v.ns=g.gitweeNamespace,[v.category,v.navigators]=this.extractGitweePath(m.path),v.fragment=m.fragment,v}),(0,N.d)(1)),this.index.fetchConfig$(this.route).pipe((0,C.R)(this.destroy$)).subscribe(g=>{g.styles&&(this.overrideStyleClass=this.dom.overrideBasicStyle(g.styles))});const i=(0,ee.T)((0,E.of)(window.innerHeight),(0,J.R)(window,"resize").pipe((0,y.U)(g=>window.innerHeight),(0,D.x)())),s=(0,J.R)(window,"scroll").pipe((0,y.U)(g=>window.scrollY),(0,ie.R)((g,m)=>[m,g[0],g[1]],[0,null,null])),d=(0,te.F)(300).pipe((0,y.U)(g=>this.sidebarElemenet?.clientHeight),(0,D.x)());(0,M.a)([i,d]);let h=0,f=0;(0,M.a)([s,i,d]).pipe((0,C.R)(this.destroy$)).subscribe(([[g,m,v],_,I])=>{const yt=h-g,q=_-I,Ct=q>=60?60:Math.min(q,0),U=Math.max(Math.min(yt+f,60),Ct);m<g?(v>m&&(h=g,f=U),this.sidebarStickyTop$.next(U)):m===g||(v<m&&(h=g,f=U),this.sidebarStickyTop$.next(U))}),this.eventShowFireGitwee$=(0,M.a)([this.localSession.loginStateChanged$,t,this.router.currentUrl$]).pipe((0,y.U)(([g,m,v])=>{if(!g)return!1;const[_,I]=this.extractGitweePath(v);return!(I||"diary"!==m.gitweeNamespace||"Calendar"!==_)}),(0,D.x)(),(0,C.R)(this.destroy$))}ngOnDestroy(){(0,p.eM)("MainComponent.OnDestroy()"),this.dom.cleanupOverrideStyle(this.overrideStyleClass),this.destroy$.next()}ngAfterViewInit(){(0,p.eM)("MainComponent.AfterViewInit()")}activatedFireGitwee(){var t=this;return(0,A.Z)(function*(){yield t.doLazyLoadFireGitwee()})()}get sidebarElemenet(){return this.sideNavigator?.element.nativeElement}doLazyLoadFireGitwee(){var t=this;return(0,A.Z)(function*(){t.gitweeFireGitweeContainer.element.nativeElement.innerHTML="",t.gitweeFireGitweeContainer.clear();const{FireGitweeModule:i}=yield Promise.all([u.e(251),u.e(579),u.e(991)]).then(u.bind(u,991)),{FireGitweeComponent:s}=yield Promise.all([u.e(251),u.e(579),u.e(485)]).then(u.bind(u,3485));t.loader.appendComponent(t.gitweeFireGitweeContainer,i,s)})()}entriesSelected(t,i){(0,p.eM)("MainComponent.entriesSelected()",t,i),this.dom.setTitle(`Gitwee Blog: ${i.title}`),this.targetTimeline$.next(i),this.selectedNavigator&&this.selectedNavigator!==t&&(this.selectedNavigator.unselect(),this.selectedNavigator=null),this.selectedNavigator=t,this.router.replaceJustUrl(`${this.gitweeUrlPrefix}/${i.urlLink}`),this.isLoading&&setTimeout(()=>this.doUnmask(),3e3)}entriesNotFound(t){(0,p.eM)("MainComponent.entriesNotFound()",t),this.router.navigateByUrl(this.gitweeUrlPrefix)}doUnmask(){this.index.initialized(),this.isLoading=!1}}return r=a,(0,n.Z)(a,"\u0275fac",function(t){return new(t||r)(e.Y36(F.v),e.Y36(w.gz),e.Y36(Q.Z),e.Y36($),e.Y36(ue.j),e.Y36(pe.m))}),(0,n.Z)(a,"\u0275cmp",e.Xpm({type:r,selectors:[["ng-component"]],viewQuery:function(t,i){if(1&t&&(e.Gf(dt,5),e.Gf(lt,5,e.s_b),e.Gf(ct,5,e.s_b)),2&t){let s;e.iGM(s=e.CRH())&&(i.tagNavi=s.first),e.iGM(s=e.CRH())&&(i.sideNavigator=s.first),e.iGM(s=e.CRH())&&(i.gitweeFireGitweeContainer=s.first)}},decls:18,vars:14,consts:[[1,"container-fluid"],["id","gitweeMainContainer",1,"row","flex-xl-nowrap"],["id","gitweeSidebarNavContainer",1,"col-12","col-md-4","col-xl-3","navbar-dark","rounded"],["type","button","data-bs-toggle","collapse","data-bs-target","#gitweeSidebarNavBody","aria-expanded","true","aria-label","Toggle docs navigation",1,"navbar-toggler","d-md-none","collapsed"],[1,"navbar-toggler-icon"],["id","gitweeSidebarNavBody",1,"collapse",2,"position","sticky"],["sideNavigator",""],[1,"m-1",3,"route$","urlPrefix","tagSelected","notFound"],["tagNavi",""],[1,"m-1",3,"route$","urlPrefix","nodeExpanded","notFound"],["calendarNavi",""],[1,"m-1"],["id","gitweeTimelineContainer",1,"col-12","col-md-8","col-xl-9"],["id","gitweeFireGitweeContainer",3,"appAfterIf",4,"ngIf"],[3,"naviEntries$"],["id","gitweeLoadingLogoMask",3,"click",4,"ngIf"],["id","gitweeFireGitweeContainer",3,"appAfterIf"],["gitweeFireGitweeContainer",""],["id","gitweeLoadingLogoMask",3,"click"],["id","gitweeLogoMask"],["xmlns","http://www.w3.org/2000/svg","width","45vw","height","45vw"],["id","gitweeSvgGradient1"],["offset","0%","stop-color","#31b271",1,"stop1"],["offset","50%","stop-color","#eb6ba4","stop-opacity","0.8",1,"stop2"],["offset","100%","stop-color","#1db8ee",1,"stop3"],["id","gitweeLoadingCircle","fill","none","transform-origin","center","stroke","url(#gitweeSvgGradient1)","stroke-width","1.5%","cx","50%","cy","50%","r","30%"],["attributeName","transform","attributeType","XML","keyTimes","0;1","calcMode","spline","keySplines","0.42 0.0 0.58 1.0","type","rotate","from","0","to","-2160","dur","3s","additive","replace","fill","freeze","repeatCount","indefinite"],["id","gitweeLogoText","x","28% 38% 43% 54% 65% 75% 86%","stroke","none","font-size","8vw","lengthAdjust","spacing","textLength","100%","text-anchor","middle","font-family","Verdana","y","55% 55% 55% 55% 55% 55%"],["id","gitwee-char1","fill","#eb6ba4",1,"gitwee-char"],["attributeType","XML","attributeName","dy","dur","3s","values","-15%; 0    ; -8% ; 0    ; -4% ; 0   ; -1.5% ; 0   ; 0","keyTimes","0 ; 0.03 ; 0.05 ; 0.07 ; 0.09; 0.12; 0.14; 0.16; 1","begin","1.0s;","repeatCount","indefinite"],["id","gitwee-char2","fill","#31b271",1,"gitwee-char"],["attributeType","XML","attributeName","dy","dur","3s","values","-15%; 0    ; -8% ; 0    ; -4% ; 0   ; -1.5% ; 0   ; 0","keyTimes","0 ; 0.03 ; 0.05 ; 0.07 ; 0.09; 0.12; 0.14; 0.16; 1","begin","1.8s;","repeatCount","indefinite"],["id","gitwee-char3","fill","#1db8ee",1,"gitwee-char"],["attributeType","XML","attributeName","dy","dur","3s","values","-15%; 0    ; -8% ; 0    ; -4% ; 0   ; -1.5% ; 0   ; 0","keyTimes","0 ; 0.03 ; 0.05 ; 0.07 ; 0.09; 0.12; 0.14; 0.16; 1","begin","2.6s;","repeatCount","indefinite"],["id","gitwee-char4","fill","#fff562",1,"gitwee-char"],["attributeType","XML","attributeName","dy","dur","3s","values","-15%; 0    ; -8% ; 0    ; -4% ; 0   ; -1.5% ; 0   ; 0","keyTimes","0 ; 0.03 ; 0.05 ; 0.07 ; 0.09; 0.12; 0.14; 0.16; 1","begin","1.4s;","repeatCount","indefinite"],["id","gitwee-char5","fill","#24b6b3",1,"gitwee-char"],["attributeType","XML","attributeName","dy","dur","3s","values","-15%; 0    ; -8% ; 0    ; -4% ; 0   ; -1.5% ; 0   ; 0","keyTimes","0 ; 0.03 ; 0.05 ; 0.07 ; 0.09; 0.12; 0.14; 0.16; 1","begin","2.2s;","repeatCount","indefinite"],["id","gitwee-char6","fill","#6357a3",1,"gitwee-char"],["attributeType","XML","attributeName","dy","dur","3s","values","-15%; 0    ; -8% ; 0    ; -4% ; 0   ; -1.5% ; 0   ; 0","keyTimes","0 ; 0.03 ; 0.05 ; 0.07 ; 0.09; 0.12; 0.14; 0.16; 1","begin","3.0s;","repeatCount","indefinite"]],template:function(t,i){if(1&t){const s=e.EpF();e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"button",3),e._UZ(4,"span",4),e.qZA(),e.TgZ(5,"div",5,6),e.ALo(7,"async"),e.TgZ(8,"gitwee-tag-navi",7,8),e.NdJ("tagSelected",function(l){e.CHM(s);const h=e.MAs(9);return e.KtG(i.entriesSelected(h,l))})("notFound",function(){e.CHM(s);const l=e.MAs(9);return e.KtG(i.entriesNotFound(l))}),e.qZA(),e.TgZ(10,"gitwee-calendar-navi",9,10),e.NdJ("nodeExpanded",function(l){e.CHM(s);const h=e.MAs(11);return e.KtG(i.entriesSelected(h,l))})("notFound",function(){e.CHM(s);const l=e.MAs(11);return e.KtG(i.entriesNotFound(l))}),e.qZA(),e._UZ(12,"app-external-banner",11),e.qZA()(),e.TgZ(13,"div",12),e.YNc(14,ht,2,0,"div",13),e.ALo(15,"async"),e._UZ(16,"gitwee-timeline",14),e.qZA()()(),e.YNc(17,ut,29,1,"div",15)}2&t&&(e.Q6J("@animationTrigger",void 0),e.xp6(5),e.Udp("top",e.lcZ(7,10,i.sidebarStickyTop$),"px"),e.xp6(3),e.Q6J("route$",i.gitweeRoute$)("urlPrefix",i.gitweeUrlPrefix),e.xp6(2),e.Q6J("route$",i.gitweeRoute$)("urlPrefix",i.gitweeUrlPrefix),e.xp6(4),e.Q6J("ngIf",e.lcZ(15,12,i.eventShowFireGitwee$)),e.xp6(2),e.Q6J("naviEntries$",i.targetTimeline$),e.xp6(1),e.Q6J("ngIf",i.isLoading))},dependencies:[x.O5,L.Y,Ee,We,it,at,x.Ov],styles:["#gitweeMainContainer[_ngcontent-%COMP%]{flex-direction:row-reverse}@media (min-width: 768px){#gitweeSidebarNavBody[_ngcontent-%COMP%]{display:block}}@media not screen and (min-width: 768px){#gitweeSidebarNavContainer[_ngcontent-%COMP%]{background-color:#cfdee7}}#gitweeSidebarNavContainer[_ngcontent-%COMP%]{text-align:left;z-index:10}#gitweeLoadingLogoMask[_ngcontent-%COMP%]{left:0%;top:0%;position:fixed;background:#8b7355;opacity:.75;width:100%;height:100%;text-align:center;z-index:99999999}#gitweeLogoMask[_ngcontent-%COMP%]{top:20%;position:relative}"],data:{animation:[(0,c.X$)("animationTrigger",[(0,c.eR)(":enter",[(0,c.oB)({opacity:0}),(0,c.jt)("800ms ease-in-out",(0,c.oB)({opacity:1}))])]),(0,c.X$)("loadingTrigger",[(0,c.eR)(":enter",[(0,c.oB)({transform:"translateY(-100%)",opacity:0}),(0,c.jt)("800ms ease-in-out",(0,c.oB)({transform:"none",opacity:"*"}))]),(0,c.eR)(":leave",[(0,c.jt)("800ms ease-in-out",(0,c.oB)({transform:"translateY(-100%)",opacity:0}))])])]}})),a})();const ft=[{path:"index.htm",redirectTo:""},{path:"jump/**",component:u(2979).w},{path:"",component:pt,children:[{path:"timeline",children:[{path:"index.htm",redirectTo:""}]},{path:"timeline/:year",children:[{path:"index.htm",redirectTo:""}]},{path:"timeline/:year/:month",children:[{path:"index.htm",redirectTo:""}]},{path:"timeline/:year/:month/:day",children:[{path:"index.htm",redirectTo:""}]},{path:"tag/:tagkey",children:[{path:"index.htm",redirectTo:""}]},{path:"**",redirectTo:""}]}];let mt=(()=>{var r;class a{}return r=a,(0,n.Z)(a,"\u0275fac",function(t){return new(t||r)}),(0,n.Z)(a,"\u0275mod",e.oAB({type:r})),(0,n.Z)(a,"\u0275inj",e.cJS({imports:[w.Bz.forChild(ft),w.Bz]})),a})();var vt=u(5101),xt=u(4209);let _t=(()=>{var r;class a{constructor(){(0,p.H_)("Dynamically loaded GitweeModule")}}return r=a,(0,n.Z)(a,"\u0275fac",function(t){return new(t||r)}),(0,n.Z)(a,"\u0275mod",e.oAB({type:r})),(0,n.Z)(a,"\u0275inj",e.cJS({providers:[$],imports:[x.ez,mt,vt.R,xt.B]})),a})()}}]);