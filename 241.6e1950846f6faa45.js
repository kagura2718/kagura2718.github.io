"use strict";(self.webpackChunkKaguraGithubPages=self.webpackChunkKaguraGithubPages||[]).push([[241],{6241:(Ot,Re,g)=>{g.r(Re),g.d(Re,{GitfireModule:()=>te});var O=g(177),o=g(9417),Y=g(9253),ae=g(4441),ne=g(8079),de=g(1152),ue=g(3383),$=g(467),e=g(3953),We=g(1825),Ee=g(4555),Ce=g(7673),he=g(983),Pe=g(1985),je=g(8793),q=g(6745),ie=g(941),se=g(5558),Ae=g(6354),z=g(9568),W=g(7083),xe=g(9437),Fe=g(3028),Ge=g(9901),ce=g(7935);const re=new e.nKC("angularfire2.messaging.vapid-key"),Be=new e.nKC("angularfire2.messaging.service-worker-registeration");let C=(()=>{class l{requestPermission;getToken;tokenChanges;messages;requestToken;deleteToken;constructor(i,s,d,b,k,ye,ze){const Xe=ze,Ye=(0,Ce.of)(void 0).pipe((0,q._)(k.outsideAngular),(0,ie.Q)(k.insideAngular),(0,se.n)(Ee.TT),(0,se.n)(Se=>Se?g.e(321).then(g.bind(g,3321)):he.w),(0,Ae.T)(()=>(0,Y.iB)(i,b,s)),(0,se.n)(Se=>(0,Y.BM)(`${Se.name}.messaging`,"AngularFireMessaging",Se.name,()=>(0,Ce.of)(Se.messaging()),[])),(0,z.t)({bufferSize:1,refCount:!1}));this.requestPermission=Ye.pipe((0,q._)(k.outsideAngular),(0,ie.Q)(k.insideAngular),(0,se.n)(()=>Notification.requestPermission())),this.getToken=Ye.pipe((0,q._)(k.outsideAngular),(0,ie.Q)(k.insideAngular),(0,se.n)(function(){var Se=(0,$.A)(function*(St){if("granted"===Notification.permission){const Dt=Xe?yield Xe:null;return yield St.getToken({vapidKey:ye,serviceWorkerRegistration:Dt})}return null});return function(St){return Se.apply(this,arguments)}}()));const jt=new Pe.c(Se=>{navigator.permissions.query({name:"notifications"}).then(St=>{St.onchange=()=>Se.next()})}),ke=Ye.pipe((0,q._)(k.outsideAngular),(0,ie.Q)(k.insideAngular),(0,W.K)(jt),(0,W.K)(this.getToken));return this.tokenChanges=Ye.pipe((0,q._)(k.outsideAngular),(0,ie.Q)(k.insideAngular),(0,se.n)(()=>(0,je.x)(this.getToken,ke))),this.messages=Ye.pipe((0,q._)(k.outsideAngular),(0,ie.Q)(k.insideAngular),(0,se.n)(Se=>new Pe.c(St=>Se.onMessage(St)))),this.requestToken=Ye.pipe((0,q._)(k.outsideAngular),(0,ie.Q)(k.insideAngular),(0,se.n)(()=>this.requestPermission),(0,xe.W)(()=>(0,Ce.of)(null)),(0,Fe.Z)(()=>this.tokenChanges)),this.deleteToken=()=>Ye.pipe((0,q._)(k.outsideAngular),(0,ie.Q)(k.insideAngular),(0,se.n)(Se=>Se.deleteToken()),(0,Ge.U)(!1)),(0,Y.Gt)(this,Ye,b)}static \u0275fac=function(s){return new(s||l)(e.KVO(Y.rx),e.KVO(Y.uP,8),e.KVO(e.Agw),e.KVO(e.SKi),e.KVO(We.u0),e.KVO(re,8),e.KVO(Be,8))};static \u0275prov=e.jDH({token:l,factory:l.\u0275fac,providedIn:"any"})}return l})(),T=(()=>{class l{constructor(){ce.A.registerVersion("angularfire",We.xv.full,"fcm-compat")}static \u0275fac=function(s){return new(s||l)};static \u0275mod=e.$C({type:l});static \u0275inj=e.G2t({providers:[C]})}return l})();var y=g(5794),F=g(7830),R=g(1188),_=g(1413),P=g(6977),I=g(6697),x=g(5964),m=g(5312),V=g(4416),le=g(8531);let J=(()=>{class l extends le.s{constructor(){super()}ngOnInit(){(0,m.Oi)("DeleteConfirmComponent.OnInit()")}static \u0275fac=function(s){return new(s||l)};static \u0275cmp=e.VBU({type:l,selectors:[["gitfire-delete-confirm"]],features:[e.Vt3],decls:10,vars:0,consts:[[1,"m-3"]],template:function(s,d){1&s&&(e.j41(0,"div",0)(1,"div"),e.EFF(2,"\u672c\u5f53\u306b\u524a\u9664\u3057\u307e\u3059\u304b\uff1f"),e.k0s(),e.j41(3,"ul")(4,"li"),e.EFF(5,"Google / Twitter \u306a\u3069\u306e\u30a2\u30ab\u30a6\u30f3\u30c8\u60c5\u5831\u306f\u524a\u9664\u3055\u308c\u307e\u305b\u3093\u3002"),e.k0s(),e.j41(6,"li"),e.EFF(7,"\u516c\u958b\u3055\u308c\u305f\u6295\u7a3f\u306f\u524a\u9664\u3055\u308c\u307e\u305b\u3093\u3002"),e.k0s(),e.j41(8,"li"),e.EFF(9,"\u53d6\u308a\u6d88\u3057\u306f\u3067\u304d\u307e\u305b\u3093\u3002"),e.k0s()()())}})}return l})();g(2438);var Q=g(4333);const Le=["specialAuthContainer"];function B(l,S){if(1&l){const i=e.RV6();e.j41(0,"a",7),e.bIt("click",function(d){const b=e.eBV(i).$implicit,k=e.XpG();return e.Njj(k.onClickReauthProvider(d,b))}),e.EFF(1),e.k0s()}if(2&l){const i=S.$implicit;e.R7$(),e.JRh(i.providerId)}}class H extends le.s{loader;toastr;static SUPPORTED_PROVIDERS={};static SupportedOauthProviderIds=[];destroy$=new _.B;get providers(){return this.currentUser.providerData}currentUser;reauthed=new e.bkB;specialAuthContainer;static#e=(()=>{const S=H.SUPPORTED_PROVIDERS,i=ce.A.auth;S[i.EmailAuthProvider.PROVIDER_ID]=i.EmailAuthProvider,S[i.TwitterAuthProvider.PROVIDER_ID]=i.TwitterAuthProvider,S[i.GoogleAuthProvider.PROVIDER_ID]=i.GoogleAuthProvider,S[i.GithubAuthProvider.PROVIDER_ID]=i.GithubAuthProvider;const s=H.SupportedOauthProviderIds;s.push(i.TwitterAuthProvider.PROVIDER_ID),s.push(i.GoogleAuthProvider.PROVIDER_ID),s.push(i.GithubAuthProvider.PROVIDER_ID)})();constructor(S,i){super(),this.loader=S,this.toastr=i}ngOnDestroy(){this.destroy$.next()}isOAuthProvider(S){return!!H.SupportedOauthProviderIds.includes(S)}onClickReauthProvider(S,i){var s=()=>super.close,d=this;return(0,$.A)(function*(){(0,m.Oi)("onClickReauthProvider()",S,i),S.preventDefault();const k=new(0,H.SUPPORTED_PROVIDERS[i.providerId]);if(d.specialAuthContainer.clear(),d.isOAuthProvider(i.providerId)){try{yield d.currentUser.reauthenticateWithPopup(k)}catch(ye){(0,m.sJ)("Error while reauth",ye);const ze=ye instanceof Error?ye.message:"Unknown error";return void d.toastr.error(`\u518d\u8a8d\u8a3c\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002 ( ${ze} )`)}(0,m.Oi)("Reanthenticated via OAuth provider")}else{const{GitfireLoginModule:ye}=yield Promise.resolve().then(g.bind(g,1951)),{InputAuthComponent:ze}=yield Promise.resolve().then(g.bind(g,2751)),Xe=d.loader.appendComponent(d.specialAuthContainer,ye,ze);Xe.isReauth=!0,Xe.reauthUser=d.currentUser,Xe.showFederations=!1;const Ye=Xe.reauthed.pipe((0,I.s)(1));try{yield Ye.toPromise()}catch(jt){(0,m.sJ)("Error while reauth done",jt);const ke=jt instanceof Error?jt.message:"Unknown error";return void d.toastr.error(`\u518d\u8a8d\u8a3c\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002 ( ${ke} )`)}(0,m.Oi)("Reanthenticated via password")}d.reauthed.next(),s().call(d)})()}static \u0275fac=function(i){return new(i||H)(e.rXU(Q.Z),e.rXU(y.tw))};static \u0275cmp=e.VBU({type:H,selectors:[["gitfire-reauth-box"]],viewQuery:function(i,s){if(1&i&&e.GBs(Le,5,e.c1b),2&i){let d;e.mGM(d=e.lsd())&&(s.specialAuthContainer=d.first)}},inputs:{currentUser:"currentUser"},outputs:{reauthed:"reauthed"},features:[e.Vt3],decls:10,vars:1,consts:[["specialAuthContainer",""],[1,"m-3"],[1,"btn-group"],["type","button","data-bs-toggle","dropdown","aria-haspopup","true","aria-expanded","false",1,"btn","btn-primary","dropdown-toggle"],[1,"visually-hidden"],[1,"dropdown-menu"],["class","dropdown-item","href","#",3,"click",4,"ngFor","ngForOf"],["href","#",1,"dropdown-item",3,"click"]],template:function(i,s){1&i&&(e.j41(0,"div",1)(1,"div",2)(2,"button",3)(3,"span",4),e.EFF(4,"Toggle Dropdown"),e.k0s(),e.EFF(5,"\u8a8d\u8a3c\u65b9\u6cd5"),e.k0s(),e.j41(6,"div",5),e.DNE(7,B,2,1,"a",6),e.k0s()(),e.nrm(8,"div",null,0),e.k0s()),2&i&&(e.R7$(7),e.Y8G("ngForOf",s.providers))},dependencies:[O.Sq]})}var w=g(6469);function j(l,S){if(l.value!==S){if(l.dirty)return void(0,m.sJ)(`Upstream value has been changed to ${l.value} -> ${S} but sillengly ignore the value.`);l.setErrors(null),l.setValue(S)}}function U(l){l.markAsPristine(),l.markAsUntouched()}var ee=g(1474),Me=g(4871),et=g(1637),Ne=g(9182),Ie=g(4572),Ve=g(3294),$e=g(8141),Je=g(2275);let lt=(()=>{class l{controlLabel;formName;tooltipText;parentForm;checkChanged=new e.bkB;autoGeneratedId;constructor(){const i=Math.random().toString(36).substring(2);this.autoGeneratedId=`appViewInput-${i}`}ngOnInit(){(0,m.Oi)("SwitchComponent.OnInit()")}onChangeBox(i){(0,m.Oi)("SwitchComponent.onChangeBox()",this.parentForm),this.checkChanged.emit(i)}static \u0275fac=function(s){return new(s||l)};static \u0275cmp=e.VBU({type:l,selectors:[["app-switch"]],inputs:{controlLabel:"controlLabel",formName:"formName",tooltipText:"tooltipText",parentForm:"parentForm"},outputs:{checkChanged:"checkChanged"},decls:4,vars:7,consts:[[1,"custom-control","custom-switch",3,"formGroup","title"],["type","checkbox",1,"custom-control-input",3,"change","id","name","formControlName"],[1,"custom-control-label",3,"for"]],template:function(s,d){1&s&&(e.j41(0,"span",0)(1,"input",1),e.bIt("change",function(k){return d.onChangeBox(k)}),e.k0s(),e.j41(2,"label",2),e.EFF(3),e.k0s()()),2&s&&(e.FS9("title",d.tooltipText),e.Y8G("formGroup",d.parentForm),e.R7$(),e.FS9("id",d.autoGeneratedId),e.FS9("name",d.formName),e.FS9("formControlName",d.formName),e.R7$(),e.FS9("for",d.autoGeneratedId),e.R7$(),e.JRh(d.controlLabel))},dependencies:[o.Zm,o.BC,o.cb,o.j4,o.JD]})}return l})();function qe(l,S){if(1&l){const i=e.RV6();e.j41(0,"button",22),e.bIt("click",function(d){e.eBV(i);const b=e.XpG().$implicit,k=e.XpG();return e.Njj(k.onClickDeleteDevice(d,b))}),e.EFF(1,"\u524a\u9664"),e.k0s()}}function Pt(l,S){if(1&l){const i=e.RV6();e.j41(0,"div",19)(1,"app-switch",20),e.nI1(2,"date"),e.bIt("checkChanged",function(d){const b=e.eBV(i).$implicit,k=e.XpG();return e.Njj(k.onToggleDevice(d,b))}),e.k0s(),e.DNE(3,qe,2,0,"button",21),e.k0s()}if(2&l){const i=S.$implicit,s=e.XpG();e.R7$(),e.yjJ("controlLabel","",i.name||"No Name"," ",i.id===s.registeredDeviceId?"[\u3053\u306e\u7aef\u672b]":null," (\u767b\u9332\u65e5: ",e.i5U(2,8,i.createdAt.toDate(),"yyyy-MM-dd"),")"),e.Mz_("formName","device-",i.id,""),e.Y8G("parentForm",s.deviceForm),e.R7$(2),e.Y8G("ngIf",i.id!==s.registeredDeviceId)}}function Ft(l,S){if(1&l&&(e.j41(0,"div"),e.EFF(1),e.k0s()),2&l){const i=S.$implicit,s=S.index;e.R7$(),e.Lme("",s,": ",i,"")}}function dt(l,S){if(1&l&&(e.j41(0,"div"),e.EFF(1),e.k0s()),2&l){const i=S.$implicit,s=S.index;e.R7$(),e.Lme("",s,": ",i,"")}}function xt(l,S){if(1&l&&(e.j41(0,"div"),e.EFF(1),e.k0s()),2&l){const i=S.$implicit,s=S.index;e.R7$(),e.Lme("",s,": ",i,"")}}function ht(l,S){if(1&l&&(e.j41(0,"div"),e.EFF(1),e.nI1(2,"json"),e.k0s()),2&l){const i=S.$implicit;e.R7$(),e.JRh(e.bMT(2,1,i))}}let It=(()=>{class l{auth;dialog;toastr;store;funcs;messaging;destroy$=new _.B;mainForm;userPrivStore$;deviceForm;messagingTypeArray;configArray;currentUser$;registeredDeviceId;registeredToken;debugObservable={};devices;tokenReceived=new _.B;tokenReceived$;privUser;constructor(i,s,d,b,k,ye){this.auth=i,this.dialog=s,this.toastr=d,this.store=b,this.funcs=k,this.messaging=ye,this.privUser=this.store.collection("/users/v1/protected"),this.currentUser$=this.auth.clientSideUser$.pipe((0,x.p)(ze=>!!ze))}onToggleDevice(i,s){(0,m.Oi)("onToggleDevice()");const d=this.getDeviceControl(s),b={deviceId:s.id,off:!d.value};try{this.funcs.call("toggleSuspendDevice",b),this.toastr.success("\u7aef\u672b\u306e\u8a2d\u5b9a\u3092\u66f4\u65b0\u3057\u307e\u3057\u305f\u3002")}catch{this.toastr.error("\u7aef\u672b\u306e\u8a2d\u5b9a\u304c\u66f4\u65b0\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002")}}onClickDeleteDevice(i,s){var k,d=this;(0,m.Oi)("onClickDeleteDevice()"),this.messaging.deleteToken(s.token).pipe((0,P.Q)(this.destroy$)).subscribe({next:(k=(0,$.A)(function*(ye){(0,m.rD)(`deleteToken() result ${ye}`),d.toastr.success("\u7aef\u672b\u306e\u901a\u77e5\u3092\u89e3\u9664\u3057\u307e\u3057\u305f\u3002")}),function(ze){return k.apply(this,arguments)}),error:k=>{(0,m.sJ)(`Failed to delete token token: ${s.token}`,k),this.toastr.error("\u7aef\u672b\u306e\u901a\u77e5\u3092\u89e3\u9664\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002\u65e2\u306b\u5931\u52b9\u3057\u3066\u3044\u308b\u53ef\u80fd\u6027\u304c\u3042\u308a\u307e\u3059\u3002")}});const b={deviceId:s.id};try{this.funcs.call("revokeDevice",b),this.toastr.success("\u30b7\u30b9\u30c6\u30e0\u4e0a\u304b\u3089\u7aef\u672b\u306e\u901a\u77e5\u3092\u89e3\u9664\u3057\u307e\u3057\u305f\u3002")}catch{this.toastr.error("\u30b7\u30b9\u30c6\u30e0\u4e0a\u306e\u7aef\u672b\u306e\u901a\u77e5\u3092\u89e3\u9664\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002")}}ngOnInit(){var i=this;const d=this.currentUser$.pipe((0,I.s)(1),(0,x.p)(b=>!!b)).pipe((0,se.n)(b=>this.store.collection(`users/v1/protected/${b.uid}/fcm`).valueChanges({idField:"id"})),(0,z.t)(1));d.pipe((0,P.Q)(this.destroy$)).subscribe(b=>{this.devices=b;for(const k in this.deviceForm.controls)this.deviceForm.removeControl(k);for(const k of this.devices)this.addDeviceControl(k);this.triggerTokenRefresh()}),this.mainForm.addControl("messagingOn",new o.MJ(!1,[])),this.deviceForm=new o.gE({}),this.mainForm.addControl("devices",this.deviceForm),this.mainForm.addControl("messagingSystemCheck",new o.MJ(!1,[])),this.mainForm.addControl("messagingTrivialCheck",new o.MJ(!1,[])),this.mainForm.addControl("messagingMentionCheck",new o.MJ(!1,[])),this.mainForm.addControl("messagingAdminCheck",new o.MJ(!1,[])),this.messagingTypeArray=new o.Yp([this.typeSystemControl,this.typeMentionControl,this.typeAdminControl]),this.configArray=new o.Yp([this.typeTrivialControl,this.messagingTypeArray]),this.userPrivStore$.pipe((0,P.Q)(this.destroy$)).subscribe(b=>{(0,m.rD)("this.userPrivStore$.subscribe()",b);const k=b.messagingTypes||["mention","admin"];j(this.typeSystemControl,k.includes("system")),j(this.typeMentionControl,k.includes("mention")),j(this.typeAdminControl,k.includes("admin")),j(this.typeTrivialControl,b.isWatchTrivial)}),this.tokenReceived$=this.tokenReceived.pipe((0,x.p)(b=>null!==b),(0,Ve.F)()),(0,Ie.z)(this.tokenReceived$,d).pipe((0,P.Q)(this.destroy$)).subscribe(function(){var b=(0,$.A)(function*([k,ye]){if((0,m.Oi)("this.messaging.tokenReceived subscribe()",k,ye),i.debugObservable.registeredToken=k,i.registeredToken=k,k){const Xe=i.findDeviceId(k,ye);i.registeredDeviceId=Xe}j(i.messagingOnControl,!!i.registeredDeviceId)});return function(k){return b.apply(this,arguments)}}()),this.triggerTokenRefresh(),this.debugObservable.messages=[],this.messaging.messages.pipe((0,P.Q)(this.destroy$)).subscribe(b=>{(0,m.rD)("message received from messaging",b),this.debugObservable.messages.push(b)}),this.debugObservable.getToken$=this.messaging.getToken,this.debugObservable.getToken=[],this.debugObservable.getToken$.subscribe({next:b=>this.debugObservable.getToken.push(b),complete:()=>(0,m.rD)("Complete getToken()")}),this.debugObservable.tokenChanges$=this.messaging.tokenChanges,this.debugObservable.tokenChanges=[],this.debugObservable.tokenChanges$.subscribe({next:b=>this.debugObservable.tokenChanges.push(b),complete:()=>(0,m.rD)("Complete tokenChanges()")}),this.debugObservable.tokenReceived=[]}findDeviceId(i,s){for(const d of s)if(d.token===i)return d.id;return null}ngOnDestroy(){this.destroy$.next()}triggerTokenRefresh(){this.messaging.getToken.pipe((0,I.s)(1),(0,P.Q)(this.destroy$)).subscribe({next:i=>this.tokenReceived.next(i),complete:()=>(0,m.Oi)("Completed getToken")})}get messagingOnControl(){return this.mainForm.get("messagingOn")}getDeviceControl(i){return this.deviceForm.get(`device-${i.id}`)}addDeviceControl(i){const s=new o.MJ(!i.isSuspend,[]);this.deviceForm.addControl(`device-${i.id}`,s)}get typeTrivialControl(){return this.mainForm.get("messagingTrivialCheck")}get typeSystemControl(){return this.mainForm.get("messagingSystemCheck")}get typeMentionControl(){return this.mainForm.get("messagingMentionCheck")}get typeAdminControl(){return this.mainForm.get("messagingAdminCheck")}revokeNotification(){var i=this;return(0,$.A)(function*(){if(!i.registeredDeviceId)return(0,m.sJ)("Unexpectedly no deviceId is found."),void i.toastr.error("\u30c7\u30d0\u30a4\u30b9\u60c5\u5831\u3092\u7121\u52b9\u306b\u3067\u304d\u307e\u305b\u3093\u3002");try{i.funcs.call("revokeDevice",{deviceId:i.registeredDeviceId}),i.toastr.info("\u30b7\u30b9\u30c6\u30e0\u304b\u3089\u901a\u77e5\u60c5\u5831\u3092\u524a\u9664\u3057\u307e\u3057\u305f\u3002")}catch(s){return(0,m.sJ)("Error while deleting token via Functions",s),i.messagingOnControl.setValue(!0),U(i.messagingOnControl),void i.toastr.error("\u30b7\u30b9\u30c6\u30e0\u306e\u901a\u77e5\u60c5\u5831\u3092\u524a\u9664\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002")}i.messaging.getToken.pipe((0,$e.M)(s=>(0,m.Oi)(`getToken before deleteToken ${s}`)),(0,Fe.Z)(s=>i.messaging.deleteToken(s)),(0,I.s)(1),(0,P.Q)(i.destroy$)).subscribe({next:s=>{(0,m.rD)(`Deleted result: ${s} on FCM.`),U(i.messagingOnControl),i.toastr.success("\u901a\u77e5\u60c5\u5831\u3092\u524a\u9664\u3057\u307e\u3057\u305f\u3002")},error:s=>{(0,m.sJ)("Error while deleting token on FCM",s),i.toastr.error("\u901a\u77e5\u60c5\u5831\u304c\u524a\u9664\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002")}})})()}onToggleMessaging(i){var s=this;return(0,$.A)(function*(){if((0,m.Oi)("UserSettingsComponent.onToggleMessaging()"),s.messagingOnControl.value){if(!s.registeredDeviceId&&s.devices&&s.devices.length>=m.cA.FCMDeviceMaxCount)return void s.toastr.error("\u767b\u9332\u3055\u308c\u305f\u30c7\u30d0\u30a4\u30b9\u304c\u591a\u3059\u304e\u307e\u3059\u3002\u524a\u9664\u3057\u3066\u304b\u3089\u3084\u308a\u76f4\u3057\u3066\u304f\u3060\u3055\u3044\u3002");yield s.updateRequestToken()}else{const b=s.dialog.createHtmlBuilder(),k=new Je.tt("\n<div>\n\u767b\u9332\u3092\u89e3\u9664\u3059\u308b\u3068\u3059\u3079\u3066\u306e\u901a\u77e5\u306f\u505c\u6b62\u3057\u307e\u3059\u3002\u3088\u308d\u3057\u3044\u3067\u3059\u304b\uff1f\n</div>\n");b.setMessage(k).setType(V.hs.Warn).setSize(V.EV.Default).setTitle("\u78ba\u8a8d").okButton((0,$.A)(function*(){yield s.revokeNotification()})).cancelButton(()=>{s.messagingOnControl.setValue(!0),U(s.messagingOnControl)}).open()}})()}getMessagingTypes(){const i=[];return this.typeSystemControl.value&&i.push("system"),this.typeMentionControl.value&&i.push("mention"),this.typeAdminControl.value&&i.push("admin"),i}updateRequestToken(){var i=this;return(0,$.A)(function*(){var s;i.messaging.requestToken.pipe((0,I.s)(1),(0,P.Q)(i.destroy$)).subscribe({next:(s=(0,$.A)(function*(d){if(i.tokenReceived.next(d),i.debugObservable.tokenReceived.push(d),!d)return(0,m.sJ)("No token returned from requestToken"),i.messagingOnControl.setValue(!1),U(i.messagingOnControl),void i.toastr.error("\u901a\u77e5\u60c5\u5831\u3092\u53d6\u5f97\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002");try{(0,m.Oi)(`Updated token with ${d}`);const b={token:d,deviceId:i.registeredDeviceId};i.registeredToken=d,i.registeredDeviceId=yield i.funcs.call("saveDeviceToken",b),i.toastr.success("\u901a\u77e5\u60c5\u5831\u3092\u4fdd\u5b58\u3057\u307e\u3057\u305f\u3002"),U(i.messagingOnControl)}catch(b){(0,m.sJ)("Error while save token to Firestore",b),i.messagingOnControl.setValue(!1),U(i.messagingOnControl),i.toastr.error("\u901a\u77e5\u60c5\u5831\u3092\u4fdd\u5b58\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002")}}),function(b){return s.apply(this,arguments)}),error:s=>{(0,m.sJ)("Error while request Token",s),i.messagingOnControl.setValue(!1),U(i.messagingOnControl),i.toastr.error("\u901a\u77e5\u3092\u6709\u52b9\u306b\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002\u30d6\u30e9\u30a6\u30b6\u306e\u8a2d\u5b9a\u3092\u78ba\u8a8d\u3057\u3066\u304f\u3060\u3055\u3044\u3002")}})})()}onClickUpdateMessaging(i){var s=this;return(0,$.A)(function*(){(0,m.Oi)("UserSettingsComponent.onClickUpdateMessaging()");try{const d={messageTypes:s.getMessagingTypes(),token:s.registeredToken,isWatchTrivial:s.typeTrivialControl.value};yield s.funcs.call("setNotifications",d),U(s.configArray),s.toastr.success("\u8a2d\u5b9a\u3092\u4fdd\u5b58\u3057\u307e\u3057\u305f\u3002")}catch(d){(0,m.sJ)("Failed to save configuration",d),s.toastr.error("\u8a2d\u5b9a\u304c\u4fdd\u5b58\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002")}})()}onClickSubscribeTopic(i){var s=this;return(0,$.A)(function*(){if(!s.debugObservable.topicText)return void alert("Not set");const d={topic:s.debugObservable.topicText,token:s.registeredToken},b=yield s.funcs.call("subscribeTopicTest",d);(0,m.rD)("subscribeTopicTest ->",b),s.toastr.success(`done subscribe ${b}`)})()}onClickUnsubscribeTopic(i){var s=this;return(0,$.A)(function*(){if(!s.debugObservable.topicText)return void alert("Not set");const d={topic:s.debugObservable.topicText,token:s.registeredToken},b=yield s.funcs.call("unsubscribeTopicTest",d);(0,m.rD)("unsubscribeTopicTest ->",b),s.toastr.success(`done unsubscribe ${b}`)})()}onClickPostToTopic(i){var s=this;return(0,$.A)(function*(){if(!s.debugObservable.topicText||!s.debugObservable.topicPostText)return void alert("Not set");const d={topic:s.debugObservable.topicText,title:s.debugObservable.topicPostText},b=yield s.funcs.call("postTopicTest",d);(0,m.rD)("postTopicTest ->",b),s.toastr.success(`done post ${b}`)})()}onClickConditionPostToTopic(i){var s=this;return(0,$.A)(function*(){if(!s.debugObservable.conditionTopicPostText||!s.debugObservable.conditionTopicPostText)return void alert("Not set");const d={topic:s.debugObservable.conditionTopicPostText,title:s.debugObservable.topicPostText},b=yield s.funcs.call("postConditionTopicTest",d);(0,m.rD)("postConditionTopicTest ->",b),s.toastr.success(`done post ${b}`)})()}onClickClearMessages(i){this.debugObservable.messages=[]}static \u0275fac=function(s){return new(s||l)(e.rXU(ee.u),e.rXU(V.o3),e.rXU(y.tw),e.rXU(ne.Qe),e.rXU(Me.Y),e.rXU(C))};static \u0275cmp=e.VBU({type:l,selectors:[["gitfire-user-notification"]],inputs:{mainForm:"mainForm",userPrivStore$:"userPrivStore$"},decls:69,vars:16,consts:[[1,"m-2"],["title","\u3053\u306e\u6a5f\u80fd\u306f\u30c6\u30b9\u30c8\u4e2d\u306e\u305f\u3081\u5909\u66f4\u3055\u308c\u308b\u3053\u3068\u3084\u3001\u60f3\u5b9a\u5916\u306e\u6319\u52d5\u3092\u3059\u308b\u5834\u5408\u304c\u3042\u308a\u307e\u3059\u3002\u30d6\u30e9\u30a6\u30b6\u304b\u3089\u306e\u901a\u77e5\u3092\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u3057\u307e\u3059\u3002\u8a2d\u5b9a\u304c\u3046\u307e\u304f\u3044\u304b\u306a\u3044\u5834\u5408\u306f\u30d6\u30e9\u30a6\u30b6\u304b\u3089\u5f53\u30b5\u30a4\u30c8\u306e\u901a\u77e5 on/off \u3092\u3057\u305f\u308a\u3001\u300e\u7aef\u672b\u306e\u524a\u9664\u300f\u3092\u304a\u8a66\u3057\u304f\u3060\u3055\u3044\u3002","src","/assets/octicons/question.svg",1,"m-3","octicon-info","help-icon"],[1,"m-2",3,"formGroup"],[1,"row","p-1"],[1,"d-flex","align-content-start","flex-wrap","p-1"],["controlLabel","\u901a\u77e5\u3092\u53d7\u3051\u53d6\u308b","formName","messagingOn","tooltipText","\u30d6\u30e9\u30a6\u30b6\u304b\u3089\u306e\u901a\u77e5\u3092\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u3057\u307e\u3059\u3002",1,"p-2",3,"checkChanged","parentForm"],[1,"d-flex","align-content-start","flex-wrap","p-3"],["class","m-1 input-group",4,"ngFor","ngForOf"],[1,"row","m-2"],["controlLabel","\u3061\u3087\u3063\u3068\u3057\u305f\u901a\u77e5","formName","messagingTrivialCheck","tooltipText","\u3061\u3087\u3063\u3068\u3057\u305f\u901a\u77e5\u3082\u53d7\u3051\u53d6\u308b\u304b\u3069\u3046\u304b\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\u901a\u5e38\u306f\u4e0d\u8981\u3067\u3059\u3002",1,"p-2",3,"parentForm"],["controlLabel","\u30b7\u30b9\u30c6\u30e0","formName","messagingSystemCheck","tooltipText","\u30b7\u30b9\u30c6\u30e0\u304b\u3089\u306e\u901a\u77e5\u3092\u9001\u308b\u304b\u3069\u3046\u304b\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002",1,"p-2",3,"parentForm"],["controlLabel","\u3042\u306a\u305f\u3078\u306e\u8a00\u53ca","formName","messagingMentionCheck","tooltipText","\u30b7\u30b9\u30c6\u30e0\u306e\u30e1\u30c3\u30bb\u30fc\u30b8\u30b7\u30b9\u30c6\u30e0\u3067\u3042\u306a\u305f\u306b\u8a00\u53ca\u3055\u308c\u305f\u5834\u5408\u306b\u901a\u77e5\u3092\u9001\u308b\u304b\u3069\u3046\u304b\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002",1,"p-2",3,"parentForm"],["controlLabel","\u7ba1\u7406\u4eba\u304b\u3089","formName","messagingAdminCheck","tooltipText","\u7ba1\u7406\u4eba\u304c\u624b\u52d5\u3067\u3042\u306a\u305f\u306b\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u9001\u3063\u305f\u5834\u5408\u306b\u901a\u77e5\u3092\u9001\u308b\u304b\u3069\u3046\u304b\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002",1,"p-2",3,"parentForm"],[1,"btn","btn-primary",3,"click","disabled"],[2,"width","100%","overflow-wrap","break-word"],[4,"ngFor","ngForOf"],["type","text",3,"ngModelChange","ngModel"],[1,"btn","btn-primary",3,"click"],[1,"btn","btn-warning",3,"click"],[1,"m-1","input-group"],["tooltipText","\u767b\u9332\u3055\u308c\u305f Device \u306e\u901a\u77e5\u3092\u4e00\u6642\u7684\u306b\u505c\u6b62\u3057\u307e\u3059\u3002",1,"m-2",3,"checkChanged","parentForm","controlLabel","formName"],["class","btn btn-warning","title","\u767b\u9332\u60c5\u5831\u3092\u524a\u9664\u3057\u3066\u3001\u3053\u306e\u7aef\u672b\u3078\u306e\u901a\u77e5\u3092\u89e3\u9664\u3057\u307e\u3059\u3002",3,"click",4,"ngIf"],["title","\u767b\u9332\u60c5\u5831\u3092\u524a\u9664\u3057\u3066\u3001\u3053\u306e\u7aef\u672b\u3078\u306e\u901a\u77e5\u3092\u89e3\u9664\u3057\u307e\u3059\u3002",1,"btn","btn-warning",3,"click"]],template:function(s,d){1&s&&(e.j41(0,"h2",0),e.EFF(1,"\u901a\u77e5\u8a2d\u5b9a (\u30c6\u30b9\u30c8\u4e2d)"),e.nrm(2,"img",1),e.k0s(),e.j41(3,"div",2)(4,"div",3)(5,"div",4)(6,"app-switch",5),e.bIt("checkChanged",function(k){return d.onToggleMessaging(k)}),e.k0s()()(),e.j41(7,"div",0)(8,"h3"),e.EFF(9,"\u767b\u9332\u3055\u308c\u305f\u30c7\u30d0\u30a4\u30b9"),e.k0s(),e.j41(10,"div",6),e.DNE(11,Pt,4,11,"div",7),e.k0s()(),e.j41(12,"div")(13,"div",8)(14,"h3"),e.EFF(15,"\u91cd\u8981\u5ea6"),e.k0s(),e.j41(16,"div",4),e.nrm(17,"app-switch",9),e.k0s()(),e.j41(18,"div",8)(19,"h3"),e.EFF(20,"\u7a2e\u985e"),e.k0s(),e.j41(21,"div",4),e.nrm(22,"app-switch",10)(23,"app-switch",11)(24,"app-switch",12),e.k0s()(),e.j41(25,"div",8)(26,"button",13),e.bIt("click",function(k){return d.onClickUpdateMessaging(k)}),e.EFF(27,"\u66f4\u65b0"),e.k0s()()()(),e.j41(28,"div",14)(29,"div"),e.EFF(30,"Token: "),e.j41(31,"div"),e.EFF(32),e.k0s()(),e.j41(33,"div"),e.EFF(34,"GetToken: "),e.DNE(35,Ft,2,2,"div",15),e.k0s(),e.j41(36,"div"),e.EFF(37,"TokenChanges: "),e.DNE(38,dt,2,2,"div",15),e.k0s(),e.j41(39,"div"),e.EFF(40,"TokenReceived: "),e.DNE(41,xt,2,2,"div",15),e.k0s(),e.j41(42,"div")(43,"div")(44,"label"),e.EFF(45,"Topic: "),e.j41(46,"input",16),e.mxI("ngModelChange",function(k){return e.DH7(d.debugObservable.topicText,k)||(d.debugObservable.topicText=k),k}),e.k0s()(),e.j41(47,"button",17),e.bIt("click",function(k){return d.onClickSubscribeTopic(k)}),e.EFF(48,"subscribe"),e.k0s(),e.j41(49,"button",17),e.bIt("click",function(k){return d.onClickUnsubscribeTopic(k)}),e.EFF(50,"unsubscribe"),e.k0s()(),e.j41(51,"div")(52,"label"),e.EFF(53,"Post Title: "),e.j41(54,"input",16),e.mxI("ngModelChange",function(k){return e.DH7(d.debugObservable.topicPostText,k)||(d.debugObservable.topicPostText=k),k}),e.k0s()(),e.j41(55,"button",17),e.bIt("click",function(k){return d.onClickPostToTopic(k)}),e.EFF(56,"Post"),e.k0s()(),e.j41(57,"div")(58,"label"),e.EFF(59,"Condition Topic Post: "),e.j41(60,"input",16),e.mxI("ngModelChange",function(k){return e.DH7(d.debugObservable.conditionTopicPostText,k)||(d.debugObservable.conditionTopicPostText=k),k}),e.k0s()(),e.j41(61,"button",17),e.bIt("click",function(k){return d.onClickConditionPostToTopic(k)}),e.EFF(62,"CondPost"),e.k0s()()()(),e.j41(63,"div")(64,"button",18),e.bIt("click",function(k){return d.onClickClearMessages(k)}),e.EFF(65,"Clear"),e.k0s(),e.j41(66,"div"),e.EFF(67,"Messages: "),e.DNE(68,ht,3,3,"div",15),e.k0s()()),2&s&&(e.R7$(3),e.Y8G("formGroup",d.mainForm),e.R7$(3),e.Y8G("parentForm",d.mainForm),e.R7$(5),e.Y8G("ngForOf",d.devices),e.R7$(6),e.Y8G("parentForm",d.mainForm),e.R7$(5),e.Y8G("parentForm",d.mainForm),e.R7$(),e.Y8G("parentForm",d.mainForm),e.R7$(),e.Y8G("parentForm",d.mainForm),e.R7$(2),e.Y8G("disabled",d.configArray.invalid||!d.configArray.dirty),e.R7$(6),e.JRh(d.debugObservable.registeredToken),e.R7$(3),e.Y8G("ngForOf",d.debugObservable.getToken),e.R7$(3),e.Y8G("ngForOf",d.debugObservable.tokenChanges),e.R7$(3),e.Y8G("ngForOf",d.debugObservable.tokenReceived),e.R7$(5),e.R50("ngModel",d.debugObservable.topicText),e.R7$(8),e.R50("ngModel",d.debugObservable.topicPostText),e.R7$(6),e.R50("ngModel",d.debugObservable.conditionTopicPostText),e.R7$(8),e.Y8G("ngForOf",d.debugObservable.messages))},dependencies:[O.Sq,O.bT,o.me,o.BC,o.cb,o.vS,o.j4,lt,O.TG,O.vh]})}return l})();const pt=["protectedSettings"],Ut=["imageBox"],ft=()=>["(\u5371\u967a)","(\u5f31\u3044)","(\u666e\u901a)","(\u5f37\u3044)","(\u5145\u5206\u306b\u5b89\u5168)"],me=()=>["#DD2C00","#FF6D00","#FFD600","#AEEA00","#00C853"];function ot(l,S){1&l&&e.EFF(0,"\u753b\u50cf\u304c\u3042\u308a\u307e\u305b\u3093")}function He(l,S){if(1&l&&e.nrm(0,"img",39),2&l){const i=e.XpG().ngIf;e.FS9("src",i.photoURL,e.B4B)}}function it(l,S){if(1&l){const i=e.RV6();e.qex(0),e.j41(1,"span",40),e.EFF(2," -> "),e.k0s(),e.j41(3,"label",11),e.EFF(4,"\u65b0\u3057\u3044\u753b\u50cf"),e.k0s(),e.nrm(5,"img",41),e.j41(6,"button",42),e.bIt("click",function(d){const b=e.eBV(i).ngIf,k=e.XpG(2);return e.Njj(k.onClickOkImage(d,b))}),e.EFF(7,"\u78ba\u5b9a"),e.k0s(),e.bVm()}if(2&l){const i=S.ngIf;e.R7$(5),e.FS9("src",i,e.B4B)}}function gt(l,S){1&l&&e.nrm(0,"div",43)}function st(l,S){if(1&l&&(e.j41(0,"div",43),e.EFF(1),e.k0s()),2&l){const i=e.XpG(3);e.R7$(),e.SpI("\u6b8b\u308a ",i.nicknameResult.changesRemain," \u56de \u5909\u66f4\u3067\u304d\u307e\u3059\u3002")}}function tt(l,S){1&l&&(e.j41(0,"div",45),e.EFF(1,"\u3053\u308c\u4ee5\u4e0a\u306f\u5909\u66f4\u3067\u304d\u307e\u305b\u3093\u3002"),e.k0s())}function wt(l,S){if(1&l&&(e.qex(0),e.DNE(1,st,2,1,"div",20)(2,tt,2,0,"div",44),e.bVm()),2&l){const i=e.XpG(2);e.R7$(),e.Y8G("ngIf",i.nicknameResult.changesRemain>0),e.R7$(),e.Y8G("ngIf",0===i.nicknameResult.changesRemain)}}function nt(l,S){1&l&&(e.j41(0,"div",45),e.EFF(1,"\u5165\u529b\u5fc5\u9808\u3067\u3059\u3002"),e.k0s())}function Rt(l,S){1&l&&(e.j41(0,"div",45),e.EFF(1,"\u9577\u3059\u304e\u307e\u3059\u3002"),e.k0s())}function we(l,S){1&l&&(e.j41(0,"div",45),e.EFF(1,"\u77ed\u3059\u304e\u307e\u3059\u3002"),e.k0s())}function mt(l,S){if(1&l&&(e.qex(0),e.DNE(1,nt,2,0,"div",44)(2,Rt,2,0,"div",44)(3,we,2,0,"div",44),e.bVm()),2&l){const i=e.XpG(2);e.R7$(),e.Y8G("ngIf",null==i.nicknameControl.errors?null:i.nicknameControl.errors.required),e.R7$(),e.Y8G("ngIf",null==i.nicknameControl.errors?null:i.nicknameControl.errors.maxlength),e.R7$(),e.Y8G("ngIf",null==i.nicknameControl.errors?null:i.nicknameControl.errors.minlength)}}function Bt(l,S){1&l&&e.nrm(0,"div",43)}function _t(l,S){1&l&&(e.j41(0,"div",45),e.EFF(1,"\u9577\u3059\u304e\u307e\u3059\u3002"),e.k0s())}function vt(l,S){if(1&l&&(e.qex(0),e.DNE(1,_t,2,0,"div",44),e.bVm()),2&l){const i=e.XpG(2);e.R7$(),e.Y8G("ngIf",null==i.aboutControl.errors?null:i.aboutControl.errors.maxlength)}}function at(l,S){if(1&l&&(e.qex(0),e.nrm(1,"hr")(2,"gitfire-user-notification",46),e.bVm()),2&l){const i=e.XpG(2);e.R7$(2),e.Y8G("mainForm",i.notificationForm)("userPrivStore$",i.userPrivate$)}}function _e(l,S){1&l&&e.nrm(0,"div",43)}function Qe(l,S){1&l&&(e.j41(0,"div",45),e.EFF(1,"E \u30e1\u30fc\u30eb\u306f\u5fc5\u9808\u3067\u3059\u3002"),e.k0s())}function Mt(l,S){1&l&&(e.j41(0,"div",45),e.EFF(1,"E \u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044\u3002"),e.k0s())}function Ke(l,S){if(1&l&&(e.qex(0),e.DNE(1,Qe,2,0,"div",44)(2,Mt,2,0,"div",44),e.bVm()),2&l){const i=e.XpG(2);e.R7$(),e.Y8G("ngIf",null==i.emailControl.errors?null:i.emailControl.errors.required),e.R7$(),e.Y8G("ngIf",(null==i.emailControl.errors?null:i.emailControl.errors.minlength)||(null==i.emailControl.errors?null:i.emailControl.errors.maxlength))}}function bt(l,S){1&l&&(e.j41(0,"div",43),e.EFF(1,"\u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u5f37\u5ea6\u306f\u5145\u5206\u306b\u3057\u3066\u304f\u3060\u3055\u3044\u3002"),e.k0s())}function Ct(l,S){1&l&&(e.j41(0,"div",45),e.EFF(1,"\u30d1\u30b9\u30ef\u30fc\u30c9\u306f\u5fc5\u9808\u3067\u3059\u3002"),e.k0s())}function ut(l,S){1&l&&(e.j41(0,"div",45),e.EFF(1,"\u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u9577\u3055\u304c\u8db3\u308a\u307e\u305b\u3093\u3002"),e.k0s())}function Lt(l,S){if(1&l&&(e.qex(0),e.DNE(1,Ct,2,0,"div",44)(2,ut,2,0,"div",44),e.bVm()),2&l){const i=e.XpG(2);e.R7$(),e.Y8G("ngIf",null==i.passwordControl.errors?null:i.passwordControl.errors.required),e.R7$(),e.Y8G("ngIf",null==i.passwordControl.errors?null:i.passwordControl.errors.minlength)}}function ct(l,S){if(1&l){const i=e.RV6();e.qex(0),e.j41(1,"div",5)(2,"form",6,0)(4,"h2",7),e.EFF(5,"\u516c\u958b\u8a2d\u5b9a"),e.nrm(6,"img",8),e.k0s(),e.j41(7,"div")(8,"div",9)(9,"div",10)(10,"label",11),e.EFF(11,"\u73fe\u5728\u306e\u753b\u50cf"),e.k0s(),e.DNE(12,ot,1,0,"ng-template",null,1,e.C5r)(14,He,1,1,"img",12)(15,it,8,1,"ng-container",4),e.nI1(16,"async"),e.k0s(),e.j41(17,"div",13),e.nrm(18,"input",14,2),e.j41(20,"button",15),e.bIt("click",function(d){e.eBV(i);const b=e.XpG();return e.Njj(b.onClickUploadImage(d))}),e.EFF(21,"Upload"),e.k0s()()(),e.j41(22,"div",16)(23,"label",17),e.EFF(24,"\u30cb\u30c3\u30af\u30cd\u30fc\u30e0"),e.nrm(25,"img",18),e.k0s(),e.nrm(26,"input",19),e.j41(27,"button",15),e.bIt("click",function(d){e.eBV(i);const b=e.XpG();return e.Njj(b.onClickUpdateNickname(d))}),e.EFF(28,"\u66f4\u65b0"),e.k0s()(),e.DNE(29,gt,1,0,"div",20)(30,wt,3,2,"ng-container",4)(31,mt,4,3,"ng-container",4),e.j41(32,"div",16)(33,"label",17),e.EFF(34,"\u81ea\u5df1\u7d39\u4ecb"),e.nrm(35,"img",21),e.k0s(),e.nrm(36,"textarea",22),e.j41(37,"button",23),e.bIt("click",function(d){e.eBV(i);const b=e.XpG();return e.Njj(b.onClickUpdateAbout(d))}),e.EFF(38,"\u66f4\u65b0"),e.k0s()()(),e.DNE(39,Bt,1,0,"div",20)(40,vt,2,1,"ng-container",4)(41,at,3,2,"ng-container",4),e.nrm(42,"hr"),e.j41(43,"a",24),e.bIt("click",function(d){e.eBV(i);const b=e.XpG();return e.Njj(b.onClickImportant(d))}),e.EFF(44),e.k0s(),e.j41(45,"div",25,3)(47,"div",26)(48,"label",27),e.EFF(49,"\u540d\u524d"),e.nrm(50,"img",28),e.k0s(),e.nrm(51,"input",29),e.k0s(),e.j41(52,"div",26)(53,"label",27),e.EFF(54,"Email"),e.nrm(55,"img",30),e.k0s(),e.nrm(56,"input",31),e.j41(57,"button",32),e.bIt("click",function(d){e.eBV(i);const b=e.XpG();return e.Njj(b.onClickUpdateEmail(d))}),e.EFF(58,"\u66f4\u65b0"),e.k0s(),e.DNE(59,_e,1,0,"div",20)(60,Ke,3,2,"ng-container",4),e.k0s(),e.j41(61,"div",26)(62,"label",27),e.EFF(63,"Password"),e.nrm(64,"img",33),e.k0s(),e.nrm(65,"input",34),e.j41(66,"button",32),e.bIt("click",function(d){e.eBV(i);const b=e.XpG();return e.Njj(b.onClickUpdatePassword(d))}),e.EFF(67,"\u66f4\u65b0"),e.k0s(),e.nrm(68,"ng9-password-strength-bar",35),e.nI1(69,"async"),e.DNE(70,bt,2,0,"div",20)(71,Lt,3,2,"ng-container",4),e.k0s(),e.j41(72,"h3",36),e.EFF(73,"\u30a2\u30ab\u30a6\u30f3\u30c8\u306e\u7d42\u4e86"),e.k0s(),e.j41(74,"div",37)(75,"button",38),e.bIt("click",function(d){e.eBV(i);const b=e.XpG();return e.Njj(b.onClickDeleteAccount(d))}),e.EFF(76,"\u30a2\u30ab\u30a6\u30f3\u30c8\u3092\u524a\u9664"),e.k0s()()()()(),e.bVm()}if(2&l){const i=S.ngIf,s=e.sdS(13),d=e.XpG();e.R7$(2),e.Y8G("formGroup",d.inputForm),e.R7$(12),e.Y8G("ngIf",i.photoURL)("ngIfElse",s),e.R7$(),e.Y8G("ngIf",e.bMT(16,35,d.profileTempImage$)),e.R7$(5),e.Y8G("disabled",d.userIconControl.invalid||!d.userIconControl.dirty),e.R7$(2),e.AVh("was-validated",d.nicknameControl.dirty||d.nicknameControl.touched),e.R7$(5),e.Y8G("disabled",d.nicknameControl.invalid||!d.nicknameControl.dirty),e.R7$(2),e.Y8G("ngIf",!d.nicknameControl.invalid),e.R7$(),e.Y8G("ngIf",d.nicknameResult),e.R7$(),e.Y8G("ngIf",d.nicknameControl.invalid),e.R7$(),e.AVh("was-validated",d.aboutControl.dirty||d.aboutControl.touched),e.R7$(5),e.Y8G("disabled",d.aboutControl.invalid||!d.aboutControl.dirty),e.R7$(2),e.Y8G("ngIf",!d.aboutControl.invalid),e.R7$(),e.Y8G("ngIf",d.aboutControl.invalid),e.R7$(),e.Y8G("ngIf",d.auth.isDeveloper),e.R7$(3),e.JRh(d.isOpenOther?"\u518d\u8a8d\u8a3c":"\u305d\u306e\u4ed6\u306e\u8a2d\u5b9a"),e.R7$(7),e.Y8G("value",i.displayName),e.R7$(),e.AVh("was-validated",d.emailControl.dirty||d.emailControl.touched),e.R7$(5),e.Y8G("disabled",d.emailControl.invalid||!d.emailControl.dirty),e.R7$(2),e.Y8G("ngIf",!d.emailControl.invalid),e.R7$(),e.Y8G("ngIf",d.emailControl.invalid),e.R7$(),e.AVh("was-validated",d.passwordControl.dirty||d.passwordControl.touched),e.R7$(5),e.Y8G("disabled",!d.passwordControl.value||d.passwordControl.invalid||!d.passwordControl.dirty),e.R7$(2),e.xc7("display",""===d.passwordControl.value?"none":null),e.Y8G("passwordToCheck",e.bMT(69,37,d.passwordControl.valueChanges))("barLabel","\u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u5f37\u5ea6(\u76ee\u5b89): ")("strengthLabels",e.lJ4(39,ft))("barColors",e.lJ4(40,me)),e.R7$(2),e.Y8G("ngIf",!d.passwordControl.invalid),e.R7$(),e.Y8G("ngIf",d.passwordControl.invalid)}}let Nt=(()=>{class l{auth;storage;funcs;store;toastr;router;dialog;localSession;destroy$=new _.B;currentUser;currentUser$;userPublic;userPrivate$=new _.B;profileTempImage$;inputForm;notificationForm;isOpenOther=!1;nicknameResult=null;protectedSettings;imageBox;pubUser;privUser;nicknameIndex;constructor(i,s,d,b,k,ye,ze,Xe){this.auth=i,this.storage=s,this.funcs=d,this.store=b,this.toastr=k,this.router=ye,this.dialog=ze,this.localSession=Xe,this.pubUser=this.store.collection("/users/v1/public"),this.privUser=this.store.collection("/users/v1/protected"),this.nicknameIndex=this.store.collection("/index/users/usernick"),this.currentUser$=this.auth.clientSideUser$,this.currentUser$.pipe((0,P.Q)(this.destroy$)).subscribe(Ye=>{this.currentUser=Ye})}ngOnInit(){this.inputForm=new o.gE({}),this.inputForm.addControl("userIcon",new o.MJ("",[o.k0.required])),this.inputForm.addControl("email",new o.MJ({value:"",disabled:!1},[o.k0.required])),this.inputForm.addControl("password",new o.MJ("",[])),this.inputForm.addControl("nickname",new o.MJ({value:"",disabled:!0},[o.k0.required])),this.inputForm.addControl("about",new o.MJ({value:"",disabled:!0},[])),this.notificationForm=new o.gE({}),this.inputForm.addControl("messaging",this.notificationForm)}ngAfterViewInit(){const i=this.currentUser$.pipe((0,I.s)(1),(0,x.p)(s=>!!s));i.pipe((0,se.n)(s=>this.pubUser.doc(s.uid).valueChanges()),(0,P.Q)(this.destroy$)).subscribe(s=>{this.userPublic=s,j(this.aboutControl,s.about),this.aboutControl.enable(),j(this.nicknameControl,s.nickname),this.nicknameControl.enable()}),i.pipe((0,se.n)(s=>this.privUser.doc(s.uid).valueChanges()),(0,P.Q)(this.destroy$)).subscribe(s=>{this.userPrivate$.next(s)}),i.pipe((0,P.Q)(this.destroy$)).subscribe(s=>{this.emailControl.setValue(s.email)})}ngOnDestroy(){this.destroy$.next()}get emailControl(){return this.inputForm.get("email")}get passwordControl(){return this.inputForm.get("password")}get aboutControl(){return this.inputForm.get("about")}get nicknameControl(){return this.inputForm.get("nickname")}get userIconControl(){return this.inputForm.get("userIcon")}onClickDeleteAccount(i){this.dialog.createDefaultBuilder().prepareBody(J).setType(V.hs.Warn).setSize(V.EV.Default).setTitle("\u6700\u7d42\u78ba\u8a8d").okButton(()=>{this.doDeleteAccount()}).cancelButton(()=>{}).open()}doDeleteAccount(){var i=this;return(0,$.A)(function*(){try{yield i.currentUser.delete(),(0,m.Oi)("Account is deleted")}catch(d){(0,m.sJ)("Error while delete account",d);const b=d instanceof Error?d.message:"Unknown error";return void i.toastr.error(`\u30a2\u30ab\u30a6\u30f3\u30c8\u3092\u524a\u9664\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002 ( ${b} )`)}i.localSession.unmarkLogin(),i.router.navigate(["/"])})()}updateError(i,s){(0,m.sJ)(`Error while update tag:${i}`,s);const d=s instanceof Error?s.message:"Unknown error";this.toastr.error(`${i} \u306e\u66f4\u65b0\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002 ( ${d} )`)}updateSucceeded(i,s){this.toastr.success(`${i} \u3092 "${s}" \u306b\u66f4\u65b0\u3057\u307e\u3057\u305f\u3002`)}updateProfileImage(i){var s=this;return(0,$.A)(function*(){if(""===i)return;const d="\u30d7\u30ed\u30d5\u30a3\u30fc\u30eb\u753b\u50cf";try{yield s.currentUser.updateProfile({photoURL:i});const k={photoURL:i,updatedAt:ce.A.firestore.FieldValue.serverTimestamp()};yield s.pubUser.doc(s.currentUser.uid).update(k),s.updateSucceeded(d,"Upload \u3057\u305f\u753b\u50cf"),s.getProfileRef("temp_profile").delete(),s.profileTempImage$=null,s.userIconControl.setValue(""),U(s.userIconControl)}catch(b){s.updateError(d,b)}})()}onClickUpdateNickname(i){var s=this;return(0,$.A)(function*(){if(s.nicknameControl.invalid)return;const d=s.nicknameControl.value;if(d===s.userPublic.nickname)return;const b="\u30cb\u30c3\u30af\u30cd\u30fc\u30e0";try{const k={nickname:d};s.nicknameResult=yield s.funcs.call("updateNickname",k),s.updateSucceeded(b,d),U(s.nicknameControl)}catch(k){s.updateError(b,k)}})()}onClickUpdateAbout(i){var s=this;return(0,$.A)(function*(){if(s.aboutControl.invalid)return;const d=s.aboutControl.value;if(d===s.userPublic.about)return;const b="\u81ea\u5df1\u7d39\u4ecb";try{const k={about:d};yield s.funcs.call("updateAbout",k),s.updateSucceeded(b,d),U(s.aboutControl)}catch(k){s.updateError(b,k)}})()}onClickUpdateEmail(i){var s=this;return(0,$.A)(function*(){if(s.emailControl.invalid)return;const d=s.emailControl.value;d!==s.currentUser.email&&s.dialog.createSimpleBuilder().setType(V.hs.Warn).setSize(V.EV.Default).setMessage("\u767b\u9332\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u3092\u5909\u66f4\u3057\u307e\u3059\u3002\u3088\u308d\u3057\u3044\u3067\u3059\u304b\uff1f").setTitle("\u78ba\u8a8d").okButton(()=>{s.doChangeEmail(d)}).cancelButton(()=>{}).open()})()}doChangeEmail(i){var s=this;return(0,$.A)(function*(){const d="Email";try{yield s.currentUser.updateEmail(i),yield s.currentUser.sendEmailVerification(),s.updateSucceeded(d,i),U(s.emailControl),s.toastr.info("\u78ba\u8a8d\u306e\u30e1\u30fc\u30eb\u3092\u9001\u4fe1\u3057\u307e\u3057\u305f\u3002")}catch(b){s.updateError(d,b)}})()}onClickUpdatePassword(i){var s=this;return(0,$.A)(function*(){if(s.passwordControl.invalid)return;const d=s.passwordControl.value;if(""===d)return;const b="\u30d1\u30b9\u30ef\u30fc\u30c9";try{yield s.currentUser.updatePassword(d),s.updateSucceeded(b,"********"),U(s.passwordControl)}catch(k){s.updateError(b,k)}finally{s.passwordControl.setValue("")}})()}listProvider(){}ensureImageFile(){const i=this.imageBox.nativeElement;if(0===i.files.length)return this.toastr.error("\u30d5\u30a1\u30a4\u30eb\u3092\u9078\u629e\u3057\u3066\u304f\u3060\u3055\u3044\u3002"),null;const s=i.files[0];return s.size>=524288?(this.toastr.error("\u30d5\u30a1\u30a4\u30eb\u306e\u30b5\u30a4\u30ba\u304c\u5927\u304d\u3059\u304e\u307e\u3059\u3002(\u7d04 500kb \u307e\u3067)"),null):s}getProfileRef(i){return this.storage.ref(`/image/${this.currentUser.uid}/profile/${i}`)}onClickUploadImage(i){var s=this;return(0,$.A)(function*(){const d=s.ensureImageFile();if(!d)return;const b=yield s.uploadProfileImage("temp_profile",d);s.profileTempImage$=b.ref.getDownloadURL()})()}uploadProfileImage(i,s){var d=this;return(0,$.A)(function*(){return yield d.getProfileRef(i).put(s)})()}doChangePhoto(i){var s=this;return(0,$.A)(function*(){const b=yield(yield s.uploadProfileImage("profile",i)).ref.getDownloadURL();s.updateProfileImage(b)})()}initializeReauth(i){i.currentUser=this.currentUser,i.reauthed.subscribe(()=>{new w.SD(this.protectedSettings.nativeElement).show(),this.isOpenOther=!0})}constructReauth(){return i=>{}}onClickImportant(i){(0,m.Oi)("onClickImportant()"),this.dialog.createDefaultBuilder().prepareBody(H,d=>this.initializeReauth(d)).setupChild(this.constructReauth()).setType(V.hs.Info).setSize(V.EV.Default).setTitle("\u518d\u8a8d\u8a3c").cancelButton(()=>{}).closeButton(()=>{}).open()}onClickOkImage(i,s){const d=this.ensureImageFile();d&&this.dialog.createSimpleBuilder().setType(V.hs.Info).setSize(V.EV.Default).setMessage("\u753b\u50cf\u306f\u516c\u958b\u3055\u308c\u307e\u3059\u3002\u3088\u308d\u3057\u3044\u3067\u3059\u304b\uff1f").setTitle("\u78ba\u8a8d").okButton(()=>{this.doChangePhoto(d)}).cancelButton(()=>{}).open()}static \u0275fac=function(s){return new(s||l)(e.rXU(ee.u),e.rXU(ue.ap),e.rXU(Me.Y),e.rXU(ne.Qe),e.rXU(y.tw),e.rXU(et.O),e.rXU(V.o3),e.rXU(Ne.Q))};static \u0275cmp=e.VBU({type:l,selectors:[["ng-component"]],viewQuery:function(s,d){if(1&s&&(e.GBs(pt,5),e.GBs(Ut,5)),2&s){let b;e.mGM(b=e.lsd())&&(d.protectedSettings=b.first),e.mGM(b=e.lsd())&&(d.imageBox=b.first)}},decls:1,vars:1,consts:[["configForm",""],["noPhoto",""],["imageBox",""],["protectedSettings",""],[4,"ngIf"],[1,"container"],[3,"formGroup"],[1,"mb-3"],["title","\u4e00\u822c\u516c\u958b\u3055\u308c\u308b\u60c5\u5831\u3092\u7de8\u96c6\u3067\u304d\u307e\u3059\u3002","src","/assets/octicons/question.svg",1,"m-3","octicon-info","help-icon"],[1,"my-2"],[1,"input-group","my-1"],[1,"visually-hidden"],["class","user-settings-profile-image rounded","alt","Profile \u753b\u50cf",3,"src",4,"ngIf","ngIfElse"],[1,"input-group"],["id","appGitfireInputIconFileInput","name","userIcon","formControlName","userIcon","type","file","placeholder","\u30a2\u30a4\u30b3\u30f3\u3092\u9078\u629e","accept","image/*",1,"form-control"],[1,"btn","btn-primary",3,"click","disabled"],[1,"input-group","my-2"],[1,"input-group-text"],["title","\u30e1\u30c3\u30bb\u30fc\u30b8\u4e0a\u306b\u8868\u793a\u3055\u308c\u308b\u3042\u306a\u305f\u306e\u540d\u524d\u3067\u3059\u3002","src","/assets/octicons/question.svg",1,"m-1","octicon-info","help-icon"],["name","nickname","placeholder","\u4f8b: hogehoge1032","formControlName","nickname","autofocus","","type","text","maxlength","19","minlength","4","required","",1,"form-control"],["class","valid-feedback",4,"ngIf"],["title","\u30d5\u30ea\u30fc\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u3067\u3059\u3002","src","/assets/octicons/question.svg",1,"m-1","octicon-info","help-icon"],["name","about","placeholder","\u4f8b: Ingress: kagura2718 (RES) \u30dd\u30b1\u30e2\u30f3go: kagura271(\u8d64)","formControlName","about","maxlength","200","type","text",1,"form-control"],["type","button",1,"btn","btn-primary",3,"click","disabled"],["role","button","aria-expanded","false",1,"btn","btn-secondary","collapsed",3,"click"],["id","appGitfireUserSettingsSecretContainer",1,"collapse","m-3"],[1,"row","input-group","m-3"],[1,"col-2","text-md-end","col-form-label"],["title","\u8a8d\u8a3c\u30d7\u30ed\u30d0\u30a4\u30c0\u304b\u3089\u63d0\u4f9b\u3055\u308c\u305f\u540d\u524d\u3067\u3059\u3002(\u975e\u516c\u958b)","src","/assets/octicons/question.svg",1,"m-1","octicon-info","help-icon"],["name","displayname","placeholder","\u4f8b: hogehoge1032","type","text","disabled","",1,"col-10","form-control",3,"value"],["title","\u8a8d\u8a3c\u306b\u4f7f\u308f\u308c\u308b\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u3067\u3059\u3002(\u975e\u516c\u958b)","src","/assets/octicons/question.svg",1,"m-1","octicon-info","help-icon"],["name","email","placeholder","email@example.com","formControlName","email","autocomplete","email","type","email","required","","autofill","","maxlength","1024","minlength","5",1,"col-8","form-control"],[1,"btn","btn-primary","col-2",3,"click","disabled"],["title","\u30ed\u30b0\u30a4\u30f3\u6642\u306e\u30d1\u30b9\u30ef\u30fc\u30c9\u3067\u3059\u3002\u4ed6\u4eba\u306b\u63a8\u6e2c\u3055\u308c\u306a\u3044\u3082\u306e\u3092\u4f7f\u7528\u3057\u3066\u304f\u3060\u3055\u3044\u3002(\u975e\u516c\u958b)","src","/assets/octicons/question.svg",1,"m-1","octicon-info","help-icon"],["name","password","placeholder","\u5909\u66f4\u306a\u3057","formControlName","password","type","password","autocomplete","new-password","maxlength","256","minlength","6",1,"col-8","form-control"],[1,"col-lg-5","col-form-label",3,"passwordToCheck","barLabel","strengthLabels","barColors"],[1,"m-3"],[1,"input-group","m-3"],["tabindex","-1",1,"btn","btn-warning",3,"click"],["alt","Profile \u753b\u50cf",1,"user-settings-profile-image","rounded",3,"src"],[1,"p-3"],["alt","\u65b0\u3057\u3044 Profile \u753b\u50cf",1,"user-settings-profile-image","rounded",3,"src"],[1,"btn","btn-primary",3,"click"],[1,"valid-feedback"],["class","invalid-feedback",4,"ngIf"],[1,"invalid-feedback"],[3,"mainForm","userPrivStore$"]],template:function(s,d){1&s&&e.DNE(0,ct,77,41,"ng-container",4),2&s&&e.Y8G("ngIf",d.currentUser)},dependencies:[O.bT,o.qT,o.me,o.BC,o.cb,o.YS,o.xh,o.tU,o.j4,o.JD,F.j,It,O.Jj],styles:[".user-settings-profile-image[_ngcontent-%COMP%]{width:80px;height:80px}.help-icon[_ngcontent-%COMP%]{width:20px;height:20px}"]})}return l})();function yt(l,S){if(1&l&&(e.j41(0,"div"),e.EFF(1),e.k0s()),2&l){const i=e.XpG().$implicit;e.R7$(),e.SpI("URL: ",i.url,"")}}function $t(l,S){if(1&l&&(e.j41(0,"div")(1,"div")(2,"div"),e.EFF(3),e.k0s(),e.DNE(4,yt,2,1,"div",0),e.j41(5,"div"),e.EFF(6),e.k0s(),e.j41(7,"div"),e.EFF(8),e.nI1(9,"date"),e.k0s()(),e.nrm(10,"hr"),e.j41(11,"div"),e.EFF(12),e.k0s()()),2&l){const i=S.$implicit;e.R7$(3),e.SpI("Title: ",i.title,""),e.R7$(),e.Y8G("ngIf",i.url),e.R7$(2),e.SpI("Done: ",i.hasRead,""),e.R7$(2),e.SpI("Date: ",e.i5U(9,5,i.createdAt.toDate(),"yyyy-MM-dd hh:mm:ss"),""),e.R7$(4),e.JRh(i.body)}}let Tt=(()=>{class l{auth;route;store;destroy$=new _.B;id$;trayStore;constructor(i,s,d){this.auth=i,this.route=s,this.store=d}ngOnDestroy(){this.destroy$.next()}ngOnInit(){(0,m.Oi)("UserTrayMessageComponent.OnInit()",this.route.snapshot),this.id$=this.route.queryParams.pipe((0,x.p)(i=>"id"in i),(0,Ae.T)(i=>i.id)),this.id$.pipe((0,se.n)(i=>(0,Ie.z)((0,Ce.of)(i),this.auth.clientSideUser$)),(0,x.p)(([i,s])=>null!==s),(0,se.n)(([i,s])=>this.store.doc(`/users/v1/protected/${s.uid}/tray/${i}`).valueChanges({idField:"id"}).pipe((0,I.s)(1))),(0,P.Q)(this.destroy$)).subscribe(i=>{this.trayStore=i})}static \u0275fac=function(s){return new(s||l)(e.rXU(ee.u),e.rXU(R.nX),e.rXU(ne.Qe))};static \u0275cmp=e.VBU({type:l,selectors:[["app-user-tray-message"]],decls:1,vars:1,consts:[[4,"ngIf"]],template:function(s,d){1&s&&e.DNE(0,$t,13,8,"div",0),2&s&&e.Y8G("ngIf",d.trayStore)},dependencies:[O.bT,O.vh]})}return l})(),c=(()=>{class l{auth;localSession;router;constructor(i,s,d){this.auth=i,this.localSession=s,this.router=d,(0,m.Oi)("AuthGuard.constructor")}canActivate(i,s){return this.auth.clientSideUser$.pipe((0,Ae.T)(d=>{if((0,m.rD)("AuthGuard",d),d)return!0;const b={queryParams:{redirectPath:s.url}};return(0,m.Oi)("auth.guard Prepare to redirect",b),this.router.createUrlTree(["/Gitfire/login"],b)}))}static \u0275fac=function(s){return new(s||l)(e.KVO(ee.u),e.KVO(Ne.Q),e.KVO(R.Ix))};static \u0275prov=e.jDH({token:l,factory:l.\u0275fac,providedIn:"root"})}return l})(),p=(()=>{class l{auth;localSession;router;constructor(i,s,d){this.auth=i,this.localSession=s,this.router=d}canActivate(i,s){return this.auth.authState.pipe((0,Ae.T)(d=>((0,m.rD)("LoginGuard",d),!d||this.router.createUrlTree(["/"]))))}static \u0275fac=function(s){return new(s||l)(e.KVO(de.DS),e.KVO(Ne.Q),e.KVO(R.Ix))};static \u0275prov=e.jDH({token:l,factory:l.\u0275fac,providedIn:"root"})}return l})();const D=[{path:"login.htm",loadChildren:()=>Promise.resolve().then(g.bind(g,1951)).then(l=>l.GitfireLoginModule),data:{mode:"login"},canActivate:[p]},{path:"login",redirectTo:"login.htm"},{path:"signup.htm",loadChildren:()=>Promise.resolve().then(g.bind(g,1951)).then(l=>l.GitfireLoginModule),data:{mode:"signup"},canActivate:[p]},{path:"signup",redirectTo:"signup.htm"},{path:"reset.htm",loadChildren:()=>Promise.resolve().then(g.bind(g,1951)).then(l=>l.GitfireLoginModule),data:{mode:"reset"}},{path:"reset",redirectTo:"reset.htm"},{path:"chat.htm",loadChildren:()=>Promise.all([g.e(76),g.e(471)]).then(g.bind(g,471)).then(l=>l.GitfireChatModule),canActivate:[c]},{path:"chat",redirectTo:"chat.htm"},{path:"post.htm",loadChildren:()=>g.e(421).then(g.bind(g,7421)).then(l=>l.GitfirePostModule),canActivate:[c]},{path:"post",redirectTo:"post.htm"},{path:"settings.htm",component:Nt,canActivate:[c]},{path:"settings",redirectTo:"settings.htm"},{path:"tray.htm",component:Tt,canActivate:[c]},{path:"tray",redirectTo:"tray.htm"}];let M=(()=>{class l{static \u0275fac=function(s){return new(s||l)};static \u0275mod=e.$C({type:l});static \u0275inj=e.G2t({imports:[R.iI.forChild(D),R.iI]})}return l})();var K=g(1951),u=g(3691),f=g(896),E=g(9243);let G=(()=>{class l{static \u0275fac=function(s){return new(s||l)};static \u0275mod=e.$C({type:l});static \u0275inj=e.G2t({providers:[E.D,f.u],imports:[O.MD,o.YN,o.X1,u.Q]})}return l})();var oe=g(5427);let te=(()=>{class l{constructor(){(0,m.rD)("Dynamically loaded GitfireModule")}static \u0275fac=function(s){return new(s||l)};static \u0275mod=e.$C({type:l});static \u0275inj=e.G2t({providers:[y.tw,ee.u,c,p,Me.Y,{provide:ae.Zg,useValue:m.cA.FirebaseCloudFunctionsRegion},{provide:re,useValue:m.cA.firebaseVapidKey}],imports:[O.MD,o.YN,o.X1,M,K.GitfireLoginModule,G,F.o,y._B.forRoot(m.cA.toastrConfig),Y.bf.initializeApp(m.cA.firebaseConfig),ne.cM,de.X8,ue.y5,ae.ab,T,oe.j]})}return l})()},1951:(Ot,Re,g)=>{g.r(Re),g.d(Re,{GitfireLoginModule:()=>R});var O=g(177),o=g(9417),Y=g(9253),ae=g(8079),ne=g(1152),de=g(5794),ue=g(1188),$=g(5312),e=g(3953),We=g(1413),Ee=g(2751);let Ce=(()=>{class _{router;destroy$=new We.B;constructor(I){this.router=I}ngOnInit(){(0,$.Oi)("LoginComponent.OnInit()")}ngOnDestroy(){this.destroy$.next()}static \u0275fac=function(x){return new(x||_)(e.rXU(ue.Ix))};static \u0275cmp=e.VBU({type:_,selectors:[["gitfire-login"]],decls:12,vars:1,consts:[[1,"h3","mb-3","fw-normal"],[3,"isLogin"],["routerLink","/Gitfire/signup"],["routerLink","/Gitfire/reset"],["routerLink","/"]],template:function(x,m){1&x&&(e.j41(0,"h1",0),e.EFF(1,"\u30ed\u30b0\u30a4\u30f3\u60c5\u5831"),e.k0s(),e.nrm(2,"gitfire-login-input-auth",1),e.j41(3,"div")(4,"a",2),e.EFF(5,"\u30a2\u30ab\u30a6\u30f3\u30c8\u3092\u4f5c\u6210\u3059\u308b"),e.k0s()(),e.j41(6,"div")(7,"a",3),e.EFF(8,"\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u5fd8\u308c\u305f\u5834\u5408"),e.k0s()(),e.j41(9,"div")(10,"a",4),e.EFF(11,"Top"),e.k0s()()),2&x&&(e.R7$(2),e.Y8G("isLogin",!0))},dependencies:[ue.Wk,Ee.InputAuthComponent]})}return _})();var he=g(9182);const Pe=["app-cookie-confirm",""];function je(_,P){if(1&_){const I=e.RV6();e.j41(0,"button",4),e.bIt("click",function(){e.eBV(I);const m=e.XpG();return e.Njj(m.remove())}),e.j41(1,"span",5),e.EFF(2,"\xd7"),e.k0s()()}}let q=(()=>{class _ extends de.y8{toastr;toastPackage;localSession;constructor(I,x,m){super(I,x),this.toastr=I,this.toastPackage=x,this.localSession=m}ngOnInit(){(0,$.Oi)("CookieConfirmComponent.OnInit()")}onClickDeny(I){this.localSession.declineAccess(),this.remove()}onClickGrant(I){this.localSession.grantAccess(),this.remove()}static \u0275fac=function(x){return new(x||_)(e.rXU(de.tw),e.rXU(de.sn),e.rXU(he.Q))};static \u0275cmp=e.VBU({type:_,selectors:[["","app-cookie-confirm",""]],features:[e.Vt3],attrs:Pe,decls:12,vars:4,consts:[["class","toast-close-button","aria-label","Close",3,"click",4,"ngIf"],["role","alertdialog","aria-live","polite"],["href","/terms.htm"],[1,"btn","btn-outline-primary",3,"click"],["aria-label","Close",1,"toast-close-button",3,"click"],["aria-hidden","true"]],template:function(x,m){1&x&&(e.DNE(0,je,3,0,"button",0),e.j41(1,"div",1)(2,"p"),e.EFF(3,"\u5f53\u30b5\u30a4\u30c8\u3067\u306f\u5229\u7528\u8005\u306e\u5229\u4fbf\u6027\u306e\u305f\u3081\u306b\u30af\u30c3\u30ad\u30fc (Cookies) \u3092\u4f7f\u7528\u3057\u307e\u3059\u3002\u8a73\u3057\u304f\u306f"),e.j41(4,"a",2),e.EFF(5," [\u5229\u7528\u898f\u7d04] "),e.k0s(),e.EFF(6,"\u3092\u3054\u89a7\u304f\u3060\u3055\u3044\u3002"),e.k0s(),e.j41(7,"div")(8,"button",3),e.bIt("click",function(le){return m.onClickGrant(le)}),e.EFF(9,"\u8a31\u53ef\u3059\u308b"),e.k0s(),e.j41(10,"button",3),e.bIt("click",function(le){return m.onClickDeny(le)}),e.EFF(11,"\u62d2\u5426\u3059\u308b"),e.k0s()()()),2&x&&(e.Y8G("ngIf",m.options.closeButton),e.R7$(),e.HbH(m.options.messageClass),e.BMQ("aria-label",m.message))},styles:["[_nghost-%COMP%]{background:#eefef0;width:100%;height:100%}a[_ngcontent-%COMP%]:link{color:red}a[_ngcontent-%COMP%]:visited{color:#a00}a[_ngcontent-%COMP%]:hover{color:red}a[_ngcontent-%COMP%]:active{color:#ff8000}"]})}return _})(),ie=(()=>{class _{toastr;localSession;constructor(I,x){this.toastr=I,this.localSession=x}ngOnInit(){(0,$.Oi)("SignupComponent.OnInit()")}ngAfterViewInit(){this.maybeConfirm()}maybeConfirm(){this.localSession.shouldConfirm()&&this.toastr.info(void 0,void 0,{toastComponent:q,disableTimeOut:!0,tapToDismiss:!1,preventDuplicates:!0})}static \u0275fac=function(x){return new(x||_)(e.rXU(de.tw),e.rXU(he.Q))};static \u0275cmp=e.VBU({type:_,selectors:[["gitfire-signup"]],decls:9,vars:1,consts:[[1,"h3","mb-3","fw-normal"],[3,"isSignup"],["routerLink","/Gitfire/login"],["routerLink","/"]],template:function(x,m){1&x&&(e.j41(0,"h1",0),e.EFF(1,"\u30a2\u30ab\u30a6\u30f3\u30c8\u306e\u4f5c\u6210"),e.k0s(),e.nrm(2,"gitfire-login-input-auth",1),e.j41(3,"div")(4,"a",2),e.EFF(5,"\u30ed\u30b0\u30a4\u30f3"),e.k0s()(),e.j41(6,"div")(7,"a",3),e.EFF(8,"Top"),e.k0s()()),2&x&&(e.R7$(2),e.Y8G("isSignup",!0))},dependencies:[ue.Wk,Ee.InputAuthComponent]})}return _})();var se=g(467),Ae=g(2275),z=g(4416);const W=["resetForm"];function xe(_,P){1&_&&(e.j41(0,"div",11),e.EFF(1,"E \u30e1\u30fc\u30eb\u306f\u5fc5\u9808\u3067\u3059\u3002"),e.k0s())}function Fe(_,P){1&_&&(e.j41(0,"div",11),e.EFF(1,"E \u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044\u3002"),e.k0s())}function Ge(_,P){if(1&_&&(e.qex(0),e.DNE(1,xe,2,0,"div",10)(2,Fe,2,0,"div",10),e.bVm()),2&_){e.XpG();const I=e.sdS(6);e.R7$(),e.Y8G("ngIf",null==I.errors?null:I.errors.required),e.R7$(),e.Y8G("ngIf",null==I.errors?null:I.errors.minlength)}}let ce=(()=>{class _{auth;dialog;toastr;emailInput="";resetForm;constructor(I,x,m){this.auth=I,this.dialog=x,this.toastr=m}ngOnInit(){(0,$.Oi)("ResetPasswordComponent.OnInit()")}onClickReset(I){this.dialog.createSimpleBuilder().setType(Ae.hs.Warn).setSize(Ae.EV.Default).setTitle("\u78ba\u8a8d").setMessage(`\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u306f\u6b63\u3057\u3044\u3067\u3059\u304b\uff1f ${this.emailInput}`).okButton(()=>{this.tryResetPassword(this.emailInput)}).cancelButton(()=>{}).open()}tryResetPassword(I){var x=this;return(0,se.A)(function*(){try{yield x.auth.sendPasswordResetEmail(I),x.toastr.info("\u30e1\u30fc\u30eb\u3092\u9001\u4fe1\u3057\u307e\u3057\u305f\u3002")}catch(m){(0,$.sJ)("Error while sent reset mail",m),Error,x.toastr.error("\u5931\u6557\u3057\u307e\u3057\u305f\u3002( ${errmsg} )")}})()}static \u0275fac=function(x){return new(x||_)(e.rXU(ne.DS),e.rXU(z.o3),e.rXU(de.tw))};static \u0275cmp=e.VBU({type:_,selectors:[["gitfire-login-reset-password"]],viewQuery:function(x,m){if(1&x&&e.GBs(W,5),2&x){let V;e.mGM(V=e.lsd())&&(m.resetForm=V.first)}},decls:19,vars:5,consts:[["resetForm",""],["email","ngModel"],[1,"row","p-3"],[1,"visually-hidden"],["autofocus","","type","email","name","email","placeholder","Email address","required","","autofill","","maxlength","1024","minlength","5",1,"form-control","col-8",3,"ngModelChange","ngModel"],[1,"btn","btn-warning",3,"click","disabled"],[4,"ngIf"],["routerLink","/"],["routerLink","/Gitfire/signup"],["routerLink","/Gitfire/login"],["class","invalid-feedback",4,"ngIf"],[1,"invalid-feedback"]],template:function(x,m){if(1&x){const V=e.RV6();e.j41(0,"form",null,0)(2,"div",2)(3,"label",3),e.EFF(4,"Email"),e.k0s(),e.j41(5,"input",4,1),e.mxI("ngModelChange",function(J){return e.eBV(V),e.DH7(m.emailInput,J)||(m.emailInput=J),e.Njj(J)}),e.k0s(),e.j41(7,"button",5),e.bIt("click",function(J){return e.eBV(V),e.Njj(m.onClickReset(J))}),e.EFF(8,"\u30d1\u30b9\u30ef\u30fc\u30c9\u30ea\u30bb\u30c3\u30c8"),e.k0s(),e.DNE(9,Ge,3,2,"ng-container",6),e.k0s()(),e.j41(10,"div")(11,"a",7),e.EFF(12,"Top"),e.k0s()(),e.j41(13,"div")(14,"a",8),e.EFF(15,"\u30a2\u30ab\u30a6\u30f3\u30c8\u3092\u4f5c\u6210\u3059\u308b"),e.k0s()(),e.j41(16,"div")(17,"a",9),e.EFF(18,"\u30ed\u30b0\u30a4\u30f3"),e.k0s()()}if(2&x){const V=e.sdS(6);e.R7$(2),e.AVh("was-validated",V.dirty||V.touched),e.R7$(3),e.R50("ngModel",m.emailInput),e.R7$(2),e.Y8G("disabled",!V.valid),e.R7$(2),e.Y8G("ngIf",V.invalid)}},dependencies:[O.bT,o.qT,o.me,o.BC,o.cb,o.YS,o.xh,o.tU,o.vS,o.cV,ue.Wk]})}return _})();function Ue(_,P){1&_&&e.nrm(0,"gitfire-signup")}function re(_,P){1&_&&e.nrm(0,"gitfire-login")}function Be(_,P){1&_&&e.nrm(0,"gitfire-login-reset-password")}const T=[{path:"",component:(()=>{class _{route;mode;constructor(I){this.route=I,this.mode=I.snapshot.data.mode}ngOnInit(){(0,$.Oi)("LoginRouterComponent.OnInit()")}static \u0275fac=function(x){return new(x||_)(e.rXU(ue.nX))};static \u0275cmp=e.VBU({type:_,selectors:[["ng-component"]],decls:4,vars:4,consts:[[3,"ngSwitch"],[4,"ngSwitchCase"]],template:function(x,m){1&x&&(e.qex(0,0),e.DNE(1,Ue,1,0,"gitfire-signup",1)(2,re,1,0,"gitfire-login",1)(3,Be,1,0,"gitfire-login-reset-password",1),e.bVm()),2&x&&(e.Y8G("ngSwitch",m.mode),e.R7$(),e.Y8G("ngSwitchCase","signup"),e.R7$(),e.Y8G("ngSwitchCase","login"),e.R7$(),e.Y8G("ngSwitchCase","reset"))},dependencies:[O.ux,O.e1,Ce,ie,ce]})}return _})()}];let y=(()=>{class _{static \u0275fac=function(x){return new(x||_)};static \u0275mod=e.$C({type:_});static \u0275inj=e.G2t({imports:[ue.iI.forChild(T),ue.iI]})}return _})();var F=g(7830);let R=(()=>{class _{static \u0275fac=function(x){return new(x||_)};static \u0275mod=e.$C({type:_});static \u0275inj=e.G2t({providers:[de.tw],imports:[O.MD,o.YN,o.X1,y,de._B.forRoot($.cA.toastrConfig),Y.bf.initializeApp($.cA.firebaseConfig),ae.cM,ne.X8,F.o]})}return _})()},2751:(Ot,Re,g)=>{g.r(Re),g.d(Re,{InputAuthComponent:()=>Le});var O=g(467),o=g(3953),Y=g(9417),ae=g(1413),ne=g(4412),de=g(8455),ue=g(6977),$=g(6697),e=g(7935),Ee=(g(7231),g(5312)),Ce=g(1152),he=g(5794),Pe=g(1188),je=g(177),q=g(7830),ie=g(8005);const se=["mainForm"],Ae=["confirmPasswordInput"],z=()=>["(\u5371\u967a)","(\u5f31\u3044)","(\u666e\u901a)","(\u5f37\u3044)","(\u5145\u5206\u306b\u5b89\u5168)"],W=()=>["#DD2C00","#FF6D00","#FFD600","#AEEA00","#00C853"];function xe(B,H){1&B&&(o.j41(0,"div",16),o.EFF(1,"OK!"),o.k0s())}function Fe(B,H){1&B&&(o.j41(0,"div",18),o.EFF(1,"E \u30e1\u30fc\u30eb\u306f\u5fc5\u9808\u3067\u3059\u3002"),o.k0s())}function Ge(B,H){1&B&&(o.j41(0,"div",18),o.EFF(1,"E \u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044\u3002"),o.k0s())}function ce(B,H){if(1&B&&(o.qex(0),o.DNE(1,Fe,2,0,"div",17)(2,Ge,2,0,"div",17),o.bVm()),2&B){const w=o.XpG();o.R7$(),o.Y8G("ngIf",null==w.emailControl.errors?null:w.emailControl.errors.required),o.R7$(),o.Y8G("ngIf",null==w.emailControl.errors?null:w.emailControl.errors.minlength)}}function Ue(B,H){1&B&&(o.j41(0,"div",16),o.EFF(1,"\u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u5f37\u5ea6\u306f\u5145\u5206\u306b\u3057\u3066\u304f\u3060\u3055\u3044\u3002"),o.k0s())}function re(B,H){1&B&&(o.j41(0,"div",18),o.EFF(1,"\u30d1\u30b9\u30ef\u30fc\u30c9\u306f\u5fc5\u9808\u3067\u3059\u3002"),o.k0s())}function Be(B,H){1&B&&(o.j41(0,"div",18),o.EFF(1,"\u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u9577\u3055\u304c\u8db3\u308a\u307e\u305b\u3093\u3002"),o.k0s())}function C(B,H){if(1&B&&(o.qex(0,19),o.DNE(1,re,2,0,"div",17)(2,Be,2,0,"div",17),o.bVm()),2&B){const w=o.XpG();o.R7$(),o.Y8G("ngIf",null==w.passwordControl.errors?null:w.passwordControl.errors.required),o.R7$(),o.Y8G("ngIf",null==w.passwordControl.errors?null:w.passwordControl.errors.minlength)}}function T(B,H){if(1&B&&(o.nrm(0,"ng9-password-strength-bar",20),o.nI1(1,"async")),2&B){const w=o.XpG();o.Y8G("passwordToCheck",o.bMT(1,4,w.passwordControl.valueChanges))("barLabel","\u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u5f37\u5ea6(\u76ee\u5b89): ")("strengthLabels",o.lJ4(6,z))("barColors",o.lJ4(7,W))}}function y(B,H){1&B&&(o.j41(0,"div",16),o.EFF(1,"\u4e00\u81f4\u3057\u307e\u3057\u305f\uff01"),o.k0s())}function F(B,H){1&B&&(o.j41(0,"div",18),o.EFF(1,"\u30d1\u30b9\u30ef\u30fc\u30c9\u306f\u5fc5\u9808\u3067\u3059\u3002"),o.k0s())}function R(B,H){1&B&&(o.j41(0,"div",18),o.EFF(1,"\u30d1\u30b9\u30ef\u30fc\u30c9\u304c\u4e00\u81f4\u3057\u307e\u305b\u3093\u3002"),o.k0s())}function _(B,H){if(1&B&&(o.qex(0),o.DNE(1,F,2,0,"div",17)(2,R,2,0,"div",17),o.bVm()),2&B){const w=o.XpG(2);o.R7$(),o.Y8G("ngIf",null==w.confirmPasswordControl.errors?null:w.confirmPasswordControl.errors.required),o.R7$(),o.Y8G("ngIf",null==w.confirmPasswordControl.errors?null:w.confirmPasswordControl.errors.passwordMisMatch)}}function P(B,H){if(1&B&&(o.j41(0,"div",3)(1,"label",21),o.EFF(2,"Confirm Password"),o.k0s(),o.nrm(3,"input",22,1),o.DNE(5,y,2,0,"div",6)(6,_,3,2,"ng-container",7),o.k0s()),2&B){const w=o.XpG();o.AVh("was-validated",w.confirmPasswordControl.dirty||w.confirmPasswordControl.touched),o.R7$(3),o.Y8G("autocomplete",w.passwordAutocomplete),o.R7$(2),o.Y8G("ngIf",!w.confirmPasswordControl.invalid),o.R7$(),o.Y8G("ngIf",w.confirmPasswordControl.invalid)}}function I(B,H){1&B&&(o.j41(0,"div",29),o.EFF(1,"OK!"),o.k0s())}function x(B,H){1&B&&(o.j41(0,"div",31),o.EFF(1,"\u898f\u7d04\u306b\u540c\u610f\u3057\u3066\u3044\u305f\u3060\u304f\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002"),o.k0s())}function m(B,H){if(1&B&&(o.qex(0),o.DNE(1,x,2,0,"div",30),o.bVm()),2&B){const w=o.XpG(2);o.R7$(),o.Y8G("ngIf",null==w.agreeTosControl.errors?null:w.agreeTosControl.errors.required)}}function V(B,H){if(1&B&&(o.j41(0,"div",23)(1,"label",24),o.EFF(2,"\u898f\u7d04\u306b\u540c\u610f\u3059\u308b"),o.k0s(),o.nrm(3,"input",25),o.j41(4,"a",26),o.EFF(5," [\u5229\u7528\u898f\u7d04] "),o.k0s(),o.j41(6,"span",27),o.EFF(7,"\u306b\u540c\u610f\u3057\u307e\u3059\u3002"),o.k0s(),o.DNE(8,I,2,0,"div",28)(9,m,2,1,"ng-container",7),o.k0s()),2&B){const w=o.XpG();o.AVh("was-validated",w.agreeTosControl.dirty||w.agreeTosControl.touched),o.R7$(8),o.Y8G("ngIf",!w.agreeTosControl.invalid),o.R7$(),o.Y8G("ngIf",w.agreeTosControl.invalid)}}function le(B,H){if(1&B){const w=o.RV6();o.j41(0,"button",32),o.bIt("click",function(U){o.eBV(w);const ee=o.XpG();return o.Njj(ee.onClickSignup(U))}),o.EFF(1,"\u30a2\u30ab\u30a6\u30f3\u30c8\u4f5c\u6210"),o.k0s()}if(2&B){const w=o.XpG();o.Y8G("disabled",!w.inputAuthForm.valid)}}function J(B,H){if(1&B){const w=o.RV6();o.j41(0,"button",32),o.bIt("click",function(U){o.eBV(w);const ee=o.XpG();return o.Njj(ee.onClickLogin(U))}),o.nrm(1,"img",33),o.EFF(2,"\u30ed\u30b0\u30a4\u30f3"),o.k0s()}if(2&B){const w=o.XpG();o.Y8G("disabled",!w.inputAuthForm.valid)}}function ge(B,H){if(1&B){const w=o.RV6();o.j41(0,"button",32),o.bIt("click",function(U){o.eBV(w);const ee=o.XpG();return o.Njj(ee.onClickReauth(U))}),o.nrm(1,"img",33),o.EFF(2,"\u518d\u8a8d\u8a3c"),o.k0s()}if(2&B){const w=o.XpG();o.Y8G("disabled",!w.inputAuthForm.valid)}}function Q(B,H){if(1&B){const w=o.RV6();o.j41(0,"app-oauth-federations",34),o.bIt("loginSucceeded",function(){o.eBV(w);const U=o.XpG();return o.Njj(U.onOauthLoginSucceeded())})("loginFailed",function(U){o.eBV(w);const ee=o.XpG();return o.Njj(ee.onOauthLoginFailed(U))}),o.k0s()}}let Le=(()=>{class B{auth;toastr;router;route;isLogin=!1;isReauth=!1;reauthUser=null;isSignup=!1;showFederations=!0;reauthed=new o.bkB;destroy$=new ae.B;inputAuthForm;loginUser$=new ne.t(null);passwordAutocomplete;mainForm;confirmPasswordInput;constructor(w,j,U,ee){this.auth=w,this.toastr=j,this.router=U,this.route=ee}ngOnInit(){this.passwordAutocomplete=this.isSignup?"new-password":"current-password",this.inputAuthForm=new Y.gE({}),this.inputAuthForm.addControl("email",new Y.MJ("")),this.inputAuthForm.addControl("password",new Y.MJ("")),this.isSignup&&(this.inputAuthForm.addControl("retypePassword",new Y.MJ("")),this.inputAuthForm.addControl("agreeTosCheck",new Y.MJ(!1)),this.inputAuthForm.setValidators([this.validateXFPassword.bind(this)])),this.inputAuthForm.disable(),this.initializeAuthForm()}ngOnDestroy(){this.destroy$.next()}ngAfterViewInit(){this.auth.authState.pipe((0,ue.Q)(this.destroy$)).subscribe(w=>{this.loginUser$.next(w)})}navigateAfterSucceeded(){this.route.queryParams.pipe((0,ue.Q)(this.destroy$),(0,$.s)(1)).subscribe(w=>{const j=w.redirectPath;this.router.navigate(j?[j]:["/"])})}erroredConnected(w){(0,Ee.sJ)("error while connecting account",w);const j=w instanceof Error?w.message:"Unknown error";this.toastr.error(`Login \u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002 \n ( ${j} )`)}loginSucceeded(){this.toastr.success("Login \u3057\u307e\u3057\u305f\u3002"),this.navigateAfterSucceeded()}connectSucceeded(w){this.toastr.success("Sign-up \u3057\u307e\u3057\u305f\u3002"),this.navigateAfterSucceeded()}get emailControl(){return this.inputAuthForm.get("email")}get passwordControl(){return this.inputAuthForm.get("password")}get confirmPasswordControl(){return this.inputAuthForm.get("retypePassword")}get agreeTosControl(){return this.inputAuthForm.get("agreeTosCheck")}validateXFPassword(w){const j=w.get("password"),U=w.get("retypePassword");return j.value!==U.value?(U.setErrors({passwordMisMatch:!0}),this.confirmPasswordInput&&this.confirmPasswordInput.nativeElement.setCustomValidity("create error state"),null):(this.confirmPasswordInput&&this.confirmPasswordInput.nativeElement.setCustomValidity(""),U.setErrors(null),null)}validateAuthForm(){return this.inputAuthForm.markAllAsTouched(),!this.inputAuthForm.invalid||((0,Ee.sJ)("Assert! Button should be disabled."),!1)}initializeAuthForm(){(0,de.H)(this.auth.setPersistence(e.A.auth.Auth.Persistence.SESSION)).pipe((0,$.s)(1),(0,ue.Q)(this.destroy$)).subscribe({next:()=>{this.inputAuthForm.enable()},error:w=>{this.toastr.error("\u8a8d\u8a3c Server \u3092\u521d\u671f\u5316\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002")}})}onClickSignup(w){var j=this;return(0,O.A)(function*(){if(w.preventDefault(),j.validateAuthForm())try{const U=yield j.auth.createUserWithEmailAndPassword(j.emailControl.value,j.passwordControl.value);j.toastr.info("\u30a2\u30ab\u30a6\u30f3\u30c8\u3092\u4f5c\u6210\u3057\u307e\u3057\u305f\u3002\u30e1\u30fc\u30eb\u3092\u78ba\u8a8d\u3057\u3066\u304f\u3060\u3055\u3044\u3002"),yield U.user.sendEmailVerification(),j.navigateAfterSucceeded()}catch(U){(0,Ee.sJ)("Error while reject",U);const ee=U instanceof Error?U.message:"Unknown error";j.toastr.error(`\u30a2\u30ab\u30a6\u30f3\u30c8\u306e\u4f5c\u6210\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002\u6700\u521d\u304b\u3089\u3084\u308a\u76f4\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n ( ${ee} )`)}})()}onClickLogin(w){var j=this;return(0,O.A)(function*(){if(w.preventDefault(),j.validateAuthForm())try{yield j.auth.signInWithEmailAndPassword(j.emailControl.value,j.passwordControl.value),j.loginSucceeded()}catch(U){j.erroredConnected(U)}})()}onClickReauth(w){var j=this;return(0,O.A)(function*(){if(w.preventDefault(),j.validateAuthForm())try{const U=e.A.auth.EmailAuthProvider.credential(j.emailControl.value,j.passwordControl.value);yield j.reauthUser.reauthenticateWithCredential(U),j.reauthed.next()}catch(U){j.erroredConnected(U)}})()}onOauthLoginFailed(w){this.erroredConnected(w)}onOauthLoginSucceeded(){this.loginSucceeded()}static \u0275fac=function(j){return new(j||B)(o.rXU(Ce.DS),o.rXU(he.tw),o.rXU(Pe.Ix),o.rXU(Pe.nX))};static \u0275cmp=o.VBU({type:B,selectors:[["gitfire-login-input-auth"]],viewQuery:function(j,U){if(1&j&&(o.GBs(se,5),o.GBs(Ae,5)),2&j){let ee;o.mGM(ee=o.lsd())&&(U.mainForm=ee.first),o.mGM(ee=o.lsd())&&(U.confirmPasswordInput=ee.first)}},inputs:{isLogin:"isLogin",isReauth:"isReauth",reauthUser:"reauthUser",isSignup:"isSignup",showFederations:"showFederations"},outputs:{reauthed:"reauthed"},decls:22,vars:17,consts:[["mainForm",""],["confirmPasswordInput",""],[3,"formGroup"],[1,"row","m-3"],["for","appGitfireLoginEmailInput",1,"visually-hidden"],["id","appGitfireLoginEmailInput","name","email","formControlName","email","placeholder","email@example.com","autocomplete","email","type","email","required","","autofill","","autofocus","","maxlength","1024","minlength","5",1,"form-control","col-12"],["class","valid-feedback",4,"ngIf"],[4,"ngIf"],["for","appGitfireLoginPasswordInput",1,"visually-hidden"],["id","appGitfireLoginPasswordInput","type","password","name","password","formControlName","password","placeholder","Password","required","","autofill","","maxlength","256","minlength","6",1,"form-control","col-12",3,"autocomplete"],["class"," ",4,"ngIf"],["class","col-12 m-3",3,"passwordToCheck","barLabel","strengthLabels","barColors",4,"ngIf"],["class","row m-3",3,"was-validated",4,"ngIf"],["class","row custom-control custom-checkbox m-5 text-center",3,"was-validated",4,"ngIf"],["class","btn btn-lg btn-primary btn-block",3,"disabled","click",4,"ngIf"],[3,"loginSucceeded","loginFailed",4,"ngIf"],[1,"valid-feedback"],["class","invalid-feedback",4,"ngIf"],[1,"invalid-feedback"],[1,""],[1,"col-12","m-3",3,"passwordToCheck","barLabel","strengthLabels","barColors"],["for","appGitfireSignupPasswordConfirmInput",1,"visually-hidden"],["id","appGitfireSignupPasswordConfirmInput","type","password","name","password_confirm","formControlName","retypePassword","placeholder","Confirm password","required","",1,"form-control","col-12",3,"autocomplete"],[1,"row","custom-control","custom-checkbox","m-5","text-center"],["for","appGitfireAgreeTosCheck",1,"col-auto","visually-hidden"],["id","col-auto appGitfireAgreeTosCheck","formControlName","agreeTosCheck","type","checkbox","required","",1,"form-check-input"],["tabindex","-1","about","_blank","href","/terms.htm",1,"col-auto"],[1,"col-auto"],["class","valid-feedback col-auto",4,"ngIf"],[1,"valid-feedback","col-auto"],["class","invalid-feedback col-auto",4,"ngIf"],[1,"invalid-feedback","col-auto"],[1,"btn","btn-lg","btn-primary","btn-block",3,"click","disabled"],["src","/assets/octicons/sign-in.svg",1,"m-1","gitfire-link-icon","octicon-info"],[3,"loginSucceeded","loginFailed"]],template:function(j,U){1&j&&(o.j41(0,"form",2,0)(2,"div",3)(3,"label",4),o.EFF(4,"Email"),o.k0s(),o.nrm(5,"input",5),o.DNE(6,xe,2,0,"div",6)(7,ce,3,2,"ng-container",7),o.k0s(),o.j41(8,"div",3)(9,"label",8),o.EFF(10,"Password"),o.k0s(),o.nrm(11,"input",9),o.DNE(12,Ue,2,0,"div",6)(13,C,3,2,"ng-container",10)(14,T,2,8,"ng9-password-strength-bar",11),o.k0s(),o.DNE(15,P,7,5,"div",12)(16,V,10,4,"div",13),o.j41(17,"div",3),o.DNE(18,le,2,1,"button",14)(19,J,3,1,"button",14)(20,ge,3,1,"button",14),o.k0s(),o.DNE(21,Q,1,0,"app-oauth-federations",15),o.k0s()),2&j&&(o.Y8G("formGroup",U.inputAuthForm),o.R7$(2),o.AVh("was-validated",U.emailControl.dirty||U.emailControl.touched),o.R7$(4),o.Y8G("ngIf",!U.emailControl.invalid),o.R7$(),o.Y8G("ngIf",U.emailControl.invalid),o.R7$(),o.AVh("was-validated",U.passwordControl.dirty||U.passwordControl.touched),o.R7$(3),o.Y8G("autocomplete",U.passwordAutocomplete),o.R7$(),o.Y8G("ngIf",U.isSignup&&!U.passwordControl.invalid),o.R7$(),o.Y8G("ngIf",U.passwordControl.invalid),o.R7$(),o.Y8G("ngIf",U.isSignup),o.R7$(),o.Y8G("ngIf",U.isSignup),o.R7$(),o.Y8G("ngIf",U.isSignup),o.R7$(2),o.Y8G("ngIf",U.isSignup),o.R7$(),o.Y8G("ngIf",U.isLogin),o.R7$(),o.Y8G("ngIf",U.isReauth),o.R7$(),o.Y8G("ngIf",U.showFederations))},dependencies:[je.bT,Y.qT,Y.me,Y.Zm,Y.BC,Y.cb,Y.YS,Y.xh,Y.tU,Y.xq,Y.j4,Y.JD,q.j,ie.d,je.Jj]})}return B})()},3691:(Ot,Re,g)=>{g.d(Re,{Q:()=>Y});var O=g(177),o=g(3953);let Y=(()=>{class ae{static \u0275fac=function(ue){return new(ue||ae)};static \u0275mod=o.$C({type:ae});static \u0275inj=o.G2t({imports:[O.MD]})}return ae})()},7830:(Ot,Re,g)=>{function ne(C,T,y,F){var P,R=arguments.length,_=R<3?T:null===F?F=Object.getOwnPropertyDescriptor(T,y):F;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)_=Reflect.decorate(C,T,y,F);else for(var I=C.length-1;I>=0;I--)(P=C[I])&&(_=(R<3?P(_):R>3?P(T,y,_):P(T,y))||_);return R>3&&_&&Object.defineProperty(T,y,_),_}g.d(Re,{j:()=>re,o:()=>Be});var Ue,ce=g(3953);let re=Ue=class{constructor(){this.onStrengthChanged=new ce.bkB,this.defaultColors=["#F00","#F90","#FF0","#9F0","#0F0"],this.defaultThresholds=[90,70,40,20],this.defaultBaseColor="#DDD",this.colors=this.defaultColors,this.thresholds=this.defaultThresholds}static measureStrength(T){let y=0;const F={};for(let P=0;P<T.length;P++)F[T[P]]=(F[T[P]]||0)+1,y+=5/F[T[P]];const R={digits:/\d/.test(T),lower:/[a-z]/.test(T),upper:/[A-Z]/.test(T),nonWords:/\W/.test(T)};let _=0;for(let P in R)_+=R[P]?1:0;return y+=10*(_-1),Math.trunc(y)}checkBarColors(){this.colors=this.barColors&&5===this.barColors.length?this.barColors.slice():this.defaultColors,this.strengths=this.strengthLabels&&5===this.strengthLabels.length?this.strengthLabels.slice():null,this.setStrengthLabel(0),/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(this.baseColor)||(this.baseColor=this.defaultBaseColor)}checkThresholds(){this.thresholds=this.customThresholds&&4===this.customThresholds.length?this.customThresholds.slice():this.defaultThresholds}getColor(T){let y=0;return T>this.thresholds[0]?y=4:T>this.thresholds[1]?y=3:T>=this.thresholds[2]?y=2:T>=this.thresholds[3]&&(y=1),{idx:y+1,col:this.colors[y]}}getStrengthIndexAndColor(T){return this.getColor(Ue.measureStrength(T))}ngOnChanges(T){if(!T.passwordToCheck)return;const y=T.passwordToCheck.currentValue;this.checkBarColors(),this.checkThresholds(),this.setBarColors(5,this.baseColor);let F=0;if(y){const R=this.getStrengthIndexAndColor(y);F=R.idx-1,this.setStrengthLabel(F),this.setBarColors(R.idx,R.col)}this.onStrengthChanged.emit(F)}setBarColors(T,y){for(let F=0;F<T;F++)this["bar"+F]=y}setStrengthLabel(T){this.strengths&&(this.strengthLabel=this.strengths[T])}};ne([(0,ce.pde)()],re.prototype,"passwordToCheck",void 0),ne([(0,ce.pde)()],re.prototype,"barLabel",void 0),ne([(0,ce.pde)()],re.prototype,"barColors",void 0),ne([(0,ce.pde)()],re.prototype,"baseColor",void 0),ne([(0,ce.pde)()],re.prototype,"strengthLabels",void 0),ne([(0,ce.pde)()],re.prototype,"customThresholds",void 0),ne([(0,ce.k7i)()],re.prototype,"onStrengthChanged",void 0),re=Ue=ne([(0,ce.uAl)({selector:"ng9-password-strength-bar",template:'\n    <div id="strength" #strength>\n      <small>{{barLabel}}</small>\n      <ul id="strengthBar" class="strengthBar">\n        <li id="bar0" class="point" [style.background-color]="bar0"></li>\n        <li class="point" [style.background-color]="bar1"></li>\n        <li class="point" [style.background-color]="bar2"></li>\n        <li class="point" [style.background-color]="bar3"></li>\n        <li class="point" [style.background-color]="bar4"></li>\n      </ul>\n      <small [hidden]="!strengths" class="pre">  {{strengthLabel}}</small>\n    </div>\n  ',styles:["\n    .strengthBar {\n      display: inline;\n      list-style: none;\n      margin: 0 0 0 15px;\n      padding: 0;\n      vertical-align: 2px;\n    }\n\n    .strengthBar .point {\n      background: #DDD;\n      border-radius: 2px;\n      display: inline-block;\n      height: 5px;\n      margin-right: 1px;\n      width: 20px;\n    }\n\n    .strengthBar .point:last-child {\n      margin: 0;\n    }\n    .pre {\n      white-space: pre;\n    }\n  "]})],re);let Be=(()=>{let C=class{};return C=ne([(0,ce.UQu)({declarations:[re],imports:[],exports:[re]})],C),C})()},3383:(Ot,Re,g)=>{g.d(Re,{ap:()=>_n,y5:()=>ir});var O=g(1825),o=g(1985),Y=g(7673),ae=g(8455),ne=g(152),de=g(6354),ue=g(5558),$=g(3953),e=g(9253),We=g(3345),Ee=g(467),Ce=g(8742),he=g(1076),Pe=g(1362);const je="firebasestorage.googleapis.com",q="storageBucket";class z extends he.g{constructor(t,r,a=0){super(xe(t),`Firebase Storage: ${r} (${xe(t)})`),this.status_=a,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,z.prototype)}get status(){return this.status_}set status(t){this.status_=t}_codeEquals(t){return xe(t)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(t){this.customData.serverResponse=t,this.message=this.customData.serverResponse?`${this._baseMessage}\n${this.customData.serverResponse}`:this._baseMessage}}var W=function(n){return n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment",n}(W||{});function xe(n){return"storage/"+n}function Fe(){return new z(W.UNKNOWN,"An unknown error occurred, please check the error payload for server response.")}function C(){return new z(W.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function T(){return new z(W.CANCELED,"User canceled the upload/download.")}function _(){return new z(W.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function m(n){return new z(W.INVALID_ARGUMENT,n)}function V(){return new z(W.APP_DELETED,"The Firebase app was deleted.")}function le(n){return new z(W.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function J(n,t){return new z(W.INVALID_FORMAT,"String does not match format '"+n+"': "+t)}function ge(n){throw new z(W.INTERNAL_ERROR,"Internal error: "+n)}class Q{constructor(t,r){this.bucket=t,this.path_=r}get path(){return this.path_}get isRoot(){return 0===this.path.length}fullServerUrl(){const t=encodeURIComponent;return"/b/"+t(this.bucket)+"/o/"+t(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(t,r){let a;try{a=Q.makeFromUrl(t,r)}catch{return new Q(t,"")}if(""===a.path)return a;throw function F(n){return new z(W.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}(t)}static makeFromUrl(t,r){let a=null;const h="([A-Za-z0-9.\\-_]+)",L=new RegExp("^gs://"+h+"(/(.*))?$","i");function X(De){De.path_=decodeURIComponent(De.path)}const ve=r.replace(/[.]/g,"\\."),Oe=[{regex:L,indices:{bucket:1,path:3},postModify:function v(De){"/"===De.path.charAt(De.path.length-1)&&(De.path_=De.path_.slice(0,-1))}},{regex:new RegExp(`^https?://${ve}/v[A-Za-z0-9_]+/b/${h}/o(/([^?#]*).*)?$`,"i"),indices:{bucket:1,path:3},postModify:X},{regex:new RegExp(`^https?://${r===je?"(?:storage.googleapis.com|storage.cloud.google.com)":r}/${h}/([^?#]*)`,"i"),indices:{bucket:1,path:2},postModify:X}];for(let De=0;De<Oe.length;De++){const Vt=Oe[De],Kt=Vt.regex.exec(t);if(Kt){let Xt=Kt[Vt.indices.path];Xt||(Xt=""),a=new Q(Kt[Vt.indices.bucket],Xt),Vt.postModify(a);break}}if(null==a)throw function y(n){return new z(W.INVALID_URL,"Invalid URL '"+n+"'.")}(t);return a}}class Le{constructor(t){this.promise_=Promise.reject(t)}getPromise(){return this.promise_}cancel(t=!1){}}function ee(n){return"string"==typeof n||n instanceof String}function Me(n){return et()&&n instanceof Blob}function et(){return typeof Blob<"u"}function Ne(n,t,r,a){if(a<t)throw m(`Invalid value for '${n}'. Expected ${t} or greater.`);if(a>r)throw m(`Invalid value for '${n}'. Expected ${r} or less.`)}function Ie(n,t,r){let a=t;return null==r&&(a=`https://${t}`),`${r}://${a}/v0${n}`}function Ve(n){const t=encodeURIComponent;let r="?";for(const a in n)n.hasOwnProperty(a)&&(r=r+(t(a)+"=")+t(n[a])+"&");return r=r.slice(0,-1),r}var $e=function(n){return n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT",n}($e||{});function Je(n,t){const r=n>=500&&n<600,h=-1!==[408,429].indexOf(n),v=-1!==t.indexOf(n);return r||h||v}class lt{constructor(t,r,a,h,v,A,L,N,X,Z,ve,pe=!0){this.url_=t,this.method_=r,this.headers_=a,this.body_=h,this.successCodes_=v,this.additionalRetryCodes_=A,this.callback_=L,this.errorCallback_=N,this.timeout_=X,this.progressCallback_=Z,this.connectionFactory_=ve,this.retry=pe,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((fe,be)=>{this.resolve_=fe,this.reject_=be,this.start_()})}start_(){const r=(a,h)=>{const v=this.resolve_,A=this.reject_,L=h.connection;if(h.wasSuccessCode)try{const N=this.callback_(L,L.getResponse());!function w(n){return void 0!==n}(N)?v():v(N)}catch(N){A(N)}else if(null!==L){const N=Fe();N.serverResponse=L.getErrorText(),A(this.errorCallback_?this.errorCallback_(L,N):N)}else A(h.canceled?this.appDelete_?V():T():C())};this.canceled_?r(0,new qe(!1,null,!0)):this.backoffId_=function B(n,t,r){let a=1,h=null,v=null,A=!1,L=0;function N(){return 2===L}let X=!1;function Z(...Te){X||(X=!0,t.apply(null,Te))}function ve(Te){h=setTimeout(()=>{h=null,n(fe,N())},Te)}function pe(){v&&clearTimeout(v)}function fe(Te,...At){if(X)return void pe();if(Te)return pe(),void Z.call(null,Te,...At);if(N()||A)return pe(),void Z.call(null,Te,...At);let Oe;a<64&&(a*=2),1===L?(L=2,Oe=0):Oe=1e3*(a+Math.random()),ve(Oe)}let be=!1;function Ze(Te){be||(be=!0,pe(),!X&&(null!==h?(Te||(L=2),clearTimeout(h),ve(0)):Te||(L=1)))}return ve(0),v=setTimeout(()=>{A=!0,Ze(!0)},r),Ze}((a,h)=>{if(h)return void a(!1,new qe(!1,null,!0));const v=this.connectionFactory_();this.pendingConnection_=v;const A=L=>{null!==this.progressCallback_&&this.progressCallback_(L.loaded,L.lengthComputable?L.total:-1)};null!==this.progressCallback_&&v.addUploadProgressListener(A),v.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{null!==this.progressCallback_&&v.removeUploadProgressListener(A),this.pendingConnection_=null;const L=v.getErrorCode()===$e.NO_ERROR,N=v.getStatus();if(!L||Je(N,this.additionalRetryCodes_)&&this.retry){const Z=v.getErrorCode()===$e.ABORT;return void a(!1,new qe(!1,null,Z))}const X=-1!==this.successCodes_.indexOf(N);a(!0,new qe(X,v))})},r,this.timeout_)}getPromise(){return this.promise_}cancel(t){this.canceled_=!0,this.appDelete_=t||!1,null!==this.backoffId_&&function H(n){n(!1)}(this.backoffId_),null!==this.pendingConnection_&&this.pendingConnection_.abort()}}class qe{constructor(t,r,a){this.wasSuccessCode=t,this.connection=r,this.canceled=!!a}}function pt(...n){const t=function It(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}();if(void 0!==t){const r=new t;for(let a=0;a<n.length;a++)r.append(n[a]);return r.getBlob()}if(et())return new Blob(n);throw new z(W.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}const me={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class ot{constructor(t,r){this.data=t,this.contentType=r||null}}function He(n,t){switch(n){case me.RAW:return new ot(it(t));case me.BASE64:case me.BASE64URL:return new ot(st(n,t));case me.DATA_URL:return new ot(function wt(n){const t=new tt(n);return t.base64?st(me.BASE64,t.rest):function gt(n){let t;try{t=decodeURIComponent(n)}catch{throw J(me.DATA_URL,"Malformed data URL.")}return it(t)}(t.rest)}(t),function nt(n){return new tt(n).contentType}(t))}throw Fe()}function it(n){const t=[];for(let r=0;r<n.length;r++){let a=n.charCodeAt(r);a<=127?t.push(a):a<=2047?t.push(192|a>>6,128|63&a):55296==(64512&a)?r<n.length-1&&56320==(64512&n.charCodeAt(r+1))?(a=65536|(1023&a)<<10|1023&n.charCodeAt(++r),t.push(240|a>>18,128|a>>12&63,128|a>>6&63,128|63&a)):t.push(239,191,189):56320==(64512&a)?t.push(239,191,189):t.push(224|a>>12,128|a>>6&63,128|63&a)}return new Uint8Array(t)}function st(n,t){switch(n){case me.BASE64:{const h=-1!==t.indexOf("-"),v=-1!==t.indexOf("_");if(h||v)throw J(n,"Invalid character '"+(h?"-":"_")+"' found: is it base64url encoded?");break}case me.BASE64URL:{const h=-1!==t.indexOf("+"),v=-1!==t.indexOf("/");if(h||v)throw J(n,"Invalid character '"+(h?"+":"/")+"' found: is it base64 encoded?");t=t.replace(/-/g,"+").replace(/_/g,"/");break}}let r;try{r=function ft(n){if(typeof atob>"u")throw function x(n){return new z(W.UNSUPPORTED_ENVIRONMENT,`${n} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}("base-64");return atob(n)}(t)}catch(h){throw h.message.includes("polyfill")?h:J(n,"Invalid character found")}const a=new Uint8Array(r.length);for(let h=0;h<r.length;h++)a[h]=r.charCodeAt(h);return a}class tt{constructor(t){this.base64=!1,this.contentType=null;const r=t.match(/^data:([^,]+)?,/);if(null===r)throw J(me.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const a=r[1]||null;null!=a&&(this.base64=function Rt(n,t){return n.length>=t.length&&n.substring(n.length-t.length)===t}(a,";base64"),this.contentType=this.base64?a.substring(0,a.length-7):a),this.rest=t.substring(t.indexOf(",")+1)}}class we{constructor(t,r){let a=0,h="";Me(t)?(this.data_=t,a=t.size,h=t.type):t instanceof ArrayBuffer?(r?this.data_=new Uint8Array(t):(this.data_=new Uint8Array(t.byteLength),this.data_.set(new Uint8Array(t))),a=this.data_.length):t instanceof Uint8Array&&(r?this.data_=t:(this.data_=new Uint8Array(t.length),this.data_.set(t)),a=t.length),this.size_=a,this.type_=h}size(){return this.size_}type(){return this.type_}slice(t,r){if(Me(this.data_)){const h=function Ut(n,t,r){return n.webkitSlice?n.webkitSlice(t,r):n.mozSlice?n.mozSlice(t,r):n.slice?n.slice(t,r):null}(this.data_,t,r);return null===h?null:new we(h)}{const a=new Uint8Array(this.data_.buffer,t,r-t);return new we(a,!0)}}static getBlob(...t){if(et()){const r=t.map(a=>a instanceof we?a.data_:a);return new we(pt.apply(null,r))}{const r=t.map(A=>ee(A)?He(me.RAW,A).data:A.data_);let a=0;r.forEach(A=>{a+=A.byteLength});const h=new Uint8Array(a);let v=0;return r.forEach(A=>{for(let L=0;L<A.length;L++)h[v++]=A[L]}),new we(h,!0)}}uploadData(){return this.data_}}function mt(n){let t;try{t=JSON.parse(n)}catch{return null}return function U(n){return"object"==typeof n&&!Array.isArray(n)}(t)?t:null}function vt(n){const t=n.lastIndexOf("/",n.length-2);return-1===t?n:n.slice(t+1)}function at(n,t){return t}class _e{constructor(t,r,a,h){this.server=t,this.local=r||t,this.writable=!!a,this.xform=h||at}}let Qe=null;function Ke(){if(Qe)return Qe;const n=[];n.push(new _e("bucket")),n.push(new _e("generation")),n.push(new _e("metageneration")),n.push(new _e("name","fullPath",!0));const r=new _e("name");r.xform=function t(v,A){return function Mt(n){return!ee(n)||n.length<2?n:vt(n)}(A)},n.push(r);const h=new _e("size");return h.xform=function a(v,A){return void 0!==A?Number(A):A},n.push(h),n.push(new _e("timeCreated")),n.push(new _e("updated")),n.push(new _e("md5Hash",null,!0)),n.push(new _e("cacheControl",null,!0)),n.push(new _e("contentDisposition",null,!0)),n.push(new _e("contentEncoding",null,!0)),n.push(new _e("contentLanguage",null,!0)),n.push(new _e("contentType",null,!0)),n.push(new _e("metadata","customMetadata",!0)),Qe=n,Qe}function ut(n,t,r){const a=mt(t);return null===a?null:function Ct(n,t,r){const a={type:"file"},h=r.length;for(let v=0;v<h;v++){const A=r[v];a[A.local]=A.xform(a,t[A.server])}return function bt(n,t){Object.defineProperty(n,"ref",{get:function r(){const v=new Q(n.bucket,n.fullPath);return t._makeStorageReference(v)}})}(a,n),a}(n,a,r)}function ct(n,t){const r={},a=t.length;for(let h=0;h<a;h++){const v=t[h];v.writable&&(r[v.server]=n[v.local])}return JSON.stringify(r)}const Nt="prefixes",yt="items";class c{constructor(t,r,a,h){this.url=t,this.method=r,this.handler=a,this.timeout=h,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}function p(n){if(!n)throw Fe()}function D(n,t){return function r(a,h){const v=ut(n,h,t);return p(null!==v),v}}function u(n){return function t(r,a){let h;return h=401===r.getStatus()?r.getErrorText().includes("Firebase App Check token is invalid")?function re(){return new z(W.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}():function Ue(){return new z(W.UNAUTHENTICATED,"User is not authenticated, please authenticate using Firebase Authentication and try again.")}():402===r.getStatus()?function ce(n){return new z(W.QUOTA_EXCEEDED,"Quota for bucket '"+n+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}(n.bucket):403===r.getStatus()?function Be(n){return new z(W.UNAUTHORIZED,"User does not have permission to access '"+n+"'.")}(n.path):a,h.status=r.getStatus(),h.serverResponse=a.serverResponse,h}}function f(n){const t=u(n);return function r(a,h){let v=t(a,h);return 404===a.getStatus()&&(v=function Ge(n){return new z(W.OBJECT_NOT_FOUND,"Object '"+n+"' does not exist.")}(n.path)),v.serverResponse=h.serverResponse,v}}function E(n,t,r){const h=Ie(t.fullServerUrl(),n.host,n._protocol),A=n.maxOperationRetryTime,L=new c(h,"GET",D(n,r),A);return L.errorHandler=f(t),L}function G(n,t,r,a,h){const v={};v.prefix=t.isRoot?"":t.path+"/",r&&r.length>0&&(v.delimiter=r),a&&(v.pageToken=a),h&&(v.maxResults=h);const L=Ie(t.bucketOnlyServerUrl(),n.host,n._protocol),X=n.maxOperationRetryTime,Z=new c(L,"GET",function M(n,t){return function r(a,h){const v=function Tt(n,t,r){const a=mt(r);return null===a?null:function $t(n,t,r){const a={prefixes:[],items:[],nextPageToken:r.nextPageToken};if(r[Nt])for(const h of r[Nt]){const v=h.replace(/\/$/,""),A=n._makeStorageReference(new Q(t,v));a.prefixes.push(A)}if(r[yt])for(const h of r[yt]){const v=n._makeStorageReference(new Q(t,h.name));a.items.push(v)}return a}(n,t,a)}(n,t,h);return p(null!==v),v}}(n,t.bucket),X);return Z.urlParams=v,Z.errorHandler=u(t),Z}function s(n,t,r){const a=Object.assign({},r);return a.fullPath=n.path,a.size=t.size(),a.contentType||(a.contentType=function i(n,t){return n&&n.contentType||t&&t.type()||"application/octet-stream"}(null,t)),a}class b{constructor(t,r,a,h){this.current=t,this.total=r,this.finalized=!!a,this.metadata=h||null}}function k(n,t){let r=null;try{r=n.getResponseHeader("X-Goog-Upload-Status")}catch{p(!1)}return p(!!r&&-1!==(t||["active"]).indexOf(r)),r}const jt={STATE_CHANGED:"state_changed"},ke={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function Se(n){switch(n){case"running":case"pausing":case"canceling":return ke.RUNNING;case"paused":return ke.PAUSED;case"success":return ke.SUCCESS;case"canceled":return ke.CANCELED;default:return ke.ERROR}}class St{constructor(t,r,a){if(function j(n){return"function"==typeof n}(t)||null!=r||null!=a)this.next=t,this.error=r??void 0,this.complete=a??void 0;else{const v=t;this.next=v.next,this.error=v.error,this.complete=v.complete}}}function Dt(n){return(...t)=>{Promise.resolve().then(()=>n(...t))}}let Qt=null;class vn{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=$e.NO_ERROR,this.sendPromise_=new Promise(t=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=$e.ABORT,t()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=$e.NETWORK_ERROR,t()}),this.xhr_.addEventListener("load",()=>{t()})})}send(t,r,a,h){if(this.sent_)throw ge("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(r,t,!0),void 0!==h)for(const v in h)h.hasOwnProperty(v)&&this.xhr_.setRequestHeader(v,h[v].toString());return void 0!==a?this.xhr_.send(a):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw ge("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw ge("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw ge("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw ge("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(t){return this.xhr_.getResponseHeader(t)}addUploadProgressListener(t){null!=this.xhr_.upload&&this.xhr_.upload.addEventListener("progress",t)}removeUploadProgressListener(t){null!=this.xhr_.upload&&this.xhr_.upload.removeEventListener("progress",t)}}class bn extends vn{initXhr(){this.xhr_.responseType="text"}}function rt(){return Qt?Qt():new bn}class Zt{constructor(t,r,a=null){this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=t,this._blob=r,this._metadata=a,this._mappings=Ke(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=h=>{if(this._request=void 0,this._chunkMultiplier=1,h._codeEquals(W.CANCELED))this._needToFetchStatus=!0,this.completeTransitions_();else{const v=this.isExponentialBackoffExpired();if(Je(h.status,[])){if(!v)return this.sleepTime=Math.max(2*this.sleepTime,1e3),this._needToFetchStatus=!0,void this.completeTransitions_();h=C()}this._error=h,this._transition("error")}},this._metadataErrorHandler=h=>{this._request=void 0,h._codeEquals(W.CANCELED)?this.completeTransitions_():(this._error=h,this._transition("error"))},this.sleepTime=0,this.maxSleepTime=this._ref.storage.maxUploadRetryTime,this._promise=new Promise((h,v)=>{this._resolve=h,this._reject=v,this._start()}),this._promise.then(null,()=>{})}isExponentialBackoffExpired(){return this.sleepTime>this.maxSleepTime}_makeProgressCallback(){const t=this._transferred;return r=>this._updateProgress(t+r)}_shouldDoResumable(t){return t.size()>262144}_start(){"running"===this._state&&void 0===this._request&&(this._resumable?void 0===this._uploadUrl?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this.pendingTimeout=setTimeout(()=>{this.pendingTimeout=void 0,this._continueUpload()},this.sleepTime):this._oneShotUpload())}_resolveToken(t){Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then(([r,a])=>{switch(this._state){case"running":t(r,a);break;case"canceling":this._transition("canceled");break;case"pausing":this._transition("paused")}})}_createResumable(){this._resolveToken((t,r)=>{const a=function ye(n,t,r,a,h){const v=t.bucketOnlyServerUrl(),A=s(t,a,h),L={name:A.fullPath},N=Ie(v,n.host,n._protocol),Z={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${a.size()}`,"X-Goog-Upload-Header-Content-Type":A.contentType,"Content-Type":"application/json; charset=utf-8"},ve=ct(A,r),be=new c(N,"POST",function fe(Ze){let Te;k(Ze);try{Te=Ze.getResponseHeader("X-Goog-Upload-URL")}catch{p(!1)}return p(ee(Te)),Te},n.maxUploadRetryTime);return be.urlParams=L,be.headers=Z,be.body=ve,be.errorHandler=u(t),be}(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),h=this._ref.storage._makeRequest(a,rt,t,r);this._request=h,h.getPromise().then(v=>{this._request=void 0,this._uploadUrl=v,this._needToFetchStatus=!1,this.completeTransitions_()},this._errorHandler)})}_fetchStatus(){const t=this._uploadUrl;this._resolveToken((r,a)=>{const h=function ze(n,t,r,a){const N=new c(r,"POST",function v(X){const Z=k(X,["active","final"]);let ve=null;try{ve=X.getResponseHeader("X-Goog-Upload-Size-Received")}catch{p(!1)}ve||p(!1);const pe=Number(ve);return p(!isNaN(pe)),new b(pe,a.size(),"final"===Z)},n.maxUploadRetryTime);return N.headers={"X-Goog-Upload-Command":"query"},N.errorHandler=u(t),N}(this._ref.storage,this._ref._location,t,this._blob),v=this._ref.storage._makeRequest(h,rt,r,a);this._request=v,v.getPromise().then(A=>{this._request=void 0,this._updateProgress(A.current),this._needToFetchStatus=!1,A.finalized&&(this._needToFetchMetadata=!0),this.completeTransitions_()},this._errorHandler)})}_continueUpload(){const t=262144*this._chunkMultiplier,r=new b(this._transferred,this._blob.size()),a=this._uploadUrl;this._resolveToken((h,v)=>{let A;try{A=function Ye(n,t,r,a,h,v,A,L){const N=new b(0,0);if(A?(N.current=A.current,N.total=A.total):(N.current=0,N.total=a.size()),a.size()!==N.total)throw function P(){return new z(W.SERVER_FILE_WRONG_SIZE,"Server recorded incorrect upload file size, please retry the upload.")}();const X=N.total-N.current;let Z=X;h>0&&(Z=Math.min(Z,h));const ve=N.current;let fe="";fe=0===Z?"finalize":X===Z?"upload, finalize":"upload";const be={"X-Goog-Upload-Command":fe,"X-Goog-Upload-Offset":`${N.current}`},Ze=a.slice(ve,ve+Z);if(null===Ze)throw _();const Oe=new c(r,"POST",function Te(De,Vt){const Kt=k(De,["active","final"]),Jt=N.current+Z,Xt=a.size();let qt;return qt="final"===Kt?D(t,v)(De,Vt):null,new b(Jt,Xt,"final"===Kt,qt)},t.maxUploadRetryTime);return Oe.headers=be,Oe.body=Ze.uploadData(),Oe.progressCallback=L||null,Oe.errorHandler=u(n),Oe}(this._ref._location,this._ref.storage,a,this._blob,t,this._mappings,r,this._makeProgressCallback())}catch(N){return this._error=N,void this._transition("error")}const L=this._ref.storage._makeRequest(A,rt,h,v,!1);this._request=L,L.getPromise().then(N=>{this._increaseMultiplier(),this._request=void 0,this._updateProgress(N.current),N.finalized?(this._metadata=N.metadata,this._transition("success")):this.completeTransitions_()},this._errorHandler)})}_increaseMultiplier(){262144*this._chunkMultiplier*2<33554432&&(this._chunkMultiplier*=2)}_fetchMetadata(){this._resolveToken((t,r)=>{const a=E(this._ref.storage,this._ref._location,this._mappings),h=this._ref.storage._makeRequest(a,rt,t,r);this._request=h,h.getPromise().then(v=>{this._request=void 0,this._metadata=v,this._transition("success")},this._metadataErrorHandler)})}_oneShotUpload(){this._resolveToken((t,r)=>{const a=function d(n,t,r,a,h){const v=t.bucketOnlyServerUrl(),A={"X-Goog-Upload-Protocol":"multipart"},N=function L(){let Oe="";for(let De=0;De<2;De++)Oe+=Math.random().toString().slice(2);return Oe}();A["Content-Type"]="multipart/related; boundary="+N;const X=s(t,a,h),Z=ct(X,r),fe=we.getBlob("--"+N+"\r\nContent-Type: application/json; charset=utf-8\r\n\r\n"+Z+"\r\n--"+N+"\r\nContent-Type: "+X.contentType+"\r\n\r\n",a,"\r\n--"+N+"--");if(null===fe)throw _();const be={name:X.fullPath},Ze=Ie(v,n.host,n._protocol),At=n.maxUploadRetryTime,kt=new c(Ze,"POST",D(n,r),At);return kt.urlParams=be,kt.headers=A,kt.body=fe.uploadData(),kt.errorHandler=u(t),kt}(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),h=this._ref.storage._makeRequest(a,rt,t,r);this._request=h,h.getPromise().then(v=>{this._request=void 0,this._metadata=v,this._updateProgress(this._blob.size()),this._transition("success")},this._errorHandler)})}_updateProgress(t){const r=this._transferred;this._transferred=t,this._transferred!==r&&this._notifyObservers()}_transition(t){if(this._state!==t)switch(t){case"canceling":case"pausing":this._state=t,void 0!==this._request?this._request.cancel():this.pendingTimeout&&(clearTimeout(this.pendingTimeout),this.pendingTimeout=void 0,this.completeTransitions_());break;case"running":const r="paused"===this._state;this._state=t,r&&(this._notifyObservers(),this._start());break;case"paused":case"error":case"success":this._state=t,this._notifyObservers();break;case"canceled":this._error=T(),this._state=t,this._notifyObservers()}}completeTransitions_(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start()}}get snapshot(){const t=Se(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:t,metadata:this._metadata,task:this,ref:this._ref}}on(t,r,a,h){const v=new St(r||void 0,a||void 0,h||void 0);return this._addObserver(v),()=>{this._removeObserver(v)}}then(t,r){return this._promise.then(t,r)}catch(t){return this.then(null,t)}_addObserver(t){this._observers.push(t),this._notifyObserver(t)}_removeObserver(t){const r=this._observers.indexOf(t);-1!==r&&this._observers.splice(r,1)}_notifyObservers(){this._finishPromise(),this._observers.slice().forEach(r=>{this._notifyObserver(r)})}_finishPromise(){if(void 0!==this._resolve){let t=!0;switch(Se(this._state)){case ke.SUCCESS:Dt(this._resolve.bind(null,this.snapshot))();break;case ke.CANCELED:case ke.ERROR:Dt(this._reject.bind(null,this._error))();break;default:t=!1}t&&(this._resolve=void 0,this._reject=void 0)}}_notifyObserver(t){switch(Se(this._state)){case ke.RUNNING:case ke.PAUSED:t.next&&Dt(t.next.bind(t,this.snapshot))();break;case ke.SUCCESS:t.complete&&Dt(t.complete.bind(t))();break;default:t.error&&Dt(t.error.bind(t,this._error))()}}resume(){const t="paused"===this._state||"pausing"===this._state;return t&&this._transition("running"),t}pause(){const t="running"===this._state;return t&&this._transition("pausing"),t}cancel(){const t="running"===this._state||"pausing"===this._state;return t&&this._transition("canceling"),t}}class Gt{constructor(t,r){this._service=t,this._location=r instanceof Q?r:Q.makeFromUrl(r,t.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(t,r){return new Gt(t,r)}get root(){const t=new Q(this._location.bucket,"");return this._newRef(this._service,t)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return vt(this._location.path)}get storage(){return this._service}get parent(){const t=function Bt(n){if(0===n.length)return null;const t=n.lastIndexOf("/");return-1===t?"":n.slice(0,t)}(this._location.path);if(null===t)return null;const r=new Q(this._location.bucket,t);return new Gt(this._service,r)}_throwIfRoot(t){if(""===this._location.path)throw le(t)}}function tn(n,t,r){return Ht.apply(this,arguments)}function Ht(){return(Ht=(0,Ee.A)(function*(n,t,r){const h=yield nn(n,{pageToken:r});t.prefixes.push(...h.prefixes),t.items.push(...h.items),null!=h.nextPageToken&&(yield tn(n,t,h.nextPageToken))})).apply(this,arguments)}function nn(n,t){null!=t&&"number"==typeof t.maxResults&&Ne("options.maxResults",1,1e3,t.maxResults);const r=t||{},a=G(n.storage,n._location,"/",r.pageToken,r.maxResults);return n.storage.makeRequestWithTokens(a,rt)}function Dn(n){n._throwIfRoot("getDownloadURL");const t=function te(n,t,r){const h=Ie(t.fullServerUrl(),n.host,n._protocol),A=n.maxOperationRetryTime,L=new c(h,"GET",function K(n,t){return function r(a,h){const v=ut(n,h,t);return p(null!==v),function Lt(n,t,r,a){const h=mt(t);if(null===h||!ee(h.downloadTokens))return null;const v=h.downloadTokens;if(0===v.length)return null;const A=encodeURIComponent;return v.split(",").map(X=>{const ve=n.fullPath;return Ie("/b/"+A(n.bucket)+"/o/"+A(ve),r,a)+Ve({alt:"media",token:X})})[0]}(v,h,n.host,n._protocol)}}(n,r),A);return L.errorHandler=f(t),L}(n.storage,n._location,Ke());return n.storage.makeRequestWithTokens(t,rt).then(r=>{if(null===r)throw function I(){return new z(W.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}();return r})}function rn(n,t){const r=function _t(n,t){const r=t.split("/").filter(a=>a.length>0).join("/");return 0===n.length?r:n+"/"+r}(n._location.path,t),a=new Q(n._location.bucket,r);return new Gt(n.storage,a)}function on(n,t){if(n instanceof zt){const r=n;if(null==r._bucket)throw function R(){return new z(W.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+q+"' property when initializing the app?")}();const a=new Gt(r,r._bucket);return null!=t?on(a,t):a}return void 0!==t?rn(n,t):n}function Un(n,t){if(t&&function Pn(n){return/^[A-Za-z]+:\/\//.test(n)}(t)){if(n instanceof zt)return function xn(n,t){return new Gt(n,t)}(n,t);throw m("To use ref(service, url), the first argument must be a Storage instance.")}return on(n,t)}function sn(n,t){const r=t?.[q];return null==r?null:Q.makeFromBucketSpec(r,n)}class zt{constructor(t,r,a,h,v){this.app=t,this._authProvider=r,this._appCheckProvider=a,this._url=h,this._firebaseVersion=v,this._bucket=null,this._host=je,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=12e4,this._maxUploadRetryTime=6e5,this._requests=new Set,this._bucket=null!=h?Q.makeFromBucketSpec(h,this._host):sn(this._host,this.app.options)}get host(){return this._host}set host(t){this._host=t,this._bucket=null!=this._url?Q.makeFromBucketSpec(this._url,t):sn(t,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(t){Ne("time",0,Number.POSITIVE_INFINITY,t),this._maxUploadRetryTime=t}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(t){Ne("time",0,Number.POSITIVE_INFINITY,t),this._maxOperationRetryTime=t}_getAuthToken(){var t=this;return(0,Ee.A)(function*(){if(t._overrideAuthToken)return t._overrideAuthToken;const r=t._authProvider.getImmediate({optional:!0});if(r){const a=yield r.getToken();if(null!==a)return a.accessToken}return null})()}_getAppCheckToken(){var t=this;return(0,Ee.A)(function*(){const r=t._appCheckProvider.getImmediate({optional:!0});return r?(yield r.getToken()).token:null})()}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(t=>t.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(t){return new Gt(this,t)}_makeRequest(t,r,a,h,v=!0){if(this._deleted)return new Le(V());{const A=function ht(n,t,r,a,h,v,A=!0){const L=Ve(n.urlParams),N=n.url+L,X=Object.assign({},n.headers);return function dt(n,t){t&&(n["X-Firebase-GMPID"]=t)}(X,t),function Pt(n,t){null!==t&&t.length>0&&(n.Authorization="Firebase "+t)}(X,r),function Ft(n,t){n["X-Firebase-Storage-Version"]="webjs/"+(t??"AppManager")}(X,v),function xt(n,t){null!==t&&(n["X-Firebase-AppCheck"]=t)}(X,a),new lt(N,n.method,X,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,h,A)}(t,this._appId,a,h,r,this._firebaseVersion,v);return this._requests.add(A),A.getPromise().then(()=>this._requests.delete(A),()=>this._requests.delete(A)),A}}makeRequestWithTokens(t,r){var a=this;return(0,Ee.A)(function*(){const[h,v]=yield Promise.all([a._getAuthToken(),a._getAppCheckToken()]);return a._makeRequest(t,r,h,v).getPromise()})()}}const an="@firebase/storage";function ln(n,t){return Un(n=(0,he.Ku)(n),t)}function Xn(n,{instanceIdentifier:t}){const r=n.getProvider("app").getImmediate(),a=n.getProvider("auth-internal"),h=n.getProvider("app-check-internal");return new zt(r,a,h,t,Ce.SDK_VERSION)}!function Yn(){(0,Ce._registerComponent)(new Pe.uA("storage",Xn,"PUBLIC").setMultipleInstances(!0)),(0,Ce.registerVersion)(an,"0.12.6",""),(0,Ce.registerVersion)(an,"0.12.6","esm2017")}();class Yt{constructor(t,r,a){this._delegate=t,this.task=r,this.ref=a}get bytesTransferred(){return this._delegate.bytesTransferred}get metadata(){return this._delegate.metadata}get state(){return this._delegate.state}get totalBytes(){return this._delegate.totalBytes}}class hn{constructor(t,r){this._delegate=t,this._ref=r,this.cancel=this._delegate.cancel.bind(this._delegate),this.catch=this._delegate.catch.bind(this._delegate),this.pause=this._delegate.pause.bind(this._delegate),this.resume=this._delegate.resume.bind(this._delegate)}get snapshot(){return new Yt(this._delegate.snapshot,this,this._ref)}then(t,r){return this._delegate.then(a=>{if(t)return t(new Yt(a,this,this._ref))},r)}on(t,r,a,h){let v;return r&&(v="function"==typeof r?A=>r(new Yt(A,this,this._ref)):{next:r.next?A=>r.next(new Yt(A,this,this._ref)):void 0,complete:r.complete||void 0,error:r.error||void 0}),this._delegate.on(t,v,a||void 0,h||void 0)}}class pn{constructor(t,r){this._delegate=t,this._service=r}get prefixes(){return this._delegate.prefixes.map(t=>new Et(t,this._service))}get items(){return this._delegate.items.map(t=>new Et(t,this._service))}get nextPageToken(){return this._delegate.nextPageToken||null}}class Et{constructor(t,r){this._delegate=t,this.storage=r}get name(){return this._delegate.name}get bucket(){return this._delegate.bucket}get fullPath(){return this._delegate.fullPath}toString(){return this._delegate.toString()}child(t){const r=function Kn(n,t){return rn(n,t)}(this._delegate,t);return new Et(r,this.storage)}get root(){return new Et(this._delegate.root,this.storage)}get parent(){const t=this._delegate.parent;return null==t?null:new Et(t,this.storage)}put(t,r){return this._throwIfRoot("put"),new hn(function Mn(n,t,r){return function Fn(n,t,r){return n._throwIfRoot("uploadBytesResumable"),new Zt(n,new we(t),r)}(n=(0,he.Ku)(n),t,r)}(this._delegate,t,r),this)}putString(t,r=me.RAW,a){this._throwIfRoot("putString");const h=He(r,t),v=Object.assign({},a);return null==v.contentType&&null!=h.contentType&&(v.contentType=h.contentType),new hn(new Zt(this._delegate,new we(h.data,!0),v),this)}listAll(){return function Gn(n){return function wn(n){const t={prefixes:[],items:[]};return tn(n,t).then(()=>t)}(n=(0,he.Ku)(n))}(this._delegate).then(t=>new pn(t,this.storage))}list(t){return function jn(n,t){return nn(n=(0,he.Ku)(n),t)}(this._delegate,t||void 0).then(r=>new pn(r,this.storage))}getMetadata(){return function Nn(n){return function Rn(n){n._throwIfRoot("getMetadata");const t=E(n.storage,n._location,Ke());return n.storage.makeRequestWithTokens(t,rt)}(n=(0,he.Ku)(n))}(this._delegate)}updateMetadata(t){return function $n(n,t){return function Sn(n,t){n._throwIfRoot("updateMetadata");const r=function l(n,t,r,a){const v=Ie(t.fullServerUrl(),n.host,n._protocol),L=ct(r,a),X=n.maxOperationRetryTime,Z=new c(v,"PATCH",D(n,a),X);return Z.headers={"Content-Type":"application/json; charset=utf-8"},Z.body=L,Z.errorHandler=f(t),Z}(n.storage,n._location,t,Ke());return n.storage.makeRequestWithTokens(r,rt)}(n=(0,he.Ku)(n),t)}(this._delegate,t)}getDownloadURL(){return function Ln(n){return Dn(n=(0,he.Ku)(n))}(this._delegate)}delete(){return this._throwIfRoot("delete"),function Vn(n){return function On(n){n._throwIfRoot("deleteObject");const t=function S(n,t){const a=Ie(t.fullServerUrl(),n.host,n._protocol),L=new c(a,"DELETE",function A(N,X){},n.maxOperationRetryTime);return L.successCodes=[200,204],L.errorHandler=f(t),L}(n.storage,n._location);return n.storage.makeRequestWithTokens(t,rt)}(n=(0,he.Ku)(n))}(this._delegate)}_throwIfRoot(t){if(""===this._delegate._location.path)throw le(t)}}class fn{constructor(t,r){this.app=t,this._delegate=r}get maxOperationRetryTime(){return this._delegate.maxOperationRetryTime}get maxUploadRetryTime(){return this._delegate.maxUploadRetryTime}ref(t){if(gn(t))throw m("ref() expected a child path but got a URL, use refFromURL instead.");return new Et(ln(this._delegate,t),this)}refFromURL(t){if(!gn(t))throw m("refFromURL() expected a full URL but got a child path, use ref() instead.");try{Q.makeFromUrl(t,this._delegate.host)}catch{throw m("refFromUrl() expected a valid full URL but got an invalid one.")}return new Et(ln(this._delegate,t),this)}setMaxUploadRetryTime(t){this._delegate.maxUploadRetryTime=t}setMaxOperationRetryTime(t){this._delegate.maxOperationRetryTime=t}useEmulator(t,r,a={}){!function dn(n,t,r,a={}){!function Bn(n,t,r,a={}){n.host=`${t}:${r}`,n._protocol="http";const{mockUserToken:h}=a;h&&(n._overrideAuthToken="string"==typeof h?h:(0,he.Fy)(h,n.app.options.projectId))}(n,t,r,a)}(this._delegate,t,r,a)}}function gn(n){return/^[A-Za-z]+:\/\//.test(n)}function Jn(n,{instanceIdentifier:t}){const r=n.getProvider("app-compat").getImmediate(),a=n.getProvider("storage").getImmediate({identifier:t});return new fn(r,a)}!function qn(n){const t={TaskState:ke,TaskEvent:jt,StringFormat:me,Storage:fn,Reference:Et};n.INTERNAL.registerComponent(new Pe.uA("storage-compat",Jn,"PUBLIC").setServiceProps(t).setMultipleInstances(!0)),n.registerVersion("@firebase/storage-compat","0.3.9")}(We.A);var Qn=g(7935);function mn(n){const t=function Zn(n){return new o.c(t=>{const r=A=>t.next(A);r(n.snapshot);const v=n.on("state_changed",r);return n.then(A=>{r(A),t.complete()},A=>{r(n.snapshot),(A=>{t.error(A)})(A)}),function(){v()}}).pipe((0,ne.B)(0))}(n);return{task:n,then:n.then.bind(n),catch:n.catch.bind(n),pause:n.pause.bind(n),cancel:n.cancel.bind(n),resume:n.resume.bind(n),snapshotChanges:()=>t,percentageChanges:()=>t.pipe((0,de.T)(r=>r.bytesTransferred/r.totalBytes*100))}}function Wt(n){return{getDownloadURL:()=>(0,Y.of)(void 0).pipe(O.Oe,(0,ue.n)(()=>n.getDownloadURL()),O.U0),getMetadata:()=>(0,Y.of)(void 0).pipe(O.Oe,(0,ue.n)(()=>n.getMetadata()),O.U0),delete:()=>(0,ae.H)(n.delete()),child:t=>Wt(n.child(t)),updateMetadata:t=>(0,ae.H)(n.updateMetadata(t)),put:(t,r)=>mn(n.put(t,r)),putString:(t,r,a)=>mn(n.putString(t,r,a)),list:t=>(0,ae.H)(n.list(t)),listAll:()=>(0,ae.H)(n.listAll())}}const er=new $.nKC("angularfire2.storageBucket"),tr=new $.nKC("angularfire2.storage.maxUploadRetryTime"),nr=new $.nKC("angularfire2.storage.maxOperationRetryTime"),rr=new $.nKC("angularfire2.storage.use-emulator");let _n=(()=>{class n{storage;constructor(r,a,h,v,A,L,N,X,Z,ve){const pe=(0,e.iB)(r,A,a);this.storage=(0,e.BM)(`${pe.name}.storage.${h}`,"AngularFireStorage",pe.name,()=>{const fe=A.runOutsideAngular(()=>pe.storage(h||void 0)),be=Z;return be&&fe.useEmulator(...be),N&&fe.setMaxUploadRetryTime(N),X&&fe.setMaxOperationRetryTime(X),fe},[N,X])}ref(r){return Wt(this.storage.ref(r))}refFromURL(r){return Wt(this.storage.refFromURL(r))}upload(r,a,h){return Wt(this.storage.ref(r)).put(a,h)}static \u0275fac=function(a){return new(a||n)($.KVO(e.rx),$.KVO(e.uP,8),$.KVO(er,8),$.KVO($.Agw),$.KVO($.SKi),$.KVO(O.u0),$.KVO(tr,8),$.KVO(nr,8),$.KVO(rr,8),$.KVO(O.Jv,8))};static \u0275prov=$.jDH({token:n,factory:n.\u0275fac,providedIn:"any"})}return n})(),or=(()=>{class n{static \u0275fac=function(a){return new(a||n)};static \u0275mod=$.$C({type:n});static \u0275inj=$.G2t({})}return n})(),ir=(()=>{class n{constructor(){Qn.A.registerVersion("angularfire",O.xv.full,"gcs-compat")}static \u0275fac=function(a){return new(a||n)};static \u0275mod=$.$C({type:n});static \u0275inj=$.G2t({providers:[_n],imports:[or]})}return n})()},9052:(Ot,Re,g)=>{var O=g(467),o=g(8742),Y=g(1362),ae=g(1076),ne=g(6749);const de="@firebase/installations",ue="0.6.8",$=1e4,e=`w:${ue}`,We="FIS_v2",Ee="https://firebaseinstallations.googleapis.com/v1",Ce=36e5,q=new ae.FA("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function ie(u){return u instanceof ae.g&&u.code.includes("request-failed")}function se({projectId:u}){return`${Ee}/projects/${u}/installations`}function Ae(u){return{token:u.token,requestStatus:2,expiresIn:Ue(u.expiresIn),creationTime:Date.now()}}function z(u,f){return W.apply(this,arguments)}function W(){return(W=(0,O.A)(function*(u,f){const G=(yield f.json()).error;return q.create("request-failed",{requestName:u,serverCode:G.code,serverMessage:G.message,serverStatus:G.status})})).apply(this,arguments)}function xe({apiKey:u}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":u})}function Ge(u){return ce.apply(this,arguments)}function ce(){return(ce=(0,O.A)(function*(u){const f=yield u();return f.status>=500&&f.status<600?u():f})).apply(this,arguments)}function Ue(u){return Number(u.replace("s","000"))}function C(){return(C=(0,O.A)(function*({appConfig:u,heartbeatServiceProvider:f},{fid:E}){const G=se(u),oe=xe(u),te=f.getImmediate({optional:!0});if(te){const s=yield te.getHeartbeatsHeader();s&&oe.append("x-firebase-client",s)}const S={method:"POST",headers:oe,body:JSON.stringify({fid:E,authVersion:We,appId:u.appId,sdkVersion:e})},i=yield Ge(()=>fetch(G,S));if(i.ok){const s=yield i.json();return{fid:s.fid||E,registrationStatus:2,refreshToken:s.refreshToken,authToken:Ae(s.authToken)}}throw yield z("Create Installation",i)})).apply(this,arguments)}function T(u){return new Promise(f=>{setTimeout(f,u)})}const F=/^[cdef][\w-]{21}$/,R="";function _(){try{const u=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(u),u[0]=112+u[0]%16;const E=function P(u){return function y(u){return btoa(String.fromCharCode(...u)).replace(/\+/g,"-").replace(/\//g,"_")}(u).substr(0,22)}(u);return F.test(E)?E:R}catch{return R}}function I(u){return`${u.appName}!${u.appId}`}const x=new Map;function m(u,f){const E=I(u);J(E,f),function ge(u,f){const E=function Le(){return!Q&&"BroadcastChannel"in self&&(Q=new BroadcastChannel("[Firebase] FID Change"),Q.onmessage=u=>{J(u.data.key,u.data.fid)}),Q}();E&&E.postMessage({key:u,fid:f}),function B(){0===x.size&&Q&&(Q.close(),Q=null)}()}(E,f)}function J(u,f){const E=x.get(u);if(E)for(const G of E)G(f)}let Q=null;const H="firebase-installations-database",w=1,j="firebase-installations-store";let U=null;function ee(){return U||(U=(0,ne.P2)(H,w,{upgrade:(u,f)=>{0===f&&u.createObjectStore(j)}})),U}function Me(u,f){return et.apply(this,arguments)}function et(){return(et=(0,O.A)(function*(u,f){const E=I(u),oe=(yield ee()).transaction(j,"readwrite"),te=oe.objectStore(j),l=yield te.get(E);return yield te.put(f,E),yield oe.done,(!l||l.fid!==f.fid)&&m(u,f.fid),f})).apply(this,arguments)}function Ne(u){return Ie.apply(this,arguments)}function Ie(){return(Ie=(0,O.A)(function*(u){const f=I(u),G=(yield ee()).transaction(j,"readwrite");yield G.objectStore(j).delete(f),yield G.done})).apply(this,arguments)}function Ve(u,f){return $e.apply(this,arguments)}function $e(){return($e=(0,O.A)(function*(u,f){const E=I(u),oe=(yield ee()).transaction(j,"readwrite"),te=oe.objectStore(j),l=yield te.get(E),S=f(l);return void 0===S?yield te.delete(E):yield te.put(S,E),yield oe.done,S&&(!l||l.fid!==S.fid)&&m(u,S.fid),S})).apply(this,arguments)}function Je(u){return lt.apply(this,arguments)}function lt(){return lt=(0,O.A)(function*(u){let f;const E=yield Ve(u.appConfig,G=>{const oe=function qe(u){return pt(u||{fid:_(),registrationStatus:0})}(G),te=function Pt(u,f){if(0===f.registrationStatus){if(!navigator.onLine)return{installationEntry:f,registrationPromise:Promise.reject(q.create("app-offline"))};const E={fid:f.fid,registrationStatus:1,registrationTime:Date.now()},G=function Ft(u,f){return dt.apply(this,arguments)}(u,E);return{installationEntry:E,registrationPromise:G}}return 1===f.registrationStatus?{installationEntry:f,registrationPromise:xt(u)}:{installationEntry:f}}(u,oe);return f=te.registrationPromise,te.installationEntry});return E.fid===R?{installationEntry:yield f}:{installationEntry:E,registrationPromise:f}}),lt.apply(this,arguments)}function dt(){return dt=(0,O.A)(function*(u,f){try{const E=yield function Be(u,f){return C.apply(this,arguments)}(u,f);return Me(u.appConfig,E)}catch(E){throw ie(E)&&409===E.customData.serverCode?yield Ne(u.appConfig):yield Me(u.appConfig,{fid:f.fid,registrationStatus:0}),E}}),dt.apply(this,arguments)}function xt(u){return ht.apply(this,arguments)}function ht(){return(ht=(0,O.A)(function*(u){let f=yield It(u.appConfig);for(;1===f.registrationStatus;)yield T(100),f=yield It(u.appConfig);if(0===f.registrationStatus){const{installationEntry:E,registrationPromise:G}=yield Je(u);return G||E}return f})).apply(this,arguments)}function It(u){return Ve(u,f=>{if(!f)throw q.create("installation-not-found");return pt(f)})}function pt(u){return function Ut(u){return 1===u.registrationStatus&&u.registrationTime+$<Date.now()}(u)?{fid:u.fid,registrationStatus:0}:u}function me(){return(me=(0,O.A)(function*({appConfig:u,heartbeatServiceProvider:f},E){const G=function ot(u,{fid:f}){return`${se(u)}/${f}/authTokens:generate`}(u,E),oe=function Fe(u,{refreshToken:f}){const E=xe(u);return E.append("Authorization",function re(u){return`${We} ${u}`}(f)),E}(u,E),te=f.getImmediate({optional:!0});if(te){const s=yield te.getHeartbeatsHeader();s&&oe.append("x-firebase-client",s)}const S={method:"POST",headers:oe,body:JSON.stringify({installation:{sdkVersion:e,appId:u.appId}})},i=yield Ge(()=>fetch(G,S));if(i.ok)return Ae(yield i.json());throw yield z("Generate Auth Token",i)})).apply(this,arguments)}function He(u){return it.apply(this,arguments)}function it(){return it=(0,O.A)(function*(u,f=!1){let E;const G=yield Ve(u.appConfig,te=>{if(!Rt(te))throw q.create("not-registered");const l=te.authToken;if(!f&&function we(u){return 2===u.requestStatus&&!function mt(u){const f=Date.now();return f<u.creationTime||u.creationTime+u.expiresIn<f+Ce}(u)}(l))return te;if(1===l.requestStatus)return E=function gt(u,f){return st.apply(this,arguments)}(u,f),te;{if(!navigator.onLine)throw q.create("app-offline");const S=function Bt(u){const f={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},u),{authToken:f})}(te);return E=function wt(u,f){return nt.apply(this,arguments)}(u,S),S}});return E?yield E:G.authToken}),it.apply(this,arguments)}function st(){return(st=(0,O.A)(function*(u,f){let E=yield tt(u.appConfig);for(;1===E.authToken.requestStatus;)yield T(100),E=yield tt(u.appConfig);const G=E.authToken;return 0===G.requestStatus?He(u,f):G})).apply(this,arguments)}function tt(u){return Ve(u,f=>{if(!Rt(f))throw q.create("not-registered");return function _t(u){return 1===u.requestStatus&&u.requestTime+$<Date.now()}(f.authToken)?Object.assign(Object.assign({},f),{authToken:{requestStatus:0}}):f})}function nt(){return nt=(0,O.A)(function*(u,f){try{const E=yield function ft(u,f){return me.apply(this,arguments)}(u,f),G=Object.assign(Object.assign({},f),{authToken:E});return yield Me(u.appConfig,G),E}catch(E){if(!ie(E)||401!==E.customData.serverCode&&404!==E.customData.serverCode){const G=Object.assign(Object.assign({},f),{authToken:{requestStatus:0}});yield Me(u.appConfig,G)}else yield Ne(u.appConfig);throw E}}),nt.apply(this,arguments)}function Rt(u){return void 0!==u&&2===u.registrationStatus}function at(){return(at=(0,O.A)(function*(u){const f=u,{installationEntry:E,registrationPromise:G}=yield Je(f);return G?G.catch(console.error):He(f).catch(console.error),E.fid})).apply(this,arguments)}function Qe(){return Qe=(0,O.A)(function*(u,f=!1){const E=u;return yield function Mt(u){return Ke.apply(this,arguments)}(E),(yield He(E,f)).token}),Qe.apply(this,arguments)}function Ke(){return(Ke=(0,O.A)(function*(u){const{registrationPromise:f}=yield Je(u);f&&(yield f)})).apply(this,arguments)}function Tt(u){return q.create("missing-app-config-values",{valueName:u})}const c="installations",D=u=>{const f=u.getProvider("app").getImmediate(),E=function $t(u){if(!u||!u.options)throw Tt("App Configuration");if(!u.name)throw Tt("App Name");const f=["projectId","apiKey","appId"];for(const E of f)if(!u.options[E])throw Tt(E);return{appName:u.name,projectId:u.options.projectId,apiKey:u.options.apiKey,appId:u.options.appId}}(f);return{app:f,appConfig:E,heartbeatServiceProvider:(0,o._getProvider)(f,"heartbeat"),_delete:()=>Promise.resolve()}},M=u=>{const f=u.getProvider("app").getImmediate(),E=(0,o._getProvider)(f,c).getImmediate();return{getId:()=>function vt(u){return at.apply(this,arguments)}(E),getToken:oe=>function _e(u){return Qe.apply(this,arguments)}(E,oe)}};(function K(){(0,o._registerComponent)(new Y.uA(c,D,"PUBLIC")),(0,o._registerComponent)(new Y.uA("installations-internal",M,"PRIVATE"))})(),(0,o.registerVersion)(de,ue),(0,o.registerVersion)(de,ue,"esm2017")},4555:(Ot,Re,g)=>{g.d(Re,{TT:()=>Ke,gf:()=>Nt,ni:()=>$t,xD:()=>Tt});var O=g(467),Y=(g(9052),g(1362)),ae=g(6749),ne=g(1076),de=g(8742);const ue="/firebase-messaging-sw.js",$="/firebase-cloud-messaging-push-scope",e="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",We="https://fcmregistrations.googleapis.com/v1",Ee="google.c.a.c_id",Ce="google.c.a.c_l",he="google.c.a.ts";var q=function(c){return c.PUSH_RECEIVED="push-received",c.NOTIFICATION_CLICKED="notification-clicked",c}(q||{});function ie(c){const p=new Uint8Array(c);return btoa(String.fromCharCode(...p)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function se(c){const D=(c+"=".repeat((4-c.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),M=atob(D),K=new Uint8Array(M.length);for(let u=0;u<M.length;++u)K[u]=M.charCodeAt(u);return K}const Ae="fcm_token_details_db",z=5,W="fcm_token_object_Store";function Fe(){return Fe=(0,O.A)(function*(c){if("databases"in indexedDB&&!(yield indexedDB.databases()).map(u=>u.name).includes(Ae))return null;let p=null;return(yield(0,ae.P2)(Ae,z,{upgrade:(M=(0,O.A)(function*(K,u,f,E){var G;if(u<2||!K.objectStoreNames.contains(W))return;const oe=E.objectStore(W),te=yield oe.index("fcmSenderId").get(c);if(yield oe.clear(),te)if(2===u){const l=te;if(!l.auth||!l.p256dh||!l.endpoint)return;p={token:l.fcmToken,createTime:null!==(G=l.createTime)&&void 0!==G?G:Date.now(),subscriptionOptions:{auth:l.auth,p256dh:l.p256dh,endpoint:l.endpoint,swScope:l.swScope,vapidKey:"string"==typeof l.vapidKey?l.vapidKey:ie(l.vapidKey)}}}else if(3===u){const l=te;p={token:l.fcmToken,createTime:l.createTime,subscriptionOptions:{auth:ie(l.auth),p256dh:ie(l.p256dh),endpoint:l.endpoint,swScope:l.swScope,vapidKey:ie(l.vapidKey)}}}else if(4===u){const l=te;p={token:l.fcmToken,createTime:l.createTime,subscriptionOptions:{auth:ie(l.auth),p256dh:ie(l.p256dh),endpoint:l.endpoint,swScope:l.swScope,vapidKey:ie(l.vapidKey)}}}}),function(u,f,E,G){return M.apply(this,arguments)})})).close(),yield(0,ae.MR)(Ae),yield(0,ae.MR)("fcm_vapid_details_db"),yield(0,ae.MR)("undefined"),function Ge(c){if(!c||!c.subscriptionOptions)return!1;const{subscriptionOptions:p}=c;return"number"==typeof c.createTime&&c.createTime>0&&"string"==typeof c.token&&c.token.length>0&&"string"==typeof p.auth&&p.auth.length>0&&"string"==typeof p.p256dh&&p.p256dh.length>0&&"string"==typeof p.endpoint&&p.endpoint.length>0&&"string"==typeof p.swScope&&p.swScope.length>0&&"string"==typeof p.vapidKey&&p.vapidKey.length>0}(p)?p:null;var M}),Fe.apply(this,arguments)}const ce="firebase-messaging-database",Ue=1,re="firebase-messaging-store";let Be=null;function C(){return Be||(Be=(0,ae.P2)(ce,Ue,{upgrade:(c,p)=>{0===p&&c.createObjectStore(re)}})),Be}function T(c){return y.apply(this,arguments)}function y(){return y=(0,O.A)(function*(c){const p=I(c),M=yield(yield C()).transaction(re).objectStore(re).get(p);if(M)return M;{const K=yield function xe(c){return Fe.apply(this,arguments)}(c.appConfig.senderId);if(K)return yield F(c,K),K}}),y.apply(this,arguments)}function F(c,p){return R.apply(this,arguments)}function R(){return(R=(0,O.A)(function*(c,p){const D=I(c),K=(yield C()).transaction(re,"readwrite");return yield K.objectStore(re).put(p,D),yield K.done,p})).apply(this,arguments)}function P(){return(P=(0,O.A)(function*(c){const p=I(c),M=(yield C()).transaction(re,"readwrite");yield M.objectStore(re).delete(p),yield M.done})).apply(this,arguments)}function I({appConfig:c}){return c.appId}const m=new ne.FA("messaging","Messaging",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."});function V(c,p){return le.apply(this,arguments)}function le(){return(le=(0,O.A)(function*(c,p){const D=yield H(c),M=j(p),K={method:"POST",headers:D,body:JSON.stringify(M)};let u;try{u=yield(yield fetch(B(c.appConfig),K)).json()}catch(f){throw m.create("token-subscribe-failed",{errorInfo:f?.toString()})}if(u.error)throw m.create("token-subscribe-failed",{errorInfo:u.error.message});if(!u.token)throw m.create("token-subscribe-no-token");return u.token})).apply(this,arguments)}function ge(){return(ge=(0,O.A)(function*(c,p){const D=yield H(c),M=j(p.subscriptionOptions),K={method:"PATCH",headers:D,body:JSON.stringify(M)};let u;try{u=yield(yield fetch(`${B(c.appConfig)}/${p.token}`,K)).json()}catch(f){throw m.create("token-update-failed",{errorInfo:f?.toString()})}if(u.error)throw m.create("token-update-failed",{errorInfo:u.error.message});if(!u.token)throw m.create("token-update-no-token");return u.token})).apply(this,arguments)}function Q(c,p){return Le.apply(this,arguments)}function Le(){return(Le=(0,O.A)(function*(c,p){const M={method:"DELETE",headers:yield H(c)};try{const u=yield(yield fetch(`${B(c.appConfig)}/${p}`,M)).json();if(u.error)throw m.create("token-unsubscribe-failed",{errorInfo:u.error.message})}catch(K){throw m.create("token-unsubscribe-failed",{errorInfo:K?.toString()})}})).apply(this,arguments)}function B({projectId:c}){return`${We}/projects/${c}/registrations`}function H(c){return w.apply(this,arguments)}function w(){return(w=(0,O.A)(function*({appConfig:c,installations:p}){const D=yield p.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":c.apiKey,"x-goog-firebase-installations-auth":`FIS ${D}`})})).apply(this,arguments)}function j({p256dh:c,auth:p,endpoint:D,vapidKey:M}){const K={web:{endpoint:D,auth:p,p256dh:c}};return M!==e&&(K.web.applicationPubKey=M),K}const U=6048e5;function Me(){return Me=(0,O.A)(function*(c){const p=yield function lt(c,p){return qe.apply(this,arguments)}(c.swRegistration,c.vapidKey),D={vapidKey:c.vapidKey,swScope:c.swRegistration.scope,endpoint:p.endpoint,auth:ie(p.getKey("auth")),p256dh:ie(p.getKey("p256dh"))},M=yield T(c.firebaseDependencies);if(M){if(function Pt(c,p){return p.vapidKey===c.vapidKey&&p.endpoint===c.endpoint&&p.auth===c.auth&&p.p256dh===c.p256dh}(M.subscriptionOptions,D))return Date.now()>=M.createTime+U?function Ie(c,p){return Ve.apply(this,arguments)}(c,{token:M.token,createTime:Date.now(),subscriptionOptions:D}):M.token;try{yield Q(c.firebaseDependencies,M.token)}catch(K){console.warn(K)}return $e(c.firebaseDependencies,D)}return $e(c.firebaseDependencies,D)}),Me.apply(this,arguments)}function Ne(){return Ne=(0,O.A)(function*(c){const p=yield T(c.firebaseDependencies);p&&(yield Q(c.firebaseDependencies,p.token),yield function _(c){return P.apply(this,arguments)}(c.firebaseDependencies));const D=yield c.swRegistration.pushManager.getSubscription();return!D||D.unsubscribe()}),Ne.apply(this,arguments)}function Ve(){return Ve=(0,O.A)(function*(c,p){try{const D=yield function J(c,p){return ge.apply(this,arguments)}(c.firebaseDependencies,p),M=Object.assign(Object.assign({},p),{token:D,createTime:Date.now()});return yield F(c.firebaseDependencies,M),D}catch(D){throw D}}),Ve.apply(this,arguments)}function $e(c,p){return Je.apply(this,arguments)}function Je(){return(Je=(0,O.A)(function*(c,p){const M={token:yield V(c,p),createTime:Date.now(),subscriptionOptions:p};return yield F(c,M),M.token})).apply(this,arguments)}function qe(){return(qe=(0,O.A)(function*(c,p){return(yield c.pushManager.getSubscription())||c.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:se(p)})})).apply(this,arguments)}function Ft(c){const p={from:c.from,collapseKey:c.collapse_key,messageId:c.fcmMessageId};return function dt(c,p){if(!p.notification)return;c.notification={};const D=p.notification.title;D&&(c.notification.title=D);const M=p.notification.body;M&&(c.notification.body=M);const K=p.notification.image;K&&(c.notification.image=K);const u=p.notification.icon;u&&(c.notification.icon=u)}(p,c),function xt(c,p){p.data&&(c.data=p.data)}(p,c),function ht(c,p){var D,M,K,u,f;if(!(p.fcmOptions||null!==(D=p.notification)&&void 0!==D&&D.click_action))return;c.fcmOptions={};const E=null!==(K=null===(M=p.fcmOptions)||void 0===M?void 0:M.link)&&void 0!==K?K:null===(u=p.notification)||void 0===u?void 0:u.click_action;E&&(c.fcmOptions.link=E);const G=null===(f=p.fcmOptions)||void 0===f?void 0:f.analytics_label;G&&(c.fcmOptions.analyticsLabel=G)}(p,c),p}function pt(c,p){const D=[];for(let M=0;M<c.length;M++)D.push(c.charAt(M)),M<p.length&&D.push(p.charAt(M));return D.join("")}function ft(c){return m.create("missing-app-config-values",{valueName:c})}pt("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),pt("AzSCbw63g1R0nCw85jG8","Iaya3yLKwmgvh7cF0q4");class me{constructor(p,D,M){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const K=function Ut(c){if(!c||!c.options)throw ft("App Configuration Object");if(!c.name)throw ft("App Name");const p=["projectId","apiKey","appId","messagingSenderId"],{options:D}=c;for(const M of p)if(!D[M])throw ft(M);return{appName:c.name,projectId:D.projectId,apiKey:D.apiKey,appId:D.appId,senderId:D.messagingSenderId}}(p);this.firebaseDependencies={app:p,appConfig:K,installations:D,analyticsProvider:M}}_delete(){return Promise.resolve()}}function ot(c){return He.apply(this,arguments)}function He(){return(He=(0,O.A)(function*(c){try{c.swRegistration=yield navigator.serviceWorker.register(ue,{scope:$}),c.swRegistration.update().catch(()=>{})}catch(p){throw m.create("failed-service-worker-registration",{browserErrorMessage:p?.message})}})).apply(this,arguments)}function gt(){return(gt=(0,O.A)(function*(c,p){if(!p&&!c.swRegistration&&(yield ot(c)),p||!c.swRegistration){if(!(p instanceof ServiceWorkerRegistration))throw m.create("invalid-sw-registration");c.swRegistration=p}})).apply(this,arguments)}function tt(){return(tt=(0,O.A)(function*(c,p){p?c.vapidKey=p:c.vapidKey||(c.vapidKey=e)})).apply(this,arguments)}function wt(c,p){return nt.apply(this,arguments)}function nt(){return nt=(0,O.A)(function*(c,p){if(!navigator)throw m.create("only-available-in-window");if("default"===Notification.permission&&(yield Notification.requestPermission()),"granted"!==Notification.permission)throw m.create("permission-blocked");return yield function st(c,p){return tt.apply(this,arguments)}(c,p?.vapidKey),yield function it(c,p){return gt.apply(this,arguments)}(c,p?.serviceWorkerRegistration),function ee(c){return Me.apply(this,arguments)}(c)}),nt.apply(this,arguments)}function we(){return(we=(0,O.A)(function*(c,p,D){const M=function mt(c){switch(c){case q.NOTIFICATION_CLICKED:return"notification_open";case q.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}(p);(yield c.firebaseDependencies.analyticsProvider.get()).logEvent(M,{message_id:D[Ee],message_name:D[Ce],message_time:D[he],message_device_time:Math.floor(Date.now()/1e3)})})).apply(this,arguments)}function _t(){return _t=(0,O.A)(function*(c,p){const D=p.data;if(!D.isFirebaseMessaging)return;c.onMessageHandler&&D.messageType===q.PUSH_RECEIVED&&("function"==typeof c.onMessageHandler?c.onMessageHandler(Ft(D)):c.onMessageHandler.next(Ft(D)));const M=D.data;(function It(c){return"object"==typeof c&&!!c&&Ee in c})(M)&&"1"===M["google.c.a.e"]&&(yield function Rt(c,p,D){return we.apply(this,arguments)}(c,D.messageType,M))}),_t.apply(this,arguments)}const vt="@firebase/messaging",at="0.12.10",_e=c=>{const p=new me(c.getProvider("app").getImmediate(),c.getProvider("installations-internal").getImmediate(),c.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",D=>function Bt(c,p){return _t.apply(this,arguments)}(p,D)),p},Qe=c=>{const p=c.getProvider("messaging").getImmediate();return{getToken:M=>wt(p,M)}};function Ke(){return bt.apply(this,arguments)}function bt(){return(bt=(0,O.A)(function*(){try{yield(0,ne.eX)()}catch{return!1}return typeof window<"u"&&(0,ne.zW)()&&(0,ne.dM)()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")})).apply(this,arguments)}function ut(){return ut=(0,O.A)(function*(c){if(!navigator)throw m.create("only-available-in-window");return c.swRegistration||(yield ot(c)),function et(c){return Ne.apply(this,arguments)}(c)}),ut.apply(this,arguments)}function Nt(c,p){return yt.apply(this,arguments)}function yt(){return(yt=(0,O.A)(function*(c,p){return wt(c=(0,ne.Ku)(c),p)})).apply(this,arguments)}function $t(c){return function Ct(c){return ut.apply(this,arguments)}(c=(0,ne.Ku)(c))}function Tt(c,p){return function Lt(c,p){if(!navigator)throw m.create("only-available-in-window");return c.onMessageHandler=p,()=>{c.onMessageHandler=null}}(c=(0,ne.Ku)(c),p)}!function Mt(){(0,de._registerComponent)(new Y.uA("messaging",_e,"PUBLIC")),(0,de._registerComponent)(new Y.uA("messaging-internal",Qe,"PRIVATE")),(0,de.registerVersion)(vt,at),(0,de.registerVersion)(vt,at,"esm2017")}()}}]);