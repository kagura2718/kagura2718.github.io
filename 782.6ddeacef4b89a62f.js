"use strict";(self.webpackChunkKaguraGithubPages=self.webpackChunkKaguraGithubPages||[]).push([[782],{9782:(j,w,s)=>{s.d(w,{e:()=>S});var f=s(5861),o=s(1180),r=s(8645),M=s(7328),T=s(2096),W=s(3997),K=s(2181),I=s(9773),A=s(4664),R=s(9397),C=s(3620),x=s(7081),b=s(8180),p=s(553),y=s(5879),D=s(434),a=s(2413),E=s(3867),O=s(5579),m=s(271);class G{constructor(l,c,g,h,L){var d=this;(0,o.Z)(this,"auth",void 0),(0,o.Z)(this,"funcs",void 0),(0,o.Z)(this,"localSession",void 0),(0,o.Z)(this,"store",void 0),(0,o.Z)(this,"dom",void 0),(0,o.Z)(this,"finalize$",new r.x),(0,o.Z)(this,"state$",void 0),(0,o.Z)(this,"localUser$",void 0),(0,o.Z)(this,"isAdminUser",!1),(0,o.Z)(this,"isDevelopUser",!1),(0,o.Z)(this,"hasMessagingDevice",!1),(0,o.Z)(this,"loginUid",null),(0,o.Z)(this,"sourceValue$",new M.t),this.auth=l,this.funcs=c,this.localSession=g,this.store=h,this.dom=L,(0,p.eM)("SingletonAuth.constructor()"),this.dom.addResourceHint("https://identitytoolkit.googleapis.com","preconnect"),this.dom.addResourceHint("https://firebaseinstallations.googleapis.com","preconnect"),this.dom.addResourceHint("https://firestore.googleapis.com","preconnect"),this.dom.addResourceHint("https://apis.google.com","preconnect"),this.dom.addResourceHint(`https://${p.NZ.firebaseConfig.authDomain}`,"preconnect"),this.dom.addResourceHint(`https://${p.NZ.FirebaseCloudFunctionsHost}`,"preconnect");const F=this.auth.user.pipe((0,W.x)());F.pipe((0,W.x)()).subscribe(_=>{this.sourceValue$.next()}),this.state$=F.pipe((0,K.h)(_=>null!==_)),this.localSession.markedLogout$.pipe().subscribe(()=>{this.sourceValue$.next()}),this.state$.pipe((0,I.R)(this.finalize$)).subscribe({error:_=>{(0,p.wb)("AuthService.state$ error",_),this.doFinalize()},complete:()=>{(0,p.H_)("AuthService.state$ completed."),this.doFinalize()}}),this.state$.pipe((0,A.w)(_=>this.store.collection(`/users/v1/protected/${_.uid}/fcm`).valueChanges().pipe((0,R.b)(v=>(0,p.eM)("UserProtectedStore has changed.",v)))),(0,I.R)(this.finalize$)).subscribe({next:_=>{this.sourceValue$.next()},error:_=>{(0,p.wb)("AuthService.state$ Maybe after logout permission error. Ignore it.",_),this.doFinalize()},complete:()=>{(0,p.H_)("AuthService.state$ completed."),this.doFinalize()}});const B=this.state$.pipe((0,A.w)(function(){var _=(0,f.Z)(function*(v){try{const H=yield d.funcs.call("readUserSettings"),N=v;return N.isAdmin=H.isAdmin,N.isDeveloper=H.isDeveloper,N.hasMessaging=H.hasMessaging,N}catch(H){return(0,p.wb)("AuthService while check user settings.",H),null}});return function(v){return _.apply(this,arguments)}}()));var _;this.localUser$=this.sourceValue$.pipe((0,C.b)(100),(0,A.w)(()=>F.pipe((0,A.w)(_=>null===_?(0,T.of)(null):B))),(0,x.d)(1)),this.localUser$.pipe((0,I.R)(this.finalize$)).subscribe({next:(_=(0,f.Z)(function*(v){(0,p.eM)("AuthService.localUser$.subscribe()",v),v?(d.loginUid=v.uid,d.isAdminUser=!!v.isAdmin,d.isDevelopUser=!!v.isDeveloper,d.hasMessagingDevice=!!v.hasMessaging,d.localSession.updateLoginPhoto(v.photoURL),d.localSession.markLogin()):(d.localSession.unmarkLogin(),d.localSession.updateLoginPhoto(null),d.loginUid=null,d.isAdminUser=!1,d.isDevelopUser=!1,d.hasMessagingDevice=!1,(0,p.H_)("Explicitly logout on client sdk."),yield d.auth.signOut())}),function(H){return _.apply(this,arguments)}),complete:()=>{(0,p.H_)("AuthService.localUser$ complete."),this.doFinalize()},error:_=>{(0,p.wb)("AuthService.localUser$ error while retrieving.",_),this.doFinalize()}})}doFinalize(){this.finalize$.isStopped||((0,p.H_)("Do finalize Singleton Auth"),this.finalize$.next(),this.finalize$.complete())}}let S=(()=>{var $;class l{constructor(g,h,L,d,F){(0,o.Z)(this,"auth",void 0),(0,o.Z)(this,"funcs",void 0),(0,o.Z)(this,"localSession",void 0),(0,o.Z)(this,"store",void 0),(0,o.Z)(this,"dom",void 0),(0,o.Z)(this,"_clientSideUser$",void 0),this.auth=g,this.funcs=h,this.localSession=L,this.store=d,this.dom=F,(0,p.eM)("AuthService.constructor()");const B=new M.t;null===l.AUTH&&(l.AUTH=new G(g,h,L,d,F),l.AUTH.finalize$.pipe((0,b.q)(1)).subscribe({next:()=>{(0,p.H_)("Finalize singleton auth continue..")},complete:()=>{(0,p.H_)("Finalizing singleton auth completed."),l.AUTH=null,B.next()},error:_=>{(0,p.wb)("Finalizing singleton auth cause by error.",_),l.AUTH=null,B.next()}})),this._clientSideUser$=B.pipe((0,A.w)(()=>null===l.AUTH?(0,T.of)(null):l.AUTH.localUser$),(0,x.d)(1)),B.next()}get clientSideUser$(){return this._clientSideUser$}get isAdmin(){return!!l.AUTH&&l.AUTH.isAdminUser}get isDeveloper(){return!!l.AUTH&&l.AUTH.isDevelopUser}get hasMessaging(){return!!l.AUTH&&l.AUTH.hasMessagingDevice}get myUid(){return l.AUTH?l.AUTH.loginUid:null}}return $=l,(0,o.Z)(l,"AUTH",null),(0,o.Z)(l,"\u0275fac",function(g){return new(g||$)(y.LFG(D.zQ),y.LFG(a.c),y.LFG(E.m),y.LFG(O.ST),y.LFG(m.v))}),(0,o.Z)(l,"\u0275prov",y.Yz7({token:$,factory:$.\u0275fac,providedIn:"root"})),l})()},2413:(j,w,s)=>{s.d(w,{c:()=>K});var f=s(5861),o=s(1180),r=s(8180),M=s(553),T=s(5879),W=s(5070);let K=(()=>{var I;class A{constructor(C){(0,o.Z)(this,"remote",void 0),this.remote=C,(0,M.eM)("LocalFunctionsService.constructor()")}call(C,x){var b=this;return(0,f.Z)(function*(){return yield b.remote.httpsCallable(C)(x).pipe((0,r.q)(1)).toPromise()})()}}return I=A,(0,o.Z)(A,"\u0275fac",function(C){return new(C||I)(T.LFG(W.l4))}),(0,o.Z)(A,"\u0275prov",T.Yz7({token:I,factory:I.\u0275fac,providedIn:"root"})),A})()},5070:(j,w,s)=>{s.d(w,{Qv:()=>E,Xz:()=>y,l4:()=>a});var f=s(1180),r=(s(7741),s(5879)),M=s(8326),T=s(7217),W=s(2096),K=s(2459),I=s(3093),A=s(4664),R=s(7398),C=s(7081),x=s(7142);const p=new r.OlP("angularfire2.functions.origin"),y=new r.OlP("angularfire2.functions.region"),D=new r.OlP("angularfire2.functions.use-emulator");let a=(()=>{var O;class m{constructor(S,$,l,c,g,h,L,d){(0,f.Z)(this,"httpsCallable",void 0);const F=L,B=(0,W.of)(void 0).pipe((0,I.Q)(c.outsideAngular),(0,A.w)(()=>Promise.resolve().then(s.bind(s,7741))),(0,R.U)(()=>(0,T.on)(S,l,$)),(0,R.U)(_=>(0,T.cc)(`${_.name}.functions.${g||h}`,"AngularFireFunctions",_.name,()=>{let v;if(g&&h)throw new Error("REGION and ORIGIN can't be used at the same time.");return v=_.functions(g||h||void 0),F&&v.useEmulator(...F),v},[g,h,F])),(0,C.d)({bufferSize:1,refCount:!1}));return this.httpsCallable=(_,v)=>H=>(0,K.D)(B).pipe((0,I.Q)(c.insideAngular),(0,A.w)(N=>N.httpsCallable(_,v)(H)),(0,R.U)(N=>N.data)),(0,T.pX)(this,B,l)}}return O=m,(0,f.Z)(m,"\u0275fac",function(S){return new(S||O)(r.LFG(T.Dh),r.LFG(T.xv,8),r.LFG(r.R0b),r.LFG(M.HU),r.LFG(y,8),r.LFG(p,8),r.LFG(D,8),r.LFG(M.Rf,8))}),(0,f.Z)(m,"\u0275prov",r.Yz7({token:O,factory:O.\u0275fac,providedIn:"any"})),m})(),E=(()=>{var O;class m{constructor(){x.Z.registerVersion("angularfire",M.q4.full,"fn-compat")}}return O=m,(0,f.Z)(m,"\u0275fac",function(S){return new(S||O)}),(0,f.Z)(m,"\u0275mod",r.oAB({type:O})),(0,f.Z)(m,"\u0275inj",r.cJS({providers:[a]})),m})()},3106:(j,w,s)=>{s.d(w,{Z:()=>y});var f=s(9058),o=s(4537),r=s(6122),M=s(7879);class T{constructor(a,E){this._delegate=a,this.firebase=E,(0,r._addComponent)(a,new o.wA("app-compat",()=>this,"PUBLIC")),this.container=a.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(a){this._delegate.automaticDataCollectionEnabled=a}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(a=>{this._delegate.checkDestroyed(),a()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),(0,r.deleteApp)(this._delegate)))}_getService(a,E=r._DEFAULT_ENTRY_NAME){var O;this._delegate.checkDestroyed();const m=this._delegate.container.getProvider(a);return!m.isInitialized()&&"EXPLICIT"===(null===(O=m.getComponent())||void 0===O?void 0:O.instantiationMode)&&m.initialize(),m.getImmediate({identifier:E})}_removeServiceInstance(a,E=r._DEFAULT_ENTRY_NAME){this._delegate.container.getProvider(a).clearInstance(E)}_addComponent(a){(0,r._addComponent)(this._delegate,a)}_addOrOverwriteComponent(a){(0,r._addOrOverwriteComponent)(this._delegate,a)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}const K=new f.LL("app-compat","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."}),R=function A(){const D=function I(D){const a={},E={__esModule:!0,initializeApp:function G(c,g={}){const h=r.initializeApp(c,g);if((0,f.r3)(a,h.name))return a[h.name];const L=new D(h,E);return a[h.name]=L,L},app:m,registerVersion:r.registerVersion,setLogLevel:r.setLogLevel,onLog:r.onLog,apps:null,SDK_VERSION:r.SDK_VERSION,INTERNAL:{registerComponent:function $(c){const g=c.name,h=g.replace("-compat","");if(r._registerComponent(c)&&"PUBLIC"===c.type){const L=(d=m())=>{if("function"!=typeof d[h])throw K.create("invalid-app-argument",{appName:g});return d[h]()};void 0!==c.serviceProps&&(0,f.ZB)(L,c.serviceProps),E[h]=L,D.prototype[h]=function(...d){return this._getService.bind(this,g).apply(this,c.multipleInstances?d:[])}}return"PUBLIC"===c.type?E[h]:null},removeApp:function O(c){delete a[c]},useAsService:function l(c,g){return"serverAuth"===g?null:g},modularAPIs:r}};function m(c){if(!(0,f.r3)(a,c=c||r._DEFAULT_ENTRY_NAME))throw K.create("no-app",{appName:c});return a[c]}return E.default=E,Object.defineProperty(E,"apps",{get:function S(){return Object.keys(a).map(c=>a[c])}}),m.App=D,E}(T);return D.INTERNAL=Object.assign(Object.assign({},D.INTERNAL),{createFirebaseNamespace:A,extendNamespace:function a(E){(0,f.ZB)(D,E)},createSubscribe:f.ne,ErrorFactory:f.LL,deepExtend:f.ZB}),D}(),C=new M.Yd("@firebase/app-compat");if((0,f.jU)()&&void 0!==self.firebase){C.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");const D=self.firebase.SDK_VERSION;D&&D.indexOf("LITE")>=0&&C.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}const y=R;!function p(D){(0,r.registerVersion)("@firebase/app-compat","0.2.13",D)}()},7741:(j,w,s)=>{s.r(w);var f=s(3106),o=s(5861),r=s(6122),M=s(9058),T=s(4537);const W="type.googleapis.com/google.protobuf.Int64Value",K="type.googleapis.com/google.protobuf.UInt64Value";function I(e,t){const n={};for(const i in e)e.hasOwnProperty(i)&&(n[i]=t(e[i]));return n}function A(e){if(null==e)return null;if(e instanceof Number&&(e=e.valueOf()),"number"==typeof e&&isFinite(e)||!0===e||!1===e||"[object String]"===Object.prototype.toString.call(e))return e;if(e instanceof Date)return e.toISOString();if(Array.isArray(e))return e.map(t=>A(t));if("function"==typeof e||"object"==typeof e)return I(e,t=>A(t));throw new Error("Data cannot be encoded in JSON: "+e)}function R(e){if(null==e)return e;if(e["@type"])switch(e["@type"]){case W:case K:{const t=Number(e.value);if(isNaN(t))throw new Error("Data cannot be decoded from JSON: "+e);return t}default:throw new Error("Data cannot be decoded from JSON: "+e)}return Array.isArray(e)?e.map(t=>R(t)):"function"==typeof e||"object"==typeof e?I(e,t=>R(t)):e}const C="functions",x={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class b extends M.ZR{constructor(t,n,i){super(`${C}/${t}`,n||""),this.details=i}}class D{constructor(t,n,i){this.auth=null,this.messaging=null,this.appCheck=null,this.auth=t.getImmediate({optional:!0}),this.messaging=n.getImmediate({optional:!0}),this.auth||t.get().then(u=>this.auth=u,()=>{}),this.messaging||n.get().then(u=>this.messaging=u,()=>{}),this.appCheck||i.get().then(u=>this.appCheck=u,()=>{})}getAuthToken(){var t=this;return(0,o.Z)(function*(){if(t.auth)try{const n=yield t.auth.getToken();return n?.accessToken}catch{return}})()}getMessagingToken(){var t=this;return(0,o.Z)(function*(){if(t.messaging&&"Notification"in self&&"granted"===Notification.permission)try{return yield t.messaging.getToken()}catch{return}})()}getAppCheckToken(t){var n=this;return(0,o.Z)(function*(){if(n.appCheck){const i=t?yield n.appCheck.getLimitedUseToken():yield n.appCheck.getToken();return i.error?null:i.token}return null})()}getContext(t){var n=this;return(0,o.Z)(function*(){return{authToken:yield n.getAuthToken(),messagingToken:yield n.getMessagingToken(),appCheckToken:yield n.getAppCheckToken(t)}})()}}const a="us-central1";class O{constructor(t,n,i,u,P=a,U){this.app=t,this.fetchImpl=U,this.emulatorOrigin=null,this.contextProvider=new D(n,i,u),this.cancelAllRequests=new Promise(Z=>{this.deleteService=()=>Promise.resolve(Z())});try{const Z=new URL(P);this.customDomain=Z.origin,this.region=a}catch{this.customDomain=null,this.region=P}}_delete(){return this.deleteService()}_url(t){const n=this.app.options.projectId;return null!==this.emulatorOrigin?`${this.emulatorOrigin}/${n}/${this.region}/${t}`:null!==this.customDomain?`${this.customDomain}/${t}`:`https://${this.region}-${n}.cloudfunctions.net/${t}`}}function $(e,t,n,i){return l.apply(this,arguments)}function l(){return(l=(0,o.Z)(function*(e,t,n,i){let u;n["Content-Type"]="application/json";try{u=yield i(e,{method:"POST",body:JSON.stringify(t),headers:n})}catch{return{status:0,json:null}}let P=null;try{P=yield u.json()}catch{}return{status:u.status,json:P}})).apply(this,arguments)}function g(e,t,n,i){return h.apply(this,arguments)}function h(){return(h=(0,o.Z)(function*(e,t,n,i){const u={data:n=A(n)},P={},U=yield e.contextProvider.getContext(i.limitedUseAppCheckTokens);U.authToken&&(P.Authorization="Bearer "+U.authToken),U.messagingToken&&(P["Firebase-Instance-ID-Token"]=U.messagingToken),null!==U.appCheckToken&&(P["X-Firebase-AppCheck"]=U.appCheckToken);const k=function E(e){let t=null;return{promise:new Promise((n,i)=>{t=setTimeout(()=>{i(new b("deadline-exceeded","deadline-exceeded"))},e)}),cancel:()=>{t&&clearTimeout(t)}}}(i.timeout||7e4),z=yield Promise.race([$(t,u,P,e.fetchImpl),k.promise,e.cancelAllRequests]);if(k.cancel(),!z)throw new b("cancelled","Firebase Functions instance was deleted.");const J=function y(e,t){let u,n=function p(e){if(e>=200&&e<300)return"ok";switch(e){case 0:case 500:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}(e),i=n;try{const P=t&&t.error;if(P){const U=P.status;if("string"==typeof U){if(!x[U])return new b("internal","internal");n=x[U],i=U}const Z=P.message;"string"==typeof Z&&(i=Z),u=P.details,void 0!==u&&(u=R(u))}}catch{}return"ok"===n?null:new b(n,i,u)}(z.status,z.json);if(J)throw J;if(!z.json)throw new b("internal","Response is not valid JSON object.");let V=z.json.data;if(typeof V>"u"&&(V=z.json.result),typeof V>"u")throw new b("internal","Response is missing data field.");return{data:R(V)}})).apply(this,arguments)}const L="@firebase/functions",d="0.10.0";function N(e,t,n){!function m(e,t,n){e.emulatorOrigin=`http://${t}:${n}`}((0,M.m9)(e),t,n)}!function v(e,t){(0,r._registerComponent)(new T.wA(C,(i,{instanceIdentifier:u})=>{const P=i.getProvider("app").getImmediate(),U=i.getProvider("auth-internal"),Z=i.getProvider("messaging-internal"),k=i.getProvider("app-check-internal");return new O(P,U,Z,k,u,e)},"PUBLIC").setMultipleInstances(!0)),(0,r.registerVersion)(L,d,t),(0,r.registerVersion)(L,d,"esm2017")}(fetch.bind(self));class Y{constructor(t,n){this.app=t,this._delegate=n,this._region=this._delegate.region,this._customDomain=this._delegate.customDomain}httpsCallable(t,n){return function X(e,t,n){return function G(e,t,n){return i=>function c(e,t,n,i){const u=e._url(t);return g(e,u,n,i)}(e,t,i,n||{})}((0,M.m9)(e),t,n)}(this._delegate,t,n)}httpsCallableFromURL(t,n){return function Q(e,t,n){return function S(e,t,n){return i=>g(e,t,i,n||{})}((0,M.m9)(e),t,n)}(this._delegate,t,n)}useFunctionsEmulator(t){const n=t.match("[a-zA-Z]+://([a-zA-Z0-9.-]+)(?::([0-9]+))?");if(null==n)throw new M.ZR("functions","No origin provided to useFunctionsEmulator()");if(null==n[2])throw new M.ZR("functions","Port missing in origin provided to useFunctionsEmulator()");return N(this._delegate,n[1],Number(n[2]))}useEmulator(t,n){return N(this._delegate,t,n)}}const ne=(e,{instanceIdentifier:t})=>{const n=e.getProvider("app-compat").getImmediate(),i=e.getProvider("functions").getImmediate({identifier:t??"us-central1"});return new Y(n,i)};(function se(){const e={Functions:Y};f.Z.INTERNAL.registerComponent(new T.wA("functions-compat",ne,"PUBLIC").setServiceProps(e).setMultipleInstances(!0))})(),f.Z.registerVersion("@firebase/functions-compat","0.3.5")}}]);