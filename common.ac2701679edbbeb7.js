"use strict";(self.webpackChunkKaguraGithubPages=self.webpackChunkKaguraGithubPages||[]).push([[592],{6448:(y,P,e)=>{e.d(P,{h:()=>c});var o=e(1180),n=e(5879),t=e(8645),C=e(7328),d=e(1687),i=e(4664),p=e(7398),g=e(3997),u=e(2181),f=e(7081),O=e(9773),m=e(9798),a=e(6593),A=e(6814);const E=["hostingSpan"];let c=(()=>{var r;class l{constructor(s,h){(0,o.Z)(this,"http",void 0),(0,o.Z)(this,"sanitizer",void 0),(0,o.Z)(this,"error",new n.vpe),(0,o.Z)(this,"src",void 0),(0,o.Z)(this,"fill",void 0),(0,o.Z)(this,"stroke",void 0),(0,o.Z)(this,"height",void 0),(0,o.Z)(this,"width",void 0),(0,o.Z)(this,"hostingSpan",void 0),(0,o.Z)(this,"contents$",void 0),(0,o.Z)(this,"svg$",void 0),(0,o.Z)(this,"destroy$",new t.x),(0,o.Z)(this,"src$",new C.t),(0,o.Z)(this,"width$",new C.t),(0,o.Z)(this,"height$",new C.t),this.http=s,this.sanitizer=h}ngOnInit(){this.contents$=this.src$.pipe((0,i.w)(s=>this.http.fetchText(s)),(0,p.U)(s=>this.sanitizer.bypassSecurityTrustHtml(s))),this.svg$=this.contents$.pipe((0,i.w)(s=>(0,d.F)(200)),(0,p.U)(s=>this.getUniqueSvgElement()),(0,g.x)(),(0,u.h)(s=>null!==s),(0,f.d)(1)),this.connectAttribute(s=>`${s}`,"width",this.width$),this.connectAttribute(s=>`${s}`,"height",this.height$)}ngOnDestroy(){this.destroy$.next()}connectAttribute(s,h,F){F.pipe((0,i.w)(B=>this.svg$.pipe((0,p.U)(_=>[_,s(B)]))),(0,O.R)(this.destroy$)).subscribe(([B,_])=>{B.setAttribute(h,_)})}getUniqueSvgElement(){const s=this.hostingSpan.nativeElement.getElementsByTagName("svg");return 1!==s.length?null:s[0]}validateSrc(s){if("string"!=typeof s)return!1;const h=s;if(!h.startsWith("/"))throw new Error(`Currently just support hosting inline svg ${h}`);return!0}ngOnChanges(s){if("src"in s){const h=s.src.currentValue;if(!this.validateSrc(h))return;this.src$.next(h)}if("width"in s){const h=s.width.currentValue;if("number"!=typeof h)throw new Error(`Not a number ${h}`);this.width$.next(h)}if("height"in s){const h=s.height.currentValue;if("number"!=typeof h)throw new Error(`Not a number ${h}`);this.height$.next(s.height.currentValue)}}}return r=l,(0,o.Z)(l,"\u0275fac",function(s){return new(s||r)(n.Y36(m.OE),n.Y36(a.H7))}),(0,o.Z)(l,"\u0275cmp",n.Xpm({type:r,selectors:[["app-inline-svg"]],viewQuery:function(s,h){if(1&s&&n.Gf(E,5),2&s){let F;n.iGM(F=n.CRH())&&(h.hostingSpan=F.first)}},inputs:{src:"src",fill:"fill",stroke:"stroke",height:"height",width:"width"},outputs:{error:"error"},features:[n.TTD],decls:3,vars:7,consts:[[3,"innerHTML"],["hostingSpan",""]],template:function(s,h){1&s&&(n._UZ(0,"span",0,1),n.ALo(2,"async")),2&s&&(n.Udp("fill",h.fill)("stroke",h.stroke),n.Q6J("innerHTML",n.lcZ(2,5,h.contents$),n.oJD))},dependencies:[A.Ov]})),l})()},1601:(y,P,e)=>{e.d(P,{a:()=>t});var o=e(1180),n=e(5879);let t=(()=>{var C;class d{transform(p){if(null===p)return null;const g=Math.floor(Date.now()/1e3),u=Math.floor(g-p.getTime()/1e3);if(u<-10)return null;if(u<60)return"\u305f\u3063\u305f\u4eca";const f=Math.floor(u/60);if(f<60)return`${f} \u5206\u524d`;const O=Math.floor(f/60);if(O<24)return`${O} \u6642\u9593\u524d`;const m=Math.floor(O/24);if(m<30)return`${m} \u65e5\u524d`;const a=Math.floor(m/30);if(a<12)return`${a} \u30f6\u6708\u524d`;const A=Math.floor(m/365);return A<10?`${A} \u5e74\u524d`:"\u304b\u306a\u308a\u6614"}}return C=d,(0,o.Z)(d,"\u0275fac",function(p){return new(p||C)}),(0,o.Z)(d,"\u0275pipe",n.Yjl({name:"relativeTime",type:C,pure:!1})),d})()},9240:(y,P,e)=>{e.d(P,{x:()=>m});var o=e(5861),n=e(1180),t=e(5879),C=e(7142),i=(e(752),e(553)),p=e(434),g=e(2425),u=e(6814);function f(a,A){if(1&a){const E=t.EpF();t.TgZ(0,"div",2)(1,"button",3),t._uU(2,"\u305d\u306e\u4ed6\u306e\u30ed\u30b0\u30a4\u30f3\u65b9\u6cd5"),t.qZA(),t.TgZ(3,"div",4)(4,"p"),t._uU(5,"\u4ee5\u4e0b\u306e\u30ed\u30b0\u30a4\u30f3\u6a5f\u80fd\u3092\u4f7f\u3046\u969b\u306f\u30d6\u30e9\u30a6\u30b6\u306e\u8a2d\u5b9a\u3067 "),t.TgZ(6,"b"),t._uU(7),t.qZA(),t._uU(8,"\u304b\u3089\u306e\u7b2c\u4e09\u8005\u30af\u30c3\u30ad\u30fc (Third-Party Cookie) \u3092\u53d7\u3051\u5bb9\u308c\u308b\u8a2d\u5b9a\u306b\u3057\u3066\u304f\u3060\u3055\u3044\u3002"),t.qZA(),t.TgZ(9,"p"),t._uU(10,"\u30a2\u30ab\u30a6\u30f3\u30c8\u3092\u4f5c\u3063\u3066\u3044\u306a\u3044\u5834\u5408\u306f\u81ea\u52d5\u7684\u306b\u4f5c\u6210\u3055\u308c\u307e\u3059\u3002\u5fc5\u305a "),t.TgZ(11,"a",5),t._uU(12,"[\u5229\u7528\u898f\u7d04]"),t.qZA(),t._uU(13," \u3092\u78ba\u8a8d\u3057\u3066\u304f\u3060\u3055\u3044\u3002"),t.qZA(),t.TgZ(14,"div")(15,"img",6),t.NdJ("click",function(r){t.CHM(E);const l=t.oxw();return t.KtG(l.onClickGoogleAuth(r))}),t.qZA(),t.TgZ(16,"img",7),t.NdJ("click",function(r){t.CHM(E);const l=t.oxw();return t.KtG(l.onClickTwitterAuth(r))}),t.qZA(),t.TgZ(17,"span",8),t.NdJ("click",function(r){t.CHM(E);const l=t.oxw();return t.KtG(l.onClickGithubAuth(r))}),t._UZ(18,"img",9),t._uU(19,"Sign in with Github"),t.qZA()()()()}if(2&a){const E=t.oxw();t.xp6(7),t.hij("",E.apiHostname," ")}}function O(a,A){if(1&a){const E=t.EpF();t.TgZ(0,"div")(1,"img",10),t.NdJ("click",function(r){t.CHM(E);const l=t.oxw();return t.KtG(l.onClickGoogleAuth(r))}),t.qZA(),t.TgZ(2,"img",11),t.NdJ("click",function(r){t.CHM(E);const l=t.oxw();return t.KtG(l.onClickTwitterAuth(r))}),t.qZA(),t.TgZ(3,"img",12),t.NdJ("click",function(r){t.CHM(E);const l=t.oxw();return t.KtG(l.onClickGithubAuth(r))}),t.qZA()()}}let m=(()=>{var a;class A{constructor(c,r){(0,n.Z)(this,"auth",void 0),(0,n.Z)(this,"toastr",void 0),(0,n.Z)(this,"apiHostname",i.NZ.firebaseConfig.authDomain),(0,n.Z)(this,"isTiny",!1),(0,n.Z)(this,"loginSucceeded",new t.vpe),(0,n.Z)(this,"loginFailed",new t.vpe),this.auth=c,this.toastr=r}ngOnInit(){(0,i.eM)("OauthFederationsComponent.OnInit()")}doOauth(c){var r=this;return(0,o.Z)(function*(){try{yield r.auth.signInWithPopup(c),r.loginSucceeded.next()}catch(l){r.loginFailed.next(l)}})()}onClickGoogleAuth(c){var r=this;return(0,o.Z)(function*(){c.preventDefault();const l=new C.Z.auth.GoogleAuthProvider;yield r.doOauth(l)})()}onClickTwitterAuth(c){var r=this;return(0,o.Z)(function*(){c.preventDefault();const l=new C.Z.auth.TwitterAuthProvider;yield r.doOauth(l)})()}onClickGithubAuth(c){var r=this;return(0,o.Z)(function*(){c.preventDefault();const l=new C.Z.auth.GithubAuthProvider;yield r.doOauth(l)})()}}return a=A,(0,n.Z)(A,"\u0275fac",function(c){return new(c||a)(t.Y36(p.zQ),t.Y36(g._W))}),(0,n.Z)(A,"\u0275cmp",t.Xpm({type:a,selectors:[["app-oauth-federations"]],inputs:{isTiny:"isTiny"},outputs:{loginSucceeded:"loginSucceeded",loginFailed:"loginFailed"},decls:2,vars:2,consts:[["class","row m-3",4,"ngIf"],[4,"ngIf"],[1,"row","m-3"],["type","button","data-bs-toggle","collapse","data-bs-target","#appGitfireOauthFederationsList","role","button","aria-label","Toggle other login","aria-expanded","false","aria-controls","appGitfireOauthFederationsList",1,"btn","btn-secondary","collapsed"],["id","appGitfireOauthFederationsList",1,"collapse","m-3"],["tabindex","-1","about","_blank","href","/terms.htm",1,""],["src","assets/google-login.png","alt","Google",1,"m-2","oauth-login-button","oauth-width-login-img",3,"click"],["src","assets/twitter-login.png","alt","Twitter",1,"m-2","oauth-login-button","oauth-width-login-img",3,"click"],[1,"m-2","oauth-login-button","oauth-pseudo-img",3,"click"],["src","assets/github-login.png","alt","Github",1,"m-1","oauth-circle-login-img"],["src","assets/google-login.png",1,"m-1","oauth-tiny-wide-img",3,"click"],["src","assets/twitter-login-small.png",1,"m-1","oauth-tiny-circle-img",3,"click"],["src","assets/github-login.png",1,"m-1","oauth-tiny-circle-img",3,"click"]],template:function(c,r){1&c&&(t.YNc(0,f,20,1,"div",0),t.YNc(1,O,4,0,"div",1)),2&c&&(t.Q6J("ngIf",!r.isTiny),t.xp6(1),t.Q6J("ngIf",r.isTiny))},dependencies:[u.O5],styles:[".oauth-login-button[_ngcontent-%COMP%]{cursor:pointer}.oauth-width-login-img[_ngcontent-%COMP%]{width:150px}.oauth-pseudo-img[_ngcontent-%COMP%]{border-style:ridge;border-radius:5px;padding:5px;white-space:nowrap}.oauth-circle-login-img[_ngcontent-%COMP%]{height:20px;width:20px}.oauth-tiny-wide-img[_ngcontent-%COMP%]{height:30px}.oauth-tiny-circle-img[_ngcontent-%COMP%]{width:30px}"]})),A})()},6450:(y,P,e)=>{e.d(P,{F:()=>B});var o=e(5861),n=e(1180),t=e(7142);class C{constructor(){(0,n.Z)(this,"saveNeverAsk",void 0),(0,n.Z)(this,"isConfirmed",void 0)}}var d=function(_){return _[_.Ok=0]="Ok",_[_.No=1]="No",_[_.OkPermanent=2]="OkPermanent",_}(d||{}),i=e(5879),p=e(5739),g=e(1248),u=e(553),f=e(6814),O=e(5187);function m(_,D){1&_&&i._UZ(0,"span",12)}function a(_,D){if(1&_&&(i.ynx(0),i.TgZ(1,"div",10),i._UZ(2,"div",13),i.qZA(),i.BQk()),2&_){const I=i.oxw();i.xp6(2),i.Q6J("innerHTML",I.tosJson.html,i.oJD)}}let A=(()=>{var _;class D extends g.W{constructor(){super(),(0,n.Z)(this,"confirmed",new i.vpe),(0,n.Z)(this,"inputConfirmForm",void 0),(0,n.Z)(this,"tosJson",void 0)}ngOnInit(){(0,u.eM)("TosConfirmComponent.OnInit()"),this.inputConfirmForm=new p.cw({}),this.inputConfirmForm.addControl("neverConfirmTosCheck",new p.NI(!1))}ngAfterViewInit(){(0,u.eM)("TosConfirmComponent.AfterViewInit()")}get neverCheckTosControl(){return this.inputConfirmForm.get("neverConfirmTosCheck")}onClickConfirm(M){if(M.preventDefault(),this.inputConfirmForm.markAllAsTouched(),this.inputConfirmForm.invalid)return;const v=new C,x=this.inputConfirmForm.get("neverConfirmTosCheck");v.saveNeverAsk=x.value,v.isConfirmed=!0,this.confirmed.emit(v)}}return _=D,(0,n.Z)(D,"\u0275fac",function(M){return new(M||_)}),(0,n.Z)(D,"\u0275cmp",i.Xpm({type:_,selectors:[["gitfire-tos-confirm"]],inputs:{tosJson:"tosJson"},outputs:{confirmed:"confirmed"},features:[i.qOj],decls:19,vars:6,consts:[["loadingTemplate",""],[1,"container"],[4,"ngIf","ngIfElse"],[1,"text-center"],[3,"formGroup"],[1,"m-5","custom-control","custom-checkbox"],["for","appGitfireTosConfirmNeverDismissCheck",1,"visually-hidden"],["id","appGitfireTosConfirmNeverDismissCheck","name","neverConfirmTosCheck","formControlName","neverConfirmTosCheck","type","checkbox",1,"form-check-input"],[1,"text-muted","fw-light"],["routerLink","/terms.htm"],[1,"m-3"],["id","appGitfireTosConfirmButton","data-bs-dismiss","modal",1,"btn","btn-success",3,"disabled","click"],["role","status",1,"spinner-border","text-primary"],[3,"innerHTML"]],template:function(M,v){if(1&M&&(i.YNc(0,m,1,0,"ng-template",null,0,i.W1O),i.TgZ(2,"div",1),i.YNc(3,a,3,1,"ng-container",2),i.TgZ(4,"div",3)(5,"form",4)(6,"div",5)(7,"label",6),i._uU(8,"\u518d\u5ea6\u8868\u793a\u3057\u306a\u3044"),i.qZA(),i._UZ(9,"input",7),i._uU(10,"\u518d\u5ea6\u8868\u793a\u3057\u306a\u3044"),i.qZA(),i.TgZ(11,"div",8),i._uU(12,"\u8a73\u3057\u304f\u306f"),i.TgZ(13,"a",9),i._uU(14,"[\u5229\u7528\u898f\u7d04]"),i.qZA(),i._uU(15,"\u3092\u3054\u78ba\u8a8d\u304f\u3060\u3055\u3044\u3002 "),i.qZA(),i.TgZ(16,"div",10)(17,"button",11),i.NdJ("click",function(Z){return v.onClickConfirm(Z)}),i._uU(18,"\u78ba\u8a8d\u3057\u307e\u3057\u305f"),i.qZA()()()()()),2&M){const x=i.MAs(1);i.xp6(3),i.Q6J("ngIf",v.tosJson)("ngIfElse",x),i.xp6(2),i.Q6J("formGroup",v.inputConfirmForm),i.xp6(1),i.ekj("was-validated",v.neverCheckTosControl.dirty||v.neverCheckTosControl.touched),i.xp6(11),i.Q6J("disabled",!v.inputConfirmForm.valid)}},dependencies:[f.O5,p._Y,p.Wl,p.JJ,p.JL,p.sg,p.u,O.rH]})),D})();var E=e(7319),c=e(8645),r=e(8180),l=e(4664),b=e(7398),s=e(9798),h=e(103),F=e(5579);let B=(()=>{var _;class D{constructor(M,v,x){(0,n.Z)(this,"http",void 0),(0,n.Z)(this,"dialog",void 0),(0,n.Z)(this,"store",void 0),(0,n.Z)(this,"privUser",void 0),this.http=M,this.dialog=v,this.store=x,this.privUser=this.store.collection("/users/v1/protected")}constructSetupTosConfirm(M,v){return x=>{x.tosJson=v.json,x.confirmed.subscribe(Z=>{if(!Z.isConfirmed)throw new Error("assert");v.answer=Z.saveNeverAsk?d.OkPermanent:d.Ok,M.next(v)})}}confirmTos$(M,v){var x=this;if(M.match(/\/$/))throw new Error(`Assertion. Not a supported ${M}`);const Z=new c.x,L=(new c.x,new c.x),S=new c.x,W=this.http.fetchGhJson(v).pipe((0,r.q)(1),(0,l.w)(T=>{const U=this.privUser.doc(`${M}/${T.version}`),w={json:T,cached:!1,cacheRef:U};return U.get().pipe((0,b.U)(($,R)=>($.exists&&$.data().alwaysConfirmed&&((0,u.eM)("TOS has already been confirmed."),w.cached=!0),w)))}));return S.pipe().subscribe({next:T=>{this.dialog.createDefaultBuilder().prepareBody(A).setupChild(this.constructSetupTosConfirm(L,T)).setType(E.iR.Warn).setSize(E.PW.Default).setTitle("\u5229\u7528\u898f\u7d04\u306e\u78ba\u8a8d").closeButton(()=>{T.answer=d.No,L.next(T)}).setFinalize(()=>{T.answer=d.No,L.next(T)}).open()},complete:()=>{(0,u.eM)("completeed dialog$")},error:T=>{(0,u.wb)("error dialog$",T)}}),W.pipe((0,r.q)(1)).subscribe({next:T=>{T.cached?Z.next(!0):S.next(T)},complete:()=>{(0,u.eM)("Completed TOS reading")},error:T=>{(0,u.wb)("Failed reading TOS cache")}}),L.pipe((0,r.q)(1)).subscribe({next:(T=(0,o.Z)(function*(U){switch(U.answer){case d.Ok:Z.next(!0);break;case d.No:Z.next(!1);break;case d.OkPermanent:const w={_docClass:"User:UserAgreementStore",alwaysConfirmed:!0,createdAt:x.fieldTimestamp()};Z.next(!0),yield U.cacheRef.set(w);break;default:throw new Error(`Not a valid answer ${U.answer}`)}}),function(w){return T.apply(this,arguments)}),complete:()=>{(0,u.eM)("Completed dialog result."),Z.complete()},error:T=>{(0,u.wb)("Failed receive dialog result"),Z.complete()}}),Z;var T}fieldTimestamp(){return t.Z.firestore.FieldValue.serverTimestamp()}}return _=D,(0,n.Z)(D,"\u0275fac",function(M){return new(M||_)(i.LFG(s.OE),i.LFG(h.xA),i.LFG(F.ST))}),(0,n.Z)(D,"\u0275prov",i.Yz7({token:_,factory:_.\u0275fac,providedIn:"root"})),D})()},7910:(y,P,e)=>{e.d(P,{K:()=>g});var o=e(1180),n=e(2096),t=e(7081),C=e(7398),d=e(5879),i=e(5579),p=e(9782);let g=(()=>{var u;class f{constructor(m,a){(0,o.Z)(this,"store",void 0),(0,o.Z)(this,"auth",void 0),(0,o.Z)(this,"pubUser",void 0),(0,o.Z)(this,"nicknameCache",{}),(0,o.Z)(this,"userCache",{}),this.store=m,this.auth=a,this.pubUser=this.store.collection("/users/v1/public")}myNickname$(){return this.auth.myUid?this.nickname$(this.auth.myUid):(0,n.of)("")}user$(m){let a=this.userCache[m];return a||(a=this.pubUser.doc(m).valueChanges().pipe((0,t.d)(1)),this.userCache[m]=a,a)}nickname$(m){let a=this.nicknameCache[m];return a||(a=this.user$(m).pipe((0,C.U)(A=>A?A.nickname:null)),this.nicknameCache[m]=a,a)}}return u=f,(0,o.Z)(f,"\u0275fac",function(m){return new(m||u)(d.LFG(i.ST),d.LFG(p.e))}),(0,o.Z)(f,"\u0275prov",d.Yz7({token:u,factory:u.\u0275fac,providedIn:"root"})),f})()},3429:(y,P,e)=>{e.d(P,{a:()=>p});var o=e(1180),n=e(5879),t=e(6814);function C(g,u){1&g&&(n.TgZ(0,"span",2),n._uU(1,"[\u524a\u9664]"),n.qZA())}function d(g,u){1&g&&n._UZ(0,"img",5),2&g&&n.s9C("src",u.$implicit,n.LSH)}function i(g,u){if(1&g&&(n.TgZ(0,"span",3),n.YNc(1,d,1,1,"img",4),n._uU(2),n.qZA()),2&g){const f=u.$implicit;n.s9C("title",f.about),n.xp6(1),n.Q6J("ngIf",f.photoURL),n.xp6(1),n.Oqu(f.nickname)}}let p=(()=>{var g;class u{constructor(){(0,o.Z)(this,"userPublic",void 0)}}return g=u,(0,o.Z)(u,"\u0275fac",function(O){return new(O||g)}),(0,o.Z)(u,"\u0275cmp",n.Xpm({type:g,selectors:[["gitfire-user-box"]],inputs:{userPublic:"userPublic"},decls:3,vars:2,consts:[["voidUser",""],["class","p-1",3,"title",4,"ngIf","ngIfElse"],["title","\u524a\u9664\u3055\u308c\u305f\u30e6\u30fc\u30b6\u3067\u3059",1,"text-warning"],[1,"p-1",3,"title"],["class","p-1","style","height: 100%; width: 2rem;",3,"src",4,"ngIf"],[1,"p-1",2,"height","100%","width","2rem",3,"src"]],template:function(O,m){if(1&O&&(n.YNc(0,C,2,0,"ng-template",null,0,n.W1O),n.YNc(2,i,3,3,"span",1)),2&O){const a=n.MAs(1);n.xp6(2),n.Q6J("ngIf",m.userPublic)("ngIfElse",a)}},dependencies:[t.O5]})),u})()},752:(y,P,e)=>{e(3560),e(9058),e(6122),e(7879),e(4537)}}]);