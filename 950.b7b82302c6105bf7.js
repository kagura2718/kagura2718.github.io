"use strict";(self.webpackChunkKaguraGithubPages=self.webpackChunkKaguraGithubPages||[]).push([[950],{3950:(Gt,h,a)=>{a.r(h),a.d(h,{CommentEntryComponent:()=>Kt});var p=a(5861),r=a(1180),w=a(7081),m=a(553),t=a(5879),C=a(9782),F=a(9339),v=a(2413),E=a(5579),f=a(2425),g=a(6814),x=a(103),y=a(7319),D=a(9773),B=a(4664),Z=a(7398),k=a(8645),A=a(2096),I=a(7910),M=a(3429),l=a(5739),L=a(2181),J=a(6450);function b(e,s){if(1&e){const n=t.EpF();t.TgZ(0,"div",9)(1,"button",10),t.NdJ("click",function(){t.CHM(n);const i=t.oxw();return t.KtG(i.onClickDismiss())}),t.TgZ(2,"span",11),t._uU(3,"\xd7"),t.qZA()()()}}function N(e,s){1&e&&(t.TgZ(0,"div",12),t._uU(1,"OK!"),t.qZA())}function U(e,s){1&e&&(t.TgZ(0,"div",14),t._uU(1,"\u5165\u529b\u5fc5\u9808\u3067\u3059\u3002"),t.qZA())}function Q(e,s){1&e&&(t.TgZ(0,"div",14),t._uU(1,"\u9577\u3059\u304e\u307e\u3059\u3002"),t.qZA())}function $(e,s){1&e&&(t.TgZ(0,"div",14),t._uU(1,"\u77ed\u3059\u304e\u307e\u3059\u3002"),t.qZA())}function Y(e,s){if(1&e&&(t.ynx(0),t.YNc(1,U,2,0,"div",13),t.YNc(2,Q,2,0,"div",13),t.YNc(3,$,2,0,"div",13),t.BQk()),2&e){const n=t.oxw();t.xp6(1),t.Q6J("ngIf",null==n.textareaControl.errors?null:n.textareaControl.errors.required),t.xp6(1),t.Q6J("ngIf",null==n.textareaControl.errors?null:n.textareaControl.errors.maxlength),t.xp6(1),t.Q6J("ngIf",null==n.textareaControl.errors?null:n.textareaControl.errors.minlength)}}let T=(()=>{var e;class s{constructor(o,i,u,c,_){(0,r.Z)(this,"user",void 0),(0,r.Z)(this,"auth",void 0),(0,r.Z)(this,"toastr",void 0),(0,r.Z)(this,"funcs",void 0),(0,r.Z)(this,"tos",void 0),(0,r.Z)(this,"editModel",void 0),(0,r.Z)(this,"pageId",void 0),(0,r.Z)(this,"showDismiss",!1),(0,r.Z)(this,"replyId",void 0),(0,r.Z)(this,"requestSent",new t.vpe),(0,r.Z)(this,"editDismiss",new t.vpe),(0,r.Z)(this,"inputForm",void 0),this.user=o,this.auth=i,this.toastr=u,this.funcs=c,this.tos=_}get textareaControl(){return this.inputForm.get("commentText")}ngOnInit(){(0,m.eM)("CommentEditorComponent.OnInit()"),this.inputForm=new l.cw({}),this.inputForm.addControl("commentText",new l.NI(this.editModel?this.editModel.message:null,[l.kI.required]))}onClickDismiss(){(0,m.eM)("CommentEditorComponent.onClickDismiss()"),this.editDismiss.emit()}doNewPost(){var o=this;return(0,p.Z)(function*(){const i={message:o.textareaControl.value,pageId:o.pageId,replyId:o.replyId};return yield o.funcs.call("postComment",i)})()}doUpdatePost(o){var i=this;return(0,p.Z)(function*(){const u={pageId:i.pageId,commentId:o.id,message:i.textareaControl.value};return yield i.funcs.call("editComment",u)})()}onClickPostComment(){var o=this;(0,m.eM)("CommentEditorComponent.onClickPostComment()"),!this.inputForm.invalid&&(this.textareaControl.invalid||this.tos.confirmTos$(`${this.auth.myUid}/commentAgreement`,m.NZ.CommentServiceTosUrl).pipe((0,L.h)(i=>i)).subscribe(function(){var i=(0,p.Z)(function*(u){o.inputForm.disable();try{o.editModel?yield o.doUpdatePost(o.editModel):yield o.doNewPost(),o.toastr.info("\u6295\u7a3f\u3057\u307e\u3057\u305f\u3002(\u627f\u8a8d\u3055\u308c\u308b\u307e\u3067\u4ed6\u306e\u4eba\u306b\u306f\u8868\u793a\u3055\u308c\u307e\u305b\u3093\u3002)"),o.textareaControl.setValue(""),o.inputForm.markAsPristine(),o.inputForm.markAsUntouched(),o.requestSent.emit()}catch(c){o.toastr.error("message"in c?`\u6295\u7a3f\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002( ${c.message} )`:"\u6295\u7a3f\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002")}finally{o.inputForm.enable()}});return function(u){return i.apply(this,arguments)}}()))}}return e=s,(0,r.Z)(s,"\u0275fac",function(o){return new(o||e)(t.Y36(I.K),t.Y36(C.e),t.Y36(f._W),t.Y36(v.c),t.Y36(J.F))}),(0,r.Z)(s,"\u0275cmp",t.Xpm({type:e,selectors:[["gitfire-comment-editor"]],inputs:{editModel:"editModel",pageId:"pageId",showDismiss:"showDismiss",replyId:"replyId"},outputs:{requestSent:"requestSent",editDismiss:"editDismiss"},decls:16,vars:14,consts:[["class","text-end",4,"ngIf"],[1,"input-group",3,"formGroup"],["title","\u3053\u306e\u540d\u524d\u3067\u6295\u7a3f\u306f\u8868\u793a\u3055\u308c\u307e\u3059\u3002","src","/assets/octicons/question.svg",1,"m-1","octicon-info","help-icon"],["disabled","",1,"m-3",3,"value"],[1,"m-3"],["autofocus","","name","commentText","formControlName","commentText","placeholder","\u6295\u7a3f\u3059\u308b\u30b3\u30e1\u30f3\u30c8\u3092\u3053\u3053\u306b\u66f8\u3044\u3066\u304f\u3060\u3055\u3044\u3002","required","","minlength","5","maxlength","65536",1,"p-3","form-control"],["class","valid-feedback",4,"ngIf"],[4,"ngIf"],["title","\u30b3\u30e1\u30f3\u30c8\u5185\u5bb9\u306f\u627f\u8a8d\u5f8c\u306b\u8868\u793a\u3055\u308c\u307e\u3059\u3002",1,"btn","btn-primary","m-2",3,"disabled","click"],[1,"text-end"],["type","button","aria-label","Close",1,"btn-close",3,"click"],["aria-hidden","true"],[1,"valid-feedback"],["class","invalid-feedback",4,"ngIf"],[1,"invalid-feedback"]],template:function(o,i){1&o&&(t.YNc(0,b,4,0,"div",0),t.TgZ(1,"div",1)(2,"div")(3,"label"),t._uU(4,"\u540d\u524d"),t._UZ(5,"img",2),t._uU(6,": "),t.qZA(),t._UZ(7,"input",3),t.ALo(8,"async"),t.qZA(),t.TgZ(9,"div",4),t._UZ(10,"textarea",5),t.YNc(11,N,2,0,"div",6),t.YNc(12,Y,4,3,"ng-container",7),t.qZA(),t.TgZ(13,"div")(14,"button",8),t.NdJ("click",function(){return i.onClickPostComment()}),t._uU(15,"\u6295\u7a3f\u3059\u308b"),t.qZA()()()),2&o&&(t.Q6J("ngIf",i.showDismiss),t.xp6(1),t.ekj("was-validated",i.textareaControl.dirty||i.textareaControl.touched),t.Q6J("formGroup",i.inputForm),t.xp6(6),t.s9C("value",t.lcZ(8,12,i.user.myNickname$())),t.xp6(2),t.Udp("width",100,"%"),t.xp6(1),t.Udp("height",8,"rem"),t.xp6(1),t.Q6J("ngIf",!i.textareaControl.invalid),t.xp6(1),t.Q6J("ngIf",i.textareaControl.invalid),t.xp6(2),t.Q6J("disabled",i.textareaControl.invalid||i.inputForm.disabled))},dependencies:[g.O5,l.Fj,l.JJ,l.JL,l.Q7,l.wO,l.nD,l.sg,l.u,g.Ov]})),s})();function P(e,s){1&e&&t._UZ(0,"span",2)}function q(e,s){if(1&e&&(t.TgZ(0,"span",20)(1,"small",6),t.ALo(2,"date"),t._uU(3),t.ALo(4,"date"),t.qZA()()),2&e){const n=t.oxw().$implicit;t.xp6(1),t.s9C("title",t.xi3(2,2,n.updatedAt,"yyyy-MM-dd HH:mm")),t.xp6(2),t.hij("\u66f4\u65b0\u65e5: ",t.xi3(4,5,n.updatedAt,"yyyy-MM-dd"),"")}}function H(e,s){if(1&e&&(t.TgZ(0,"span",20)(1,"small"),t._uU(2),t.ALo(3,"date"),t.qZA()()),2&e){const n=t.oxw().$implicit;t.xp6(2),t.hij("\u627f\u8a8d\u65e5: ",t.xi3(3,1,n.decisionAt,"yyyy-MM-dd"),"")}}function S(e,s){if(1&e){const n=t.EpF();t.TgZ(0,"a",32),t.NdJ("click",function(i){t.CHM(n);const u=t.oxw(2).$implicit,c=t.oxw(2);return t.KtG(c.onClickApprove(i,u))}),t._uU(1,"\u627f\u8a8d"),t.qZA()}}function R(e,s){if(1&e){const n=t.EpF();t.TgZ(0,"a",33),t.NdJ("click",function(i){t.CHM(n);const u=t.oxw(2).$implicit,c=t.oxw(2);return t.KtG(c.onClickApprove(i,u))}),t._uU(1,"\u7de8\u96c6\u627f\u8a8d"),t.qZA()}}function O(e,s){if(1&e){const n=t.EpF();t.TgZ(0,"a",34),t.NdJ("click",function(i){t.CHM(n);const u=t.oxw(2).$implicit,c=t.oxw(2);return t.KtG(c.onClickApprove(i,u))}),t._uU(1,"\u524a\u9664\u627f\u8a8d"),t.qZA()}}function K(e,s){if(1&e){const n=t.EpF();t.TgZ(0,"a",35),t.NdJ("click",function(i){t.CHM(n);const u=t.oxw(2).$implicit,c=t.oxw(2);return t.KtG(c.onClickReject(i,u))}),t._uU(1,"\u62d2\u5426"),t.qZA()}}function G(e,s){if(1&e){const n=t.EpF();t.TgZ(0,"a",36),t.NdJ("click",function(i){t.CHM(n);const u=t.oxw(2).$implicit,c=t.oxw(2);return t.KtG(c.onClickReject(i,u))}),t._uU(1,"\u7de8\u96c6\u62d2\u5426"),t.qZA()}}function j(e,s){if(1&e){const n=t.EpF();t.TgZ(0,"a",37),t.NdJ("click",function(i){t.CHM(n);const u=t.oxw(2).$implicit,c=t.oxw(2);return t.KtG(c.onClickReject(i,u))}),t._uU(1,"\u7de8\u96c6\u62d2\u5426"),t.qZA()}}function W(e,s){if(1&e){const n=t.EpF();t.TgZ(0,"a",38),t.NdJ("click",function(i){t.CHM(n);const u=t.oxw(2).$implicit,c=t.oxw(2);return t.KtG(c.onClickProtect(i,u))}),t._uU(1,"\u4fdd\u8b77"),t.qZA()}}function X(e,s){if(1&e){const n=t.EpF();t.TgZ(0,"a",39),t.NdJ("click",function(i){t.CHM(n);const u=t.oxw(2).$implicit,c=t.oxw(2);return t.KtG(c.onClickUnProtect(i,u))}),t._uU(1,"\u4fdd\u8b77\u89e3\u9664"),t.qZA()}}function V(e,s){if(1&e&&(t.TgZ(0,"span",21)(1,"span",22),t._uU(2,"\ufe19"),t.qZA(),t.TgZ(3,"div",23),t.YNc(4,S,2,0,"a",24),t.YNc(5,R,2,0,"a",25),t.YNc(6,O,2,0,"a",26),t.YNc(7,K,2,0,"a",27),t.YNc(8,G,2,0,"a",28),t.YNc(9,j,2,0,"a",29),t.YNc(10,W,2,0,"a",30),t.YNc(11,X,2,0,"a",31),t.qZA()()),2&e){const n=t.oxw().$implicit;t.xp6(4),t.Q6J("ngIf","pending"===n.store.state),t.xp6(1),t.Q6J("ngIf","approved"===n.store.state&&"edit-request"===n.store.editedState),t.xp6(1),t.Q6J("ngIf","approved"===n.store.state&&"delete-request"===n.store.editedState),t.xp6(1),t.Q6J("ngIf","pending"===n.store.state),t.xp6(1),t.Q6J("ngIf","approved"===n.store.state&&"edit-request"===n.store.editedState),t.xp6(1),t.Q6J("ngIf","approved"===n.store.state&&"delete-request"===n.store.editedState),t.xp6(1),t.Q6J("ngIf","approved"===n.store.state&&!n.store.isAdminEdit),t.xp6(1),t.Q6J("ngIf","approved"===n.store.state&&n.store.isAdminEdit)}}function z(e,s){1&e&&t._UZ(0,"gitfire-user-box",40),2&e&&t.Q6J("userPublic",s.$implicit)}function tt(e,s){1&e&&(t.TgZ(0,"span",41),t._uU(1,"\u7ba1\u7406\u4eba\u306b\u3088\u308b\u4fdd\u8b77"),t.qZA())}function et(e,s){1&e&&(t.TgZ(0,"span",42),t._uU(1,"\u5374\u4e0b\u3055\u308c\u305f\u30b3\u30e1\u30f3\u30c8\u3067\u3059\u3002"),t.qZA())}function nt(e,s){1&e&&(t.TgZ(0,"span",43),t._uU(1,"\u627f\u8a8d\u5f85\u3061\u306e\u30b3\u30e1\u30f3\u30c8\u3067\u3059\u3002"),t.qZA())}function it(e,s){1&e&&(t.TgZ(0,"span",43),t._uU(1,"\u524a\u9664\u3055\u308c\u307e\u3057\u305f\u3002"),t.qZA())}function ot(e,s){1&e&&(t.TgZ(0,"span",42),t._uU(1,"\u7de8\u96c6\u7533\u8acb\u304c\u5374\u4e0b\u3055\u308c\u307e\u3057\u305f\u3002"),t.qZA())}function ut(e,s){1&e&&(t.TgZ(0,"span",42),t._uU(1,"\u524a\u9664\u7533\u8acb\u304c\u5374\u4e0b\u3055\u308c\u307e\u3057\u305f\u3002"),t.qZA())}function st(e,s){1&e&&(t.TgZ(0,"span",42),t._uU(1,"\u524a\u9664\u7533\u8acb\u4e2d\u3067\u3059\u3002"),t.qZA())}function ct(e,s){1&e&&(t.TgZ(0,"span",43),t._uU(1,"\u7de8\u96c6\u7533\u8acb\u4e2d\u3067\u3059\u3002"),t.qZA())}function rt(e,s){if(1&e&&(t.ynx(0)(1,13),t.YNc(2,ot,2,0,"span",14),t.YNc(3,ut,2,0,"span",14),t.YNc(4,st,2,0,"span",14),t.YNc(5,ct,2,0,"span",15),t.BQk()()),2&e){const n=t.oxw().$implicit;t.xp6(1),t.Q6J("ngSwitch",n.store.editedState),t.xp6(1),t.Q6J("ngSwitchCase","edit-rejected"),t.xp6(1),t.Q6J("ngSwitchCase","delete-rejected"),t.xp6(1),t.Q6J("ngSwitchCase","delete-request"),t.xp6(1),t.Q6J("ngSwitchCase","edit-request")}}function mt(e,s){if(1&e){const n=t.EpF();t.ynx(0),t.TgZ(1,"gitfire-comment-editor",45),t.NdJ("requestSent",function(){t.CHM(n);const i=t.oxw(3).$implicit,u=t.oxw(2);return t.KtG(u.onEditRequested(i))})("editDismiss",function(){t.CHM(n);const i=t.oxw(3).$implicit,u=t.oxw(2);return t.KtG(u.onEditDismissed(i))}),t.qZA(),t.BQk()}if(2&e){const n=s.$implicit,o=t.oxw(5);t.xp6(1),t.Q6J("pageId",o.pageId)("editModel",n)("showDismiss",!0)}}function _t(e,s){if(1&e&&(t.ynx(0),t.YNc(1,mt,2,3,"ng-container",1),t.ALo(2,"async"),t.BQk()),2&e){const n=t.oxw(2).$implicit;t.xp6(1),t.Q6J("ngIf",t.lcZ(2,1,n.editor$))}}function at(e,s){if(1&e&&t._UZ(0,"div",46),2&e){const n=t.oxw(2).$implicit;t.Q6J("innerHTML",n.store.messageHtml,t.oJD)}}function dt(e,s){if(1&e&&(t.TgZ(0,"div"),t.YNc(1,_t,3,3,"ng-container",1),t.YNc(2,at,1,1,"div",44),t.qZA()),2&e){const n=t.oxw().$implicit;t.xp6(1),t.Q6J("ngIf",n.isEditing),t.xp6(1),t.Q6J("ngIf","approved"===n.store.state&&!n.isEditing)}}function pt(e,s){if(1&e&&t._UZ(0,"div",46),2&e){const n=t.oxw(2).$implicit;t.Q6J("innerHTML",n.store.messageHtml,t.oJD)}}function lt(e,s){if(1&e&&(t.ynx(0),t.YNc(1,pt,1,1,"div",44),t.BQk()),2&e){const n=t.oxw().$implicit;t.xp6(1),t.Q6J("ngIf","approved"===n.store.state)}}function gt(e,s){1&e&&t._UZ(0,"span",2)}function Ct(e,s){1&e&&t._UZ(0,"div",53),2&e&&t.Q6J("innerHTML",s.$implicit.messageHtml,t.oJD)}function vt(e,s){if(1&e&&(t.TgZ(0,"div",51)(1,"span",43),t._uU(2,"\u7533\u8acb\u4e2d\u306e\u30e1\u30c3\u30bb\u30fc\u30b8"),t.qZA(),t.YNc(3,Ct,1,1,"div",52),t.ALo(4,"async"),t.qZA()),2&e){t.oxw();const n=t.MAs(2),o=t.oxw().$implicit;t.xp6(3),t.Q6J("ngIf",t.lcZ(4,2,o.privateMessage$))("ngIfElse",n)}}function ft(e,s){1&e&&t._UZ(0,"div",53),2&e&&t.Q6J("innerHTML",s.$implicit.messageHtml,t.oJD)}function xt(e,s){if(1&e&&(t.TgZ(0,"div",54)(1,"span",42),t._uU(2,"\u5374\u4e0b\u3055\u308c\u305f\u30e1\u30c3\u30bb\u30fc\u30b8"),t.qZA(),t.YNc(3,ft,1,1,"div",52),t.ALo(4,"async"),t.qZA()),2&e){t.oxw();const n=t.MAs(2),o=t.oxw().$implicit;t.xp6(3),t.Q6J("ngIf",t.lcZ(4,2,o.privateMessage$))("ngIfElse",n)}}function ht(e,s){1&e&&t._UZ(0,"div",53),2&e&&t.Q6J("innerHTML",s.$implicit.messageHtml,t.oJD)}function Et(e,s){if(1&e&&(t.TgZ(0,"div",51)(1,"span",43),t._uU(2,"\u7de8\u96c6\u7533\u8acb\u4e2d\u306e\u30e1\u30c3\u30bb\u30fc\u30b8"),t.qZA(),t.YNc(3,ht,1,1,"div",52),t.ALo(4,"async"),t.qZA()),2&e){t.oxw(2);const n=t.MAs(2),o=t.oxw().$implicit;t.xp6(3),t.Q6J("ngIf",t.lcZ(4,2,o.privateMessage$))("ngIfElse",n)}}function Zt(e,s){1&e&&t._UZ(0,"div",53),2&e&&t.Q6J("innerHTML",s.$implicit.messageHtml,t.oJD)}function At(e,s){if(1&e&&(t.TgZ(0,"div",54)(1,"span",42),t._uU(2,"\u7de8\u96c6\u7533\u8acb\u304c\u5374\u4e0b\u3055\u308c\u305f\u30e1\u30c3\u30bb\u30fc\u30b8"),t.qZA(),t.YNc(3,Zt,1,1,"div",52),t.ALo(4,"async"),t.qZA()),2&e){t.oxw(2);const n=t.MAs(2),o=t.oxw().$implicit;t.xp6(3),t.Q6J("ngIf",t.lcZ(4,2,o.privateMessage$))("ngIfElse",n)}}function It(e,s){if(1&e&&(t.TgZ(0,"div"),t.YNc(1,Et,5,4,"div",49),t.YNc(2,At,5,4,"div",50),t.qZA()),2&e){const n=t.oxw(2).$implicit;t.xp6(1),t.Q6J("ngIf","edit-request"===n.store.editedState),t.xp6(1),t.Q6J("ngIf","edit-rejected"===n.store.editedState)}}function Tt(e,s){if(1&e&&(t.TgZ(0,"div",47),t.YNc(1,gt,1,0,"ng-template",null,48,t.W1O),t.YNc(3,vt,5,4,"div",49),t.YNc(4,xt,5,4,"div",50),t.YNc(5,It,3,2,"div",1),t.qZA()),2&e){const n=t.oxw().$implicit;t.xp6(3),t.Q6J("ngIf","pending"===n.store.state),t.xp6(1),t.Q6J("ngIf","rejected"===n.store.state),t.xp6(1),t.Q6J("ngIf","approved"===n.store.state)}}function wt(e,s){if(1&e){const n=t.EpF();t.ynx(0),t.TgZ(1,"button",55),t.NdJ("click",function(i){t.CHM(n);const u=t.oxw().$implicit,c=t.oxw(2);return t.KtG(c.onClickReply(i,u))}),t._uU(2,"\u8fd4\u4fe1"),t.qZA(),t.BQk()}}function Ft(e,s){if(1&e){const n=t.EpF();t.ynx(0),t.TgZ(1,"button",56),t.NdJ("click",function(i){t.CHM(n);const u=t.oxw().$implicit,c=t.oxw(2);return t.KtG(c.onClickDelete(i,u))}),t._uU(2,"\u524a\u9664"),t.qZA(),t.TgZ(3,"button",57),t.NdJ("click",function(i){t.CHM(n);const u=t.oxw().$implicit,c=t.oxw(2);return t.KtG(c.onClickEdit(i,u))}),t._uU(4,"\u7de8\u96c6"),t.qZA(),t.BQk()}}function yt(e,s){if(1&e){const n=t.EpF();t.TgZ(0,"div",18)(1,"gitfire-comment-editor",58),t.NdJ("requestSent",function(){t.CHM(n);const i=t.oxw().$implicit,u=t.oxw(2);return t.KtG(u.onReplyRequested(i))})("editDismiss",function(){t.CHM(n);const i=t.oxw().$implicit,u=t.oxw(2);return t.KtG(u.onReplyDismissed(i))}),t.qZA()()}if(2&e){const n=t.oxw().$implicit,o=t.oxw(2);t.xp6(1),t.Q6J("showDismiss",!0)("replyId",n.store.id)("pageId",o.pageId)}}function Dt(e,s){if(1&e&&(t.TgZ(0,"div",5)(1,"div")(2,"div")(3,"span",6),t.ALo(4,"date"),t._uU(5),t.ALo(6,"date"),t.qZA(),t.YNc(7,q,5,8,"span",7),t.YNc(8,H,4,4,"span",7),t.YNc(9,V,12,8,"span",8),t.qZA(),t.TgZ(10,"div",9),t._uU(11,"\u30e6\u30fc\u30b6: "),t.YNc(12,z,1,1,"gitfire-user-box",10),t.ALo(13,"async"),t.qZA()(),t.TgZ(14,"div",11)(15,"div"),t.YNc(16,tt,2,0,"span",12),t.ynx(17,13),t.YNc(18,et,2,0,"span",14),t.YNc(19,nt,2,0,"span",15),t.YNc(20,it,2,0,"span",15),t.YNc(21,rt,6,5,"ng-container",16),t.BQk(),t.qZA(),t.TgZ(22,"div"),t.YNc(23,dt,3,2,"div",1),t.YNc(24,lt,2,1,"ng-container",1),t.qZA(),t.YNc(25,Tt,6,3,"div",17),t.qZA(),t.TgZ(26,"div",18),t.YNc(27,wt,3,0,"ng-container",1),t.YNc(28,Ft,5,0,"ng-container",1),t.qZA(),t.YNc(29,yt,2,3,"div",19),t.qZA()),2&e){const n=s.$implicit,o=s.odd,i=t.oxw(2);t.Udp("background",o?i.ACCENT_COLOR:null),t.MGl("id","appGitfireComment-",n.store.id,""),t.xp6(3),t.s9C("title",t.xi3(4,21,n.publishAt,"yyyy-MM-dd HH:mm")),t.xp6(2),t.hij("\u6295\u7a3f\u65e5\u6642: ",t.xi3(6,24,n.publishAt,"yyyy-MM-dd HH:mm"),""),t.xp6(2),t.Q6J("ngIf",n.isEdited),t.xp6(1),t.Q6J("ngIf",n.decisionAt),t.xp6(1),t.Q6J("ngIf",n.isDisplayAdmin),t.xp6(3),t.Q6J("ngIf",t.lcZ(13,27,n.user$)),t.xp6(4),t.Q6J("ngIf",n.store.isAdminEdit),t.xp6(1),t.Q6J("ngSwitch",n.store.state),t.xp6(1),t.Q6J("ngSwitchCase","rejected"),t.xp6(1),t.Q6J("ngSwitchCase","pending"),t.xp6(1),t.Q6J("ngSwitchCase","deleted"),t.xp6(1),t.Q6J("ngSwitchCase","approved"),t.xp6(2),t.Q6J("ngIf",n.isOwn),t.xp6(1),t.Q6J("ngIf",!n.isOwn),t.xp6(1),t.Q6J("ngIf",n.isOwn||n.isDisplayAdmin),t.xp6(2),t.Q6J("ngIf",n.canReply),t.xp6(1),t.Q6J("ngIf",n.canChange),t.xp6(1),t.Q6J("ngIf",n.isReplying)}}function Bt(e,s){if(1&e){const n=t.EpF();t.TgZ(0,"button",59),t.NdJ("click",function(i){t.CHM(n);const u=t.oxw(2);return t.KtG(u.onClickMoreComment(i))}),t._uU(1,"\u3055\u3089\u306b\u8aad\u307f\u8fbc\u3080"),t.qZA()}}function kt(e,s){if(1&e&&(t.TgZ(0,"div"),t.YNc(1,Dt,30,29,"div",3),t.YNc(2,Bt,2,0,"button",4),t.qZA()),2&e){const n=t.oxw();t.xp6(1),t.Q6J("ngForOf",n.comments),t.xp6(1),t.Q6J("ngIf",n.maybeMoreComment)}}class Mt{constructor(){(0,r.Z)(this,"store",void 0),(0,r.Z)(this,"updatedAt",void 0),(0,r.Z)(this,"publishAt",void 0),(0,r.Z)(this,"decisionAt",void 0),(0,r.Z)(this,"isEdited",void 0),(0,r.Z)(this,"privateMessage$",void 0),(0,r.Z)(this,"editor$",void 0),(0,r.Z)(this,"user$",void 0),(0,r.Z)(this,"isEditing",void 0),(0,r.Z)(this,"isReplying",void 0),(0,r.Z)(this,"isDisplayAdmin",void 0),(0,r.Z)(this,"canReply",void 0),(0,r.Z)(this,"canChange",void 0),(0,r.Z)(this,"isOwn",void 0)}}let Lt=(()=>{var e;class s{constructor(o,i,u,c,_,d){(0,r.Z)(this,"auth",void 0),(0,r.Z)(this,"user",void 0),(0,r.Z)(this,"dialog",void 0),(0,r.Z)(this,"store",void 0),(0,r.Z)(this,"funcs",void 0),(0,r.Z)(this,"toastr",void 0),(0,r.Z)(this,"ACCENT_COLOR",m.NZ.themaColor.EVEN),(0,r.Z)(this,"destroy$",new k.x),(0,r.Z)(this,"pageId",void 0),(0,r.Z)(this,"isPageProtect",!1),(0,r.Z)(this,"comments$",void 0),(0,r.Z)(this,"comments",[]),(0,r.Z)(this,"commentData",{}),(0,r.Z)(this,"maybeMoreComment",!1),(0,r.Z)(this,"isLoading",!0),this.auth=o,this.user=i,this.dialog=u,this.store=c,this.funcs=_,this.toastr=d}ngOnDestroy(){(0,m.eM)("CommentListComponent.OnDestroy()"),this.destroy$.next()}ngOnInit(){(0,m.eM)("CommentListComponent.OnInit()"),this.comments$=this.store.doc(`/comment/v1/page/${this.pageId}`).collection("public",o=>o.orderBy("publishAt","desc").limit(30)).valueChanges({idField:"id"}),this.comments$.pipe((0,D.R)(this.destroy$)).subscribe(o=>{for(let i of o){let u=this.commentData[i.id];u||(u=new Mt,this.comments.push(u)),u.publishAt=i.publishAt.toDate(),u.updatedAt=i.updatedAt.toDate();const c=u.updatedAt.getTime()-u.publishAt.getTime();u.isEdited="none"!==i.editedState&&Math.abs(c)>5,i.decisionAt&&(u.decisionAt=i.decisionAt.toDate()),u.user$=this.user.user$(i.owner),u.store=i,this.auth.myUid===i.owner||this.auth.isAdmin?u.privateMessage$||(u.privateMessage$=(0,A.of)({pageId:this.pageId,commentId:i.id}).pipe((0,B.w)(d=>this.funcs.call("readPrivateComment",d)),(0,Z.U)(d=>d)),u.editor$=u.privateMessage$.pipe((0,Z.U)(d=>({id:d.id,message:d.message,images:d.images})))):u.editor$=(0,A.of)({id:i.id,message:i.message,images:i.images}),u.isDisplayAdmin=this.auth.isAdmin,u.isOwn=i.owner===this.auth.myUid,u.canReply=!this.isPageProtect&&!u.isOwn&&"approved"==i.state&&!i.isProtect,u.canChange=u.isOwn&&!i.isAdminEdit&&!i.isProtect&&"approved"===i.state,this.commentData[i.id]=u}this.comments=this.comments.sort((i,u)=>u.publishAt.getTime()-i.publishAt.getTime()),this.isLoading=!1})}onClickEdit(o,i){(0,m.eM)("CommentListComponent.onClickEdit()"),i.isEditing=!0}doDeleteRequest(o){var i=this;return(0,p.Z)(function*(){const u={pageId:i.pageId,commentId:o.store.id};try{yield i.funcs.call("deleteComment",u),i.toastr.info("\u524a\u9664\u7533\u8acb\u3057\u307e\u3057\u305f\u3002\u627f\u8a8d\u5f8c\u306b\u524a\u9664\u3055\u308c\u307e\u3059\u3002")}catch(c){(0,m.wb)("Error while delete request",c);const _=c instanceof Error?c.message:"Unknown error";i.toastr.error(`\u524a\u9664\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002 ( ${_} )`)}})()}onClickDelete(o,i){var u=this;return(0,p.Z)(function*(){(0,m.eM)("onClickDelete()",o,i);const c=u.dialog.createHtmlBuilder(),_=new y.ww("\n<div>\n\u7ba1\u7406\u4eba\u306b\u627f\u8a8d\u3055\u308c\u305f\u5f8c\u3067\u524a\u9664\u3055\u308c\u307e\u3059\u3002\u3088\u308d\u3057\u3044\u3067\u3059\u304b\uff1f\n</div>\n");c.setMessage(_).setType(x.iR.Warn).setSize(x.PW.Default).setTitle("\u78ba\u8a8d").okButton((0,p.Z)(function*(){yield u.doDeleteRequest(i)})).cancelButton(()=>{}).open()})()}onClickReply(o,i){(0,m.eM)("CommentListComponent.onClickReply()",o,i),i.isReplying=!0}onEditDismissed(o){(0,m.eM)("CommentListComponent.onEditDismissed()"),o.isEditing=!1}onEditRequested(o){(0,m.eM)("CommentListComponent.onEditRequested()"),o.isEditing=!1}onReplyRequested(o){(0,m.eM)("CommentListComponent.onReplyRequested()"),o.isReplying=!1}onReplyDismissed(o){(0,m.eM)("CommentListComponent.onReplyDismissed()"),o.isReplying=!1}onClickMoreComment(o){(0,m.eM)("CommentListComponent.onClickMoreComment()")}onClickApprove(o,i){var u=this;return(0,p.Z)(function*(){(0,m.eM)("CommentListComponent.onClickApprove()");const c={pageId:u.pageId,commentId:i.store.id};try{yield u.funcs.call("approveComment",c),u.toastr.info("\u627f\u8a8d\u3057\u307e\u3057\u305f\u3002")}catch(_){(0,m.wb)("Error while approve",_);const d=_ instanceof Error?_.message:"Unknown error";u.toastr.error(`\u627f\u8a8d\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002 ( ${d} )`)}})()}onClickReject(o,i){var u=this;return(0,p.Z)(function*(){(0,m.eM)("CommentListComponent.onClickReject()");const c={pageId:u.pageId,commentId:i.store.id};try{yield u.funcs.call("rejectComment",c),u.toastr.info("\u5374\u4e0b\u3057\u307e\u3057\u305f\u3002")}catch(_){(0,m.wb)("Error while reject",_);const d=_ instanceof Error?_.message:"Unknown error";u.toastr.error(`\u5374\u4e0b\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002 ( ${d} )`)}})()}onClickProtect(o,i){var u=this;return(0,p.Z)(function*(){(0,m.eM)("CommentListComponent.onClickProtect()");const c={pageId:u.pageId,commentId:i.store.id};try{yield u.funcs.call("protectComment",c),u.toastr.info("\u4fdd\u8b77\u3057\u307e\u3057\u305f\u3002")}catch(_){(0,m.wb)("Error while protect",_);const d=_ instanceof Error?_.message:"Unknown error";u.toastr.error(`\u4fdd\u8b77\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002 ( ${d} )`)}})()}onClickUnProtect(o,i){var u=this;return(0,p.Z)(function*(){(0,m.eM)("CommentListComponent.onClickUnProtect()");const c={pageId:u.pageId,commentId:i.store.id,unprotect:!0};try{yield u.funcs.call("protectComment",c),u.toastr.info("\u4fdd\u8b77\u89e3\u9664\u3057\u307e\u3057\u305f\u3002")}catch(_){(0,m.wb)("Error while unprotect",_);const d=_ instanceof Error?_.message:"Unknown error";u.toastr.error(`\u4fdd\u8b77\u89e3\u9664\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002 ( ${d} )`)}})()}}return e=s,(0,r.Z)(s,"\u0275fac",function(o){return new(o||e)(t.Y36(C.e),t.Y36(I.K),t.Y36(x.xA),t.Y36(E.ST),t.Y36(v.c),t.Y36(f._W))}),(0,r.Z)(s,"\u0275cmp",t.Xpm({type:e,selectors:[["gitfire-comment-list"]],inputs:{pageId:"pageId",isPageProtect:"isPageProtect"},decls:2,vars:2,consts:[["class","spinner-border text-primary","role","status",4,"ngIf"],[4,"ngIf"],["role","status",1,"spinner-border","text-primary"],[3,"id","background",4,"ngFor","ngForOf"],["class","btn btn-primary","title","\u53e4\u3044\u6295\u7a3f\u3092\u3055\u3089\u306b\u8aad\u307f\u8fbc\u307f\u307e\u3059\u3002",3,"click",4,"ngIf"],[3,"id"],[3,"title"],["class","mx-1",4,"ngIf"],["class","mx-2","style","position: absolute; right: 0px;","data-bs-toggle","dropdown",4,"ngIf"],[2,"height","2rem"],[3,"userPublic",4,"ngIf"],[1,"m-1"],["class","border border-danger text-danger m-1 p-1",4,"ngIf"],[3,"ngSwitch"],["class","text-warning",4,"ngSwitchCase"],["class","text-info",4,"ngSwitchCase"],[4,"ngSwitchCase"],["class","p-2",4,"ngIf"],[1,"m-2"],["class","m-2",4,"ngIf"],[1,"mx-1"],["data-bs-toggle","dropdown",1,"mx-2",2,"position","absolute","right","0px"],[1,"gitweeMenuItem"],[1,"dropdown-menu"],["class","text-info dropdown-item gitweeMenuItem","title","\u4fdd\u7559\u72b6\u614b\u306e\u30b3\u30e1\u30f3\u30c8\u3092\u627f\u8a8d\u3057\u307e\u3059\u3002",3,"click",4,"ngIf"],["class","text-info dropdown-item gitweeMenuItem","title","\u7de8\u96c6\u7533\u8acb\u3055\u308c\u305f\u30b3\u30e1\u30f3\u30c8\u3092\u627f\u8a8d\u3057\u307e\u3059\u3002",3,"click",4,"ngIf"],["class","text-info dropdown-item gitweeMenuItem","title","\u524a\u9664\u7533\u8acb\u3055\u308c\u305f\u30b3\u30e1\u30f3\u30c8\u3092\u627f\u8a8d\u3057\u307e\u3059\u3002",3,"click",4,"ngIf"],["class","text-warning dropdown-item gitweeMenuItem","title","\u4fdd\u7559\u72b6\u614b\u306e\u30b3\u30e1\u30f3\u30c8\u3092\u62d2\u5426\u3057\u307e\u3059\u3002",3,"click",4,"ngIf"],["class","text-warning dropdown-item gitweeMenuItem","title","\u7de8\u96c6\u7533\u8acb\u3055\u308c\u305f\u30b3\u30e1\u30f3\u30c8\u3092\u62d2\u5426\u3057\u307e\u3059\u3002",3,"click",4,"ngIf"],["class","text-warning dropdown-item gitweeMenuItem","title","\u524a\u9664\u7533\u8acb\u3055\u308c\u305f\u30b3\u30e1\u30f3\u30c8\u3092\u62d2\u5426\u3057\u307e\u3059\u3002",3,"click",4,"ngIf"],["class","text-danger dropdown-item gitweeMenuItem","title","\u30b3\u30e1\u30f3\u30c8\u3092\u4fdd\u8b77\u3057\u307e\u3059\u3002",3,"click",4,"ngIf"],["class","text-danger dropdown-item gitweeMenuItem","title","\u30b3\u30e1\u30f3\u30c8\u4fdd\u8b77\u3092\u89e3\u9664\u3057\u307e\u3059\u3002",3,"click",4,"ngIf"],["title","\u4fdd\u7559\u72b6\u614b\u306e\u30b3\u30e1\u30f3\u30c8\u3092\u627f\u8a8d\u3057\u307e\u3059\u3002",1,"text-info","dropdown-item","gitweeMenuItem",3,"click"],["title","\u7de8\u96c6\u7533\u8acb\u3055\u308c\u305f\u30b3\u30e1\u30f3\u30c8\u3092\u627f\u8a8d\u3057\u307e\u3059\u3002",1,"text-info","dropdown-item","gitweeMenuItem",3,"click"],["title","\u524a\u9664\u7533\u8acb\u3055\u308c\u305f\u30b3\u30e1\u30f3\u30c8\u3092\u627f\u8a8d\u3057\u307e\u3059\u3002",1,"text-info","dropdown-item","gitweeMenuItem",3,"click"],["title","\u4fdd\u7559\u72b6\u614b\u306e\u30b3\u30e1\u30f3\u30c8\u3092\u62d2\u5426\u3057\u307e\u3059\u3002",1,"text-warning","dropdown-item","gitweeMenuItem",3,"click"],["title","\u7de8\u96c6\u7533\u8acb\u3055\u308c\u305f\u30b3\u30e1\u30f3\u30c8\u3092\u62d2\u5426\u3057\u307e\u3059\u3002",1,"text-warning","dropdown-item","gitweeMenuItem",3,"click"],["title","\u524a\u9664\u7533\u8acb\u3055\u308c\u305f\u30b3\u30e1\u30f3\u30c8\u3092\u62d2\u5426\u3057\u307e\u3059\u3002",1,"text-warning","dropdown-item","gitweeMenuItem",3,"click"],["title","\u30b3\u30e1\u30f3\u30c8\u3092\u4fdd\u8b77\u3057\u307e\u3059\u3002",1,"text-danger","dropdown-item","gitweeMenuItem",3,"click"],["title","\u30b3\u30e1\u30f3\u30c8\u4fdd\u8b77\u3092\u89e3\u9664\u3057\u307e\u3059\u3002",1,"text-danger","dropdown-item","gitweeMenuItem",3,"click"],[3,"userPublic"],[1,"border","border-danger","text-danger","m-1","p-1"],[1,"text-warning"],[1,"text-info"],["class","p-2",3,"innerHTML",4,"ngIf"],[3,"pageId","editModel","showDismiss","requestSent","editDismiss"],[1,"p-2",3,"innerHTML"],[1,"p-2"],["loadingMessage",""],["class","border border-info",4,"ngIf"],["class","border border-warning",4,"ngIf"],[1,"border","border-info"],[3,"innerHTML",4,"ngIf","ngIfElse"],[3,"innerHTML"],[1,"border","border-warning"],["title","\u3053\u306e\u30b3\u30e1\u30f3\u30c8\u3078\u8fd4\u4fe1\u3057\u307e\u3059\u3002",1,"btn","btn-primary","m-1",3,"click"],["title","\u6295\u7a3f\u306e\u524a\u9664\u3092\u7533\u8acb\u3057\u307e\u3059\u3002",1,"btn","btn-warning","m-1",3,"click"],["title","\u30b3\u30e1\u30f3\u30c8\u3092\u7de8\u96c6\u3057\u307e\u3059\u3002",1,"btn","btn-secondary","m-1",3,"click"],[3,"showDismiss","replyId","pageId","requestSent","editDismiss"],["title","\u53e4\u3044\u6295\u7a3f\u3092\u3055\u3089\u306b\u8aad\u307f\u8fbc\u307f\u307e\u3059\u3002",1,"btn","btn-primary",3,"click"]],template:function(o,i){1&o&&(t.YNc(0,P,1,0,"span",0),t.YNc(1,kt,3,2,"div",1)),2&o&&(t.Q6J("ngIf",i.isLoading),t.xp6(1),t.Q6J("ngIf",i.comments))},dependencies:[g.sg,g.O5,g.RF,g.n9,M.a,T,g.Ov,g.uU],styles:[".gitweeMenuItem[_ngcontent-%COMP%]{cursor:pointer}"]})),s})();function Jt(e,s){1&e&&t._UZ(0,"span",2)}function bt(e,s){1&e&&(t.TgZ(0,"div",7),t._uU(1,"\u30b3\u30e1\u30f3\u30c8\u306f\u3042\u308a\u307e\u305b\u3093"),t.qZA())}function Nt(e,s){if(1&e){const n=t.EpF();t.TgZ(0,"button",11),t.NdJ("click",function(){t.CHM(n);const i=t.oxw(4);return t.KtG(i.onClickProtect())}),t._uU(1,"\u30da\u30fc\u30b8\u3092\u4fdd\u8b77"),t.qZA()}}function Ut(e,s){if(1&e){const n=t.EpF();t.TgZ(0,"button",12),t.NdJ("click",function(){t.CHM(n);const i=t.oxw(4);return t.KtG(i.onClickUnProtect())}),t._uU(1,"\u4fdd\u8b77\u3092\u89e3\u9664"),t.qZA()}}function Qt(e,s){if(1&e&&(t.ynx(0),t.YNc(1,Nt,2,0,"button",9),t.YNc(2,Ut,2,0,"button",10),t.BQk()),2&e){const n=t.oxw().$implicit;t.xp6(1),t.Q6J("ngIf",!n.isProtect),t.xp6(1),t.Q6J("ngIf",n.isProtect)}}function $t(e,s){1&e&&(t.TgZ(0,"span",14)(1,"span",15),t._uU(2,"\u30da\u30fc\u30b8\u306f\u4fdd\u8b77\u3055\u308c\u3066\u3044\u307e\u3059"),t.qZA()())}function Yt(e,s){if(1&e&&(t.ynx(0),t.YNc(1,$t,3,0,"span",13),t.BQk()),2&e){const n=t.oxw().$implicit;t.xp6(1),t.Q6J("ngIf",n.isProtect)}}function Pt(e,s){if(1&e){const n=t.EpF();t.ynx(0),t.TgZ(1,"button",16),t.NdJ("click",function(i){t.CHM(n);const u=t.oxw(3);return t.KtG(u.onClickWatchPage(i,!0))}),t._uU(2,"Watch(\u30c6\u30b9\u30c8\u4e2d)"),t.qZA(),t.TgZ(3,"button",17),t.NdJ("click",function(i){t.CHM(n);const u=t.oxw(3);return t.KtG(u.onClickWatchPage(i,!1))}),t._uU(4,"Unwatch(\u30c6\u30b9\u30c8\u4e2d)"),t.qZA(),t.BQk()}}function qt(e,s){if(1&e&&(t.TgZ(0,"span",20),t._uU(1),t.qZA()),2&e){const n=t.oxw(2).$implicit;t.xp6(1),t.hij("(\u4fdd\u7559 ",n.countPending," \u4ef6)")}}function Ht(e,s){if(1&e&&(t.TgZ(0,"div",18)(1,"span"),t._uU(2),t.qZA(),t.YNc(3,qt,2,1,"span",19),t.qZA()),2&e){const n=t.oxw().$implicit;t.xp6(2),t.hij("",n.countAll," \u4ef6\u306e\u30b3\u30e1\u30f3\u30c8"),t.xp6(1),t.Q6J("ngIf",n.countPending>0)}}function St(e,s){if(1&e&&(t.TgZ(0,"div")(1,"div",7),t.YNc(2,Qt,3,2,"ng-container",1),t.YNc(3,Yt,2,1,"ng-container",1),t.YNc(4,Pt,5,0,"ng-container",1),t.qZA(),t.YNc(5,Ht,4,2,"div",8),t.qZA()),2&e){const n=s.$implicit;t.oxw();const o=t.MAs(2),i=t.oxw();t.xp6(2),t.Q6J("ngIf",i.auth.isAdmin),t.xp6(1),t.Q6J("ngIf",!i.auth.isAdmin),t.xp6(1),t.Q6J("ngIf",i.auth.hasMessaging),t.xp6(1),t.Q6J("ngIf",n.countAll>0)("ngIfElse",o)}}function Rt(e,s){if(1&e&&t._UZ(0,"gitfire-comment-editor",21),2&e){const n=t.oxw(2);t.Q6J("pageId",n.pageId)}}function Ot(e,s){if(1&e&&(t.TgZ(0,"div"),t.YNc(1,bt,2,0,"ng-template",null,3,t.W1O),t.YNc(3,St,6,5,"div",4),t.ALo(4,"async"),t.TgZ(5,"div"),t.YNc(6,Rt,1,1,"gitfire-comment-editor",5),t.ALo(7,"async"),t._UZ(8,"gitfire-comment-list",6),t.ALo(9,"async"),t.qZA()()),2&e){const n=t.MAs(2),o=t.oxw();let i,u;t.xp6(3),t.Q6J("ngIf",t.lcZ(4,5,o.pageInfo$))("ngIfElse",n),t.xp6(3),t.Q6J("ngIf",!(null!=(i=t.lcZ(7,7,o.pageInfo$))&&i.isProtect)),t.xp6(2),t.Q6J("pageId",o.pageId)("isPageProtect",null==(u=t.lcZ(9,9,o.pageInfo$))?null:u.isProtect)}}let Kt=(()=>{var e;class s{constructor(o,i,u,c,_){(0,r.Z)(this,"auth",void 0),(0,r.Z)(this,"router",void 0),(0,r.Z)(this,"funcs",void 0),(0,r.Z)(this,"store",void 0),(0,r.Z)(this,"toastr",void 0),(0,r.Z)(this,"pagePath",void 0),(0,r.Z)(this,"pageJson",void 0),(0,r.Z)(this,"pageInfo$",void 0),(0,r.Z)(this,"pageId",void 0),this.auth=o,this.router=i,this.funcs=u,this.store=c,this.toastr=_}pagePath2PageKey(o){const i=`${m.NZ.PAGE_DATA}/`,u=i.length,c=o.jsonPath;if(!c.startsWith(i))throw new Error(`Not a supported path ${c}`);return c.substring(u-1)}buildLeafUrl(){const o=this.pageJson;return o.anchorLink?o.anchorId?`${o.anchorLink}#${o.anchorId}`:o.anchorLink:this.router.url}ngOnInit(){var o=this;return(0,p.Z)(function*(){(0,m.eM)("CommentEntryComponent.OnInit()",o.pagePath);const c={pageKey:o.pageJson?.pageKey||o.pagePath2PageKey(o.pagePath),leafUrl:o.buildLeafUrl()};o.pageId=yield o.funcs.call("getPageId",c),(0,m.eM)("getPageId",o.pageId,c),o.pageInfo$=o.store.doc(`/comment/v1/page/${o.pageId}`).valueChanges().pipe((0,w.d)(1))})()}doProtectPage(o){var i=this;return(0,p.Z)(function*(){const u={pageId:i.pageId,unprotect:o};yield i.funcs.call("protectPage",u)})()}onClickUnProtect(){var o=this;return(0,p.Z)(function*(){(0,m.eM)("CommentEntryComponent.onClickUnProtect()");try{o.doProtectPage(!0),o.toastr.info("\u30da\u30fc\u30b8\u306e\u4fdd\u8b77\u3092\u89e3\u9664\u3057\u307e\u3057\u305f\u3002")}catch(i){(0,m.wb)(i);const u=i instanceof Error?i.message:"Unknown error";o.toastr.error(`\u30da\u30fc\u30b8\u306e\u4fdd\u8b77\u3092\u89e3\u9664\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002 ( ${u} )`)}})()}onClickWatchPage(o,i){var u=this;return(0,p.Z)(function*(){(0,m.eM)("CommentEntryComponent.onClickWatchPage()");try{const c={pageId:u.pageId,isWatch:i};yield u.funcs.call("watchCommentPage",c),u.toastr.info(i?"\u30da\u30fc\u30b8\u306e Watch \u3092\u958b\u59cb\u3057\u307e\u3057\u305f\u3002":"\u30da\u30fc\u30b8\u3092 Watch \u3092\u505c\u6b62\u3057\u307e\u3057\u305f\u3002")}catch(c){(0,m.wb)(c);const _=c instanceof Error?c.message:"Unknown error";u.toastr.error(`\u30da\u30fc\u30b8\u306e Watch \u72b6\u614b\u3092\u5909\u66f4\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002 ( ${_} )`)}})()}onClickProtect(){var o=this;return(0,p.Z)(function*(){(0,m.eM)("CommentEntryComponent.onClickProtect()");try{o.doProtectPage(!1),o.toastr.info("\u30da\u30fc\u30b8\u3092\u4fdd\u8b77\u3057\u307e\u3057\u305f\u3002")}catch(i){(0,m.wb)(i);const u=i instanceof Error?i.message:"Unknown error";o.toastr.error(`\u30da\u30fc\u30b8\u3092\u4fdd\u8b77\u72b6\u614b\u306b\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002 ( ${u} )`)}})()}}return e=s,(0,r.Z)(s,"\u0275fac",function(o){return new(o||e)(t.Y36(C.e),t.Y36(F.Z),t.Y36(v.c),t.Y36(E.ST),t.Y36(f._W))}),(0,r.Z)(s,"\u0275cmp",t.Xpm({type:e,selectors:[["gitfire-comment-entry"]],inputs:{pagePath:"pagePath",pageJson:"pageJson"},decls:3,vars:2,consts:[["class","spinner-border text-primary","role","status",4,"ngIf"],[4,"ngIf"],["role","status",1,"spinner-border","text-primary"],["commentNothing",""],[4,"ngIf","ngIfElse"],[3,"pageId",4,"ngIf"],[3,"pageId","isPageProtect"],[1,"text-end"],["class","m-1 text-end",4,"ngIf","ngIfElse"],["class","btn btn-danger m-1","title","\u30da\u30fc\u30b8\u3078\u306e\u30b3\u30e1\u30f3\u30c8\u3092\u7981\u6b62\u3057\u307e\u3059\u3002",3,"click",4,"ngIf"],["class","btn btn-info m-1","title","\u30da\u30fc\u30b8\u3078\u306e\u30b3\u30e1\u30f3\u30c8\u3092\u53ef\u80fd\u306b\u3057\u307e\u3059\u3002",3,"click",4,"ngIf"],["title","\u30da\u30fc\u30b8\u3078\u306e\u30b3\u30e1\u30f3\u30c8\u3092\u7981\u6b62\u3057\u307e\u3059\u3002",1,"btn","btn-danger","m-1",3,"click"],["title","\u30da\u30fc\u30b8\u3078\u306e\u30b3\u30e1\u30f3\u30c8\u3092\u53ef\u80fd\u306b\u3057\u307e\u3059\u3002",1,"btn","btn-info","m-1",3,"click"],["class","p-1 border border-danger",4,"ngIf"],[1,"p-1","border","border-danger"],[1,"text-danger"],["title","\u3053\u306e\u6a5f\u80fd\u306f\u8a66\u9a13\u904b\u7528\u4e2d\u3067\u3059\u3002\u3053\u306e\u30da\u30fc\u30b8\u3078\u306e\u30b3\u30e1\u30f3\u30c8\u3001\u66f4\u65b0\u3092\u901a\u77e5\u3057\u307e\u3059\u3002",1,"btn","btn-secondary","m-1",3,"click"],["title","\u3053\u306e\u6a5f\u80fd\u306f\u8a66\u9a13\u904b\u7528\u4e2d\u3067\u3059\u3002\u3053\u306e\u30da\u30fc\u30b8\u3078\u306e\u30b3\u30e1\u30f3\u30c8\u3001\u66f4\u65b0\u901a\u77e5\u3092\u505c\u6b62\u3057\u307e\u3059\u3002",1,"btn","btn-secondary","m-1",3,"click"],[1,"m-1","text-end"],["class","text-warning",4,"ngIf"],[1,"text-warning"],[3,"pageId"]],template:function(o,i){1&o&&(t._UZ(0,"hr"),t.YNc(1,Jt,1,0,"span",0),t.YNc(2,Ot,10,11,"div",1)),2&o&&(t.xp6(1),t.Q6J("ngIf",!i.pageId),t.xp6(1),t.Q6J("ngIf",i.pageId))},dependencies:[g.O5,Lt,T,g.Ov]})),s})()}}]);