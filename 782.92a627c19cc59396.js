"use strict";(self.webpackChunkKaguraGithubPages=self.webpackChunkKaguraGithubPages||[]).push([[782],{9782:(j,$,s)=>{s.d($,{e:()=>x});var A=s(5861),u=s(8645),d=s(7328),m=s(2096),F=s(3997),B=s(2181),P=s(9773),L=s(4664),O=s(9397),I=s(3620),R=s(7081),K=s(8180),a=s(553),N=s(9212),H=s(434),h=s(2413),r=s(3867),l=s(5579),W=s(271);class M{auth;funcs;localSession;store;dom;finalize$=new u.x;state$;localUser$;isAdminUser=!1;isDevelopUser=!1;hasMessagingDevice=!1;loginUid=null;sourceValue$=new d.t;constructor(w,C,o,D,g){var c=this;this.auth=w,this.funcs=C,this.localSession=o,this.store=D,this.dom=g,(0,a.eM)("SingletonAuth.constructor()"),this.dom.addResourceHint("https://identitytoolkit.googleapis.com","preconnect"),this.dom.addResourceHint("https://firebaseinstallations.googleapis.com","preconnect"),this.dom.addResourceHint("https://firestore.googleapis.com","preconnect"),this.dom.addResourceHint("https://apis.google.com","preconnect"),this.dom.addResourceHint(`https://${a.NZ.firebaseConfig.authDomain}`,"preconnect"),this.dom.addResourceHint(`https://${a.NZ.FirebaseCloudFunctionsHost}`,"preconnect");const v=this.auth.user.pipe((0,F.x)());v.pipe((0,F.x)()).subscribe(f=>{this.sourceValue$.next()}),this.state$=v.pipe((0,B.h)(f=>null!==f)),this.localSession.markedLogout$.pipe().subscribe(()=>{this.sourceValue$.next()}),this.state$.pipe((0,P.R)(this.finalize$)).subscribe({error:f=>{(0,a.wb)("AuthService.state$ error",f),this.doFinalize()},complete:()=>{(0,a.H_)("AuthService.state$ completed."),this.doFinalize()}}),this.state$.pipe((0,L.w)(f=>this.store.collection(`/users/v1/protected/${f.uid}/fcm`).valueChanges().pipe((0,O.b)(T=>(0,a.eM)("UserProtectedStore has changed.",T)))),(0,P.R)(this.finalize$)).subscribe({next:f=>{this.sourceValue$.next()},error:f=>{(0,a.wb)("AuthService.state$ Maybe after logout permission error. Ignore it.",f),this.doFinalize()},complete:()=>{(0,a.H_)("AuthService.state$ completed."),this.doFinalize()}});const y=this.state$.pipe((0,L.w)(function(){var f=(0,A.Z)(function*(T){try{const b=yield c.funcs.call("readUserSettings"),z=T;return z.isAdmin=b.isAdmin,z.isDeveloper=b.isDeveloper,z.hasMessaging=b.hasMessaging,z}catch(b){return(0,a.wb)("AuthService while check user settings.",b),null}});return function(T){return f.apply(this,arguments)}}()));var f;this.localUser$=this.sourceValue$.pipe((0,I.b)(100),(0,L.w)(()=>v.pipe((0,L.w)(f=>null===f?(0,m.of)(null):y))),(0,R.d)(1)),this.localUser$.pipe((0,P.R)(this.finalize$)).subscribe({next:(f=(0,A.Z)(function*(T){(0,a.eM)("AuthService.localUser$.subscribe()",T),T?(c.loginUid=T.uid,c.isAdminUser=!!T.isAdmin,c.isDevelopUser=!!T.isDeveloper,c.hasMessagingDevice=!!T.hasMessaging,c.localSession.updateLoginPhoto(T.photoURL),c.localSession.markLogin()):(c.localSession.unmarkLogin(),c.localSession.updateLoginPhoto(null),c.loginUid=null,c.isAdminUser=!1,c.isDevelopUser=!1,c.hasMessagingDevice=!1,(0,a.H_)("Explicitly logout on client sdk."),yield c.auth.signOut())}),function(b){return f.apply(this,arguments)}),complete:()=>{(0,a.H_)("AuthService.localUser$ complete."),this.doFinalize()},error:f=>{(0,a.wb)("AuthService.localUser$ error while retrieving.",f),this.doFinalize()}})}doFinalize(){this.finalize$.isStopped||((0,a.H_)("Do finalize Singleton Auth"),this.finalize$.next(),this.finalize$.complete())}}let x=(()=>{class p{auth;funcs;localSession;store;dom;static AUTH=null;_clientSideUser$;constructor(C,o,D,g,c){this.auth=C,this.funcs=o,this.localSession=D,this.store=g,this.dom=c,(0,a.eM)("AuthService.constructor()");const v=new d.t;null===p.AUTH&&(p.AUTH=new M(C,o,D,g,c),p.AUTH.finalize$.pipe((0,K.q)(1)).subscribe({next:()=>{(0,a.H_)("Finalize singleton auth continue..")},complete:()=>{(0,a.H_)("Finalizing singleton auth completed."),p.AUTH=null,v.next()},error:y=>{(0,a.wb)("Finalizing singleton auth cause by error.",y),p.AUTH=null,v.next()}})),this._clientSideUser$=v.pipe((0,L.w)(()=>null===p.AUTH?(0,m.of)(null):p.AUTH.localUser$),(0,R.d)(1)),v.next()}get clientSideUser$(){return this._clientSideUser$}get isAdmin(){return!!p.AUTH&&p.AUTH.isAdminUser}get isDeveloper(){return!!p.AUTH&&p.AUTH.isDevelopUser}get hasMessaging(){return!!p.AUTH&&p.AUTH.hasMessagingDevice}get myUid(){return p.AUTH?p.AUTH.loginUid:null}static \u0275fac=function(o){return new(o||p)(N.LFG(H.zQ),N.LFG(h.c),N.LFG(r.m),N.LFG(l.ST),N.LFG(W.v))};static \u0275prov=N.Yz7({token:p,factory:p.\u0275fac,providedIn:"root"})}return p})()},2413:(j,$,s)=>{s.d($,{c:()=>B});var A=s(5861),u=s(8180),d=s(553),m=s(9212),F=s(5070);let B=(()=>{class P{remote;constructor(O){this.remote=O,(0,d.eM)("LocalFunctionsService.constructor()")}call(O,I){var R=this;return(0,A.Z)(function*(){return yield R.remote.httpsCallable(O)(I).pipe((0,u.q)(1)).toPromise()})()}static \u0275fac=function(I){return new(I||P)(m.LFG(F.l4))};static \u0275prov=m.Yz7({token:P,factory:P.\u0275fac,providedIn:"root"})}return P})()},5070:(j,$,s)=>{s.d($,{Qv:()=>r,Xz:()=>N,l4:()=>h}),s(7741);var u=s(9212),d=s(8326),m=s(7217),F=s(2096),B=s(2459),P=s(3093),L=s(4664),O=s(7398),I=s(7081),R=s(7142);const a=new u.OlP("angularfire2.functions.origin"),N=new u.OlP("angularfire2.functions.region"),H=new u.OlP("angularfire2.functions.use-emulator");let h=(()=>{class l{httpsCallable;constructor(M,x,p,w,C,o,D,g){const c=D,v=(0,F.of)(void 0).pipe((0,P.Q)(w.outsideAngular),(0,L.w)(()=>Promise.resolve().then(s.bind(s,7741))),(0,O.U)(()=>(0,m.on)(M,p,x)),(0,O.U)(y=>(0,m.cc)(`${y.name}.functions.${C||o}`,"AngularFireFunctions",y.name,()=>{let f;if(C&&o)throw new Error("REGION and ORIGIN can't be used at the same time.");return f=y.functions(C||o||void 0),c&&f.useEmulator(...c),f},[C,o,c])),(0,I.d)({bufferSize:1,refCount:!1}));return this.httpsCallable=(y,f)=>T=>(0,B.D)(v).pipe((0,P.Q)(w.insideAngular),(0,L.w)(b=>b.httpsCallable(y,f)(T)),(0,O.U)(b=>b.data)),(0,m.pX)(this,v,p)}static \u0275fac=function(x){return new(x||l)(u.LFG(m.Dh),u.LFG(m.xv,8),u.LFG(u.R0b),u.LFG(d.HU),u.LFG(N,8),u.LFG(a,8),u.LFG(H,8),u.LFG(d.Rf,8))};static \u0275prov=u.Yz7({token:l,factory:l.\u0275fac,providedIn:"any"})}return l})(),r=(()=>{class l{constructor(){R.Z.registerVersion("angularfire",d.q4.full,"fn-compat")}static \u0275fac=function(x){return new(x||l)};static \u0275mod=u.oAB({type:l});static \u0275inj=u.cJS({providers:[h]})}return l})()},3106:(j,$,s)=>{s.d($,{Z:()=>H});var A=s(9058),u=s(4537),d=s(6122),m=s(7879);class F{constructor(r,l){this._delegate=r,this.firebase=l,(0,d._addComponent)(r,new u.wA("app-compat",()=>this,"PUBLIC")),this.container=r.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(r){this._delegate.automaticDataCollectionEnabled=r}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(r=>{this._delegate.checkDestroyed(),r()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),(0,d.deleteApp)(this._delegate)))}_getService(r,l=d._DEFAULT_ENTRY_NAME){var W;this._delegate.checkDestroyed();const M=this._delegate.container.getProvider(r);return!M.isInitialized()&&"EXPLICIT"===(null===(W=M.getComponent())||void 0===W?void 0:W.instantiationMode)&&M.initialize(),M.getImmediate({identifier:l})}_removeServiceInstance(r,l=d._DEFAULT_ENTRY_NAME){this._delegate.container.getProvider(r).clearInstance(l)}_addComponent(r){(0,d._addComponent)(this._delegate,r)}_addOrOverwriteComponent(r){(0,d._addOrOverwriteComponent)(this._delegate,r)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}const P=new A.LL("app-compat","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."}),I=function O(){const h=function L(h){const r={},l={__esModule:!0,initializeApp:function x(o,D={}){const g=d.initializeApp(o,D);if((0,A.r3)(r,g.name))return r[g.name];const c=new h(g,l);return r[g.name]=c,c},app:M,registerVersion:d.registerVersion,setLogLevel:d.setLogLevel,onLog:d.onLog,apps:null,SDK_VERSION:d.SDK_VERSION,INTERNAL:{registerComponent:function w(o){const D=o.name,g=D.replace("-compat","");if(d._registerComponent(o)&&"PUBLIC"===o.type){const c=(v=M())=>{if("function"!=typeof v[g])throw P.create("invalid-app-argument",{appName:D});return v[g]()};void 0!==o.serviceProps&&(0,A.ZB)(c,o.serviceProps),l[g]=c,h.prototype[g]=function(...v){return this._getService.bind(this,D).apply(this,o.multipleInstances?v:[])}}return"PUBLIC"===o.type?l[g]:null},removeApp:function W(o){delete r[o]},useAsService:function C(o,D){return"serverAuth"===D?null:D},modularAPIs:d}};function M(o){if(!(0,A.r3)(r,o=o||d._DEFAULT_ENTRY_NAME))throw P.create("no-app",{appName:o});return r[o]}return l.default=l,Object.defineProperty(l,"apps",{get:function p(){return Object.keys(r).map(o=>r[o])}}),M.App=h,l}(F);return h.INTERNAL=Object.assign(Object.assign({},h.INTERNAL),{createFirebaseNamespace:O,extendNamespace:function r(l){(0,A.ZB)(h,l)},createSubscribe:A.ne,ErrorFactory:A.LL,deepExtend:A.ZB}),h}(),R=new m.Yd("@firebase/app-compat");if((0,A.jU)()&&void 0!==self.firebase){R.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");const h=self.firebase.SDK_VERSION;h&&h.indexOf("LITE")>=0&&R.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}const H=I;!function N(h){(0,d.registerVersion)("@firebase/app-compat","0.2.13",h)}()},7741:(j,$,s)=>{s.r($);var A=s(3106),u=s(5861),d=s(6122),m=s(9058),F=s(4537);const B="type.googleapis.com/google.protobuf.Int64Value",P="type.googleapis.com/google.protobuf.UInt64Value";function L(e,t){const n={};for(const i in e)e.hasOwnProperty(i)&&(n[i]=t(e[i]));return n}function O(e){if(null==e)return null;if(e instanceof Number&&(e=e.valueOf()),"number"==typeof e&&isFinite(e)||!0===e||!1===e||"[object String]"===Object.prototype.toString.call(e))return e;if(e instanceof Date)return e.toISOString();if(Array.isArray(e))return e.map(t=>O(t));if("function"==typeof e||"object"==typeof e)return L(e,t=>O(t));throw new Error("Data cannot be encoded in JSON: "+e)}function I(e){if(null==e)return e;if(e["@type"])switch(e["@type"]){case B:case P:{const t=Number(e.value);if(isNaN(t))throw new Error("Data cannot be decoded from JSON: "+e);return t}default:throw new Error("Data cannot be decoded from JSON: "+e)}return Array.isArray(e)?e.map(t=>I(t)):"function"==typeof e||"object"==typeof e?L(e,t=>I(t)):e}const R="functions",K={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class a extends m.ZR{constructor(t,n,i){super(`${R}/${t}`,n||""),this.details=i}}class h{constructor(t,n,i){this.auth=null,this.messaging=null,this.appCheck=null,this.auth=t.getImmediate({optional:!0}),this.messaging=n.getImmediate({optional:!0}),this.auth||t.get().then(_=>this.auth=_,()=>{}),this.messaging||n.get().then(_=>this.messaging=_,()=>{}),this.appCheck||i.get().then(_=>this.appCheck=_,()=>{})}getAuthToken(){var t=this;return(0,u.Z)(function*(){if(t.auth)try{const n=yield t.auth.getToken();return n?.accessToken}catch{return}})()}getMessagingToken(){var t=this;return(0,u.Z)(function*(){if(t.messaging&&"Notification"in self&&"granted"===Notification.permission)try{return yield t.messaging.getToken()}catch{return}})()}getAppCheckToken(t){var n=this;return(0,u.Z)(function*(){if(n.appCheck){const i=t?yield n.appCheck.getLimitedUseToken():yield n.appCheck.getToken();return i.error?null:i.token}return null})()}getContext(t){var n=this;return(0,u.Z)(function*(){return{authToken:yield n.getAuthToken(),messagingToken:yield n.getMessagingToken(),appCheckToken:yield n.getAppCheckToken(t)}})()}}const r="us-central1";class W{constructor(t,n,i,_,E=r,U){this.app=t,this.fetchImpl=U,this.emulatorOrigin=null,this.contextProvider=new h(n,i,_),this.cancelAllRequests=new Promise(S=>{this.deleteService=()=>Promise.resolve(S())});try{const S=new URL(E);this.customDomain=S.origin,this.region=r}catch{this.customDomain=null,this.region=E}}_delete(){return this.deleteService()}_url(t){const n=this.app.options.projectId;return null!==this.emulatorOrigin?`${this.emulatorOrigin}/${n}/${this.region}/${t}`:null!==this.customDomain?`${this.customDomain}/${t}`:`https://${this.region}-${n}.cloudfunctions.net/${t}`}}function w(e,t,n,i){return C.apply(this,arguments)}function C(){return(C=(0,u.Z)(function*(e,t,n,i){let _;n["Content-Type"]="application/json";try{_=yield i(e,{method:"POST",body:JSON.stringify(t),headers:n})}catch{return{status:0,json:null}}let E=null;try{E=yield _.json()}catch{}return{status:_.status,json:E}})).apply(this,arguments)}function D(e,t,n,i){return g.apply(this,arguments)}function g(){return(g=(0,u.Z)(function*(e,t,n,i){const _={data:n=O(n)},E={},U=yield e.contextProvider.getContext(i.limitedUseAppCheckTokens);U.authToken&&(E.Authorization="Bearer "+U.authToken),U.messagingToken&&(E["Firebase-Instance-ID-Token"]=U.messagingToken),null!==U.appCheckToken&&(E["X-Firebase-AppCheck"]=U.appCheckToken);const k=function l(e){let t=null;return{promise:new Promise((n,i)=>{t=setTimeout(()=>{i(new a("deadline-exceeded","deadline-exceeded"))},e)}),cancel:()=>{t&&clearTimeout(t)}}}(i.timeout||7e4),G=yield Promise.race([w(t,_,E,e.fetchImpl),k.promise,e.cancelAllRequests]);if(k.cancel(),!G)throw new a("cancelled","Firebase Functions instance was deleted.");const J=function H(e,t){let _,n=function N(e){if(e>=200&&e<300)return"ok";switch(e){case 0:case 500:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}(e),i=n;try{const E=t&&t.error;if(E){const U=E.status;if("string"==typeof U){if(!K[U])return new a("internal","internal");n=K[U],i=U}const S=E.message;"string"==typeof S&&(i=S),_=E.details,void 0!==_&&(_=I(_))}}catch{}return"ok"===n?null:new a(n,i,_)}(G.status,G.json);if(J)throw J;if(!G.json)throw new a("internal","Response is not valid JSON object.");let Z=G.json.data;if(typeof Z>"u"&&(Z=G.json.result),typeof Z>"u")throw new a("internal","Response is missing data field.");return{data:I(Z)}})).apply(this,arguments)}const c="@firebase/functions",v="0.10.0";function V(e,t,n){!function M(e,t,n){e.emulatorOrigin=`http://${t}:${n}`}((0,m.m9)(e),t,n)}!function b(e,t){(0,d._registerComponent)(new F.wA(R,(i,{instanceIdentifier:_})=>{const E=i.getProvider("app").getImmediate(),U=i.getProvider("auth-internal"),S=i.getProvider("messaging-internal"),k=i.getProvider("app-check-internal");return new W(E,U,S,k,_,e)},"PUBLIC").setMultipleInstances(!0)),(0,d.registerVersion)(c,v,t),(0,d.registerVersion)(c,v,"esm2017")}(fetch.bind(self));class Y{constructor(t,n){this.app=t,this._delegate=n,this._region=this._delegate.region,this._customDomain=this._delegate.customDomain}httpsCallable(t,n){return function X(e,t,n){return function x(e,t,n){return i=>function o(e,t,n,i){const _=e._url(t);return D(e,_,n,i)}(e,t,i,n||{})}((0,m.m9)(e),t,n)}(this._delegate,t,n)}httpsCallableFromURL(t,n){return function Q(e,t,n){return function p(e,t,n){return i=>D(e,t,i,n||{})}((0,m.m9)(e),t,n)}(this._delegate,t,n)}useFunctionsEmulator(t){const n=t.match("[a-zA-Z]+://([a-zA-Z0-9.-]+)(?::([0-9]+))?");if(null==n)throw new m.ZR("functions","No origin provided to useFunctionsEmulator()");if(null==n[2])throw new m.ZR("functions","Port missing in origin provided to useFunctionsEmulator()");return V(this._delegate,n[1],Number(n[2]))}useEmulator(t,n){return V(this._delegate,t,n)}}const ne=(e,{instanceIdentifier:t})=>{const n=e.getProvider("app-compat").getImmediate(),i=e.getProvider("functions").getImmediate({identifier:t??"us-central1"});return new Y(n,i)};(function se(){const e={Functions:Y};A.Z.INTERNAL.registerComponent(new F.wA("functions-compat",ne,"PUBLIC").setServiceProps(e).setMultipleInstances(!0))})(),A.Z.registerVersion("@firebase/functions-compat","0.3.5")}}]);