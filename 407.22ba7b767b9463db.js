"use strict";(self.webpackChunkKaguraGithubPages=self.webpackChunkKaguraGithubPages||[]).push([[407],{4407:(Yt,je,_)=>{_.r(je),_.d(je,{GitfireModule:()=>Ai});var B=_(177),c=_(9417),J=_(9253),_e=_(4441),le=_(8334),be=_(1152),ve=_(1848),R=_(467),e=_(4438),rt=_(574),xe=_(490),De=_(7673),Ae=_(983),We=_(1985),Ze=_(8793),oe=_(6745),pe=_(941),me=_(5558),Be=_(6354),te=_(9568),Q=_(7083),Ke=_(9437),Ne=_(3028),et=_(9901),Ce=_(762);const de=new e.nKC("angularfire2.messaging.vapid-key"),Ye=new e.nKC("angularfire2.messaging.service-worker-registeration");let E=(()=>{class n{requestPermission;getToken;tokenChanges;messages;requestToken;deleteToken;constructor(t,s,a,h,g,G,q){const ee=q,ce=(0,De.of)(void 0).pipe((0,oe._)(g.outsideAngular),(0,pe.Q)(g.insideAngular),(0,me.n)(xe.TT),(0,me.n)(Oe=>Oe?_.e(304).then(_.bind(_,8304)):Ae.w),(0,Be.T)(()=>(0,J.iB)(t,h,s)),(0,me.n)(Oe=>(0,J.BM)(`${Oe.name}.messaging`,"AngularFireMessaging",Oe.name,()=>(0,De.of)(Oe.messaging()),[])),(0,te.t)({bufferSize:1,refCount:!1}));this.requestPermission=ce.pipe((0,oe._)(g.outsideAngular),(0,pe.Q)(g.insideAngular),(0,me.n)(()=>Notification.requestPermission())),this.getToken=ce.pipe((0,oe._)(g.outsideAngular),(0,pe.Q)(g.insideAngular),(0,me.n)(function(){var Oe=(0,R.A)(function*(Ht){if("granted"===Notification.permission){const Ti=ee?yield ee:null;return yield Ht.getToken({vapidKey:G,serviceWorkerRegistration:Ti})}return null});return function(Ht){return Oe.apply(this,arguments)}}()));const W=new We.c(Oe=>{navigator.permissions.query({name:"notifications"}).then(Ht=>{Ht.onchange=()=>Oe.next()})}),Re=ce.pipe((0,oe._)(g.outsideAngular),(0,pe.Q)(g.insideAngular),(0,Q.K)(W),(0,Q.K)(this.getToken));return this.tokenChanges=ce.pipe((0,oe._)(g.outsideAngular),(0,pe.Q)(g.insideAngular),(0,me.n)(()=>(0,Ze.x)(this.getToken,Re))),this.messages=ce.pipe((0,oe._)(g.outsideAngular),(0,pe.Q)(g.insideAngular),(0,me.n)(Oe=>new We.c(Ht=>Oe.onMessage(Ht)))),this.requestToken=ce.pipe((0,oe._)(g.outsideAngular),(0,pe.Q)(g.insideAngular),(0,me.n)(()=>this.requestPermission),(0,Ke.W)(()=>(0,De.of)(null)),(0,Ne.Z)(()=>this.tokenChanges)),this.deleteToken=()=>ce.pipe((0,oe._)(g.outsideAngular),(0,pe.Q)(g.insideAngular),(0,me.n)(Oe=>Oe.deleteToken()),(0,et.U)(!1)),(0,J.Gt)(this,ce,h)}static \u0275fac=function(s){return new(s||n)(e.KVO(J.rx),e.KVO(J.uP,8),e.KVO(e.Agw),e.KVO(e.SKi),e.KVO(rt.u0),e.KVO(de,8),e.KVO(Ye,8))};static \u0275prov=e.jDH({token:n,factory:n.\u0275fac,providedIn:"any"})}return n})(),T=(()=>{class n{constructor(){Ce.A.registerVersion("angularfire",rt.xv.full,"fcm-compat")}static \u0275fac=function(s){return new(s||n)};static \u0275mod=e.$C({type:n});static \u0275inj=e.G2t({providers:[E]})}return n})();var A=_(5794),F=_(7830),P=_(1188),C=_(1413),U=_(6977),O=_(6697),N=_(5964),w=_(7935),S=_(5312),re=_(4416),Z=_(8531);let Ie=(()=>{class n extends Z.s{constructor(){super()}ngOnInit(){(0,S.Oi)("DeleteConfirmComponent.OnInit()")}static \u0275fac=function(s){return new(s||n)};static \u0275cmp=e.VBU({type:n,selectors:[["gitfire-delete-confirm"]],features:[e.Vt3],decls:10,vars:0,consts:[[1,"m-3"]],template:function(s,a){1&s&&(e.j41(0,"div",0)(1,"div"),e.EFF(2,"\u672c\u5f53\u306b\u524a\u9664\u3057\u307e\u3059\u304b\uff1f"),e.k0s(),e.j41(3,"ul")(4,"li"),e.EFF(5,"Google / Twitter \u306a\u3069\u306e\u30a2\u30ab\u30a6\u30f3\u30c8\u60c5\u5831\u306f\u524a\u9664\u3055\u308c\u307e\u305b\u3093\u3002"),e.k0s(),e.j41(6,"li"),e.EFF(7,"\u516c\u958b\u3055\u308c\u305f\u6295\u7a3f\u306f\u524a\u9664\u3055\u308c\u307e\u305b\u3093\u3002"),e.k0s(),e.j41(8,"li"),e.EFF(9,"\u53d6\u308a\u6d88\u3057\u306f\u3067\u304d\u307e\u305b\u3093\u3002"),e.k0s()()())}})}return n})();var ne=_(3727),y=_(1632),M=_(2584),H=(_(4098),_(8041),_(6238));function $(){return window}function ot(){return ot=(0,R.A)(function*(n,o,t){var s;const{BuildInfo:a}=$();(0,y.au)(o.sessionId,"AuthEvent did not contain a session ID");const h=yield function ct(n){return wt.apply(this,arguments)}(o.sessionId),g={};return(0,y.av)()?g.ibi=a.packageName:(0,y.aw)()?g.apn=a.packageName:(0,y.ax)(n,"operation-not-supported-in-this-environment"),a.displayName&&(g.appDisplayName=a.displayName),g.sessionId=h,(0,y.ay)(n,t,o.type,void 0,null!==(s=o.eventId)&&void 0!==s?s:void 0,g)}),ot.apply(this,arguments)}function Ue(){return(Ue=(0,R.A)(function*(n){const{BuildInfo:o}=$(),t={};(0,y.av)()?t.iosBundleId=o.packageName:(0,y.aw)()?t.androidPackageName=o.packageName:(0,y.ax)(n,"operation-not-supported-in-this-environment"),yield(0,y.az)(n,t)})).apply(this,arguments)}function nt(){return(nt=(0,R.A)(function*(n,o,t){const{cordova:s}=$();let a=()=>{};try{yield new Promise((h,g)=>{let G=null;function q(){var W;h();const Re=null===(W=s.plugins.browsertab)||void 0===W?void 0:W.close;"function"==typeof Re&&Re(),"function"==typeof t?.close&&t.close()}function ee(){G||(G=window.setTimeout(()=>{g((0,y.aB)(n,"redirect-cancelled-by-user"))},2e3))}function ce(){"visible"===document?.visibilityState&&ee()}o.addPassiveListener(q),document.addEventListener("resume",ee,!1),(0,y.aw)()&&document.addEventListener("visibilitychange",ce,!1),a=()=>{o.removePassiveListener(q),document.removeEventListener("resume",ee,!1),document.removeEventListener("visibilitychange",ce,!1),G&&window.clearTimeout(G)}})}finally{a()}})).apply(this,arguments)}function wt(){return(wt=(0,R.A)(function*(n){const o=function Mt(n){if((0,y.au)(/[0-9a-zA-Z]+/.test(n),"Can only convert alpha-numeric strings"),typeof TextEncoder<"u")return(new TextEncoder).encode(n);const o=new ArrayBuffer(n.length),t=new Uint8Array(o);for(let s=0;s<n.length;s++)t[s]=n.charCodeAt(s);return t}(n),t=yield crypto.subtle.digest("SHA-256",o);return Array.from(new Uint8Array(t)).map(a=>a.toString(16).padStart(2,"0")).join("")})).apply(this,arguments)}class Xt extends y.aD{constructor(){super(...arguments),this.passiveListeners=new Set,this.initPromise=new Promise(o=>{this.resolveInitialized=o})}addPassiveListener(o){this.passiveListeners.add(o)}removePassiveListener(o){this.passiveListeners.delete(o)}resetRedirect(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}onEvent(o){return this.resolveInitialized(),this.passiveListeners.forEach(t=>t(o)),super.onEvent(o)}initialized(){var o=this;return(0,R.A)(function*(){yield o.initPromise})()}}function St(n){return Ot.apply(this,arguments)}function Ot(){return(Ot=(0,R.A)(function*(n){const o=yield lt()._get(ze(n));return o&&(yield lt()._remove(ze(n))),o})).apply(this,arguments)}function Fe(){const n=[];for(let t=0;t<20;t++){const s=Math.floor(62*Math.random());n.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(s))}return n.join("")}function lt(){return(0,y.aE)(y.b)}function ze(n){return(0,y.aF)("authEvent",n.config.apiKey,n.name)}function at(n){if(!n?.includes("?"))return{};const[o,...t]=n.split("?");return(0,M.I9)(t.join("?"))}const mt=class jt{constructor(){this._redirectPersistence=y.a,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=y.aG,this._overrideRedirectResult=y.aH}_initialize(o){var t=this;return(0,R.A)(function*(){const s=o._key();let a=t.eventManagers.get(s);return a||(a=new Xt(o),t.eventManagers.set(s,a),t.attachCallbackListeners(o,a)),a})()}_openPopup(o){(0,y.ax)(o,"operation-not-supported-in-this-environment")}_openRedirect(o,t,s,a){var h=this;return(0,R.A)(function*(){!function It(n){var o,t,s,a,h,g,G,q,ee,ce;const W=$();(0,y.aC)("function"==typeof(null===(o=W?.universalLinks)||void 0===o?void 0:o.subscribe),n,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),(0,y.aC)(typeof(null===(t=W?.BuildInfo)||void 0===t?void 0:t.packageName)<"u",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),(0,y.aC)("function"==typeof(null===(h=null===(a=null===(s=W?.cordova)||void 0===s?void 0:s.plugins)||void 0===a?void 0:a.browsertab)||void 0===h?void 0:h.openUrl),n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),(0,y.aC)("function"==typeof(null===(q=null===(G=null===(g=W?.cordova)||void 0===g?void 0:g.plugins)||void 0===G?void 0:G.browsertab)||void 0===q?void 0:q.isAvailable),n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),(0,y.aC)("function"==typeof(null===(ce=null===(ee=W?.cordova)||void 0===ee?void 0:ee.InAppBrowser)||void 0===ce?void 0:ce.open),n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}(o);const g=yield h._initialize(o);yield g.initialized(),g.resetRedirect(),(0,y.aI)(),yield h._originValidation(o);const G=function Ft(n,o,t=null){return{type:o,eventId:t,urlResponse:null,sessionId:Fe(),postBody:null,tenantId:n.tenantId,error:(0,y.aB)(n,"no-auth-event")}}(o,s,a);yield function Lt(n,o){return lt()._set(ze(n),o)}(o,G);const q=yield function it(n,o,t){return ot.apply(this,arguments)}(o,G,t),ee=yield function tt(n){const{cordova:o}=$();return new Promise(t=>{o.plugins.browsertab.isAvailable(s=>{let a=null;s?o.plugins.browsertab.openUrl(n):a=o.InAppBrowser.open(n,(0,y.aA)()?"_blank":"_system","location=yes"),t(a)})})}(q);return function Xe(n,o,t){return nt.apply(this,arguments)}(o,g,ee)})()}_isIframeWebStorageSupported(o,t){throw new Error("Method not implemented.")}_originValidation(o){const t=o._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=function st(n){return Ue.apply(this,arguments)}(o)),this.originValidationPromises[t]}attachCallbackListeners(o,t){const{universalLinks:s,handleOpenURL:a,BuildInfo:h}=$(),g=setTimeout((0,R.A)(function*(){yield St(o),t.onEvent(xt())}),500),G=function(){var ce=(0,R.A)(function*(W){clearTimeout(g);const Re=yield St(o);let Oe=null;Re&&W?.url&&(Oe=function Dt(n,o){var t,s;const a=function Pt(n){const o=at(n),t=o.link?decodeURIComponent(o.link):void 0,s=at(t).link,a=o.deep_link_id?decodeURIComponent(o.deep_link_id):void 0;return at(a).link||a||s||t||n}(o);if(a.includes("/__/auth/callback")){const h=at(a),g=h.firebaseError?function Et(n){try{return JSON.parse(n)}catch{return null}}(decodeURIComponent(h.firebaseError)):null,G=null===(s=null===(t=g?.code)||void 0===t?void 0:t.split("auth/"))||void 0===s?void 0:s[1],q=G?(0,y.aB)(G):null;return q?{type:n.type,eventId:n.eventId,tenantId:n.tenantId,error:q,urlResponse:null,sessionId:null,postBody:null}:{type:n.type,eventId:n.eventId,tenantId:n.tenantId,sessionId:n.sessionId,urlResponse:a,postBody:null}}return null}(Re,W.url)),t.onEvent(Oe||xt())});return function(Re){return ce.apply(this,arguments)}}();typeof s<"u"&&"function"==typeof s.subscribe&&s.subscribe(null,G);const q=a,ee=`${h.packageName.toLowerCase()}://`;$().handleOpenURL=function(){var ce=(0,R.A)(function*(W){if(W.toLowerCase().startsWith(ee)&&G({url:W}),"function"==typeof q)try{q(W)}catch(Re){console.error(Re)}});return function(W){return ce.apply(this,arguments)}}()}};function xt(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:(0,y.aB)("no-auth-event")}}const we={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(n,o){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=o?this.byteToCharMapWebSafe_:this.byteToCharMap_,s=[];for(let a=0;a<n.length;a+=3){const h=n[a],g=a+1<n.length,G=g?n[a+1]:0,q=a+2<n.length,ee=q?n[a+2]:0;let Re=(15&G)<<2|ee>>6,Oe=63&ee;q||(Oe=64,g||(Re=64)),s.push(t[h>>2],t[(3&h)<<4|G>>4],t[Re],t[Oe])}return s.join("")},encodeString(n,o){return this.HAS_NATIVE_SUPPORT&&!o?btoa(n):this.encodeByteArray(function(n){const o=[];let t=0;for(let s=0;s<n.length;s++){let a=n.charCodeAt(s);a<128?o[t++]=a:a<2048?(o[t++]=a>>6|192,o[t++]=63&a|128):55296==(64512&a)&&s+1<n.length&&56320==(64512&n.charCodeAt(s+1))?(a=65536+((1023&a)<<10)+(1023&n.charCodeAt(++s)),o[t++]=a>>18|240,o[t++]=a>>12&63|128,o[t++]=a>>6&63|128,o[t++]=63&a|128):(o[t++]=a>>12|224,o[t++]=a>>6&63|128,o[t++]=63&a|128)}return o}(n),o)},decodeString(n,o){return this.HAS_NATIVE_SUPPORT&&!o?atob(n):function(n){const o=[];let t=0,s=0;for(;t<n.length;){const a=n[t++];if(a<128)o[s++]=String.fromCharCode(a);else if(a>191&&a<224){const h=n[t++];o[s++]=String.fromCharCode((31&a)<<6|63&h)}else if(a>239&&a<365){const q=((7&a)<<18|(63&n[t++])<<12|(63&n[t++])<<6|63&n[t++])-65536;o[s++]=String.fromCharCode(55296+(q>>10)),o[s++]=String.fromCharCode(56320+(1023&q))}else{const h=n[t++],g=n[t++];o[s++]=String.fromCharCode((15&a)<<12|(63&h)<<6|63&g)}}return o.join("")}(this.decodeStringToByteArray(n,o))},decodeStringToByteArray(n,o){this.init_();const t=o?this.charToByteMapWebSafe_:this.charToByteMap_,s=[];for(let a=0;a<n.length;){const h=t[n.charAt(a++)],G=a<n.length?t[n.charAt(a)]:0;++a;const ee=a<n.length?t[n.charAt(a)]:64;++a;const W=a<n.length?t[n.charAt(a)]:64;if(++a,null==h||null==G||null==ee||null==W)throw new dt;s.push(h<<2|G>>4),64!==ee&&(s.push(G<<4&240|ee>>2),64!==W&&s.push(ee<<6&192|W))}return s},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class dt extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const ht=()=>{try{return function kt(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__||(()=>{if(typeof process>"u"||typeof process.env>"u")return;const n=process.env.__FIREBASE_DEFAULTS__;return n?JSON.parse(n):void 0})()||(()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const o=n&&function(n){try{return we.decodeString(n,!0)}catch(o){console.error("base64Decode failed: ",o)}return null}(n[1]);return o&&JSON.parse(o)})()}catch(n){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`)}};function m(){return typeof navigator<"u"&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function V(){var n;const o=null===(n=ht())||void 0===n?void 0:n.forceEnvironment;if("node"===o)return!0;if("browser"===o)return!1;try{return"[object process]"===Object.prototype.toString.call(global.process)}catch{return!1}}function ft(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function cn(){try{return"object"==typeof indexedDB}catch{return!1}}class Ee extends Error{constructor(o,t,s){super(t),this.code=o,this.customData=s,this.name="FirebaseError",Object.setPrototypeOf(this,Ee.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ln.prototype.create)}}class ln{constructor(o,t,s){this.service=o,this.serviceName=t,this.errors=s}create(o,...t){const s=t[0]||{},a=`${this.service}/${o}`,h=this.errors[o],g=h?function Mn(n,o){return n.replace(Gt,(t,s)=>{const a=o[s];return null!=a?String(a):`<${s}?>`})}(h,s):"Error";return new Ee(a,`${this.serviceName}: ${g} (${a}).`,s)}}const Gt=/\{\$([^}]+)}/g;function Zt(){var n;return(null===(n=self?.location)||void 0===n?void 0:n.protocol)||null}function gn(n=m()){return!("file:"!==Zt()&&"ionic:"!==Zt()&&"capacitor:"!==Zt()||!n.toLowerCase().match(/iphone|ipad|ipod|android/))}function wr(n=m()){return function Ir(){return function on(){const n=m();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}()&&11===document?.documentMode}()||function Sn(n=m()){return/Edge\/\d+/.test(n)}(n)}function er(){try{const n=self.localStorage,o=y.aN();if(n)return n.setItem(o,"1"),n.removeItem(o),!wr()||cn()}catch{return mn()&&cn()}return!1}function mn(){return typeof global<"u"&&"WorkerGlobalScope"in global&&"importScripts"in global}function _n(){return(function Qn(){return"http:"===Zt()||"https:"===Zt()}()||function $e(){const n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof n&&void 0!==n.id}()||gn())&&!function Zn(){return ft()||V()}()&&er()&&!mn()}function en(){return gn()&&typeof document<"u"}function an(){return(an=(0,R.A)(function*(){return!!en()&&new Promise(n=>{const o=setTimeout(()=>{n(!1)},1e3);document.addEventListener("deviceready",()=>{clearTimeout(o),n(!0)})})})).apply(this,arguments)}const Ve={LOCAL:"local",NONE:"none",SESSION:"session"},Wt=y.aC,Dn="persistence";function vn(n){return yn.apply(this,arguments)}function yn(){return(yn=(0,R.A)(function*(n){yield n._initializationPromise;const o=Pn(),t=y.aF(Dn,n.config.apiKey,n.name);o&&o.setItem(t,n._getPersistence())})).apply(this,arguments)}function Pn(){var n;try{return(null===(n=function bt(){return typeof window<"u"?window:null}())||void 0===n?void 0:n.sessionStorage)||null}catch{return null}}const rr=y.aC;class Ct{constructor(){this.browserResolver=y.aE(y.k),this.cordovaResolver=y.aE(mt),this.underlyingResolver=null,this._redirectPersistence=y.a,this._completeRedirectFn=y.aG,this._overrideRedirectResult=y.aH}_initialize(o){var t=this;return(0,R.A)(function*(){return yield t.selectUnderlyingResolver(),t.assertedUnderlyingResolver._initialize(o)})()}_openPopup(o,t,s,a){var h=this;return(0,R.A)(function*(){return yield h.selectUnderlyingResolver(),h.assertedUnderlyingResolver._openPopup(o,t,s,a)})()}_openRedirect(o,t,s,a){var h=this;return(0,R.A)(function*(){return yield h.selectUnderlyingResolver(),h.assertedUnderlyingResolver._openRedirect(o,t,s,a)})()}_isIframeWebStorageSupported(o,t){this.assertedUnderlyingResolver._isIframeWebStorageSupported(o,t)}_originValidation(o){return this.assertedUnderlyingResolver._originValidation(o)}get _shouldInitProactively(){return en()||this.browserResolver._shouldInitProactively}get assertedUnderlyingResolver(){return rr(this.underlyingResolver,"internal-error"),this.underlyingResolver}selectUnderlyingResolver(){var o=this;return(0,R.A)(function*(){if(o.underlyingResolver)return;const t=yield function On(){return an.apply(this,arguments)}();o.underlyingResolver=t?o.cordovaResolver:o.browserResolver})()}}function tn(n){return n.unwrap()}function or(n){return xn(n)}function xn(n){const{_tokenResponse:o}=n instanceof Ee?n.customData:n;if(!o)return null;if(!(n instanceof Ee)&&"temporaryProof"in o&&"phoneNumber"in o)return y.P.credentialFromResult(n);const t=o.providerId;if(!t||t===y.p.PASSWORD)return null;let s;switch(t){case y.p.GOOGLE:s=y.X;break;case y.p.FACEBOOK:s=y.W;break;case y.p.GITHUB:s=y.Y;break;case y.p.TWITTER:s=y.$;break;default:const{oauthIdToken:a,oauthAccessToken:h,oauthTokenSecret:g,pendingToken:G,nonce:q}=o;return h||g||a||G?G?t.startsWith("saml.")?y.aQ._create(t,G):y.N._fromParams({providerId:t,signInMethod:t,pendingToken:G,idToken:a,accessToken:h}):new y.Z(t).credential({idToken:a,accessToken:h,rawNonce:q}):null}return n instanceof Ee?s.credentialFromError(n):s.credentialFromResult(n)}function Ge(n,o){return o.catch(t=>{throw t instanceof Ee&&function sr(n,o){var t;const s=null===(t=o.customData)||void 0===t?void 0:t._tokenResponse;if("auth/multi-factor-auth-required"===o?.code)o.resolver=new ar(n,y.as(n,o));else if(s){const a=xn(o),h=o;a&&(h.credential=a,h.tenantId=s.tenantId||void 0,h.email=s.email||void 0,h.phoneNumber=s.phoneNumber||void 0)}}(n,t),t}).then(t=>{const a=t.user;return{operationType:t.operationType,credential:or(t),additionalUserInfo:y.aq(t),user:i.getOrCreate(a)}})}function Bn(n,o){return bn.apply(this,arguments)}function bn(){return(bn=(0,R.A)(function*(n,o){const t=yield o;return{verificationId:t.verificationId,confirm:s=>Ge(n,t.confirm(s))}})).apply(this,arguments)}class ar{constructor(o,t){this.resolver=t,this.auth=function ir(n){return n.wrapped()}(o)}get session(){return this.resolver.session}get hints(){return this.resolver.hints}resolveSignIn(o){return Ge(tn(this.auth),this.resolver.resolveSignIn(o))}}class i{constructor(o){this._delegate=o,this.multiFactor=y.at(o)}static getOrCreate(o){return i.USER_MAP.has(o)||i.USER_MAP.set(o,new i(o)),i.USER_MAP.get(o)}delete(){return this._delegate.delete()}reload(){return this._delegate.reload()}toJSON(){return this._delegate.toJSON()}getIdTokenResult(o){return this._delegate.getIdTokenResult(o)}getIdToken(o){return this._delegate.getIdToken(o)}linkAndRetrieveDataWithCredential(o){return this.linkWithCredential(o)}linkWithCredential(o){var t=this;return(0,R.A)(function*(){return Ge(t.auth,y.a2(t._delegate,o))})()}linkWithPhoneNumber(o,t){var s=this;return(0,R.A)(function*(){return Bn(s.auth,y.l(s._delegate,o,t))})()}linkWithPopup(o){var t=this;return(0,R.A)(function*(){return Ge(t.auth,y.d(t._delegate,o,Ct))})()}linkWithRedirect(o){var t=this;return(0,R.A)(function*(){return yield vn(y.aJ(t.auth)),y.g(t._delegate,o,Ct)})()}reauthenticateAndRetrieveDataWithCredential(o){return this.reauthenticateWithCredential(o)}reauthenticateWithCredential(o){var t=this;return(0,R.A)(function*(){return Ge(t.auth,y.a3(t._delegate,o))})()}reauthenticateWithPhoneNumber(o,t){return Bn(this.auth,y.r(this._delegate,o,t))}reauthenticateWithPopup(o){return Ge(this.auth,y.e(this._delegate,o,Ct))}reauthenticateWithRedirect(o){var t=this;return(0,R.A)(function*(){return yield vn(y.aJ(t.auth)),y.h(t._delegate,o,Ct)})()}sendEmailVerification(o){return y.ag(this._delegate,o)}unlink(o){var t=this;return(0,R.A)(function*(){return yield y.ap(t._delegate,o),t})()}updateEmail(o){return y.al(this._delegate,o)}updatePassword(o){return y.am(this._delegate,o)}updatePhoneNumber(o){return y.u(this._delegate,o)}updateProfile(o){return y.ak(this._delegate,o)}verifyBeforeUpdateEmail(o,t){return y.ah(this._delegate,o,t)}get emailVerified(){return this._delegate.emailVerified}get isAnonymous(){return this._delegate.isAnonymous}get metadata(){return this._delegate.metadata}get phoneNumber(){return this._delegate.phoneNumber}get providerData(){return this._delegate.providerData}get refreshToken(){return this._delegate.refreshToken}get tenantId(){return this._delegate.tenantId}get displayName(){return this._delegate.displayName}get email(){return this._delegate.email}get photoURL(){return this._delegate.photoURL}get providerId(){return this._delegate.providerId}get uid(){return this._delegate.uid}get auth(){return this._delegate.auth}}i.USER_MAP=new WeakMap;const r=y.aC;let u=(()=>{class n{constructor(t,s){if(this.app=t,s.isInitialized())return this._delegate=s.getImmediate(),void this.linkUnderlyingAuth();const{apiKey:a}=t.options;r(a,"invalid-api-key",{appName:t.name}),r(a,"invalid-api-key",{appName:t.name});const h=typeof window<"u"?Ct:void 0;this._delegate=s.initialize({options:{persistence:p(a,t.name),popupRedirectResolver:h}}),this._delegate._updateErrorMap(y.G),this.linkUnderlyingAuth()}get emulatorConfig(){return this._delegate.emulatorConfig}get currentUser(){return this._delegate.currentUser?i.getOrCreate(this._delegate.currentUser):null}get languageCode(){return this._delegate.languageCode}set languageCode(t){this._delegate.languageCode=t}get settings(){return this._delegate.settings}get tenantId(){return this._delegate.tenantId}set tenantId(t){this._delegate.tenantId=t}useDeviceLanguage(){this._delegate.useDeviceLanguage()}signOut(){return this._delegate.signOut()}useEmulator(t,s){y.K(this._delegate,t,s)}applyActionCode(t){return y.a7(this._delegate,t)}checkActionCode(t){return y.a8(this._delegate,t)}confirmPasswordReset(t,s){return y.a6(this._delegate,t,s)}createUserWithEmailAndPassword(t,s){var a=this;return(0,R.A)(function*(){return Ge(a._delegate,y.aa(a._delegate,t,s))})()}fetchProvidersForEmail(t){return this.fetchSignInMethodsForEmail(t)}fetchSignInMethodsForEmail(t){return y.af(this._delegate,t)}isSignInWithEmailLink(t){return y.ad(this._delegate,t)}getRedirectResult(){var t=this;return(0,R.A)(function*(){r(_n(),t._delegate,"operation-not-supported-in-this-environment");const s=yield y.j(t._delegate,Ct);return s?Ge(t._delegate,Promise.resolve(s)):{credential:null,user:null}})()}addFrameworkForLogging(t){!function Me(n,o){(0,y.aJ)(n)._logFramework(o)}(this._delegate,t)}onAuthStateChanged(t,s,a){const{next:h,error:g,complete:G}=l(t,s,a);return this._delegate.onAuthStateChanged(h,g,G)}onIdTokenChanged(t,s,a){const{next:h,error:g,complete:G}=l(t,s,a);return this._delegate.onIdTokenChanged(h,g,G)}sendSignInLinkToEmail(t,s){return y.ac(this._delegate,t,s)}sendPasswordResetEmail(t,s){return y.a5(this._delegate,t,s||void 0)}setPersistence(t){var s=this;return(0,R.A)(function*(){let a;switch(function tr(n,o){Wt(Object.values(Ve).includes(o),n,"invalid-persistence-type"),ft()?Wt(o!==Ve.SESSION,n,"unsupported-persistence-type"):V()?Wt(o===Ve.NONE,n,"unsupported-persistence-type"):mn()?Wt(o===Ve.NONE||o===Ve.LOCAL&&cn(),n,"unsupported-persistence-type"):Wt(o===Ve.NONE||er(),n,"unsupported-persistence-type")}(s._delegate,t),t){case Ve.SESSION:a=y.a;break;case Ve.LOCAL:a=(yield y.aE(y.i)._isAvailable())?y.i:y.b;break;case Ve.NONE:a=y.U;break;default:return y.ax("argument-error",{appName:s._delegate.name})}return s._delegate.setPersistence(a)})()}signInAndRetrieveDataWithCredential(t){return this.signInWithCredential(t)}signInAnonymously(){return Ge(this._delegate,y.a0(this._delegate))}signInWithCredential(t){return Ge(this._delegate,y.a1(this._delegate,t))}signInWithCustomToken(t){return Ge(this._delegate,y.a4(this._delegate,t))}signInWithEmailAndPassword(t,s){return Ge(this._delegate,y.ab(this._delegate,t,s))}signInWithEmailLink(t,s){return Ge(this._delegate,y.ae(this._delegate,t,s))}signInWithPhoneNumber(t,s){return Bn(this._delegate,y.s(this._delegate,t,s))}signInWithPopup(t){var s=this;return(0,R.A)(function*(){return r(_n(),s._delegate,"operation-not-supported-in-this-environment"),Ge(s._delegate,y.c(s._delegate,t,Ct))})()}signInWithRedirect(t){var s=this;return(0,R.A)(function*(){return r(_n(),s._delegate,"operation-not-supported-in-this-environment"),yield vn(s._delegate),y.f(s._delegate,t,Ct)})()}updateCurrentUser(t){return this._delegate.updateCurrentUser(t)}verifyPasswordResetCode(t){return y.a9(this._delegate,t)}unwrap(){return this._delegate}_delete(){return this._delegate._delete()}linkUnderlyingAuth(){this._delegate.wrapped=()=>this}}return n.Persistence=Ve,n})();function l(n,o,t){let s=n;"function"!=typeof n&&({next:s,error:o,complete:t}=n);const a=s;return{next:g=>a(g&&i.getOrCreate(g)),error:o,complete:t}}function p(n,o){const t=function nr(n,o){const t=Pn();if(!t)return[];const s=y.aF(Dn,n,o);switch(t.getItem(s)){case Ve.NONE:return[y.U];case Ve.LOCAL:return[y.i,y.a];case Ve.SESSION:return[y.a];default:return[]}}(n,o);if(typeof self<"u"&&!t.includes(y.i)&&t.push(y.i),typeof window<"u")for(const s of[y.b,y.a])t.includes(s)||t.push(s);return t.includes(y.U)||t.push(y.U),t}class b{constructor(){this.providerId="phone",this._delegate=new y.P(tn(ne.A.auth()))}static credential(o,t){return y.P.credential(o,t)}verifyPhoneNumber(o,t){return this._delegate.verifyPhoneNumber(o,t)}unwrap(){return this._delegate}}b.PHONE_SIGN_IN_METHOD=y.P.PHONE_SIGN_IN_METHOD,b.PROVIDER_ID=y.P.PROVIDER_ID;const k=y.aC;class K{constructor(o,t,s=ne.A.app()){var a;k(null===(a=s.options)||void 0===a?void 0:a.apiKey,"invalid-api-key",{appName:s.name}),this._delegate=new y.R(s.auth(),o,t),this.type=this._delegate.type}clear(){this._delegate.clear()}render(){return this._delegate.render()}verify(){return this._delegate.verify()}}!function Y(n){n.INTERNAL.registerComponent(new H.uA("auth-compat",o=>{const t=o.getProvider("app-compat").getImmediate(),s=o.getProvider("auth");return new u(t,s)},"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:y.A.EMAIL_SIGNIN,PASSWORD_RESET:y.A.PASSWORD_RESET,RECOVER_EMAIL:y.A.RECOVER_EMAIL,REVERT_SECOND_FACTOR_ADDITION:y.A.REVERT_SECOND_FACTOR_ADDITION,VERIFY_AND_CHANGE_EMAIL:y.A.VERIFY_AND_CHANGE_EMAIL,VERIFY_EMAIL:y.A.VERIFY_EMAIL}},EmailAuthProvider:y.V,FacebookAuthProvider:y.W,GithubAuthProvider:y.Y,GoogleAuthProvider:y.X,OAuthProvider:y.Z,SAMLAuthProvider:y._,PhoneAuthProvider:b,PhoneMultiFactorGenerator:y.m,RecaptchaVerifier:K,TwitterAuthProvider:y.$,Auth:u,AuthCredential:y.L,Error:Ee}).setInstantiationMode("LAZY").setMultipleInstances(!1)),n.registerVersion("@firebase/auth-compat","0.5.15")}(ne.A);var ie=_(4333);const Te=["specialAuthContainer"];function ye(n,o){if(1&n){const t=e.RV6();e.j41(0,"a",7),e.bIt("click",function(a){const h=e.eBV(t).$implicit,g=e.XpG();return e.Njj(g.onClickReauthProvider(a,h))}),e.EFF(1),e.k0s()}if(2&n){const t=o.$implicit;e.R7$(),e.JRh(t.providerId)}}class ue extends Z.s{loader;toastr;static SUPPORTED_PROVIDERS={};static SupportedOauthProviderIds=[];destroy$=new C.B;get providers(){return this.currentUser.providerData}currentUser;reauthed=new e.bkB;specialAuthContainer;static{const o=ue.SUPPORTED_PROVIDERS,t=w.A.auth;o[t.EmailAuthProvider.PROVIDER_ID]=t.EmailAuthProvider,o[t.TwitterAuthProvider.PROVIDER_ID]=t.TwitterAuthProvider,o[t.GoogleAuthProvider.PROVIDER_ID]=t.GoogleAuthProvider,o[t.GithubAuthProvider.PROVIDER_ID]=t.GithubAuthProvider;const s=ue.SupportedOauthProviderIds;s.push(t.TwitterAuthProvider.PROVIDER_ID),s.push(t.GoogleAuthProvider.PROVIDER_ID),s.push(t.GithubAuthProvider.PROVIDER_ID)}constructor(o,t){super(),this.loader=o,this.toastr=t}ngOnDestroy(){this.destroy$.next()}isOAuthProvider(o){return!!ue.SupportedOauthProviderIds.includes(o)}onClickReauthProvider(o,t){var s=()=>super.close,a=this;return(0,R.A)(function*(){(0,S.Oi)("onClickReauthProvider()",o,t),o.preventDefault();const g=new(0,ue.SUPPORTED_PROVIDERS[t.providerId]);if(a.specialAuthContainer.clear(),a.isOAuthProvider(t.providerId)){try{yield a.currentUser.reauthenticateWithPopup(g)}catch(G){(0,S.sJ)("Error while reauth",G);const q=G instanceof Error?G.message:"Unknown error";return void a.toastr.error(`\u518d\u8a8d\u8a3c\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002 ( ${q} )`)}(0,S.Oi)("Reanthenticated via OAuth provider")}else{const{GitfireLoginModule:G}=yield Promise.resolve().then(_.bind(_,1951)),{InputAuthComponent:q}=yield Promise.resolve().then(_.bind(_,2751)),ee=a.loader.appendComponent(a.specialAuthContainer,G,q);ee.isReauth=!0,ee.reauthUser=a.currentUser,ee.showFederations=!1;const ce=ee.reauthed.pipe((0,O.s)(1));try{yield ce.toPromise()}catch(W){(0,S.sJ)("Error while reauth done",W);const Re=W instanceof Error?W.message:"Unknown error";return void a.toastr.error(`\u518d\u8a8d\u8a3c\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002 ( ${Re} )`)}(0,S.Oi)("Reanthenticated via password")}a.reauthed.next(),s().call(a)})()}static \u0275fac=function(t){return new(t||ue)(e.rXU(ie.Z),e.rXU(A.tw))};static \u0275cmp=e.VBU({type:ue,selectors:[["gitfire-reauth-box"]],viewQuery:function(t,s){if(1&t&&e.GBs(Te,5,e.c1b),2&t){let a;e.mGM(a=e.lsd())&&(s.specialAuthContainer=a.first)}},inputs:{currentUser:"currentUser"},outputs:{reauthed:"reauthed"},features:[e.Vt3],decls:10,vars:1,consts:[["specialAuthContainer",""],[1,"m-3"],[1,"btn-group"],["type","button","data-bs-toggle","dropdown","aria-haspopup","true","aria-expanded","false",1,"btn","btn-primary","dropdown-toggle"],[1,"visually-hidden"],[1,"dropdown-menu"],["class","dropdown-item","href","#",3,"click",4,"ngFor","ngForOf"],["href","#",1,"dropdown-item",3,"click"]],template:function(t,s){1&t&&(e.j41(0,"div",1)(1,"div",2)(2,"button",3)(3,"span",4),e.EFF(4,"Toggle Dropdown"),e.k0s(),e.EFF(5,"\u8a8d\u8a3c\u65b9\u6cd5"),e.k0s(),e.j41(6,"div",5),e.DNE(7,ye,2,1,"a",6),e.k0s()(),e.nrm(8,"div",null,0),e.k0s()),2&t&&(e.R7$(7),e.Y8G("ngForOf",s.providers))},dependencies:[B.Sq]})}var ke=_(6469);function Pe(n,o){if(n.value!==o){if(n.dirty)return void(0,S.sJ)(`Upstream value has been changed to ${n.value} -> ${o} but sillengly ignore the value.`);n.setErrors(null),n.setValue(o)}}function se(n){n.markAsPristine(),n.markAsUntouched()}var Qe=_(1474),ut=_(4871),Le=_(1637),Se=_(9182),Nt=_(4572),Kt=_(3294),Cn=_(8141),nn=_(2275);let En=(()=>{class n{controlLabel;formName;tooltipText;parentForm;checkChanged=new e.bkB;autoGeneratedId;constructor(){const t=Math.random().toString(36).substring(2);this.autoGeneratedId=`appViewInput-${t}`}ngOnInit(){(0,S.Oi)("SwitchComponent.OnInit()")}onChangeBox(t){(0,S.Oi)("SwitchComponent.onChangeBox()",this.parentForm),this.checkChanged.emit(t)}static \u0275fac=function(s){return new(s||n)};static \u0275cmp=e.VBU({type:n,selectors:[["app-switch"]],inputs:{controlLabel:"controlLabel",formName:"formName",tooltipText:"tooltipText",parentForm:"parentForm"},outputs:{checkChanged:"checkChanged"},decls:4,vars:7,consts:[[1,"custom-control","custom-switch",3,"formGroup","title"],["type","checkbox",1,"custom-control-input",3,"change","id","name","formControlName"],[1,"custom-control-label",3,"for"]],template:function(s,a){1&s&&(e.j41(0,"span",0)(1,"input",1),e.bIt("change",function(g){return a.onChangeBox(g)}),e.k0s(),e.j41(2,"label",2),e.EFF(3),e.k0s()()),2&s&&(e.FS9("title",a.tooltipText),e.Y8G("formGroup",a.parentForm),e.R7$(),e.FS9("id",a.autoGeneratedId),e.FS9("name",a.formName),e.FS9("formControlName",a.formName),e.R7$(),e.FS9("for",a.autoGeneratedId),e.R7$(),e.JRh(a.controlLabel))},dependencies:[c.Zm,c.BC,c.cb,c.j4,c.JD]})}return n})();function Sr(n,o){if(1&n){const t=e.RV6();e.j41(0,"button",22),e.bIt("click",function(a){e.eBV(t);const h=e.XpG().$implicit,g=e.XpG();return e.Njj(g.onClickDeleteDevice(a,h))}),e.EFF(1,"\u524a\u9664"),e.k0s()}}function Or(n,o){if(1&n){const t=e.RV6();e.j41(0,"div",19)(1,"app-switch",20),e.nI1(2,"date"),e.bIt("checkChanged",function(a){const h=e.eBV(t).$implicit,g=e.XpG();return e.Njj(g.onToggleDevice(a,h))}),e.k0s(),e.DNE(3,Sr,2,0,"button",21),e.k0s()}if(2&n){const t=o.$implicit,s=e.XpG();e.R7$(),e.yjJ("controlLabel","",t.name||"No Name"," ",t.id===s.registeredDeviceId?"[\u3053\u306e\u7aef\u672b]":null," (\u767b\u9332\u65e5: ",e.i5U(2,8,t.createdAt.toDate(),"yyyy-MM-dd"),")"),e.Mz_("formName","device-",t.id,""),e.Y8G("parentForm",s.deviceForm),e.R7$(2),e.Y8G("ngIf",t.id!==s.registeredDeviceId)}}function Dr(n,o){if(1&n&&(e.j41(0,"div"),e.EFF(1),e.k0s()),2&n){const t=o.$implicit,s=o.index;e.R7$(),e.Lme("",s,": ",t,"")}}function Pr(n,o){if(1&n&&(e.j41(0,"div"),e.EFF(1),e.k0s()),2&n){const t=o.$implicit,s=o.index;e.R7$(),e.Lme("",s,": ",t,"")}}function xr(n,o){if(1&n&&(e.j41(0,"div"),e.EFF(1),e.k0s()),2&n){const t=o.$implicit,s=o.index;e.R7$(),e.Lme("",s,": ",t,"")}}function Br(n,o){if(1&n&&(e.j41(0,"div"),e.EFF(1),e.nI1(2,"json"),e.k0s()),2&n){const t=o.$implicit;e.R7$(),e.JRh(e.bMT(2,1,t))}}let Ur=(()=>{class n{auth;dialog;toastr;store;funcs;messaging;destroy$=new C.B;mainForm;userPrivStore$;deviceForm;messagingTypeArray;configArray;currentUser$;registeredDeviceId;registeredToken;debugObservable={};devices;tokenReceived=new C.B;tokenReceived$;privUser;constructor(t,s,a,h,g,G){this.auth=t,this.dialog=s,this.toastr=a,this.store=h,this.funcs=g,this.messaging=G,this.privUser=this.store.collection("/users/v1/protected"),this.currentUser$=this.auth.clientSideUser$.pipe((0,N.p)(q=>!!q))}onToggleDevice(t,s){(0,S.Oi)("onToggleDevice()");const a=this.getDeviceControl(s),h={deviceId:s.id,off:!a.value};try{this.funcs.call("toggleSuspendDevice",h),this.toastr.success("\u7aef\u672b\u306e\u8a2d\u5b9a\u3092\u66f4\u65b0\u3057\u307e\u3057\u305f\u3002")}catch{this.toastr.error("\u7aef\u672b\u306e\u8a2d\u5b9a\u304c\u66f4\u65b0\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002")}}onClickDeleteDevice(t,s){var g,a=this;(0,S.Oi)("onClickDeleteDevice()"),this.messaging.deleteToken(s.token).pipe((0,U.Q)(this.destroy$)).subscribe({next:(g=(0,R.A)(function*(G){(0,S.rD)(`deleteToken() result ${G}`),a.toastr.success("\u7aef\u672b\u306e\u901a\u77e5\u3092\u89e3\u9664\u3057\u307e\u3057\u305f\u3002")}),function(q){return g.apply(this,arguments)}),error:g=>{(0,S.sJ)(`Failed to delete token token: ${s.token}`,g),this.toastr.error("\u7aef\u672b\u306e\u901a\u77e5\u3092\u89e3\u9664\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002\u65e2\u306b\u5931\u52b9\u3057\u3066\u3044\u308b\u53ef\u80fd\u6027\u304c\u3042\u308a\u307e\u3059\u3002")}});const h={deviceId:s.id};try{this.funcs.call("revokeDevice",h),this.toastr.success("\u30b7\u30b9\u30c6\u30e0\u4e0a\u304b\u3089\u7aef\u672b\u306e\u901a\u77e5\u3092\u89e3\u9664\u3057\u307e\u3057\u305f\u3002")}catch{this.toastr.error("\u30b7\u30b9\u30c6\u30e0\u4e0a\u306e\u7aef\u672b\u306e\u901a\u77e5\u3092\u89e3\u9664\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002")}}ngOnInit(){var t=this;const a=this.currentUser$.pipe((0,O.s)(1),(0,N.p)(h=>!!h)).pipe((0,me.n)(h=>this.store.collection(`users/v1/protected/${h.uid}/fcm`).valueChanges({idField:"id"})),(0,te.t)(1));a.pipe((0,U.Q)(this.destroy$)).subscribe(h=>{this.devices=h;for(const g in this.deviceForm.controls)this.deviceForm.removeControl(g);for(const g of this.devices)this.addDeviceControl(g);this.triggerTokenRefresh()}),this.mainForm.addControl("messagingOn",new c.MJ(!1,[])),this.deviceForm=new c.gE({}),this.mainForm.addControl("devices",this.deviceForm),this.mainForm.addControl("messagingSystemCheck",new c.MJ(!1,[])),this.mainForm.addControl("messagingTrivialCheck",new c.MJ(!1,[])),this.mainForm.addControl("messagingMentionCheck",new c.MJ(!1,[])),this.mainForm.addControl("messagingAdminCheck",new c.MJ(!1,[])),this.messagingTypeArray=new c.Yp([this.typeSystemControl,this.typeMentionControl,this.typeAdminControl]),this.configArray=new c.Yp([this.typeTrivialControl,this.messagingTypeArray]),this.userPrivStore$.pipe((0,U.Q)(this.destroy$)).subscribe(h=>{(0,S.rD)("this.userPrivStore$.subscribe()",h);const g=h.messagingTypes||["mention","admin"];Pe(this.typeSystemControl,g.includes("system")),Pe(this.typeMentionControl,g.includes("mention")),Pe(this.typeAdminControl,g.includes("admin")),Pe(this.typeTrivialControl,h.isWatchTrivial)}),this.tokenReceived$=this.tokenReceived.pipe((0,N.p)(h=>null!==h),(0,Kt.F)()),(0,Nt.z)(this.tokenReceived$,a).pipe((0,U.Q)(this.destroy$)).subscribe(function(){var h=(0,R.A)(function*([g,G]){if((0,S.Oi)("this.messaging.tokenReceived subscribe()",g,G),t.debugObservable.registeredToken=g,t.registeredToken=g,g){const ee=t.findDeviceId(g,G);if(!ee)return void t.toastr.error("\u30c7\u30d0\u30a4\u30b9\u306e\u53d6\u5f97\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002");t.registeredDeviceId=ee}Pe(t.messagingOnControl,!!t.registeredDeviceId)});return function(g){return h.apply(this,arguments)}}()),this.triggerTokenRefresh(),this.debugObservable.messages=[],this.messaging.messages.pipe((0,U.Q)(this.destroy$)).subscribe(h=>{(0,S.rD)("message received from messaging",h),this.debugObservable.messages.push(h)}),this.debugObservable.getToken$=this.messaging.getToken,this.debugObservable.getToken=[],this.debugObservable.getToken$.subscribe({next:h=>this.debugObservable.getToken.push(h),complete:()=>(0,S.rD)("Complete getToken()")}),this.debugObservable.tokenChanges$=this.messaging.tokenChanges,this.debugObservable.tokenChanges=[],this.debugObservable.tokenChanges$.subscribe({next:h=>this.debugObservable.tokenChanges.push(h),complete:()=>(0,S.rD)("Complete tokenChanges()")}),this.debugObservable.tokenReceived=[]}findDeviceId(t,s){for(const a of s)if(a.token===t)return a.id;return null}ngOnDestroy(){this.destroy$.next()}triggerTokenRefresh(){this.messaging.getToken.pipe((0,O.s)(1),(0,U.Q)(this.destroy$)).subscribe({next:t=>this.tokenReceived.next(t),complete:()=>(0,S.Oi)("Completed getToken")})}get messagingOnControl(){return this.mainForm.get("messagingOn")}getDeviceControl(t){return this.deviceForm.get(`device-${t.id}`)}addDeviceControl(t){const s=new c.MJ(!t.isSuspend,[]);this.deviceForm.addControl(`device-${t.id}`,s)}get typeTrivialControl(){return this.mainForm.get("messagingTrivialCheck")}get typeSystemControl(){return this.mainForm.get("messagingSystemCheck")}get typeMentionControl(){return this.mainForm.get("messagingMentionCheck")}get typeAdminControl(){return this.mainForm.get("messagingAdminCheck")}revokeNotification(){var t=this;return(0,R.A)(function*(){if(!t.registeredDeviceId)return(0,S.sJ)("Unexpectedly no deviceId is found."),void t.toastr.error("\u30c7\u30d0\u30a4\u30b9\u60c5\u5831\u3092\u7121\u52b9\u306b\u3067\u304d\u307e\u305b\u3093\u3002");try{t.funcs.call("revokeDevice",{deviceId:t.registeredDeviceId}),t.toastr.info("\u30b7\u30b9\u30c6\u30e0\u304b\u3089\u901a\u77e5\u60c5\u5831\u3092\u524a\u9664\u3057\u307e\u3057\u305f\u3002")}catch(s){return(0,S.sJ)("Error while deleting token via Functions",s),t.messagingOnControl.setValue(!0),se(t.messagingOnControl),void t.toastr.error("\u30b7\u30b9\u30c6\u30e0\u306e\u901a\u77e5\u60c5\u5831\u3092\u524a\u9664\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002")}t.messaging.getToken.pipe((0,Cn.M)(s=>(0,S.Oi)(`getToken before deleteToken ${s}`)),(0,Ne.Z)(s=>t.messaging.deleteToken(s)),(0,O.s)(1),(0,U.Q)(t.destroy$)).subscribe({next:s=>{(0,S.rD)(`Deleted result: ${s} on FCM.`),se(t.messagingOnControl),t.toastr.success("\u901a\u77e5\u60c5\u5831\u3092\u524a\u9664\u3057\u307e\u3057\u305f\u3002")},error:s=>{(0,S.sJ)("Error while deleting token on FCM",s),t.toastr.error("\u901a\u77e5\u60c5\u5831\u304c\u524a\u9664\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002")}})})()}onToggleMessaging(t){var s=this;return(0,R.A)(function*(){if((0,S.Oi)("UserSettingsComponent.onToggleMessaging()"),s.messagingOnControl.value){if(!s.registeredDeviceId&&s.devices&&s.devices.length>=S.cA.FCMDeviceMaxCount)return void s.toastr.error("\u767b\u9332\u3055\u308c\u305f\u30c7\u30d0\u30a4\u30b9\u304c\u591a\u3059\u304e\u307e\u3059\u3002\u524a\u9664\u3057\u3066\u304b\u3089\u3084\u308a\u76f4\u3057\u3066\u304f\u3060\u3055\u3044\u3002");yield s.updateRequestToken()}else{const h=s.dialog.createHtmlBuilder(),g=new nn.tt("\n<div>\n\u767b\u9332\u3092\u89e3\u9664\u3059\u308b\u3068\u3059\u3079\u3066\u306e\u901a\u77e5\u306f\u505c\u6b62\u3057\u307e\u3059\u3002\u3088\u308d\u3057\u3044\u3067\u3059\u304b\uff1f\n</div>\n");h.setMessage(g).setType(re.hs.Warn).setSize(re.EV.Default).setTitle("\u78ba\u8a8d").okButton((0,R.A)(function*(){yield s.revokeNotification()})).cancelButton(()=>{s.messagingOnControl.setValue(!0),se(s.messagingOnControl)}).open()}})()}getMessagingTypes(){const t=[];return this.typeSystemControl.value&&t.push("system"),this.typeMentionControl.value&&t.push("mention"),this.typeAdminControl.value&&t.push("admin"),t}updateRequestToken(){var t=this;return(0,R.A)(function*(){var s;t.messaging.requestToken.pipe((0,O.s)(1),(0,U.Q)(t.destroy$)).subscribe({next:(s=(0,R.A)(function*(a){if(t.tokenReceived.next(a),t.debugObservable.tokenReceived.push(a),!a)return(0,S.sJ)("No token returned from requestToken"),t.messagingOnControl.setValue(!1),se(t.messagingOnControl),void t.toastr.error("\u901a\u77e5\u60c5\u5831\u3092\u53d6\u5f97\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002");try{(0,S.Oi)(`Updated token with ${a}`);const h={token:a,deviceId:t.registeredDeviceId};t.registeredToken=a,t.registeredDeviceId=yield t.funcs.call("saveDeviceToken",h),t.toastr.success("\u901a\u77e5\u60c5\u5831\u3092\u4fdd\u5b58\u3057\u307e\u3057\u305f\u3002"),se(t.messagingOnControl)}catch(h){(0,S.sJ)("Error while save token to Firestore",h),t.messagingOnControl.setValue(!1),se(t.messagingOnControl),t.toastr.error("\u901a\u77e5\u60c5\u5831\u3092\u4fdd\u5b58\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002")}}),function(h){return s.apply(this,arguments)}),error:s=>{(0,S.sJ)("Error while request Token",s),t.messagingOnControl.setValue(!1),se(t.messagingOnControl),t.toastr.error("\u901a\u77e5\u3092\u6709\u52b9\u306b\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002\u30d6\u30e9\u30a6\u30b6\u306e\u8a2d\u5b9a\u3092\u78ba\u8a8d\u3057\u3066\u304f\u3060\u3055\u3044\u3002")}})})()}onClickUpdateMessaging(t){var s=this;return(0,R.A)(function*(){(0,S.Oi)("UserSettingsComponent.onClickUpdateMessaging()");try{const a={messageTypes:s.getMessagingTypes(),token:s.registeredToken,isWatchTrivial:s.typeTrivialControl.value};yield s.funcs.call("setNotifications",a),se(s.configArray),s.toastr.success("\u8a2d\u5b9a\u3092\u4fdd\u5b58\u3057\u307e\u3057\u305f\u3002")}catch(a){(0,S.sJ)("Failed to save configuration",a),s.toastr.error("\u8a2d\u5b9a\u304c\u4fdd\u5b58\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002")}})()}onClickSubscribeTopic(t){var s=this;return(0,R.A)(function*(){if(!s.debugObservable.topicText)return void alert("Not set");const a={topic:s.debugObservable.topicText,token:s.registeredToken},h=yield s.funcs.call("subscribeTopicTest",a);(0,S.rD)("subscribeTopicTest ->",h),s.toastr.success(`done subscribe ${h}`)})()}onClickUnsubscribeTopic(t){var s=this;return(0,R.A)(function*(){if(!s.debugObservable.topicText)return void alert("Not set");const a={topic:s.debugObservable.topicText,token:s.registeredToken},h=yield s.funcs.call("unsubscribeTopicTest",a);(0,S.rD)("unsubscribeTopicTest ->",h),s.toastr.success(`done unsubscribe ${h}`)})()}onClickPostToTopic(t){var s=this;return(0,R.A)(function*(){if(!s.debugObservable.topicText||!s.debugObservable.topicPostText)return void alert("Not set");const a={topic:s.debugObservable.topicText,title:s.debugObservable.topicPostText},h=yield s.funcs.call("postTopicTest",a);(0,S.rD)("postTopicTest ->",h),s.toastr.success(`done post ${h}`)})()}onClickConditionPostToTopic(t){var s=this;return(0,R.A)(function*(){if(!s.debugObservable.conditionTopicPostText||!s.debugObservable.conditionTopicPostText)return void alert("Not set");const a={topic:s.debugObservable.conditionTopicPostText,title:s.debugObservable.topicPostText},h=yield s.funcs.call("postConditionTopicTest",a);(0,S.rD)("postConditionTopicTest ->",h),s.toastr.success(`done post ${h}`)})()}onClickClearMessages(t){this.debugObservable.messages=[]}static \u0275fac=function(s){return new(s||n)(e.rXU(Qe.u),e.rXU(re.o3),e.rXU(A.tw),e.rXU(le.Qe),e.rXU(ut.Y),e.rXU(E))};static \u0275cmp=e.VBU({type:n,selectors:[["gitfire-user-notification"]],inputs:{mainForm:"mainForm",userPrivStore$:"userPrivStore$"},decls:69,vars:16,consts:[[1,"m-2"],["title","\u3053\u306e\u6a5f\u80fd\u306f\u30c6\u30b9\u30c8\u4e2d\u306e\u305f\u3081\u5909\u66f4\u3055\u308c\u308b\u3053\u3068\u3084\u3001\u60f3\u5b9a\u5916\u306e\u6319\u52d5\u3092\u3059\u308b\u5834\u5408\u304c\u3042\u308a\u307e\u3059\u3002\u30d6\u30e9\u30a6\u30b6\u304b\u3089\u306e\u901a\u77e5\u3092\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u3057\u307e\u3059\u3002\u8a2d\u5b9a\u304c\u3046\u307e\u304f\u3044\u304b\u306a\u3044\u5834\u5408\u306f\u30d6\u30e9\u30a6\u30b6\u304b\u3089\u5f53\u30b5\u30a4\u30c8\u306e\u901a\u77e5 on/off \u3092\u3057\u305f\u308a\u3001\u300e\u7aef\u672b\u306e\u524a\u9664\u300f\u3092\u304a\u8a66\u3057\u304f\u3060\u3055\u3044\u3002","src","/assets/octicons/question.svg",1,"m-3","octicon-info","help-icon"],[1,"m-2",3,"formGroup"],[1,"row","p-1"],[1,"d-flex","align-content-start","flex-wrap","p-1"],["controlLabel","\u901a\u77e5\u3092\u53d7\u3051\u53d6\u308b","formName","messagingOn","tooltipText","\u30d6\u30e9\u30a6\u30b6\u304b\u3089\u306e\u901a\u77e5\u3092\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u3057\u307e\u3059\u3002",1,"p-2",3,"checkChanged","parentForm"],[1,"d-flex","align-content-start","flex-wrap","p-3"],["class","m-1 input-group",4,"ngFor","ngForOf"],[1,"row","m-2"],["controlLabel","\u3061\u3087\u3063\u3068\u3057\u305f\u901a\u77e5","formName","messagingTrivialCheck","tooltipText","\u3061\u3087\u3063\u3068\u3057\u305f\u901a\u77e5\u3082\u53d7\u3051\u53d6\u308b\u304b\u3069\u3046\u304b\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\u901a\u5e38\u306f\u4e0d\u8981\u3067\u3059\u3002",1,"p-2",3,"parentForm"],["controlLabel","\u30b7\u30b9\u30c6\u30e0","formName","messagingSystemCheck","tooltipText","\u30b7\u30b9\u30c6\u30e0\u304b\u3089\u306e\u901a\u77e5\u3092\u9001\u308b\u304b\u3069\u3046\u304b\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002",1,"p-2",3,"parentForm"],["controlLabel","\u3042\u306a\u305f\u3078\u306e\u8a00\u53ca","formName","messagingMentionCheck","tooltipText","\u30b7\u30b9\u30c6\u30e0\u306e\u30e1\u30c3\u30bb\u30fc\u30b8\u30b7\u30b9\u30c6\u30e0\u3067\u3042\u306a\u305f\u306b\u8a00\u53ca\u3055\u308c\u305f\u5834\u5408\u306b\u901a\u77e5\u3092\u9001\u308b\u304b\u3069\u3046\u304b\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002",1,"p-2",3,"parentForm"],["controlLabel","\u7ba1\u7406\u4eba\u304b\u3089","formName","messagingAdminCheck","tooltipText","\u7ba1\u7406\u4eba\u304c\u624b\u52d5\u3067\u3042\u306a\u305f\u306b\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u9001\u3063\u305f\u5834\u5408\u306b\u901a\u77e5\u3092\u9001\u308b\u304b\u3069\u3046\u304b\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002",1,"p-2",3,"parentForm"],[1,"btn","btn-primary",3,"click","disabled"],[2,"width","100%","overflow-wrap","break-word"],[4,"ngFor","ngForOf"],["type","text",3,"ngModelChange","ngModel"],[1,"btn","btn-primary",3,"click"],[1,"btn","btn-warning",3,"click"],[1,"m-1","input-group"],["tooltipText","\u767b\u9332\u3055\u308c\u305f Device \u306e\u901a\u77e5\u3092\u4e00\u6642\u7684\u306b\u505c\u6b62\u3057\u307e\u3059\u3002",1,"m-2",3,"checkChanged","parentForm","controlLabel","formName"],["class","btn btn-warning","title","\u767b\u9332\u60c5\u5831\u3092\u524a\u9664\u3057\u3066\u3001\u3053\u306e\u7aef\u672b\u3078\u306e\u901a\u77e5\u3092\u89e3\u9664\u3057\u307e\u3059\u3002",3,"click",4,"ngIf"],["title","\u767b\u9332\u60c5\u5831\u3092\u524a\u9664\u3057\u3066\u3001\u3053\u306e\u7aef\u672b\u3078\u306e\u901a\u77e5\u3092\u89e3\u9664\u3057\u307e\u3059\u3002",1,"btn","btn-warning",3,"click"]],template:function(s,a){1&s&&(e.j41(0,"h2",0),e.EFF(1,"\u901a\u77e5\u8a2d\u5b9a (\u30c6\u30b9\u30c8\u4e2d)"),e.nrm(2,"img",1),e.k0s(),e.j41(3,"div",2)(4,"div",3)(5,"div",4)(6,"app-switch",5),e.bIt("checkChanged",function(g){return a.onToggleMessaging(g)}),e.k0s()()(),e.j41(7,"div",0)(8,"h3"),e.EFF(9,"\u767b\u9332\u3055\u308c\u305f\u30c7\u30d0\u30a4\u30b9"),e.k0s(),e.j41(10,"div",6),e.DNE(11,Or,4,11,"div",7),e.k0s()(),e.j41(12,"div")(13,"div",8)(14,"h3"),e.EFF(15,"\u91cd\u8981\u5ea6"),e.k0s(),e.j41(16,"div",4),e.nrm(17,"app-switch",9),e.k0s()(),e.j41(18,"div",8)(19,"h3"),e.EFF(20,"\u7a2e\u985e"),e.k0s(),e.j41(21,"div",4),e.nrm(22,"app-switch",10)(23,"app-switch",11)(24,"app-switch",12),e.k0s()(),e.j41(25,"div",8)(26,"button",13),e.bIt("click",function(g){return a.onClickUpdateMessaging(g)}),e.EFF(27,"\u66f4\u65b0"),e.k0s()()()(),e.j41(28,"div",14)(29,"div"),e.EFF(30,"Token: "),e.j41(31,"div"),e.EFF(32),e.k0s()(),e.j41(33,"div"),e.EFF(34,"GetToken: "),e.DNE(35,Dr,2,2,"div",15),e.k0s(),e.j41(36,"div"),e.EFF(37,"TokenChanges: "),e.DNE(38,Pr,2,2,"div",15),e.k0s(),e.j41(39,"div"),e.EFF(40,"TokenReceived: "),e.DNE(41,xr,2,2,"div",15),e.k0s(),e.j41(42,"div")(43,"div")(44,"label"),e.EFF(45,"Topic: "),e.j41(46,"input",16),e.mxI("ngModelChange",function(g){return e.DH7(a.debugObservable.topicText,g)||(a.debugObservable.topicText=g),g}),e.k0s()(),e.j41(47,"button",17),e.bIt("click",function(g){return a.onClickSubscribeTopic(g)}),e.EFF(48,"subscribe"),e.k0s(),e.j41(49,"button",17),e.bIt("click",function(g){return a.onClickUnsubscribeTopic(g)}),e.EFF(50,"unsubscribe"),e.k0s()(),e.j41(51,"div")(52,"label"),e.EFF(53,"Post Title: "),e.j41(54,"input",16),e.mxI("ngModelChange",function(g){return e.DH7(a.debugObservable.topicPostText,g)||(a.debugObservable.topicPostText=g),g}),e.k0s()(),e.j41(55,"button",17),e.bIt("click",function(g){return a.onClickPostToTopic(g)}),e.EFF(56,"Post"),e.k0s()(),e.j41(57,"div")(58,"label"),e.EFF(59,"Condition Topic Post: "),e.j41(60,"input",16),e.mxI("ngModelChange",function(g){return e.DH7(a.debugObservable.conditionTopicPostText,g)||(a.debugObservable.conditionTopicPostText=g),g}),e.k0s()(),e.j41(61,"button",17),e.bIt("click",function(g){return a.onClickConditionPostToTopic(g)}),e.EFF(62,"CondPost"),e.k0s()()()(),e.j41(63,"div")(64,"button",18),e.bIt("click",function(g){return a.onClickClearMessages(g)}),e.EFF(65,"Clear"),e.k0s(),e.j41(66,"div"),e.EFF(67,"Messages: "),e.DNE(68,Br,3,3,"div",15),e.k0s()()),2&s&&(e.R7$(3),e.Y8G("formGroup",a.mainForm),e.R7$(3),e.Y8G("parentForm",a.mainForm),e.R7$(5),e.Y8G("ngForOf",a.devices),e.R7$(6),e.Y8G("parentForm",a.mainForm),e.R7$(5),e.Y8G("parentForm",a.mainForm),e.R7$(),e.Y8G("parentForm",a.mainForm),e.R7$(),e.Y8G("parentForm",a.mainForm),e.R7$(2),e.Y8G("disabled",a.configArray.invalid||!a.configArray.dirty),e.R7$(6),e.JRh(a.debugObservable.registeredToken),e.R7$(3),e.Y8G("ngForOf",a.debugObservable.getToken),e.R7$(3),e.Y8G("ngForOf",a.debugObservable.tokenChanges),e.R7$(3),e.Y8G("ngForOf",a.debugObservable.tokenReceived),e.R7$(5),e.R50("ngModel",a.debugObservable.topicText),e.R7$(8),e.R50("ngModel",a.debugObservable.topicPostText),e.R7$(6),e.R50("ngModel",a.debugObservable.conditionTopicPostText),e.R7$(8),e.Y8G("ngForOf",a.debugObservable.messages))},dependencies:[B.Sq,B.bT,c.me,c.BC,c.cb,c.vS,c.j4,En,B.TG,B.vh]})}return n})();const Nr=["protectedSettings"],Mr=["imageBox"],Lr=()=>["(\u5371\u967a)","(\u5f31\u3044)","(\u666e\u901a)","(\u5f37\u3044)","(\u5145\u5206\u306b\u5b89\u5168)"],jr=()=>["#DD2C00","#FF6D00","#FFD600","#AEEA00","#00C853"];function $r(n,o){1&n&&e.EFF(0,"\u753b\u50cf\u304c\u3042\u308a\u307e\u305b\u3093")}function Gr(n,o){if(1&n&&e.nrm(0,"img",39),2&n){const t=e.XpG().ngIf;e.FS9("src",t.photoURL,e.B4B)}}function Vr(n,o){if(1&n){const t=e.RV6();e.qex(0),e.j41(1,"span",40),e.EFF(2," -> "),e.k0s(),e.j41(3,"label",11),e.EFF(4,"\u65b0\u3057\u3044\u753b\u50cf"),e.k0s(),e.nrm(5,"img",41),e.j41(6,"button",42),e.bIt("click",function(a){const h=e.eBV(t).ngIf,g=e.XpG(2);return e.Njj(g.onClickOkImage(a,h))}),e.EFF(7,"\u78ba\u5b9a"),e.k0s(),e.bVm()}if(2&n){const t=o.ngIf;e.R7$(5),e.FS9("src",t,e.B4B)}}function Wr(n,o){1&n&&e.nrm(0,"div",43)}function Kr(n,o){if(1&n&&(e.j41(0,"div",43),e.EFF(1),e.k0s()),2&n){const t=e.XpG(3);e.R7$(),e.SpI("\u6b8b\u308a ",t.nicknameResult.changesRemain," \u56de \u5909\u66f4\u3067\u304d\u307e\u3059\u3002")}}function Hr(n,o){1&n&&(e.j41(0,"div",45),e.EFF(1,"\u3053\u308c\u4ee5\u4e0a\u306f\u5909\u66f4\u3067\u304d\u307e\u305b\u3093\u3002"),e.k0s())}function Yr(n,o){if(1&n&&(e.qex(0),e.DNE(1,Kr,2,1,"div",20)(2,Hr,2,0,"div",44),e.bVm()),2&n){const t=e.XpG(2);e.R7$(),e.Y8G("ngIf",t.nicknameResult.changesRemain>0),e.R7$(),e.Y8G("ngIf",0===t.nicknameResult.changesRemain)}}function Xr(n,o){1&n&&(e.j41(0,"div",45),e.EFF(1,"\u5165\u529b\u5fc5\u9808\u3067\u3059\u3002"),e.k0s())}function zr(n,o){1&n&&(e.j41(0,"div",45),e.EFF(1,"\u9577\u3059\u304e\u307e\u3059\u3002"),e.k0s())}function Jr(n,o){1&n&&(e.j41(0,"div",45),e.EFF(1,"\u77ed\u3059\u304e\u307e\u3059\u3002"),e.k0s())}function qr(n,o){if(1&n&&(e.qex(0),e.DNE(1,Xr,2,0,"div",44)(2,zr,2,0,"div",44)(3,Jr,2,0,"div",44),e.bVm()),2&n){const t=e.XpG(2);e.R7$(),e.Y8G("ngIf",null==t.nicknameControl.errors?null:t.nicknameControl.errors.required),e.R7$(),e.Y8G("ngIf",null==t.nicknameControl.errors?null:t.nicknameControl.errors.maxlength),e.R7$(),e.Y8G("ngIf",null==t.nicknameControl.errors?null:t.nicknameControl.errors.minlength)}}function Qr(n,o){1&n&&e.nrm(0,"div",43)}function Zr(n,o){1&n&&(e.j41(0,"div",45),e.EFF(1,"\u9577\u3059\u304e\u307e\u3059\u3002"),e.k0s())}function ei(n,o){if(1&n&&(e.qex(0),e.DNE(1,Zr,2,0,"div",44),e.bVm()),2&n){const t=e.XpG(2);e.R7$(),e.Y8G("ngIf",null==t.aboutControl.errors?null:t.aboutControl.errors.maxlength)}}function ti(n,o){if(1&n&&(e.qex(0),e.nrm(1,"hr")(2,"gitfire-user-notification",46),e.bVm()),2&n){const t=e.XpG(2);e.R7$(2),e.Y8G("mainForm",t.notificationForm)("userPrivStore$",t.userPrivate$)}}function ni(n,o){1&n&&e.nrm(0,"div",43)}function ri(n,o){1&n&&(e.j41(0,"div",45),e.EFF(1,"E \u30e1\u30fc\u30eb\u306f\u5fc5\u9808\u3067\u3059\u3002"),e.k0s())}function ii(n,o){1&n&&(e.j41(0,"div",45),e.EFF(1,"E \u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044\u3002"),e.k0s())}function oi(n,o){if(1&n&&(e.qex(0),e.DNE(1,ri,2,0,"div",44)(2,ii,2,0,"div",44),e.bVm()),2&n){const t=e.XpG(2);e.R7$(),e.Y8G("ngIf",null==t.emailControl.errors?null:t.emailControl.errors.required),e.R7$(),e.Y8G("ngIf",(null==t.emailControl.errors?null:t.emailControl.errors.minlength)||(null==t.emailControl.errors?null:t.emailControl.errors.maxlength))}}function si(n,o){1&n&&(e.j41(0,"div",43),e.EFF(1,"\u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u5f37\u5ea6\u306f\u5145\u5206\u306b\u3057\u3066\u304f\u3060\u3055\u3044\u3002"),e.k0s())}function ai(n,o){1&n&&(e.j41(0,"div",45),e.EFF(1,"\u30d1\u30b9\u30ef\u30fc\u30c9\u306f\u5fc5\u9808\u3067\u3059\u3002"),e.k0s())}function ui(n,o){1&n&&(e.j41(0,"div",45),e.EFF(1,"\u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u9577\u3055\u304c\u8db3\u308a\u307e\u305b\u3093\u3002"),e.k0s())}function ci(n,o){if(1&n&&(e.qex(0),e.DNE(1,ai,2,0,"div",44)(2,ui,2,0,"div",44),e.bVm()),2&n){const t=e.XpG(2);e.R7$(),e.Y8G("ngIf",null==t.passwordControl.errors?null:t.passwordControl.errors.required),e.R7$(),e.Y8G("ngIf",null==t.passwordControl.errors?null:t.passwordControl.errors.minlength)}}function li(n,o){if(1&n){const t=e.RV6();e.qex(0),e.j41(1,"div",5)(2,"form",6,0)(4,"h2",7),e.EFF(5,"\u516c\u958b\u8a2d\u5b9a"),e.nrm(6,"img",8),e.k0s(),e.j41(7,"div")(8,"div",9)(9,"div",10)(10,"label",11),e.EFF(11,"\u73fe\u5728\u306e\u753b\u50cf"),e.k0s(),e.DNE(12,$r,1,0,"ng-template",null,1,e.C5r)(14,Gr,1,1,"img",12)(15,Vr,8,1,"ng-container",4),e.nI1(16,"async"),e.k0s(),e.j41(17,"div",13),e.nrm(18,"input",14,2),e.j41(20,"button",15),e.bIt("click",function(a){e.eBV(t);const h=e.XpG();return e.Njj(h.onClickUploadImage(a))}),e.EFF(21,"Upload"),e.k0s()()(),e.j41(22,"div",16)(23,"label",17),e.EFF(24,"\u30cb\u30c3\u30af\u30cd\u30fc\u30e0"),e.nrm(25,"img",18),e.k0s(),e.nrm(26,"input",19),e.j41(27,"button",15),e.bIt("click",function(a){e.eBV(t);const h=e.XpG();return e.Njj(h.onClickUpdateNickname(a))}),e.EFF(28,"\u66f4\u65b0"),e.k0s()(),e.DNE(29,Wr,1,0,"div",20)(30,Yr,3,2,"ng-container",4)(31,qr,4,3,"ng-container",4),e.j41(32,"div",16)(33,"label",17),e.EFF(34,"\u81ea\u5df1\u7d39\u4ecb"),e.nrm(35,"img",21),e.k0s(),e.nrm(36,"textarea",22),e.j41(37,"button",23),e.bIt("click",function(a){e.eBV(t);const h=e.XpG();return e.Njj(h.onClickUpdateAbout(a))}),e.EFF(38,"\u66f4\u65b0"),e.k0s()()(),e.DNE(39,Qr,1,0,"div",20)(40,ei,2,1,"ng-container",4)(41,ti,3,2,"ng-container",4),e.nrm(42,"hr"),e.j41(43,"a",24),e.bIt("click",function(a){e.eBV(t);const h=e.XpG();return e.Njj(h.onClickImportant(a))}),e.EFF(44),e.k0s(),e.j41(45,"div",25,3)(47,"div",26)(48,"label",27),e.EFF(49,"\u540d\u524d"),e.nrm(50,"img",28),e.k0s(),e.nrm(51,"input",29),e.k0s(),e.j41(52,"div",26)(53,"label",27),e.EFF(54,"Email"),e.nrm(55,"img",30),e.k0s(),e.nrm(56,"input",31),e.j41(57,"button",32),e.bIt("click",function(a){e.eBV(t);const h=e.XpG();return e.Njj(h.onClickUpdateEmail(a))}),e.EFF(58,"\u66f4\u65b0"),e.k0s(),e.DNE(59,ni,1,0,"div",20)(60,oi,3,2,"ng-container",4),e.k0s(),e.j41(61,"div",26)(62,"label",27),e.EFF(63,"Password"),e.nrm(64,"img",33),e.k0s(),e.nrm(65,"input",34),e.j41(66,"button",32),e.bIt("click",function(a){e.eBV(t);const h=e.XpG();return e.Njj(h.onClickUpdatePassword(a))}),e.EFF(67,"\u66f4\u65b0"),e.k0s(),e.nrm(68,"ng9-password-strength-bar",35),e.nI1(69,"async"),e.DNE(70,si,2,0,"div",20)(71,ci,3,2,"ng-container",4),e.k0s(),e.j41(72,"h3",36),e.EFF(73,"\u30a2\u30ab\u30a6\u30f3\u30c8\u306e\u7d42\u4e86"),e.k0s(),e.j41(74,"div",37)(75,"button",38),e.bIt("click",function(a){e.eBV(t);const h=e.XpG();return e.Njj(h.onClickDeleteAccount(a))}),e.EFF(76,"\u30a2\u30ab\u30a6\u30f3\u30c8\u3092\u524a\u9664"),e.k0s()()()()(),e.bVm()}if(2&n){const t=o.ngIf,s=e.sdS(13),a=e.XpG();e.R7$(2),e.Y8G("formGroup",a.inputForm),e.R7$(12),e.Y8G("ngIf",t.photoURL)("ngIfElse",s),e.R7$(),e.Y8G("ngIf",e.bMT(16,35,a.profileTempImage$)),e.R7$(5),e.Y8G("disabled",a.userIconControl.invalid||!a.userIconControl.dirty),e.R7$(2),e.AVh("was-validated",a.nicknameControl.dirty||a.nicknameControl.touched),e.R7$(5),e.Y8G("disabled",a.nicknameControl.invalid||!a.nicknameControl.dirty),e.R7$(2),e.Y8G("ngIf",!a.nicknameControl.invalid),e.R7$(),e.Y8G("ngIf",a.nicknameResult),e.R7$(),e.Y8G("ngIf",a.nicknameControl.invalid),e.R7$(),e.AVh("was-validated",a.aboutControl.dirty||a.aboutControl.touched),e.R7$(5),e.Y8G("disabled",a.aboutControl.invalid||!a.aboutControl.dirty),e.R7$(2),e.Y8G("ngIf",!a.aboutControl.invalid),e.R7$(),e.Y8G("ngIf",a.aboutControl.invalid),e.R7$(),e.Y8G("ngIf",a.auth.isDeveloper),e.R7$(3),e.JRh(a.isOpenOther?"\u518d\u8a8d\u8a3c":"\u305d\u306e\u4ed6\u306e\u8a2d\u5b9a"),e.R7$(7),e.Y8G("value",t.displayName),e.R7$(),e.AVh("was-validated",a.emailControl.dirty||a.emailControl.touched),e.R7$(5),e.Y8G("disabled",a.emailControl.invalid||!a.emailControl.dirty),e.R7$(2),e.Y8G("ngIf",!a.emailControl.invalid),e.R7$(),e.Y8G("ngIf",a.emailControl.invalid),e.R7$(),e.AVh("was-validated",a.passwordControl.dirty||a.passwordControl.touched),e.R7$(5),e.Y8G("disabled",!a.passwordControl.value||a.passwordControl.invalid||!a.passwordControl.dirty),e.R7$(2),e.xc7("display",""===a.passwordControl.value?"none":null),e.Y8G("passwordToCheck",e.bMT(69,37,a.passwordControl.valueChanges))("barLabel","\u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u5f37\u5ea6(\u76ee\u5b89): ")("strengthLabels",e.lJ4(39,Lr))("barColors",e.lJ4(40,jr)),e.R7$(2),e.Y8G("ngIf",!a.passwordControl.invalid),e.R7$(),e.Y8G("ngIf",a.passwordControl.invalid)}}let di=(()=>{class n{auth;storage;funcs;store;toastr;router;dialog;localSession;destroy$=new C.B;currentUser;currentUser$;userPublic;userPrivate$=new C.B;profileTempImage$;inputForm;notificationForm;isOpenOther=!1;nicknameResult=null;protectedSettings;imageBox;pubUser;privUser;nicknameIndex;constructor(t,s,a,h,g,G,q,ee){this.auth=t,this.storage=s,this.funcs=a,this.store=h,this.toastr=g,this.router=G,this.dialog=q,this.localSession=ee,this.pubUser=this.store.collection("/users/v1/public"),this.privUser=this.store.collection("/users/v1/protected"),this.nicknameIndex=this.store.collection("/index/users/usernick"),this.currentUser$=this.auth.clientSideUser$,this.currentUser$.pipe((0,U.Q)(this.destroy$)).subscribe(ce=>{this.currentUser=ce})}ngOnInit(){this.inputForm=new c.gE({}),this.inputForm.addControl("userIcon",new c.MJ("",[c.k0.required])),this.inputForm.addControl("email",new c.MJ({value:"",disabled:!1},[c.k0.required])),this.inputForm.addControl("password",new c.MJ("",[])),this.inputForm.addControl("nickname",new c.MJ({value:"",disabled:!0},[c.k0.required])),this.inputForm.addControl("about",new c.MJ({value:"",disabled:!0},[])),this.notificationForm=new c.gE({}),this.inputForm.addControl("messaging",this.notificationForm)}ngAfterViewInit(){const t=this.currentUser$.pipe((0,O.s)(1),(0,N.p)(s=>!!s));t.pipe((0,me.n)(s=>this.pubUser.doc(s.uid).valueChanges()),(0,U.Q)(this.destroy$)).subscribe(s=>{this.userPublic=s,Pe(this.aboutControl,s.about),this.aboutControl.enable(),Pe(this.nicknameControl,s.nickname),this.nicknameControl.enable()}),t.pipe((0,me.n)(s=>this.privUser.doc(s.uid).valueChanges()),(0,U.Q)(this.destroy$)).subscribe(s=>{this.userPrivate$.next(s)}),t.pipe((0,U.Q)(this.destroy$)).subscribe(s=>{this.emailControl.setValue(s.email)})}ngOnDestroy(){this.destroy$.next()}get emailControl(){return this.inputForm.get("email")}get passwordControl(){return this.inputForm.get("password")}get aboutControl(){return this.inputForm.get("about")}get nicknameControl(){return this.inputForm.get("nickname")}get userIconControl(){return this.inputForm.get("userIcon")}onClickDeleteAccount(t){this.dialog.createDefaultBuilder().prepareBody(Ie).setType(re.hs.Warn).setSize(re.EV.Default).setTitle("\u6700\u7d42\u78ba\u8a8d").okButton(()=>{this.doDeleteAccount()}).cancelButton(()=>{}).open()}doDeleteAccount(){var t=this;return(0,R.A)(function*(){try{yield t.currentUser.delete(),(0,S.Oi)("Account is deleted")}catch(a){(0,S.sJ)("Error while delete account",a);const h=a instanceof Error?a.message:"Unknown error";return void t.toastr.error(`\u30a2\u30ab\u30a6\u30f3\u30c8\u3092\u524a\u9664\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002 ( ${h} )`)}t.localSession.unmarkLogin(),t.router.navigate(["/"])})()}updateError(t,s){(0,S.sJ)(`Error while update tag:${t}`,s);const a=s instanceof Error?s.message:"Unknown error";this.toastr.error(`${t} \u306e\u66f4\u65b0\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002 ( ${a} )`)}updateSucceeded(t,s){this.toastr.success(`${t} \u3092 "${s}" \u306b\u66f4\u65b0\u3057\u307e\u3057\u305f\u3002`)}updateProfileImage(t){var s=this;return(0,R.A)(function*(){if(""===t)return;const a="\u30d7\u30ed\u30d5\u30a3\u30fc\u30eb\u753b\u50cf";try{yield s.currentUser.updateProfile({photoURL:t});const g={photoURL:t,updatedAt:w.A.firestore.FieldValue.serverTimestamp()};yield s.pubUser.doc(s.currentUser.uid).update(g),s.updateSucceeded(a,"Upload \u3057\u305f\u753b\u50cf"),s.getProfileRef("temp_profile").delete(),s.profileTempImage$=null,s.userIconControl.setValue(""),se(s.userIconControl)}catch(h){s.updateError(a,h)}})()}onClickUpdateNickname(t){var s=this;return(0,R.A)(function*(){if(s.nicknameControl.invalid)return;const a=s.nicknameControl.value;if(a===s.userPublic.nickname)return;const h="\u30cb\u30c3\u30af\u30cd\u30fc\u30e0";try{const g={nickname:a};s.nicknameResult=yield s.funcs.call("updateNickname",g),s.updateSucceeded(h,a),se(s.nicknameControl)}catch(g){s.updateError(h,g)}})()}onClickUpdateAbout(t){var s=this;return(0,R.A)(function*(){if(s.aboutControl.invalid)return;const a=s.aboutControl.value;if(a===s.userPublic.about)return;const h="\u81ea\u5df1\u7d39\u4ecb";try{const g={about:a};yield s.funcs.call("updateAbout",g),s.updateSucceeded(h,a),se(s.aboutControl)}catch(g){s.updateError(h,g)}})()}onClickUpdateEmail(t){var s=this;return(0,R.A)(function*(){if(s.emailControl.invalid)return;const a=s.emailControl.value;a!==s.currentUser.email&&s.dialog.createSimpleBuilder().setType(re.hs.Warn).setSize(re.EV.Default).setMessage("\u767b\u9332\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u3092\u5909\u66f4\u3057\u307e\u3059\u3002\u3088\u308d\u3057\u3044\u3067\u3059\u304b\uff1f").setTitle("\u78ba\u8a8d").okButton(()=>{s.doChangeEmail(a)}).cancelButton(()=>{}).open()})()}doChangeEmail(t){var s=this;return(0,R.A)(function*(){const a="Email";try{yield s.currentUser.updateEmail(t),yield s.currentUser.sendEmailVerification(),s.updateSucceeded(a,t),se(s.emailControl),s.toastr.info("\u78ba\u8a8d\u306e\u30e1\u30fc\u30eb\u3092\u9001\u4fe1\u3057\u307e\u3057\u305f\u3002")}catch(h){s.updateError(a,h)}})()}onClickUpdatePassword(t){var s=this;return(0,R.A)(function*(){if(s.passwordControl.invalid)return;const a=s.passwordControl.value;if(""===a)return;const h="\u30d1\u30b9\u30ef\u30fc\u30c9";try{yield s.currentUser.updatePassword(a),s.updateSucceeded(h,"********"),se(s.passwordControl)}catch(g){s.updateError(h,g)}finally{s.passwordControl.setValue("")}})()}listProvider(){}ensureImageFile(){const t=this.imageBox.nativeElement;if(0===t.files.length)return this.toastr.error("\u30d5\u30a1\u30a4\u30eb\u3092\u9078\u629e\u3057\u3066\u304f\u3060\u3055\u3044\u3002"),null;const s=t.files[0];return s.size>=524288?(this.toastr.error("\u30d5\u30a1\u30a4\u30eb\u306e\u30b5\u30a4\u30ba\u304c\u5927\u304d\u3059\u304e\u307e\u3059\u3002(\u7d04 500kb \u307e\u3067)"),null):s}getProfileRef(t){return this.storage.ref(`/image/${this.currentUser.uid}/profile/${t}`)}onClickUploadImage(t){var s=this;return(0,R.A)(function*(){const a=s.ensureImageFile();if(!a)return;const h=yield s.uploadProfileImage("temp_profile",a);s.profileTempImage$=h.ref.getDownloadURL()})()}uploadProfileImage(t,s){var a=this;return(0,R.A)(function*(){return yield a.getProfileRef(t).put(s)})()}doChangePhoto(t){var s=this;return(0,R.A)(function*(){const h=yield(yield s.uploadProfileImage("profile",t)).ref.getDownloadURL();s.updateProfileImage(h)})()}initializeReauth(t){t.currentUser=this.currentUser,t.reauthed.subscribe(()=>{new ke.SD(this.protectedSettings.nativeElement).show(),this.isOpenOther=!0})}constructReauth(){return t=>{}}onClickImportant(t){(0,S.Oi)("onClickImportant()"),this.dialog.createDefaultBuilder().prepareBody(ue,a=>this.initializeReauth(a)).setupChild(this.constructReauth()).setType(re.hs.Info).setSize(re.EV.Default).setTitle("\u518d\u8a8d\u8a3c").cancelButton(()=>{}).closeButton(()=>{}).open()}onClickOkImage(t,s){const a=this.ensureImageFile();a&&this.dialog.createSimpleBuilder().setType(re.hs.Info).setSize(re.EV.Default).setMessage("\u753b\u50cf\u306f\u516c\u958b\u3055\u308c\u307e\u3059\u3002\u3088\u308d\u3057\u3044\u3067\u3059\u304b\uff1f").setTitle("\u78ba\u8a8d").okButton(()=>{this.doChangePhoto(a)}).cancelButton(()=>{}).open()}static \u0275fac=function(s){return new(s||n)(e.rXU(Qe.u),e.rXU(ve.ap),e.rXU(ut.Y),e.rXU(le.Qe),e.rXU(A.tw),e.rXU(Le.O),e.rXU(re.o3),e.rXU(Se.Q))};static \u0275cmp=e.VBU({type:n,selectors:[["ng-component"]],viewQuery:function(s,a){if(1&s&&(e.GBs(Nr,5),e.GBs(Mr,5)),2&s){let h;e.mGM(h=e.lsd())&&(a.protectedSettings=h.first),e.mGM(h=e.lsd())&&(a.imageBox=h.first)}},decls:1,vars:1,consts:[["configForm",""],["noPhoto",""],["imageBox",""],["protectedSettings",""],[4,"ngIf"],[1,"container"],[3,"formGroup"],[1,"mb-3"],["title","\u4e00\u822c\u516c\u958b\u3055\u308c\u308b\u60c5\u5831\u3092\u7de8\u96c6\u3067\u304d\u307e\u3059\u3002","src","/assets/octicons/question.svg",1,"m-3","octicon-info","help-icon"],[1,"my-2"],[1,"input-group","my-1"],[1,"visually-hidden"],["class","user-settings-profile-image rounded","alt","Profile \u753b\u50cf",3,"src",4,"ngIf","ngIfElse"],[1,"input-group"],["id","appGitfireInputIconFileInput","name","userIcon","formControlName","userIcon","type","file","placeholder","\u30a2\u30a4\u30b3\u30f3\u3092\u9078\u629e","accept","image/*",1,"form-control"],[1,"btn","btn-primary",3,"click","disabled"],[1,"input-group","my-2"],[1,"input-group-text"],["title","\u30e1\u30c3\u30bb\u30fc\u30b8\u4e0a\u306b\u8868\u793a\u3055\u308c\u308b\u3042\u306a\u305f\u306e\u540d\u524d\u3067\u3059\u3002","src","/assets/octicons/question.svg",1,"m-1","octicon-info","help-icon"],["name","nickname","placeholder","\u4f8b: hogehoge1032","formControlName","nickname","autofocus","","type","text","maxlength","19","minlength","4","required","",1,"form-control"],["class","valid-feedback",4,"ngIf"],["title","\u30d5\u30ea\u30fc\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u3067\u3059\u3002","src","/assets/octicons/question.svg",1,"m-1","octicon-info","help-icon"],["name","about","placeholder","\u4f8b: Ingress: kagura2718 (RES) \u30dd\u30b1\u30e2\u30f3go: kagura271(\u8d64)","formControlName","about","maxlength","200","type","text",1,"form-control"],["type","button",1,"btn","btn-primary",3,"click","disabled"],["role","button","aria-expanded","false",1,"btn","btn-secondary","collapsed",3,"click"],["id","appGitfireUserSettingsSecretContainer",1,"collapse","m-3"],[1,"row","input-group","m-3"],[1,"col-2","text-md-end","col-form-label"],["title","\u8a8d\u8a3c\u30d7\u30ed\u30d0\u30a4\u30c0\u304b\u3089\u63d0\u4f9b\u3055\u308c\u305f\u540d\u524d\u3067\u3059\u3002(\u975e\u516c\u958b)","src","/assets/octicons/question.svg",1,"m-1","octicon-info","help-icon"],["name","displayname","placeholder","\u4f8b: hogehoge1032","type","text","disabled","",1,"col-10","form-control",3,"value"],["title","\u8a8d\u8a3c\u306b\u4f7f\u308f\u308c\u308b\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u3067\u3059\u3002(\u975e\u516c\u958b)","src","/assets/octicons/question.svg",1,"m-1","octicon-info","help-icon"],["name","email","placeholder","email@example.com","formControlName","email","autocomplete","email","type","email","required","","autofill","","maxlength","1024","minlength","5",1,"col-8","form-control"],[1,"btn","btn-primary","col-2",3,"click","disabled"],["title","\u30ed\u30b0\u30a4\u30f3\u6642\u306e\u30d1\u30b9\u30ef\u30fc\u30c9\u3067\u3059\u3002\u4ed6\u4eba\u306b\u63a8\u6e2c\u3055\u308c\u306a\u3044\u3082\u306e\u3092\u4f7f\u7528\u3057\u3066\u304f\u3060\u3055\u3044\u3002(\u975e\u516c\u958b)","src","/assets/octicons/question.svg",1,"m-1","octicon-info","help-icon"],["name","password","placeholder","\u5909\u66f4\u306a\u3057","formControlName","password","type","password","autocomplete","new-password","maxlength","256","minlength","6",1,"col-8","form-control"],[1,"col-lg-5","col-form-label",3,"passwordToCheck","barLabel","strengthLabels","barColors"],[1,"m-3"],[1,"input-group","m-3"],["tabindex","-1",1,"btn","btn-warning",3,"click"],["alt","Profile \u753b\u50cf",1,"user-settings-profile-image","rounded",3,"src"],[1,"p-3"],["alt","\u65b0\u3057\u3044 Profile \u753b\u50cf",1,"user-settings-profile-image","rounded",3,"src"],[1,"btn","btn-primary",3,"click"],[1,"valid-feedback"],["class","invalid-feedback",4,"ngIf"],[1,"invalid-feedback"],[3,"mainForm","userPrivStore$"]],template:function(s,a){1&s&&e.DNE(0,li,77,41,"ng-container",4),2&s&&e.Y8G("ngIf",a.currentUser)},dependencies:[B.bT,c.qT,c.me,c.BC,c.cb,c.YS,c.xh,c.tU,c.j4,c.JD,F.j,Ur,B.Jj],styles:[".user-settings-profile-image[_ngcontent-%COMP%]{width:80px;height:80px}.help-icon[_ngcontent-%COMP%]{width:20px;height:20px}"]})}return n})();function hi(n,o){if(1&n&&(e.j41(0,"div"),e.EFF(1),e.k0s()),2&n){const t=e.XpG().$implicit;e.R7$(),e.SpI("URL: ",t.url,"")}}function fi(n,o){if(1&n&&(e.j41(0,"div")(1,"div")(2,"div"),e.EFF(3),e.k0s(),e.DNE(4,hi,2,1,"div",0),e.j41(5,"div"),e.EFF(6),e.k0s(),e.j41(7,"div"),e.EFF(8),e.nI1(9,"date"),e.k0s()(),e.nrm(10,"hr"),e.j41(11,"div"),e.EFF(12),e.k0s()()),2&n){const t=o.$implicit;e.R7$(3),e.SpI("Title: ",t.title,""),e.R7$(),e.Y8G("ngIf",t.url),e.R7$(2),e.SpI("Done: ",t.hasRead,""),e.R7$(2),e.SpI("Date: ",e.i5U(9,5,t.createdAt.toDate(),"yyyy-MM-dd hh:mm:ss"),""),e.R7$(4),e.JRh(t.body)}}let pi=(()=>{class n{auth;route;store;destroy$=new C.B;id$;trayStore;constructor(t,s,a){this.auth=t,this.route=s,this.store=a}ngOnDestroy(){this.destroy$.next()}ngOnInit(){(0,S.Oi)("UserTrayMessageComponent.OnInit()",this.route.snapshot),this.id$=this.route.queryParams.pipe((0,N.p)(t=>"id"in t),(0,Be.T)(t=>t.id)),this.id$.pipe((0,me.n)(t=>(0,Nt.z)((0,De.of)(t),this.auth.clientSideUser$)),(0,N.p)(([t,s])=>null!==s),(0,me.n)(([t,s])=>this.store.doc(`/users/v1/protected/${s.uid}/tray/${t}`).valueChanges({idField:"id"}).pipe((0,O.s)(1))),(0,U.Q)(this.destroy$)).subscribe(t=>{this.trayStore=t})}static \u0275fac=function(s){return new(s||n)(e.rXU(Qe.u),e.rXU(P.nX),e.rXU(le.Qe))};static \u0275cmp=e.VBU({type:n,selectors:[["app-user-tray-message"]],decls:1,vars:1,consts:[[4,"ngIf"]],template:function(s,a){1&s&&e.DNE(0,fi,13,8,"div",0),2&s&&e.Y8G("ngIf",a.trayStore)},dependencies:[B.bT,B.vh]})}return n})(),An=(()=>{class n{auth;localSession;router;constructor(t,s,a){this.auth=t,this.localSession=s,this.router=a,(0,S.Oi)("AuthGuard.constructor")}canActivate(t,s){return this.auth.clientSideUser$.pipe((0,Be.T)(a=>{if((0,S.rD)("AuthGuard",a),a)return!0;const h={queryParams:{redirectPath:s.url}};return(0,S.Oi)("auth.guard Prepare to redirect",h),this.router.createUrlTree(["/Gitfire/login"],h)}))}static \u0275fac=function(s){return new(s||n)(e.KVO(Qe.u),e.KVO(Se.Q),e.KVO(P.Ix))};static \u0275prov=e.jDH({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),ur=(()=>{class n{auth;localSession;router;constructor(t,s,a){this.auth=t,this.localSession=s,this.router=a}canActivate(t,s){return this.auth.authState.pipe((0,Be.T)(a=>((0,S.rD)("LoginGuard",a),!a||this.router.createUrlTree(["/"]))))}static \u0275fac=function(s){return new(s||n)(e.KVO(be.DS),e.KVO(Se.Q),e.KVO(P.Ix))};static \u0275prov=e.jDH({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const gi=[{path:"login.htm",loadChildren:()=>Promise.resolve().then(_.bind(_,1951)).then(n=>n.GitfireLoginModule),data:{mode:"login"},canActivate:[ur]},{path:"login",redirectTo:"login.htm"},{path:"signup.htm",loadChildren:()=>Promise.resolve().then(_.bind(_,1951)).then(n=>n.GitfireLoginModule),data:{mode:"signup"},canActivate:[ur]},{path:"signup",redirectTo:"signup.htm"},{path:"reset.htm",loadChildren:()=>Promise.resolve().then(_.bind(_,1951)).then(n=>n.GitfireLoginModule),data:{mode:"reset"}},{path:"reset",redirectTo:"reset.htm"},{path:"chat.htm",loadChildren:()=>Promise.all([_.e(76),_.e(471)]).then(_.bind(_,471)).then(n=>n.GitfireChatModule),canActivate:[An]},{path:"chat",redirectTo:"chat.htm"},{path:"post.htm",loadChildren:()=>_.e(421).then(_.bind(_,7421)).then(n=>n.GitfirePostModule),canActivate:[An]},{path:"post",redirectTo:"post.htm"},{path:"settings.htm",component:di,canActivate:[An]},{path:"settings",redirectTo:"settings.htm"},{path:"tray.htm",component:pi,canActivate:[An]},{path:"tray",redirectTo:"tray.htm"}];let mi=(()=>{class n{static \u0275fac=function(s){return new(s||n)};static \u0275mod=e.$C({type:n});static \u0275inj=e.G2t({imports:[P.iI.forChild(gi),P.iI]})}return n})();var _i=_(1951),vi=_(3691),yi=_(896),bi=_(9243);let Ci=(()=>{class n{static \u0275fac=function(s){return new(s||n)};static \u0275mod=e.$C({type:n});static \u0275inj=e.G2t({providers:[bi.D,yi.u],imports:[B.MD,c.YN,c.X1,vi.Q]})}return n})();var Ei=_(5427);let Ai=(()=>{class n{constructor(){(0,S.rD)("Dynamically loaded GitfireModule")}static \u0275fac=function(s){return new(s||n)};static \u0275mod=e.$C({type:n});static \u0275inj=e.G2t({providers:[A.tw,Qe.u,An,ur,ut.Y,{provide:_e.Zg,useValue:S.cA.FirebaseCloudFunctionsRegion},{provide:de,useValue:S.cA.firebaseVapidKey}],imports:[B.MD,c.YN,c.X1,mi,_i.GitfireLoginModule,Ci,F.o,A._B.forRoot(S.cA.toastrConfig),J.bf.initializeApp(S.cA.firebaseConfig),le.cM,be.X8,ve.y5,_e.ab,T,Ei.j]})}return n})()},1951:(Yt,je,_)=>{_.r(je),_.d(je,{GitfireLoginModule:()=>P});var B=_(177),c=_(9417),J=_(9253),_e=_(8334),le=_(1152),be=_(5794),ve=_(1188),R=_(5312),e=_(4438),rt=_(1413),xe=_(2751);let De=(()=>{class C{router;destroy$=new rt.B;constructor(O){this.router=O}ngOnInit(){(0,R.Oi)("LoginComponent.OnInit()")}ngOnDestroy(){this.destroy$.next()}static \u0275fac=function(N){return new(N||C)(e.rXU(ve.Ix))};static \u0275cmp=e.VBU({type:C,selectors:[["gitfire-login"]],decls:12,vars:1,consts:[[1,"h3","mb-3","fw-normal"],[3,"isLogin"],["routerLink","/Gitfire/signup"],["routerLink","/Gitfire/reset"],["routerLink","/"]],template:function(N,w){1&N&&(e.j41(0,"h1",0),e.EFF(1,"\u30ed\u30b0\u30a4\u30f3\u60c5\u5831"),e.k0s(),e.nrm(2,"gitfire-login-input-auth",1),e.j41(3,"div")(4,"a",2),e.EFF(5,"\u30a2\u30ab\u30a6\u30f3\u30c8\u3092\u4f5c\u6210\u3059\u308b"),e.k0s()(),e.j41(6,"div")(7,"a",3),e.EFF(8,"\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u5fd8\u308c\u305f\u5834\u5408"),e.k0s()(),e.j41(9,"div")(10,"a",4),e.EFF(11,"Top"),e.k0s()()),2&N&&(e.R7$(2),e.Y8G("isLogin",!0))},dependencies:[ve.Wk,xe.InputAuthComponent]})}return C})();var Ae=_(9182);const We=["app-cookie-confirm",""];function Ze(C,U){if(1&C){const O=e.RV6();e.j41(0,"button",4),e.bIt("click",function(){e.eBV(O);const w=e.XpG();return e.Njj(w.remove())}),e.j41(1,"span",5),e.EFF(2,"\xd7"),e.k0s()()}}let oe=(()=>{class C extends be.y8{toastr;toastPackage;localSession;constructor(O,N,w){super(O,N),this.toastr=O,this.toastPackage=N,this.localSession=w}ngOnInit(){(0,R.Oi)("CookieConfirmComponent.OnInit()")}onClickDeny(O){this.localSession.declineAccess(),this.remove()}onClickGrant(O){this.localSession.grantAccess(),this.remove()}static \u0275fac=function(N){return new(N||C)(e.rXU(be.tw),e.rXU(be.sn),e.rXU(Ae.Q))};static \u0275cmp=e.VBU({type:C,selectors:[["","app-cookie-confirm",""]],features:[e.Vt3],attrs:We,decls:12,vars:4,consts:[["class","toast-close-button","aria-label","Close",3,"click",4,"ngIf"],["role","alertdialog","aria-live","polite"],["href","/terms.htm"],[1,"btn","btn-outline-primary",3,"click"],["aria-label","Close",1,"toast-close-button",3,"click"],["aria-hidden","true"]],template:function(N,w){1&N&&(e.DNE(0,Ze,3,0,"button",0),e.j41(1,"div",1)(2,"p"),e.EFF(3,"\u5f53\u30b5\u30a4\u30c8\u3067\u306f\u5229\u7528\u8005\u306e\u5229\u4fbf\u6027\u306e\u305f\u3081\u306b\u30af\u30c3\u30ad\u30fc (Cookies) \u3092\u4f7f\u7528\u3057\u307e\u3059\u3002\u8a73\u3057\u304f\u306f"),e.j41(4,"a",2),e.EFF(5," [\u5229\u7528\u898f\u7d04] "),e.k0s(),e.EFF(6,"\u3092\u3054\u89a7\u304f\u3060\u3055\u3044\u3002"),e.k0s(),e.j41(7,"div")(8,"button",3),e.bIt("click",function(re){return w.onClickGrant(re)}),e.EFF(9,"\u8a31\u53ef\u3059\u308b"),e.k0s(),e.j41(10,"button",3),e.bIt("click",function(re){return w.onClickDeny(re)}),e.EFF(11,"\u62d2\u5426\u3059\u308b"),e.k0s()()()),2&N&&(e.Y8G("ngIf",w.options.closeButton),e.R7$(),e.HbH(w.options.messageClass),e.BMQ("aria-label",w.message))},styles:["[_nghost-%COMP%]{background:#eefef0;width:100%;height:100%}a[_ngcontent-%COMP%]:link{color:red}a[_ngcontent-%COMP%]:visited{color:#a00}a[_ngcontent-%COMP%]:hover{color:red}a[_ngcontent-%COMP%]:active{color:#ff8000}"]})}return C})(),pe=(()=>{class C{toastr;localSession;constructor(O,N){this.toastr=O,this.localSession=N}ngOnInit(){(0,R.Oi)("SignupComponent.OnInit()")}ngAfterViewInit(){this.maybeConfirm()}maybeConfirm(){this.localSession.shouldConfirm()&&this.toastr.info(void 0,void 0,{toastComponent:oe,disableTimeOut:!0,tapToDismiss:!1,preventDuplicates:!0})}static \u0275fac=function(N){return new(N||C)(e.rXU(be.tw),e.rXU(Ae.Q))};static \u0275cmp=e.VBU({type:C,selectors:[["gitfire-signup"]],decls:9,vars:1,consts:[[1,"h3","mb-3","fw-normal"],[3,"isSignup"],["routerLink","/Gitfire/login"],["routerLink","/"]],template:function(N,w){1&N&&(e.j41(0,"h1",0),e.EFF(1,"\u30a2\u30ab\u30a6\u30f3\u30c8\u306e\u4f5c\u6210"),e.k0s(),e.nrm(2,"gitfire-login-input-auth",1),e.j41(3,"div")(4,"a",2),e.EFF(5,"\u30ed\u30b0\u30a4\u30f3"),e.k0s()(),e.j41(6,"div")(7,"a",3),e.EFF(8,"Top"),e.k0s()()),2&N&&(e.R7$(2),e.Y8G("isSignup",!0))},dependencies:[ve.Wk,xe.InputAuthComponent]})}return C})();var me=_(467),Be=_(2275),te=_(4416);const Q=["resetForm"];function Ke(C,U){1&C&&(e.j41(0,"div",11),e.EFF(1,"E \u30e1\u30fc\u30eb\u306f\u5fc5\u9808\u3067\u3059\u3002"),e.k0s())}function Ne(C,U){1&C&&(e.j41(0,"div",11),e.EFF(1,"E \u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044\u3002"),e.k0s())}function et(C,U){if(1&C&&(e.qex(0),e.DNE(1,Ke,2,0,"div",10)(2,Ne,2,0,"div",10),e.bVm()),2&C){e.XpG();const O=e.sdS(6);e.R7$(),e.Y8G("ngIf",null==O.errors?null:O.errors.required),e.R7$(),e.Y8G("ngIf",null==O.errors?null:O.errors.minlength)}}let Ce=(()=>{class C{auth;dialog;toastr;emailInput="";resetForm;constructor(O,N,w){this.auth=O,this.dialog=N,this.toastr=w}ngOnInit(){(0,R.Oi)("ResetPasswordComponent.OnInit()")}onClickReset(O){this.dialog.createSimpleBuilder().setType(Be.hs.Warn).setSize(Be.EV.Default).setTitle("\u78ba\u8a8d").setMessage(`\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u306f\u6b63\u3057\u3044\u3067\u3059\u304b\uff1f ${this.emailInput}`).okButton(()=>{this.tryResetPassword(this.emailInput)}).cancelButton(()=>{}).open()}tryResetPassword(O){var N=this;return(0,me.A)(function*(){try{yield N.auth.sendPasswordResetEmail(O),N.toastr.info("\u30e1\u30fc\u30eb\u3092\u9001\u4fe1\u3057\u307e\u3057\u305f\u3002")}catch(w){(0,R.sJ)("Error while sent reset mail",w),Error,N.toastr.error("\u5931\u6557\u3057\u307e\u3057\u305f\u3002( ${errmsg} )")}})()}static \u0275fac=function(N){return new(N||C)(e.rXU(le.DS),e.rXU(te.o3),e.rXU(be.tw))};static \u0275cmp=e.VBU({type:C,selectors:[["gitfire-login-reset-password"]],viewQuery:function(N,w){if(1&N&&e.GBs(Q,5),2&N){let S;e.mGM(S=e.lsd())&&(w.resetForm=S.first)}},decls:19,vars:5,consts:[["resetForm",""],["email","ngModel"],[1,"row","p-3"],[1,"visually-hidden"],["autofocus","","type","email","name","email","placeholder","Email address","required","","autofill","","maxlength","1024","minlength","5",1,"form-control","col-8",3,"ngModelChange","ngModel"],[1,"btn","btn-warning",3,"click","disabled"],[4,"ngIf"],["routerLink","/"],["routerLink","/Gitfire/signup"],["routerLink","/Gitfire/login"],["class","invalid-feedback",4,"ngIf"],[1,"invalid-feedback"]],template:function(N,w){if(1&N){const S=e.RV6();e.j41(0,"form",null,0)(2,"div",2)(3,"label",3),e.EFF(4,"Email"),e.k0s(),e.j41(5,"input",4,1),e.mxI("ngModelChange",function(Z){return e.eBV(S),e.DH7(w.emailInput,Z)||(w.emailInput=Z),e.Njj(Z)}),e.k0s(),e.j41(7,"button",5),e.bIt("click",function(Z){return e.eBV(S),e.Njj(w.onClickReset(Z))}),e.EFF(8,"\u30d1\u30b9\u30ef\u30fc\u30c9\u30ea\u30bb\u30c3\u30c8"),e.k0s(),e.DNE(9,et,3,2,"ng-container",6),e.k0s()(),e.j41(10,"div")(11,"a",7),e.EFF(12,"Top"),e.k0s()(),e.j41(13,"div")(14,"a",8),e.EFF(15,"\u30a2\u30ab\u30a6\u30f3\u30c8\u3092\u4f5c\u6210\u3059\u308b"),e.k0s()(),e.j41(16,"div")(17,"a",9),e.EFF(18,"\u30ed\u30b0\u30a4\u30f3"),e.k0s()()}if(2&N){const S=e.sdS(6);e.R7$(2),e.AVh("was-validated",S.dirty||S.touched),e.R7$(3),e.R50("ngModel",w.emailInput),e.R7$(2),e.Y8G("disabled",!S.valid),e.R7$(2),e.Y8G("ngIf",S.invalid)}},dependencies:[B.bT,c.qT,c.me,c.BC,c.cb,c.YS,c.xh,c.tU,c.vS,c.cV,ve.Wk]})}return C})();function He(C,U){1&C&&e.nrm(0,"gitfire-signup")}function de(C,U){1&C&&e.nrm(0,"gitfire-login")}function Ye(C,U){1&C&&e.nrm(0,"gitfire-login-reset-password")}const T=[{path:"",component:(()=>{class C{route;mode;constructor(O){this.route=O,this.mode=O.snapshot.data.mode}ngOnInit(){(0,R.Oi)("LoginRouterComponent.OnInit()")}static \u0275fac=function(N){return new(N||C)(e.rXU(ve.nX))};static \u0275cmp=e.VBU({type:C,selectors:[["ng-component"]],decls:4,vars:4,consts:[[3,"ngSwitch"],[4,"ngSwitchCase"]],template:function(N,w){1&N&&(e.qex(0,0),e.DNE(1,He,1,0,"gitfire-signup",1)(2,de,1,0,"gitfire-login",1)(3,Ye,1,0,"gitfire-login-reset-password",1),e.bVm()),2&N&&(e.Y8G("ngSwitch",w.mode),e.R7$(),e.Y8G("ngSwitchCase","signup"),e.R7$(),e.Y8G("ngSwitchCase","login"),e.R7$(),e.Y8G("ngSwitchCase","reset"))},dependencies:[B.ux,B.e1,De,pe,Ce]})}return C})()}];let A=(()=>{class C{static \u0275fac=function(N){return new(N||C)};static \u0275mod=e.$C({type:C});static \u0275inj=e.G2t({imports:[ve.iI.forChild(T),ve.iI]})}return C})();var F=_(7830);let P=(()=>{class C{static \u0275fac=function(N){return new(N||C)};static \u0275mod=e.$C({type:C});static \u0275inj=e.G2t({providers:[be.tw],imports:[B.MD,c.YN,c.X1,A,be._B.forRoot(R.cA.toastrConfig),J.bf.initializeApp(R.cA.firebaseConfig),_e.cM,le.X8,F.o]})}return C})()},2751:(Yt,je,_)=>{_.r(je),_.d(je,{InputAuthComponent:()=>y});var B=_(467),c=_(4438),J=_(9417),_e=_(1413),le=_(4412),be=_(8455),ve=_(6977),R=_(6697),e=_(7935),xe=(_(7231),_(5312)),De=_(1152),Ae=_(5794),We=_(1188),Ze=_(177),oe=_(7830),pe=_(386);const me=["mainForm"],Be=["confirmPasswordInput"],te=()=>["(\u5371\u967a)","(\u5f31\u3044)","(\u666e\u901a)","(\u5f37\u3044)","(\u5145\u5206\u306b\u5b89\u5168)"],Q=()=>["#DD2C00","#FF6D00","#FFD600","#AEEA00","#00C853"];function Ke(M,he){1&M&&(c.j41(0,"div",16),c.EFF(1,"OK!"),c.k0s())}function Ne(M,he){1&M&&(c.j41(0,"div",18),c.EFF(1,"E \u30e1\u30fc\u30eb\u306f\u5fc5\u9808\u3067\u3059\u3002"),c.k0s())}function et(M,he){1&M&&(c.j41(0,"div",18),c.EFF(1,"E \u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044\u3002"),c.k0s())}function Ce(M,he){if(1&M&&(c.qex(0),c.DNE(1,Ne,2,0,"div",17)(2,et,2,0,"div",17),c.bVm()),2&M){const D=c.XpG();c.R7$(),c.Y8G("ngIf",null==D.emailControl.errors?null:D.emailControl.errors.required),c.R7$(),c.Y8G("ngIf",null==D.emailControl.errors?null:D.emailControl.errors.minlength)}}function He(M,he){1&M&&(c.j41(0,"div",16),c.EFF(1,"\u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u5f37\u5ea6\u306f\u5145\u5206\u306b\u3057\u3066\u304f\u3060\u3055\u3044\u3002"),c.k0s())}function de(M,he){1&M&&(c.j41(0,"div",18),c.EFF(1,"\u30d1\u30b9\u30ef\u30fc\u30c9\u306f\u5fc5\u9808\u3067\u3059\u3002"),c.k0s())}function Ye(M,he){1&M&&(c.j41(0,"div",18),c.EFF(1,"\u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u9577\u3055\u304c\u8db3\u308a\u307e\u305b\u3093\u3002"),c.k0s())}function E(M,he){if(1&M&&(c.qex(0,19),c.DNE(1,de,2,0,"div",17)(2,Ye,2,0,"div",17),c.bVm()),2&M){const D=c.XpG();c.R7$(),c.Y8G("ngIf",null==D.passwordControl.errors?null:D.passwordControl.errors.required),c.R7$(),c.Y8G("ngIf",null==D.passwordControl.errors?null:D.passwordControl.errors.minlength)}}function T(M,he){if(1&M&&(c.nrm(0,"ng9-password-strength-bar",20),c.nI1(1,"async")),2&M){const D=c.XpG();c.Y8G("passwordToCheck",c.bMT(1,4,D.passwordControl.valueChanges))("barLabel","\u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u5f37\u5ea6(\u76ee\u5b89): ")("strengthLabels",c.lJ4(6,te))("barColors",c.lJ4(7,Q))}}function A(M,he){1&M&&(c.j41(0,"div",16),c.EFF(1,"\u4e00\u81f4\u3057\u307e\u3057\u305f\uff01"),c.k0s())}function F(M,he){1&M&&(c.j41(0,"div",18),c.EFF(1,"\u30d1\u30b9\u30ef\u30fc\u30c9\u306f\u5fc5\u9808\u3067\u3059\u3002"),c.k0s())}function P(M,he){1&M&&(c.j41(0,"div",18),c.EFF(1,"\u30d1\u30b9\u30ef\u30fc\u30c9\u304c\u4e00\u81f4\u3057\u307e\u305b\u3093\u3002"),c.k0s())}function C(M,he){if(1&M&&(c.qex(0),c.DNE(1,F,2,0,"div",17)(2,P,2,0,"div",17),c.bVm()),2&M){const D=c.XpG(2);c.R7$(),c.Y8G("ngIf",null==D.confirmPasswordControl.errors?null:D.confirmPasswordControl.errors.required),c.R7$(),c.Y8G("ngIf",null==D.confirmPasswordControl.errors?null:D.confirmPasswordControl.errors.passwordMisMatch)}}function U(M,he){if(1&M&&(c.j41(0,"div",3)(1,"label",21),c.EFF(2,"Confirm Password"),c.k0s(),c.nrm(3,"input",22,1),c.DNE(5,A,2,0,"div",6)(6,C,3,2,"ng-container",7),c.k0s()),2&M){const D=c.XpG();c.AVh("was-validated",D.confirmPasswordControl.dirty||D.confirmPasswordControl.touched),c.R7$(3),c.Y8G("autocomplete",D.passwordAutocomplete),c.R7$(2),c.Y8G("ngIf",!D.confirmPasswordControl.invalid),c.R7$(),c.Y8G("ngIf",D.confirmPasswordControl.invalid)}}function O(M,he){1&M&&(c.j41(0,"div",29),c.EFF(1,"OK!"),c.k0s())}function N(M,he){1&M&&(c.j41(0,"div",31),c.EFF(1,"\u898f\u7d04\u306b\u540c\u610f\u3057\u3066\u3044\u305f\u3060\u304f\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002"),c.k0s())}function w(M,he){if(1&M&&(c.qex(0),c.DNE(1,N,2,0,"div",30),c.bVm()),2&M){const D=c.XpG(2);c.R7$(),c.Y8G("ngIf",null==D.agreeTosControl.errors?null:D.agreeTosControl.errors.required)}}function S(M,he){if(1&M&&(c.j41(0,"div",23)(1,"label",24),c.EFF(2,"\u898f\u7d04\u306b\u540c\u610f\u3059\u308b"),c.k0s(),c.nrm(3,"input",25),c.j41(4,"a",26),c.EFF(5," [\u5229\u7528\u898f\u7d04] "),c.k0s(),c.j41(6,"span",27),c.EFF(7,"\u306b\u540c\u610f\u3057\u307e\u3059\u3002"),c.k0s(),c.DNE(8,O,2,0,"div",28)(9,w,2,1,"ng-container",7),c.k0s()),2&M){const D=c.XpG();c.AVh("was-validated",D.agreeTosControl.dirty||D.agreeTosControl.touched),c.R7$(8),c.Y8G("ngIf",!D.agreeTosControl.invalid),c.R7$(),c.Y8G("ngIf",D.agreeTosControl.invalid)}}function re(M,he){if(1&M){const D=c.RV6();c.j41(0,"button",32),c.bIt("click",function($){c.eBV(D);const fe=c.XpG();return c.Njj(fe.onClickSignup($))}),c.EFF(1,"\u30a2\u30ab\u30a6\u30f3\u30c8\u4f5c\u6210"),c.k0s()}if(2&M){const D=c.XpG();c.Y8G("disabled",!D.inputAuthForm.valid)}}function Z(M,he){if(1&M){const D=c.RV6();c.j41(0,"button",32),c.bIt("click",function($){c.eBV(D);const fe=c.XpG();return c.Njj(fe.onClickLogin($))}),c.nrm(1,"img",33),c.EFF(2,"\u30ed\u30b0\u30a4\u30f3"),c.k0s()}if(2&M){const D=c.XpG();c.Y8G("disabled",!D.inputAuthForm.valid)}}function Ie(M,he){if(1&M){const D=c.RV6();c.j41(0,"button",32),c.bIt("click",function($){c.eBV(D);const fe=c.XpG();return c.Njj(fe.onClickReauth($))}),c.nrm(1,"img",33),c.EFF(2,"\u518d\u8a8d\u8a3c"),c.k0s()}if(2&M){const D=c.XpG();c.Y8G("disabled",!D.inputAuthForm.valid)}}function ne(M,he){if(1&M){const D=c.RV6();c.j41(0,"app-oauth-federations",34),c.bIt("loginSucceeded",function(){c.eBV(D);const $=c.XpG();return c.Njj($.onOauthLoginSucceeded())})("loginFailed",function($){c.eBV(D);const fe=c.XpG();return c.Njj(fe.onOauthLoginFailed($))}),c.k0s()}}let y=(()=>{class M{auth;toastr;router;route;isLogin=!1;isReauth=!1;reauthUser=null;isSignup=!1;showFederations=!0;reauthed=new c.bkB;destroy$=new _e.B;inputAuthForm;loginUser$=new le.t(null);passwordAutocomplete;mainForm;confirmPasswordInput;constructor(D,H,$,fe){this.auth=D,this.toastr=H,this.router=$,this.route=fe}ngOnInit(){this.passwordAutocomplete=this.isSignup?"new-password":"current-password",this.inputAuthForm=new J.gE({}),this.inputAuthForm.addControl("email",new J.MJ("")),this.inputAuthForm.addControl("password",new J.MJ("")),this.isSignup&&(this.inputAuthForm.addControl("retypePassword",new J.MJ("")),this.inputAuthForm.addControl("agreeTosCheck",new J.MJ(!1)),this.inputAuthForm.setValidators([this.validateXFPassword.bind(this)])),this.inputAuthForm.disable(),this.initializeAuthForm()}ngOnDestroy(){this.destroy$.next()}ngAfterViewInit(){this.auth.authState.pipe((0,ve.Q)(this.destroy$)).subscribe(D=>{this.loginUser$.next(D)})}navigateAfterSucceeded(){this.route.queryParams.pipe((0,ve.Q)(this.destroy$),(0,R.s)(1)).subscribe(D=>{const H=D.redirectPath;this.router.navigate(H?[H]:["/"])})}erroredConnected(D){(0,xe.sJ)("error while connecting account",D);const H=D instanceof Error?D.message:"Unknown error";this.toastr.error(`Login \u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002 \n ( ${H} )`)}loginSucceeded(){this.toastr.success("Login \u3057\u307e\u3057\u305f\u3002"),this.navigateAfterSucceeded()}connectSucceeded(D){this.toastr.success("Sign-up \u3057\u307e\u3057\u305f\u3002"),this.navigateAfterSucceeded()}get emailControl(){return this.inputAuthForm.get("email")}get passwordControl(){return this.inputAuthForm.get("password")}get confirmPasswordControl(){return this.inputAuthForm.get("retypePassword")}get agreeTosControl(){return this.inputAuthForm.get("agreeTosCheck")}validateXFPassword(D){const H=D.get("password"),$=D.get("retypePassword");return H.value!==$.value?($.setErrors({passwordMisMatch:!0}),this.confirmPasswordInput&&this.confirmPasswordInput.nativeElement.setCustomValidity("create error state"),null):(this.confirmPasswordInput&&this.confirmPasswordInput.nativeElement.setCustomValidity(""),$.setErrors(null),null)}validateAuthForm(){return this.inputAuthForm.markAllAsTouched(),!this.inputAuthForm.invalid||((0,xe.sJ)("Assert! Button should be disabled."),!1)}initializeAuthForm(){(0,be.H)(this.auth.setPersistence(e.A.auth.Auth.Persistence.SESSION)).pipe((0,R.s)(1),(0,ve.Q)(this.destroy$)).subscribe({next:()=>{this.inputAuthForm.enable()},error:D=>{this.toastr.error("\u8a8d\u8a3c Server \u3092\u521d\u671f\u5316\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002")}})}onClickSignup(D){var H=this;return(0,B.A)(function*(){if(D.preventDefault(),H.validateAuthForm())try{const $=yield H.auth.createUserWithEmailAndPassword(H.emailControl.value,H.passwordControl.value);H.toastr.info("\u30a2\u30ab\u30a6\u30f3\u30c8\u3092\u4f5c\u6210\u3057\u307e\u3057\u305f\u3002\u30e1\u30fc\u30eb\u3092\u78ba\u8a8d\u3057\u3066\u304f\u3060\u3055\u3044\u3002"),yield $.user.sendEmailVerification(),H.navigateAfterSucceeded()}catch($){(0,xe.sJ)("Error while reject",$);const fe=$ instanceof Error?$.message:"Unknown error";H.toastr.error(`\u30a2\u30ab\u30a6\u30f3\u30c8\u306e\u4f5c\u6210\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002\u6700\u521d\u304b\u3089\u3084\u308a\u76f4\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n ( ${fe} )`)}})()}onClickLogin(D){var H=this;return(0,B.A)(function*(){if(D.preventDefault(),H.validateAuthForm())try{yield H.auth.signInWithEmailAndPassword(H.emailControl.value,H.passwordControl.value),H.loginSucceeded()}catch($){H.erroredConnected($)}})()}onClickReauth(D){var H=this;return(0,B.A)(function*(){if(D.preventDefault(),H.validateAuthForm())try{const $=e.A.auth.EmailAuthProvider.credential(H.emailControl.value,H.passwordControl.value);yield H.reauthUser.reauthenticateWithCredential($),H.reauthed.next()}catch($){H.erroredConnected($)}})()}onOauthLoginFailed(D){this.erroredConnected(D)}onOauthLoginSucceeded(){this.loginSucceeded()}static \u0275fac=function(H){return new(H||M)(c.rXU(De.DS),c.rXU(Ae.tw),c.rXU(We.Ix),c.rXU(We.nX))};static \u0275cmp=c.VBU({type:M,selectors:[["gitfire-login-input-auth"]],viewQuery:function(H,$){if(1&H&&(c.GBs(me,5),c.GBs(Be,5)),2&H){let fe;c.mGM(fe=c.lsd())&&($.mainForm=fe.first),c.mGM(fe=c.lsd())&&($.confirmPasswordInput=fe.first)}},inputs:{isLogin:"isLogin",isReauth:"isReauth",reauthUser:"reauthUser",isSignup:"isSignup",showFederations:"showFederations"},outputs:{reauthed:"reauthed"},decls:22,vars:17,consts:[["mainForm",""],["confirmPasswordInput",""],[3,"formGroup"],[1,"row","m-3"],["for","appGitfireLoginEmailInput",1,"visually-hidden"],["id","appGitfireLoginEmailInput","name","email","formControlName","email","placeholder","email@example.com","autocomplete","email","type","email","required","","autofill","","autofocus","","maxlength","1024","minlength","5",1,"form-control","col-12"],["class","valid-feedback",4,"ngIf"],[4,"ngIf"],["for","appGitfireLoginPasswordInput",1,"visually-hidden"],["id","appGitfireLoginPasswordInput","type","password","name","password","formControlName","password","placeholder","Password","required","","autofill","","maxlength","256","minlength","6",1,"form-control","col-12",3,"autocomplete"],["class"," ",4,"ngIf"],["class","col-12 m-3",3,"passwordToCheck","barLabel","strengthLabels","barColors",4,"ngIf"],["class","row m-3",3,"was-validated",4,"ngIf"],["class","row custom-control custom-checkbox m-5 text-center",3,"was-validated",4,"ngIf"],["class","btn btn-lg btn-primary btn-block",3,"disabled","click",4,"ngIf"],[3,"loginSucceeded","loginFailed",4,"ngIf"],[1,"valid-feedback"],["class","invalid-feedback",4,"ngIf"],[1,"invalid-feedback"],[1,""],[1,"col-12","m-3",3,"passwordToCheck","barLabel","strengthLabels","barColors"],["for","appGitfireSignupPasswordConfirmInput",1,"visually-hidden"],["id","appGitfireSignupPasswordConfirmInput","type","password","name","password_confirm","formControlName","retypePassword","placeholder","Confirm password","required","",1,"form-control","col-12",3,"autocomplete"],[1,"row","custom-control","custom-checkbox","m-5","text-center"],["for","appGitfireAgreeTosCheck",1,"col-auto","visually-hidden"],["id","col-auto appGitfireAgreeTosCheck","formControlName","agreeTosCheck","type","checkbox","required","",1,"form-check-input"],["tabindex","-1","about","_blank","href","/terms.htm",1,"col-auto"],[1,"col-auto"],["class","valid-feedback col-auto",4,"ngIf"],[1,"valid-feedback","col-auto"],["class","invalid-feedback col-auto",4,"ngIf"],[1,"invalid-feedback","col-auto"],[1,"btn","btn-lg","btn-primary","btn-block",3,"click","disabled"],["src","/assets/octicons/sign-in.svg",1,"m-1","gitfire-link-icon","octicon-info"],[3,"loginSucceeded","loginFailed"]],template:function(H,$){1&H&&(c.j41(0,"form",2,0)(2,"div",3)(3,"label",4),c.EFF(4,"Email"),c.k0s(),c.nrm(5,"input",5),c.DNE(6,Ke,2,0,"div",6)(7,Ce,3,2,"ng-container",7),c.k0s(),c.j41(8,"div",3)(9,"label",8),c.EFF(10,"Password"),c.k0s(),c.nrm(11,"input",9),c.DNE(12,He,2,0,"div",6)(13,E,3,2,"ng-container",10)(14,T,2,8,"ng9-password-strength-bar",11),c.k0s(),c.DNE(15,U,7,5,"div",12)(16,S,10,4,"div",13),c.j41(17,"div",3),c.DNE(18,re,2,1,"button",14)(19,Z,3,1,"button",14)(20,Ie,3,1,"button",14),c.k0s(),c.DNE(21,ne,1,0,"app-oauth-federations",15),c.k0s()),2&H&&(c.Y8G("formGroup",$.inputAuthForm),c.R7$(2),c.AVh("was-validated",$.emailControl.dirty||$.emailControl.touched),c.R7$(4),c.Y8G("ngIf",!$.emailControl.invalid),c.R7$(),c.Y8G("ngIf",$.emailControl.invalid),c.R7$(),c.AVh("was-validated",$.passwordControl.dirty||$.passwordControl.touched),c.R7$(3),c.Y8G("autocomplete",$.passwordAutocomplete),c.R7$(),c.Y8G("ngIf",$.isSignup&&!$.passwordControl.invalid),c.R7$(),c.Y8G("ngIf",$.passwordControl.invalid),c.R7$(),c.Y8G("ngIf",$.isSignup),c.R7$(),c.Y8G("ngIf",$.isSignup),c.R7$(),c.Y8G("ngIf",$.isSignup),c.R7$(2),c.Y8G("ngIf",$.isSignup),c.R7$(),c.Y8G("ngIf",$.isLogin),c.R7$(),c.Y8G("ngIf",$.isReauth),c.R7$(),c.Y8G("ngIf",$.showFederations))},dependencies:[Ze.bT,J.qT,J.me,J.Zm,J.BC,J.cb,J.YS,J.xh,J.tU,J.xq,J.j4,J.JD,oe.j,pe.d,Ze.Jj]})}return M})()},3691:(Yt,je,_)=>{_.d(je,{Q:()=>J});var B=_(177),c=_(4438);let J=(()=>{class _e{static \u0275fac=function(ve){return new(ve||_e)};static \u0275mod=c.$C({type:_e});static \u0275inj=c.G2t({imports:[B.MD]})}return _e})()},7830:(Yt,je,_)=>{function le(E,T,A,F){var U,P=arguments.length,C=P<3?T:null===F?F=Object.getOwnPropertyDescriptor(T,A):F;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)C=Reflect.decorate(E,T,A,F);else for(var O=E.length-1;O>=0;O--)(U=E[O])&&(C=(P<3?U(C):P>3?U(T,A,C):U(T,A))||C);return P>3&&C&&Object.defineProperty(T,A,C),C}_.d(je,{j:()=>de,o:()=>Ye});var He,Ce=_(4438);let de=He=class{constructor(){this.onStrengthChanged=new Ce.bkB,this.defaultColors=["#F00","#F90","#FF0","#9F0","#0F0"],this.defaultThresholds=[90,70,40,20],this.defaultBaseColor="#DDD",this.colors=this.defaultColors,this.thresholds=this.defaultThresholds}static measureStrength(T){let A=0;const F={};for(let U=0;U<T.length;U++)F[T[U]]=(F[T[U]]||0)+1,A+=5/F[T[U]];const P={digits:/\d/.test(T),lower:/[a-z]/.test(T),upper:/[A-Z]/.test(T),nonWords:/\W/.test(T)};let C=0;for(let U in P)C+=P[U]?1:0;return A+=10*(C-1),Math.trunc(A)}checkBarColors(){this.colors=this.barColors&&5===this.barColors.length?this.barColors.slice():this.defaultColors,this.strengths=this.strengthLabels&&5===this.strengthLabels.length?this.strengthLabels.slice():null,this.setStrengthLabel(0),/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(this.baseColor)||(this.baseColor=this.defaultBaseColor)}checkThresholds(){this.thresholds=this.customThresholds&&4===this.customThresholds.length?this.customThresholds.slice():this.defaultThresholds}getColor(T){let A=0;return T>this.thresholds[0]?A=4:T>this.thresholds[1]?A=3:T>=this.thresholds[2]?A=2:T>=this.thresholds[3]&&(A=1),{idx:A+1,col:this.colors[A]}}getStrengthIndexAndColor(T){return this.getColor(He.measureStrength(T))}ngOnChanges(T){if(!T.passwordToCheck)return;const A=T.passwordToCheck.currentValue;this.checkBarColors(),this.checkThresholds(),this.setBarColors(5,this.baseColor);let F=0;if(A){const P=this.getStrengthIndexAndColor(A);F=P.idx-1,this.setStrengthLabel(F),this.setBarColors(P.idx,P.col)}this.onStrengthChanged.emit(F)}setBarColors(T,A){for(let F=0;F<T;F++)this["bar"+F]=A}setStrengthLabel(T){this.strengths&&(this.strengthLabel=this.strengths[T])}};le([(0,Ce.pde)()],de.prototype,"passwordToCheck",void 0),le([(0,Ce.pde)()],de.prototype,"barLabel",void 0),le([(0,Ce.pde)()],de.prototype,"barColors",void 0),le([(0,Ce.pde)()],de.prototype,"baseColor",void 0),le([(0,Ce.pde)()],de.prototype,"strengthLabels",void 0),le([(0,Ce.pde)()],de.prototype,"customThresholds",void 0),le([(0,Ce.k7i)()],de.prototype,"onStrengthChanged",void 0),de=He=le([(0,Ce.uAl)({selector:"ng9-password-strength-bar",template:'\n    <div id="strength" #strength>\n      <small>{{barLabel}}</small>\n      <ul id="strengthBar" class="strengthBar">\n        <li id="bar0" class="point" [style.background-color]="bar0"></li>\n        <li class="point" [style.background-color]="bar1"></li>\n        <li class="point" [style.background-color]="bar2"></li>\n        <li class="point" [style.background-color]="bar3"></li>\n        <li class="point" [style.background-color]="bar4"></li>\n      </ul>\n      <small [hidden]="!strengths" class="pre">  {{strengthLabel}}</small>\n    </div>\n  ',styles:["\n    .strengthBar {\n      display: inline;\n      list-style: none;\n      margin: 0 0 0 15px;\n      padding: 0;\n      vertical-align: 2px;\n    }\n\n    .strengthBar .point {\n      background: #DDD;\n      border-radius: 2px;\n      display: inline-block;\n      height: 5px;\n      margin-right: 1px;\n      width: 20px;\n    }\n\n    .strengthBar .point:last-child {\n      margin: 0;\n    }\n    .pre {\n      white-space: pre;\n    }\n  "]})],de);let Ye=(()=>{let E=class{};return E=le([(0,Ce.UQu)({declarations:[de],imports:[],exports:[de]})],E),E})()},1848:(Yt,je,_)=>{_.d(je,{ap:()=>Ge,y5:()=>ar});var B=_(574),c=_(1985),J=_(7673),_e=_(8455),le=_(152),be=_(6354),ve=_(5558),R=_(4438),e=_(9253),rt=_(9574),xe=_(467),De=_(1631),Ae=_(1076),We=_(8779);const Ze="firebasestorage.googleapis.com",oe="storageBucket";class te extends Ae.g{constructor(r,u,l=0){super(Ke(r),`Firebase Storage: ${u} (${Ke(r)})`),this.status_=l,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,te.prototype)}get status(){return this.status_}set status(r){this.status_=r}_codeEquals(r){return Ke(r)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(r){this.customData.serverResponse=r,this.message=this.customData.serverResponse?`${this._baseMessage}\n${this.customData.serverResponse}`:this._baseMessage}}var Q=function(i){return i.UNKNOWN="unknown",i.OBJECT_NOT_FOUND="object-not-found",i.BUCKET_NOT_FOUND="bucket-not-found",i.PROJECT_NOT_FOUND="project-not-found",i.QUOTA_EXCEEDED="quota-exceeded",i.UNAUTHENTICATED="unauthenticated",i.UNAUTHORIZED="unauthorized",i.UNAUTHORIZED_APP="unauthorized-app",i.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",i.INVALID_CHECKSUM="invalid-checksum",i.CANCELED="canceled",i.INVALID_EVENT_NAME="invalid-event-name",i.INVALID_URL="invalid-url",i.INVALID_DEFAULT_BUCKET="invalid-default-bucket",i.NO_DEFAULT_BUCKET="no-default-bucket",i.CANNOT_SLICE_BLOB="cannot-slice-blob",i.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",i.NO_DOWNLOAD_URL="no-download-url",i.INVALID_ARGUMENT="invalid-argument",i.INVALID_ARGUMENT_COUNT="invalid-argument-count",i.APP_DELETED="app-deleted",i.INVALID_ROOT_OPERATION="invalid-root-operation",i.INVALID_FORMAT="invalid-format",i.INTERNAL_ERROR="internal-error",i.UNSUPPORTED_ENVIRONMENT="unsupported-environment",i}(Q||{});function Ke(i){return"storage/"+i}function Ne(){return new te(Q.UNKNOWN,"An unknown error occurred, please check the error payload for server response.")}function E(){return new te(Q.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function T(){return new te(Q.CANCELED,"User canceled the upload/download.")}function C(){return new te(Q.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function w(i){return new te(Q.INVALID_ARGUMENT,i)}function S(){return new te(Q.APP_DELETED,"The Firebase app was deleted.")}function re(i){return new te(Q.INVALID_ROOT_OPERATION,"The operation '"+i+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function Z(i,r){return new te(Q.INVALID_FORMAT,"String does not match format '"+i+"': "+r)}function Ie(i){throw new te(Q.INTERNAL_ERROR,"Internal error: "+i)}class ne{constructor(r,u){this.bucket=r,this.path_=u}get path(){return this.path_}get isRoot(){return 0===this.path.length}fullServerUrl(){const r=encodeURIComponent;return"/b/"+r(this.bucket)+"/o/"+r(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(r,u){let l;try{l=ne.makeFromUrl(r,u)}catch{return new ne(r,"")}if(""===l.path)return l;throw function F(i){return new te(Q.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+i+"'.")}(r)}static makeFromUrl(r,u){let l=null;const p="([A-Za-z0-9.\\-_]+)",K=new RegExp("^gs://"+p+"(/(.*))?$","i");function Y(Se){Se.path_=decodeURIComponent(Se.path)}const Te=u.replace(/[.]/g,"\\."),Le=[{regex:K,indices:{bucket:1,path:3},postModify:function b(Se){"/"===Se.path.charAt(Se.path.length-1)&&(Se.path_=Se.path_.slice(0,-1))}},{regex:new RegExp(`^https?://${Te}/v[A-Za-z0-9_]+/b/${p}/o(/([^?#]*).*)?$`,"i"),indices:{bucket:1,path:3},postModify:Y},{regex:new RegExp(`^https?://${u===Ze?"(?:storage.googleapis.com|storage.cloud.google.com)":u}/${p}/([^?#]*)`,"i"),indices:{bucket:1,path:2},postModify:Y}];for(let Se=0;Se<Le.length;Se++){const Nt=Le[Se],Kt=Nt.regex.exec(r);if(Kt){let nn=Kt[Nt.indices.path];nn||(nn=""),l=new ne(Kt[Nt.indices.bucket],nn),Nt.postModify(l);break}}if(null==l)throw function A(i){return new te(Q.INVALID_URL,"Invalid URL '"+i+"'.")}(r);return l}}class y{constructor(r){this.promise_=Promise.reject(r)}getPromise(){return this.promise_}cancel(r=!1){}}function fe(i){return"string"==typeof i||i instanceof String}function it(i){return ot()&&i instanceof Blob}function ot(){return typeof Blob<"u"}function st(i,r,u,l){if(l<r)throw w(`Invalid value for '${i}'. Expected ${r} or greater.`);if(l>u)throw w(`Invalid value for '${i}'. Expected ${u} or less.`)}function Ue(i,r,u){let l=r;return null==u&&(l=`https://${r}`),`${u}://${l}/v0${i}`}function tt(i){const r=encodeURIComponent;let u="?";for(const l in i)i.hasOwnProperty(l)&&(u=u+(r(l)+"=")+r(i[l])+"&");return u=u.slice(0,-1),u}var Xe=function(i){return i[i.NO_ERROR=0]="NO_ERROR",i[i.NETWORK_ERROR=1]="NETWORK_ERROR",i[i.ABORT=2]="ABORT",i}(Xe||{});function nt(i,r){const u=i>=500&&i<600,p=-1!==[408,429].indexOf(i),b=-1!==r.indexOf(i);return u||p||b}class It{constructor(r,u,l,p,b,k,K,j,Y,ie,Te,ye=!0){this.url_=r,this.method_=u,this.headers_=l,this.body_=p,this.successCodes_=b,this.additionalRetryCodes_=k,this.callback_=K,this.errorCallback_=j,this.timeout_=Y,this.progressCallback_=ie,this.connectionFactory_=Te,this.retry=ye,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((ue,ke)=>{this.resolve_=ue,this.reject_=ke,this.start_()})}start_(){const u=(l,p)=>{const b=this.resolve_,k=this.reject_,K=p.connection;if(p.wasSuccessCode)try{const j=this.callback_(K,K.getResponse());!function D(i){return void 0!==i}(j)?b():b(j)}catch(j){k(j)}else if(null!==K){const j=Ne();j.serverResponse=K.getErrorText(),k(this.errorCallback_?this.errorCallback_(K,j):j)}else k(p.canceled?this.appDelete_?S():T():E())};this.canceled_?u(0,new ct(!1,null,!0)):this.backoffId_=function M(i,r,u){let l=1,p=null,b=null,k=!1,K=0;function j(){return 2===K}let Y=!1;function ie(...se){Y||(Y=!0,r.apply(null,se))}function Te(se){p=setTimeout(()=>{p=null,i(ue,j())},se)}function ye(){b&&clearTimeout(b)}function ue(se,...Qe){if(Y)return void ye();if(se)return ye(),void ie.call(null,se,...Qe);if(j()||k)return ye(),void ie.call(null,se,...Qe);let Le;l<64&&(l*=2),1===K?(K=2,Le=0):Le=1e3*(l+Math.random()),Te(Le)}let ke=!1;function Pe(se){ke||(ke=!0,ye(),!Y&&(null!==p?(se||(K=2),clearTimeout(p),Te(0)):se||(K=1)))}return Te(0),b=setTimeout(()=>{k=!0,Pe(!0)},u),Pe}((l,p)=>{if(p)return void l(!1,new ct(!1,null,!0));const b=this.connectionFactory_();this.pendingConnection_=b;const k=K=>{null!==this.progressCallback_&&this.progressCallback_(K.loaded,K.lengthComputable?K.total:-1)};null!==this.progressCallback_&&b.addUploadProgressListener(k),b.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{null!==this.progressCallback_&&b.removeUploadProgressListener(k),this.pendingConnection_=null;const K=b.getErrorCode()===Xe.NO_ERROR,j=b.getStatus();if(!K||nt(j,this.additionalRetryCodes_)&&this.retry){const ie=b.getErrorCode()===Xe.ABORT;return void l(!1,new ct(!1,null,ie))}const Y=-1!==this.successCodes_.indexOf(j);l(!0,new ct(Y,b))})},u,this.timeout_)}getPromise(){return this.promise_}cancel(r){this.canceled_=!0,this.appDelete_=r||!1,null!==this.backoffId_&&function he(i){i(!1)}(this.backoffId_),null!==this.pendingConnection_&&this.pendingConnection_.abort()}}class ct{constructor(r,u,l){this.wasSuccessCode=r,this.connection=u,this.canceled=!!l}}function St(...i){const r=function Lt(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}();if(void 0!==r){const u=new r;for(let l=0;l<i.length;l++)u.append(i[l]);return u.getBlob()}if(ot())return new Blob(i);throw new te(Q.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}const Fe={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class lt{constructor(r,u){this.data=r,this.contentType=u||null}}function ze(i,r){switch(i){case Fe.RAW:return new lt(Et(r));case Fe.BASE64:case Fe.BASE64URL:return new lt(at(i,r));case Fe.DATA_URL:return new lt(function jt(i){const r=new gt(i);return r.base64?at(Fe.BASE64,r.rest):function Pt(i){let r;try{r=decodeURIComponent(i)}catch{throw Z(Fe.DATA_URL,"Malformed data URL.")}return Et(r)}(r.rest)}(r),function mt(i){return new gt(i).contentType}(r))}throw Ne()}function Et(i){const r=[];for(let u=0;u<i.length;u++){let l=i.charCodeAt(u);l<=127?r.push(l):l<=2047?r.push(192|l>>6,128|63&l):55296==(64512&l)?u<i.length-1&&56320==(64512&i.charCodeAt(u+1))?(l=65536|(1023&l)<<10|1023&i.charCodeAt(++u),r.push(240|l>>18,128|l>>12&63,128|l>>6&63,128|63&l)):r.push(239,191,189):56320==(64512&l)?r.push(239,191,189):r.push(224|l>>12,128|l>>6&63,128|63&l)}return new Uint8Array(r)}function at(i,r){switch(i){case Fe.BASE64:{const p=-1!==r.indexOf("-"),b=-1!==r.indexOf("_");if(p||b)throw Z(i,"Invalid character '"+(p?"-":"_")+"' found: is it base64url encoded?");break}case Fe.BASE64URL:{const p=-1!==r.indexOf("+"),b=-1!==r.indexOf("/");if(p||b)throw Z(i,"Invalid character '"+(p?"+":"/")+"' found: is it base64 encoded?");r=r.replace(/-/g,"+").replace(/_/g,"/");break}}let u;try{u=function Dt(i){if(typeof atob>"u")throw function N(i){return new te(Q.UNSUPPORTED_ENVIRONMENT,`${i} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}("base-64");return atob(i)}(r)}catch(p){throw p.message.includes("polyfill")?p:Z(i,"Invalid character found")}const l=new Uint8Array(u.length);for(let p=0;p<u.length;p++)l[p]=u.charCodeAt(p);return l}class gt{constructor(r){this.base64=!1,this.contentType=null;const u=r.match(/^data:([^,]+)?,/);if(null===u)throw Z(Fe.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const l=u[1]||null;null!=l&&(this.base64=function xt(i,r){return i.length>=r.length&&i.substring(i.length-r.length)===r}(l,";base64"),this.contentType=this.base64?l.substring(0,l.length-7):l),this.rest=r.substring(r.indexOf(",")+1)}}class Me{constructor(r,u){let l=0,p="";it(r)?(this.data_=r,l=r.size,p=r.type):r instanceof ArrayBuffer?(u?this.data_=new Uint8Array(r):(this.data_=new Uint8Array(r.byteLength),this.data_.set(new Uint8Array(r))),l=this.data_.length):r instanceof Uint8Array&&(u?this.data_=r:(this.data_=new Uint8Array(r.length),this.data_.set(r)),l=r.length),this.size_=l,this.type_=p}size(){return this.size_}type(){return this.type_}slice(r,u){if(it(this.data_)){const p=function Ot(i,r,u){return i.webkitSlice?i.webkitSlice(r,u):i.mozSlice?i.mozSlice(r,u):i.slice?i.slice(r,u):null}(this.data_,r,u);return null===p?null:new Me(p)}{const l=new Uint8Array(this.data_.buffer,r,u-r);return new Me(l,!0)}}static getBlob(...r){if(ot()){const u=r.map(l=>l instanceof Me?l.data_:l);return new Me(St.apply(null,u))}{const u=r.map(k=>fe(k)?ze(Fe.RAW,k).data:k.data_);let l=0;u.forEach(k=>{l+=k.byteLength});const p=new Uint8Array(l);let b=0;return u.forEach(k=>{for(let K=0;K<k.length;K++)p[b++]=k[K]}),new Me(p,!0)}}uploadData(){return this.data_}}function _t(i){let r;try{r=JSON.parse(i)}catch{return null}return function $(i){return"object"==typeof i&&!Array.isArray(i)}(r)?r:null}function At(i){const r=i.lastIndexOf("/",i.length-2);return-1===r?i:i.slice(r+1)}function Tt(i,r){return r}class we{constructor(r,u,l,p){this.server=r,this.local=u||r,this.writable=!!l,this.xform=p||Tt}}let dt=null;function Je(){if(dt)return dt;const i=[];i.push(new we("bucket")),i.push(new we("generation")),i.push(new we("metageneration")),i.push(new we("name","fullPath",!0));const u=new we("name");u.xform=function r(b,k){return function Jt(i){return!fe(i)||i.length<2?i:At(i)}(k)},i.push(u);const p=new we("size");return p.xform=function l(b,k){return void 0!==k?Number(k):k},i.push(p),i.push(new we("timeCreated")),i.push(new we("updated")),i.push(new we("md5Hash",null,!0)),i.push(new we("cacheControl",null,!0)),i.push(new we("contentDisposition",null,!0)),i.push(new we("contentEncoding",null,!0)),i.push(new we("contentLanguage",null,!0)),i.push(new we("contentType",null,!0)),i.push(new we("metadata","customMetadata",!0)),dt=i,dt}function yt(i,r,u){const l=_t(r);return null===l?null:function $t(i,r,u){const l={type:"file"},p=u.length;for(let b=0;b<p;b++){const k=u[b];l[k.local]=k.xform(l,r[k.server])}return function vt(i,r){Object.defineProperty(i,"ref",{get:function u(){const b=new ne(i.bucket,i.fullPath);return r._makeStorageReference(b)}})}(l,i),l}(i,l,u)}function kt(i,r){const u={},l=r.length;for(let p=0;p<l;p++){const b=r[p];b.writable&&(u[b.server]=i[b.local])}return JSON.stringify(u)}const qt="prefixes",Ut="items";class f{constructor(r,u,l,p){this.url=r,this.method=u,this.handler=l,this.timeout=p,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}function v(i){if(!i)throw Ne()}function x(i,r){return function u(l,p){const b=yt(i,p,r);return v(null!==b),b}}function d(i){return function r(u,l){let p;return p=401===u.getStatus()?u.getErrorText().includes("Firebase App Check token is invalid")?function de(){return new te(Q.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}():function He(){return new te(Q.UNAUTHENTICATED,"User is not authenticated, please authenticate using Firebase Authentication and try again.")}():402===u.getStatus()?function Ce(i){return new te(Q.QUOTA_EXCEEDED,"Quota for bucket '"+i+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}(i.bucket):403===u.getStatus()?function Ye(i){return new te(Q.UNAUTHORIZED,"User does not have permission to access '"+i+"'.")}(i.path):l,p.status=u.getStatus(),p.serverResponse=l.serverResponse,p}}function m(i){const r=d(i);return function u(l,p){let b=r(l,p);return 404===l.getStatus()&&(b=function et(i){return new te(Q.OBJECT_NOT_FOUND,"Object '"+i+"' does not exist.")}(i.path)),b.serverResponse=p.serverResponse,b}}function I(i,r,u){const p=Ue(r.fullServerUrl(),i.host,i._protocol),k=i.maxOperationRetryTime,K=new f(p,"GET",x(i,u),k);return K.errorHandler=m(r),K}function V(i,r,u,l,p){const b={};b.prefix=r.isRoot?"":r.path+"/",u&&u.length>0&&(b.delimiter=u),l&&(b.pageToken=l),p&&(b.maxResults=p);const K=Ue(r.bucketOnlyServerUrl(),i.host,i._protocol),Y=i.maxOperationRetryTime,ie=new f(K,"GET",function L(i,r){return function u(l,p){const b=function ht(i,r,u){const l=_t(u);return null===l?null:function Qt(i,r,u){const l={prefixes:[],items:[],nextPageToken:u.nextPageToken};if(u[qt])for(const p of u[qt]){const b=p.replace(/\/$/,""),k=i._makeStorageReference(new ne(r,b));l.prefixes.push(k)}if(u[Ut])for(const p of u[Ut]){const b=i._makeStorageReference(new ne(r,p.name));l.items.push(b)}return l}(i,r,l)}(i,r,p);return v(null!==b),b}}(i,r.bucket),Y);return ie.urlParams=b,ie.errorHandler=d(r),ie}function qe(i,r,u){const l=Object.assign({},u);return l.fullPath=i.path,l.size=r.size(),l.contentType||(l.contentType=function ft(i,r){return i&&i.contentType||r&&r.type()||"application/octet-stream"}(null,r)),l}class un{constructor(r,u,l,p){this.current=r,this.total=u,this.finalized=!!l,this.metadata=p||null}}function Tn(i,r){let u=null;try{u=i.getResponseHeader("X-Goog-Upload-Status")}catch{v(!1)}return v(!!u&&-1!==(r||["active"]).indexOf(u)),u}const Nn={STATE_CHANGED:"state_changed"},Ee={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function ln(i){switch(i){case"running":case"pausing":case"canceling":return Ee.RUNNING;case"paused":return Ee.PAUSED;case"success":return Ee.SUCCESS;case"canceled":return Ee.CANCELED;default:return Ee.ERROR}}class Mn{constructor(r,u,l){if(function H(i){return"function"==typeof i}(r)||null!=u||null!=l)this.next=r,this.error=u??void 0,this.complete=l??void 0;else{const b=r;this.next=b.next,this.error=b.error,this.complete=b.complete}}}function Gt(i){return(...r)=>{Promise.resolve().then(()=>i(...r))}}let dn=null;class dr{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Xe.NO_ERROR,this.sendPromise_=new Promise(r=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=Xe.ABORT,r()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=Xe.NETWORK_ERROR,r()}),this.xhr_.addEventListener("load",()=>{r()})})}send(r,u,l,p){if(this.sent_)throw Ie("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(u,r,!0),void 0!==p)for(const b in p)p.hasOwnProperty(b)&&this.xhr_.setRequestHeader(b,p[b].toString());return void 0!==l?this.xhr_.send(l):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw Ie("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw Ie("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw Ie("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw Ie("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(r){return this.xhr_.getResponseHeader(r)}addUploadProgressListener(r){null!=this.xhr_.upload&&this.xhr_.upload.addEventListener("progress",r)}removeUploadProgressListener(r){null!=this.xhr_.upload&&this.xhr_.upload.removeEventListener("progress",r)}}class sn extends dr{initXhr(){this.xhr_.responseType="text"}}function pt(){return dn?dn():new sn}class Ln{constructor(r,u,l=null){this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=r,this._blob=u,this._metadata=l,this._mappings=Je(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=p=>{if(this._request=void 0,this._chunkMultiplier=1,p._codeEquals(Q.CANCELED))this._needToFetchStatus=!0,this.completeTransitions_();else{const b=this.isExponentialBackoffExpired();if(nt(p.status,[])){if(!b)return this.sleepTime=Math.max(2*this.sleepTime,1e3),this._needToFetchStatus=!0,void this.completeTransitions_();p=E()}this._error=p,this._transition("error")}},this._metadataErrorHandler=p=>{this._request=void 0,p._codeEquals(Q.CANCELED)?this.completeTransitions_():(this._error=p,this._transition("error"))},this.sleepTime=0,this.maxSleepTime=this._ref.storage.maxUploadRetryTime,this._promise=new Promise((p,b)=>{this._resolve=p,this._reject=b,this._start()}),this._promise.then(null,()=>{})}isExponentialBackoffExpired(){return this.sleepTime>this.maxSleepTime}_makeProgressCallback(){const r=this._transferred;return u=>this._updateProgress(r+u)}_shouldDoResumable(r){return r.size()>262144}_start(){"running"===this._state&&void 0===this._request&&(this._resumable?void 0===this._uploadUrl?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this.pendingTimeout=setTimeout(()=>{this.pendingTimeout=void 0,this._continueUpload()},this.sleepTime):this._oneShotUpload())}_resolveToken(r){Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then(([u,l])=>{switch(this._state){case"running":r(u,l);break;case"canceling":this._transition("canceled");break;case"pausing":this._transition("paused")}})}_createResumable(){this._resolveToken((r,u)=>{const l=function cr(i,r,u,l,p){const b=r.bucketOnlyServerUrl(),k=qe(r,l,p),K={name:k.fullPath},j=Ue(b,i.host,i._protocol),ie={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${l.size()}`,"X-Goog-Upload-Header-Content-Type":k.contentType,"Content-Type":"application/json; charset=utf-8"},Te=kt(k,u),ke=new f(j,"POST",function ue(Pe){let se;Tn(Pe);try{se=Pe.getResponseHeader("X-Goog-Upload-URL")}catch{v(!1)}return v(fe(se)),se},i.maxUploadRetryTime);return ke.urlParams=K,ke.headers=ie,ke.body=Te,ke.errorHandler=d(r),ke}(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),p=this._ref.storage._makeRequest(l,pt,r,u);this._request=p,p.getPromise().then(b=>{this._request=void 0,this._uploadUrl=b,this._needToFetchStatus=!1,this.completeTransitions_()},this._errorHandler)})}_fetchStatus(){const r=this._uploadUrl;this._resolveToken((u,l)=>{const p=function cn(i,r,u,l){const j=new f(u,"POST",function b(Y){const ie=Tn(Y,["active","final"]);let Te=null;try{Te=Y.getResponseHeader("X-Goog-Upload-Size-Received")}catch{v(!1)}Te||v(!1);const ye=Number(Te);return v(!isNaN(ye)),new un(ye,l.size(),"final"===ie)},i.maxUploadRetryTime);return j.headers={"X-Goog-Upload-Command":"query"},j.errorHandler=d(r),j}(this._ref.storage,this._ref._location,r,this._blob),b=this._ref.storage._makeRequest(p,pt,u,l);this._request=b,b.getPromise().then(k=>{this._request=void 0,this._updateProgress(k.current),this._needToFetchStatus=!1,k.finalized&&(this._needToFetchMetadata=!0),this.completeTransitions_()},this._errorHandler)})}_continueUpload(){const r=262144*this._chunkMultiplier,u=new un(this._transferred,this._blob.size()),l=this._uploadUrl;this._resolveToken((p,b)=>{let k;try{k=function lr(i,r,u,l,p,b,k,K){const j=new un(0,0);if(k?(j.current=k.current,j.total=k.total):(j.current=0,j.total=l.size()),l.size()!==j.total)throw function U(){return new te(Q.SERVER_FILE_WRONG_SIZE,"Server recorded incorrect upload file size, please retry the upload.")}();const Y=j.total-j.current;let ie=Y;p>0&&(ie=Math.min(ie,p));const Te=j.current;let ue="";ue=0===ie?"finalize":Y===ie?"upload, finalize":"upload";const ke={"X-Goog-Upload-Command":ue,"X-Goog-Upload-Offset":`${j.current}`},Pe=l.slice(Te,Te+ie);if(null===Pe)throw C();const Le=new f(u,"POST",function se(Se,Nt){const Kt=Tn(Se,["active","final"]),Cn=j.current+ie,nn=l.size();let En;return En="final"===Kt?x(r,b)(Se,Nt):null,new un(Cn,nn,"final"===Kt,En)},r.maxUploadRetryTime);return Le.headers=ke,Le.body=Pe.uploadData(),Le.progressCallback=K||null,Le.errorHandler=d(i),Le}(this._ref._location,this._ref.storage,l,this._blob,r,this._mappings,u,this._makeProgressCallback())}catch(j){return this._error=j,void this._transition("error")}const K=this._ref.storage._makeRequest(k,pt,p,b,!1);this._request=K,K.getPromise().then(j=>{this._increaseMultiplier(),this._request=void 0,this._updateProgress(j.current),j.finalized?(this._metadata=j.metadata,this._transition("success")):this.completeTransitions_()},this._errorHandler)})}_increaseMultiplier(){262144*this._chunkMultiplier*2<33554432&&(this._chunkMultiplier*=2)}_fetchMetadata(){this._resolveToken((r,u)=>{const l=I(this._ref.storage,this._ref._location,this._mappings),p=this._ref.storage._makeRequest(l,pt,r,u);this._request=p,p.getPromise().then(b=>{this._request=void 0,this._metadata=b,this._transition("success")},this._metadataErrorHandler)})}_oneShotUpload(){this._resolveToken((r,u)=>{const l=function on(i,r,u,l,p){const b=r.bucketOnlyServerUrl(),k={"X-Goog-Upload-Protocol":"multipart"},j=function K(){let Le="";for(let Se=0;Se<2;Se++)Le+=Math.random().toString().slice(2);return Le}();k["Content-Type"]="multipart/related; boundary="+j;const Y=qe(r,l,p),ie=kt(Y,u),ue=Me.getBlob("--"+j+"\r\nContent-Type: application/json; charset=utf-8\r\n\r\n"+ie+"\r\n--"+j+"\r\nContent-Type: "+Y.contentType+"\r\n\r\n",l,"\r\n--"+j+"--");if(null===ue)throw C();const ke={name:Y.fullPath},Pe=Ue(b,i.host,i._protocol),Qe=i.maxUploadRetryTime,ut=new f(Pe,"POST",x(i,u),Qe);return ut.urlParams=ke,ut.headers=k,ut.body=ue.uploadData(),ut.errorHandler=d(r),ut}(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),p=this._ref.storage._makeRequest(l,pt,r,u);this._request=p,p.getPromise().then(b=>{this._request=void 0,this._metadata=b,this._updateProgress(this._blob.size()),this._transition("success")},this._errorHandler)})}_updateProgress(r){const u=this._transferred;this._transferred=r,this._transferred!==u&&this._notifyObservers()}_transition(r){if(this._state!==r)switch(r){case"canceling":case"pausing":this._state=r,void 0!==this._request?this._request.cancel():this.pendingTimeout&&(clearTimeout(this.pendingTimeout),this.pendingTimeout=void 0,this.completeTransitions_());break;case"running":const u="paused"===this._state;this._state=r,u&&(this._notifyObservers(),this._start());break;case"paused":case"error":case"success":this._state=r,this._notifyObservers();break;case"canceled":this._error=T(),this._state=r,this._notifyObservers()}}completeTransitions_(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start()}}get snapshot(){const r=ln(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:r,metadata:this._metadata,task:this,ref:this._ref}}on(r,u,l,p){const b=new Mn(u||void 0,l||void 0,p||void 0);return this._addObserver(b),()=>{this._removeObserver(b)}}then(r,u){return this._promise.then(r,u)}catch(r){return this.then(null,r)}_addObserver(r){this._observers.push(r),this._notifyObserver(r)}_removeObserver(r){const u=this._observers.indexOf(r);-1!==u&&this._observers.splice(u,1)}_notifyObservers(){this._finishPromise(),this._observers.slice().forEach(u=>{this._notifyObserver(u)})}_finishPromise(){if(void 0!==this._resolve){let r=!0;switch(ln(this._state)){case Ee.SUCCESS:Gt(this._resolve.bind(null,this.snapshot))();break;case Ee.CANCELED:case Ee.ERROR:Gt(this._reject.bind(null,this._error))();break;default:r=!1}r&&(this._resolve=void 0,this._reject=void 0)}}_notifyObserver(r){switch(ln(this._state)){case Ee.RUNNING:case Ee.PAUSED:r.next&&Gt(r.next.bind(r,this.snapshot))();break;case Ee.SUCCESS:r.complete&&Gt(r.complete.bind(r))();break;default:r.error&&Gt(r.error.bind(r,this._error))()}}resume(){const r="paused"===this._state||"pausing"===this._state;return r&&this._transition("running"),r}pause(){const r="running"===this._state;return r&&this._transition("pausing"),r}cancel(){const r="running"===this._state||"pausing"===this._state;return r&&this._transition("canceling"),r}}class Vt{constructor(r,u){this._service=r,this._location=u instanceof ne?u:ne.makeFromUrl(u,r.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(r,u){return new Vt(r,u)}get root(){const r=new ne(this._location.bucket,"");return this._newRef(this._service,r)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return At(this._location.path)}get storage(){return this._service}get parent(){const r=function zt(i){if(0===i.length)return null;const r=i.lastIndexOf("/");return-1===r?"":i.slice(0,r)}(this._location.path);if(null===r)return null;const u=new ne(this._location.bucket,r);return new Vt(this._service,u)}_throwIfRoot(r){if(""===this._location.path)throw re(r)}}function $n(i,r,u){return kn.apply(this,arguments)}function kn(){return(kn=(0,xe.A)(function*(i,r,u){const p=yield Gn(i,{pageToken:u});r.prefixes.push(...p.prefixes),r.items.push(...p.items),null!=p.nextPageToken&&(yield $n(i,r,p.nextPageToken))})).apply(this,arguments)}function Gn(i,r){null!=r&&"number"==typeof r.maxResults&&st("options.maxResults",1,1e3,r.maxResults);const u=r||{},l=V(i.storage,i._location,"/",u.pageToken,u.maxResults);return i.storage.makeRequestWithTokens(l,pt)}function Wn(i){i._throwIfRoot("getDownloadURL");const r=function ae(i,r,u){const p=Ue(r.fullServerUrl(),i.host,i._protocol),k=i.maxOperationRetryTime,K=new f(p,"GET",function X(i,r){return function u(l,p){const b=yt(i,p,r);return v(null!==b),function rn(i,r,u,l){const p=_t(r);if(null===p||!fe(p.downloadTokens))return null;const b=p.downloadTokens;if(0===b.length)return null;const k=encodeURIComponent;return b.split(",").map(Y=>{const Te=i.fullPath;return Ue("/b/"+k(i.bucket)+"/o/"+k(Te),u,l)+tt({alt:"media",token:Y})})[0]}(b,p,i.host,i._protocol)}}(i,u),k);return K.errorHandler=m(r),K}(i.storage,i._location,Je());return i.storage.makeRequestWithTokens(r,pt).then(u=>{if(null===u)throw function O(){return new te(Q.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}();return u})}function Kn(i,r){const u=function Bt(i,r){const u=r.split("/").filter(l=>l.length>0).join("/");return 0===i.length?u:i+"/"+u}(i._location.path,r),l=new ne(i._location.bucket,u);return new Vt(i.storage,l)}function Hn(i,r){if(i instanceof In){const u=i;if(null==u._bucket)throw function P(){return new te(Q.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+oe+"' property when initializing the app?")}();const l=new Vt(u,u._bucket);return null!=r?Hn(l,r):l}return void 0!==r?Kn(i,r):i}function Er(i,r){if(r&&function pn(i){return/^[A-Za-z]+:\/\//.test(i)}(r)){if(i instanceof In)return function Cr(i,r){return new Vt(i,r)}(i,r);throw w("To use ref(service, url), the first argument must be a Storage instance.")}return Hn(i,r)}function Yn(i,r){const u=r?.[oe];return null==u?null:ne.makeFromBucketSpec(u,i)}class In{constructor(r,u,l,p,b){this.app=r,this._authProvider=u,this._appCheckProvider=l,this._url=p,this._firebaseVersion=b,this._bucket=null,this._host=Ze,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=12e4,this._maxUploadRetryTime=6e5,this._requests=new Set,this._bucket=null!=p?ne.makeFromBucketSpec(p,this._host):Yn(this._host,this.app.options)}get host(){return this._host}set host(r){this._host=r,this._bucket=null!=this._url?ne.makeFromBucketSpec(this._url,r):Yn(r,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(r){st("time",0,Number.POSITIVE_INFINITY,r),this._maxUploadRetryTime=r}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(r){st("time",0,Number.POSITIVE_INFINITY,r),this._maxOperationRetryTime=r}_getAuthToken(){var r=this;return(0,xe.A)(function*(){if(r._overrideAuthToken)return r._overrideAuthToken;const u=r._authProvider.getImmediate({optional:!0});if(u){const l=yield u.getToken();if(null!==l)return l.accessToken}return null})()}_getAppCheckToken(){var r=this;return(0,xe.A)(function*(){const u=r._appCheckProvider.getImmediate({optional:!0});return u?(yield u.getToken()).token:null})()}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(r=>r.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(r){return new Vt(this,r)}_makeRequest(r,u,l,p,b=!0){if(this._deleted)return new y(S());{const k=function Ft(i,r,u,l,p,b,k=!0){const K=tt(i.urlParams),j=i.url+K,Y=Object.assign({},i.headers);return function Rt(i,r){r&&(i["X-Firebase-GMPID"]=r)}(Y,r),function wt(i,r){null!==r&&r.length>0&&(i.Authorization="Firebase "+r)}(Y,u),function Mt(i,r){i["X-Firebase-Storage-Version"]="webjs/"+(r??"AppManager")}(Y,b),function Xt(i,r){null!==r&&(i["X-Firebase-AppCheck"]=r)}(Y,l),new It(j,i.method,Y,i.body,i.successCodes,i.additionalRetryCodes,i.handler,i.errorHandler,i.timeout,i.progressCallback,p,k)}(r,this._appId,l,p,u,this._firebaseVersion,b);return this._requests.add(k),k.getPromise().then(()=>this._requests.delete(k),()=>this._requests.delete(k)),k}}makeRequestWithTokens(r,u){var l=this;return(0,xe.A)(function*(){const[p,b]=yield Promise.all([l._getAuthToken(),l._getAppCheckToken()]);return l._makeRequest(r,u,p,b).getPromise()})()}}const wn="@firebase/storage";function gn(i,r){return Er(i=(0,Ae.Ku)(i),r)}function mn(i,{instanceIdentifier:r}){const u=i.getProvider("app").getImmediate(),l=i.getProvider("auth-internal"),p=i.getProvider("app-check-internal");return new In(u,l,p,r,De.SDK_VERSION)}!function _n(){(0,De._registerComponent)(new We.uA("storage",mn,"PUBLIC").setMultipleInstances(!0)),(0,De.registerVersion)(wn,"0.13.2",""),(0,De.registerVersion)(wn,"0.13.2","esm2017")}();class en{constructor(r,u,l){this._delegate=r,this.task=u,this.ref=l}get bytesTransferred(){return this._delegate.bytesTransferred}get metadata(){return this._delegate.metadata}get state(){return this._delegate.state}get totalBytes(){return this._delegate.totalBytes}}class On{constructor(r,u){this._delegate=r,this._ref=u,this.cancel=this._delegate.cancel.bind(this._delegate),this.catch=this._delegate.catch.bind(this._delegate),this.pause=this._delegate.pause.bind(this._delegate),this.resume=this._delegate.resume.bind(this._delegate)}get snapshot(){return new en(this._delegate.snapshot,this,this._ref)}then(r,u){return this._delegate.then(l=>{if(r)return r(new en(l,this,this._ref))},u)}on(r,u,l,p){let b;return u&&(b="function"==typeof u?k=>u(new en(k,this,this._ref)):{next:u.next?k=>u.next(new en(k,this,this._ref)):void 0,complete:u.complete||void 0,error:u.error||void 0}),this._delegate.on(r,b,l||void 0,p||void 0)}}class an{constructor(r,u){this._delegate=r,this._service=u}get prefixes(){return this._delegate.prefixes.map(r=>new bt(r,this._service))}get items(){return this._delegate.items.map(r=>new bt(r,this._service))}get nextPageToken(){return this._delegate.nextPageToken||null}}class bt{constructor(r,u){this._delegate=r,this.storage=u}get name(){return this._delegate.name}get bucket(){return this._delegate.bucket}get fullPath(){return this._delegate.fullPath}toString(){return this._delegate.toString()}child(r){const u=function Zn(i,r){return Kn(i,r)}(this._delegate,r);return new bt(u,this.storage)}get root(){return new bt(this._delegate.root,this.storage)}get parent(){const r=this._delegate.parent;return null==r?null:new bt(r,this.storage)}put(r,u){return this._throwIfRoot("put"),new On(function Xn(i,r,u){return function _r(i,r,u){return i._throwIfRoot("uploadBytesResumable"),new Ln(i,new Me(r),u)}(i=(0,Ae.Ku)(i),r,u)}(this._delegate,r,u),this)}putString(r,u=Fe.RAW,l){this._throwIfRoot("putString");const p=ze(u,r),b=Object.assign({},l);return null==b.contentType&&null!=p.contentType&&(b.contentType=p.contentType),new On(new Ln(this._delegate,new Me(p.data,!0),b),this)}listAll(){return function qn(i){return function yr(i){const r={prefixes:[],items:[]};return $n(i,r).then(()=>r)}(i=(0,Ae.Ku)(i))}(this._delegate).then(r=>new an(r,this.storage))}list(r){return function Jn(i,r){return Gn(i=(0,Ae.Ku)(i),r)}(this._delegate,r||void 0).then(u=>new an(u,this.storage))}getMetadata(){return function kr(i){return function Vn(i){i._throwIfRoot("getMetadata");const r=I(i.storage,i._location,Je());return i.storage.makeRequestWithTokens(r,pt)}(i=(0,Ae.Ku)(i))}(this._delegate)}updateMetadata(r){return function zn(i,r){return function br(i,r){i._throwIfRoot("updateMetadata");const u=function z(i,r,u,l){const b=Ue(r.fullServerUrl(),i.host,i._protocol),K=kt(u,l),Y=i.maxOperationRetryTime,ie=new f(b,"PATCH",x(i,l),Y);return ie.headers={"Content-Type":"application/json; charset=utf-8"},ie.body=K,ie.errorHandler=m(r),ie}(i.storage,i._location,r,Je());return i.storage.makeRequestWithTokens(u,pt)}(i=(0,Ae.Ku)(i),r)}(this._delegate,r)}getDownloadURL(){return function Zt(i){return Wn(i=(0,Ae.Ku)(i))}(this._delegate)}delete(){return this._throwIfRoot("delete"),function Qn(i){return function fn(i){i._throwIfRoot("deleteObject");const r=function $e(i,r){const l=Ue(r.fullServerUrl(),i.host,i._protocol),K=new f(l,"DELETE",function k(j,Y){},i.maxOperationRetryTime);return K.successCodes=[200,204],K.errorHandler=m(r),K}(i.storage,i._location);return i.storage.makeRequestWithTokens(r,pt)}(i=(0,Ae.Ku)(i))}(this._delegate)}_throwIfRoot(r){if(""===this._delegate._location.path)throw re(r)}}class Ve{constructor(r,u){this.app=r,this._delegate=u}get maxOperationRetryTime(){return this._delegate.maxOperationRetryTime}get maxUploadRetryTime(){return this._delegate.maxUploadRetryTime}ref(r){if(Wt(r))throw w("ref() expected a child path but got a URL, use refFromURL instead.");return new bt(gn(this._delegate,r),this)}refFromURL(r){if(!Wt(r))throw w("refFromURL() expected a full URL but got a child path, use ref() instead.");try{ne.makeFromUrl(r,this._delegate.host)}catch{throw w("refFromUrl() expected a valid full URL but got an invalid one.")}return new bt(gn(this._delegate,r),this)}setMaxUploadRetryTime(r){this._delegate.maxUploadRetryTime=r}setMaxOperationRetryTime(r){this._delegate.maxOperationRetryTime=r}useEmulator(r,u,l={}){!function Sn(i,r,u,l={}){!function Ar(i,r,u,l={}){i.host=`${r}:${u}`,i._protocol="http";const{mockUserToken:p}=l;p&&(i._overrideAuthToken="string"==typeof p?p:(0,Ae.Fy)(p,i.app.options.projectId))}(i,r,u,l)}(this._delegate,r,u,l)}}function Wt(i){return/^[A-Za-z]+:\/\//.test(i)}function yn(i,{instanceIdentifier:r}){const u=i.getProvider("app-compat").getImmediate(),l=i.getProvider("storage").getImmediate({identifier:r});return new Ve(u,l)}!function nr(i){const r={TaskState:Ee,TaskEvent:Nn,StringFormat:Fe,Storage:Ve,Reference:bt};i.INTERNAL.registerComponent(new We.uA("storage-compat",yn,"PUBLIC").setServiceProps(r).setMultipleInstances(!0)),i.registerVersion("@firebase/storage-compat","0.3.12")}(rt.A);var Pn=_(762);function Ct(i){const r=function rr(i){return new c.c(r=>{const u=k=>r.next(k);u(i.snapshot);const b=i.on("state_changed",u);return i.then(k=>{u(k),r.complete()},k=>{u(i.snapshot),(k=>{r.error(k)})(k)}),function(){b()}}).pipe((0,le.B)(0))}(i);return{task:i,then:i.then.bind(i),catch:i.catch.bind(i),pause:i.pause.bind(i),cancel:i.cancel.bind(i),resume:i.resume.bind(i),snapshotChanges:()=>r,percentageChanges:()=>r.pipe((0,be.T)(u=>u.bytesTransferred/u.totalBytes*100))}}function tn(i){return{getDownloadURL:()=>(0,J.of)(void 0).pipe(B.Oe,(0,ve.n)(()=>i.getDownloadURL()),B.U0),getMetadata:()=>(0,J.of)(void 0).pipe(B.Oe,(0,ve.n)(()=>i.getMetadata()),B.U0),delete:()=>(0,_e.H)(i.delete()),child:r=>tn(i.child(r)),updateMetadata:r=>(0,_e.H)(i.updateMetadata(r)),put:(r,u)=>Ct(i.put(r,u)),putString:(r,u,l)=>Ct(i.putString(r,u,l)),list:r=>(0,_e.H)(i.list(r)),listAll:()=>(0,_e.H)(i.listAll())}}const ir=new R.nKC("angularfire2.storageBucket"),or=new R.nKC("angularfire2.storage.maxUploadRetryTime"),sr=new R.nKC("angularfire2.storage.maxOperationRetryTime"),xn=new R.nKC("angularfire2.storage.use-emulator");let Ge=(()=>{class i{storage;constructor(u,l,p,b,k,K,j,Y,ie,Te){const ye=(0,e.iB)(u,k,l);this.storage=(0,e.BM)(`${ye.name}.storage.${p}`,"AngularFireStorage",ye.name,()=>{const ue=k.runOutsideAngular(()=>ye.storage(p||void 0)),ke=ie;return ke&&ue.useEmulator(...ke),j&&ue.setMaxUploadRetryTime(j),Y&&ue.setMaxOperationRetryTime(Y),ue},[j,Y])}ref(u){return tn(this.storage.ref(u))}refFromURL(u){return tn(this.storage.refFromURL(u))}upload(u,l,p){return tn(this.storage.ref(u)).put(l,p)}static \u0275fac=function(l){return new(l||i)(R.KVO(e.rx),R.KVO(e.uP,8),R.KVO(ir,8),R.KVO(R.Agw),R.KVO(R.SKi),R.KVO(B.u0),R.KVO(or,8),R.KVO(sr,8),R.KVO(xn,8),R.KVO(B.Jv,8))};static \u0275prov=R.jDH({token:i,factory:i.\u0275fac,providedIn:"any"})}return i})(),bn=(()=>{class i{static \u0275fac=function(l){return new(l||i)};static \u0275mod=R.$C({type:i});static \u0275inj=R.G2t({})}return i})(),ar=(()=>{class i{constructor(){Pn.A.registerVersion("angularfire",B.xv.full,"gcs-compat")}static \u0275fac=function(l){return new(l||i)};static \u0275mod=R.$C({type:i});static \u0275inj=R.G2t({providers:[Ge],imports:[bn]})}return i})()},5557:(Yt,je,_)=>{var B=_(467),c=_(1631),J=_(8779),_e=_(1076),le=_(6749);const be="@firebase/installations",ve="0.6.9",R=1e4,e=`w:${ve}`,rt="FIS_v2",xe="https://firebaseinstallations.googleapis.com/v1",De=36e5,oe=new _e.FA("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function pe(d){return d instanceof _e.g&&d.code.includes("request-failed")}function me({projectId:d}){return`${xe}/projects/${d}/installations`}function Be(d){return{token:d.token,requestStatus:2,expiresIn:He(d.expiresIn),creationTime:Date.now()}}function te(d,m){return Q.apply(this,arguments)}function Q(){return(Q=(0,B.A)(function*(d,m){const V=(yield m.json()).error;return oe.create("request-failed",{requestName:d,serverCode:V.code,serverMessage:V.message,serverStatus:V.status})})).apply(this,arguments)}function Ke({apiKey:d}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":d})}function et(d){return Ce.apply(this,arguments)}function Ce(){return(Ce=(0,B.A)(function*(d){const m=yield d();return m.status>=500&&m.status<600?d():m})).apply(this,arguments)}function He(d){return Number(d.replace("s","000"))}function E(){return(E=(0,B.A)(function*({appConfig:d,heartbeatServiceProvider:m},{fid:I}){const V=me(d),ge=Ke(d),ae=m.getImmediate({optional:!0});if(ae){const qe=yield ae.getHeartbeatsHeader();qe&&ge.append("x-firebase-client",qe)}const $e={method:"POST",headers:ge,body:JSON.stringify({fid:I,authVersion:rt,appId:d.appId,sdkVersion:e})},ft=yield et(()=>fetch(V,$e));if(ft.ok){const qe=yield ft.json();return{fid:qe.fid||I,registrationStatus:2,refreshToken:qe.refreshToken,authToken:Be(qe.authToken)}}throw yield te("Create Installation",ft)})).apply(this,arguments)}function T(d){return new Promise(m=>{setTimeout(m,d)})}const F=/^[cdef][\w-]{21}$/,P="";function C(){try{const d=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(d),d[0]=112+d[0]%16;const I=function U(d){return function A(d){return btoa(String.fromCharCode(...d)).replace(/\+/g,"-").replace(/\//g,"_")}(d).substr(0,22)}(d);return F.test(I)?I:P}catch{return P}}function O(d){return`${d.appName}!${d.appId}`}const N=new Map;function w(d,m){const I=O(d);Z(I,m),function Ie(d,m){const I=function y(){return!ne&&"BroadcastChannel"in self&&(ne=new BroadcastChannel("[Firebase] FID Change"),ne.onmessage=d=>{Z(d.data.key,d.data.fid)}),ne}();I&&I.postMessage({key:d,fid:m}),function M(){0===N.size&&ne&&(ne.close(),ne=null)}()}(I,m)}function Z(d,m){const I=N.get(d);if(I)for(const V of I)V(m)}let ne=null;const he="firebase-installations-database",D=1,H="firebase-installations-store";let $=null;function fe(){return $||($=(0,le.P2)(he,D,{upgrade:(d,m)=>{0===m&&d.createObjectStore(H)}})),$}function it(d,m){return ot.apply(this,arguments)}function ot(){return(ot=(0,B.A)(function*(d,m){const I=O(d),ge=(yield fe()).transaction(H,"readwrite"),ae=ge.objectStore(H),z=yield ae.get(I);return yield ae.put(m,I),yield ge.done,(!z||z.fid!==m.fid)&&w(d,m.fid),m})).apply(this,arguments)}function st(d){return Ue.apply(this,arguments)}function Ue(){return(Ue=(0,B.A)(function*(d){const m=O(d),V=(yield fe()).transaction(H,"readwrite");yield V.objectStore(H).delete(m),yield V.done})).apply(this,arguments)}function tt(d,m){return Xe.apply(this,arguments)}function Xe(){return(Xe=(0,B.A)(function*(d,m){const I=O(d),ge=(yield fe()).transaction(H,"readwrite"),ae=ge.objectStore(H),z=yield ae.get(I),$e=m(z);return void 0===$e?yield ae.delete(I):yield ae.put($e,I),yield ge.done,$e&&(!z||z.fid!==$e.fid)&&w(d,$e.fid),$e})).apply(this,arguments)}function nt(d){return It.apply(this,arguments)}function It(){return It=(0,B.A)(function*(d){let m;const I=yield tt(d.appConfig,V=>{const ge=function ct(d){return St(d||{fid:C(),registrationStatus:0})}(V),ae=function wt(d,m){if(0===m.registrationStatus){if(!navigator.onLine)return{installationEntry:m,registrationPromise:Promise.reject(oe.create("app-offline"))};const I={fid:m.fid,registrationStatus:1,registrationTime:Date.now()},V=function Mt(d,m){return Rt.apply(this,arguments)}(d,I);return{installationEntry:I,registrationPromise:V}}return 1===m.registrationStatus?{installationEntry:m,registrationPromise:Xt(d)}:{installationEntry:m}}(d,ge);return m=ae.registrationPromise,ae.installationEntry});return I.fid===P?{installationEntry:yield m}:{installationEntry:I,registrationPromise:m}}),It.apply(this,arguments)}function Rt(){return Rt=(0,B.A)(function*(d,m){try{const I=yield function Ye(d,m){return E.apply(this,arguments)}(d,m);return it(d.appConfig,I)}catch(I){throw pe(I)&&409===I.customData.serverCode?yield st(d.appConfig):yield it(d.appConfig,{fid:m.fid,registrationStatus:0}),I}}),Rt.apply(this,arguments)}function Xt(d){return Ft.apply(this,arguments)}function Ft(){return(Ft=(0,B.A)(function*(d){let m=yield Lt(d.appConfig);for(;1===m.registrationStatus;)yield T(100),m=yield Lt(d.appConfig);if(0===m.registrationStatus){const{installationEntry:I,registrationPromise:V}=yield nt(d);return V||I}return m})).apply(this,arguments)}function Lt(d){return tt(d,m=>{if(!m)throw oe.create("installation-not-found");return St(m)})}function St(d){return function Ot(d){return 1===d.registrationStatus&&d.registrationTime+R<Date.now()}(d)?{fid:d.fid,registrationStatus:0}:d}function Fe(){return(Fe=(0,B.A)(function*({appConfig:d,heartbeatServiceProvider:m},I){const V=function lt(d,{fid:m}){return`${me(d)}/${m}/authTokens:generate`}(d,I),ge=function Ne(d,{refreshToken:m}){const I=Ke(d);return I.append("Authorization",function de(d){return`${rt} ${d}`}(m)),I}(d,I),ae=m.getImmediate({optional:!0});if(ae){const qe=yield ae.getHeartbeatsHeader();qe&&ge.append("x-firebase-client",qe)}const $e={method:"POST",headers:ge,body:JSON.stringify({installation:{sdkVersion:e,appId:d.appId}})},ft=yield et(()=>fetch(V,$e));if(ft.ok)return Be(yield ft.json());throw yield te("Generate Auth Token",ft)})).apply(this,arguments)}function ze(d){return Et.apply(this,arguments)}function Et(){return Et=(0,B.A)(function*(d,m=!1){let I;const V=yield tt(d.appConfig,ae=>{if(!xt(ae))throw oe.create("not-registered");const z=ae.authToken;if(!m&&function Me(d){return 2===d.requestStatus&&!function _t(d){const m=Date.now();return m<d.creationTime||d.creationTime+d.expiresIn<m+De}(d)}(z))return ae;if(1===z.requestStatus)return I=function Pt(d,m){return at.apply(this,arguments)}(d,m),ae;{if(!navigator.onLine)throw oe.create("app-offline");const $e=function zt(d){const m={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},d),{authToken:m})}(ae);return I=function jt(d,m){return mt.apply(this,arguments)}(d,$e),$e}});return I?yield I:V.authToken}),Et.apply(this,arguments)}function at(){return(at=(0,B.A)(function*(d,m){let I=yield gt(d.appConfig);for(;1===I.authToken.requestStatus;)yield T(100),I=yield gt(d.appConfig);const V=I.authToken;return 0===V.requestStatus?ze(d,m):V})).apply(this,arguments)}function gt(d){return tt(d,m=>{if(!xt(m))throw oe.create("not-registered");return function Bt(d){return 1===d.requestStatus&&d.requestTime+R<Date.now()}(m.authToken)?Object.assign(Object.assign({},m),{authToken:{requestStatus:0}}):m})}function mt(){return mt=(0,B.A)(function*(d,m){try{const I=yield function Dt(d,m){return Fe.apply(this,arguments)}(d,m),V=Object.assign(Object.assign({},m),{authToken:I});return yield it(d.appConfig,V),I}catch(I){if(!pe(I)||401!==I.customData.serverCode&&404!==I.customData.serverCode){const V=Object.assign(Object.assign({},m),{authToken:{requestStatus:0}});yield it(d.appConfig,V)}else yield st(d.appConfig);throw I}}),mt.apply(this,arguments)}function xt(d){return void 0!==d&&2===d.registrationStatus}function Tt(){return(Tt=(0,B.A)(function*(d){const m=d,{installationEntry:I,registrationPromise:V}=yield nt(m);return V?V.catch(console.error):ze(m).catch(console.error),I.fid})).apply(this,arguments)}function dt(){return dt=(0,B.A)(function*(d,m=!1){const I=d;return yield function Jt(d){return Je.apply(this,arguments)}(I),(yield ze(I,m)).token}),dt.apply(this,arguments)}function Je(){return(Je=(0,B.A)(function*(d){const{registrationPromise:m}=yield nt(d);m&&(yield m)})).apply(this,arguments)}function ht(d){return oe.create("missing-app-config-values",{valueName:d})}const f="installations",x=d=>{const m=d.getProvider("app").getImmediate(),I=function Qt(d){if(!d||!d.options)throw ht("App Configuration");if(!d.name)throw ht("App Name");const m=["projectId","apiKey","appId"];for(const I of m)if(!d.options[I])throw ht(I);return{appName:d.name,projectId:d.options.projectId,apiKey:d.options.apiKey,appId:d.options.appId}}(m);return{app:m,appConfig:I,heartbeatServiceProvider:(0,c._getProvider)(m,"heartbeat"),_delete:()=>Promise.resolve()}},L=d=>{const m=d.getProvider("app").getImmediate(),I=(0,c._getProvider)(m,f).getImmediate();return{getId:()=>function At(d){return Tt.apply(this,arguments)}(I),getToken:ge=>function we(d){return dt.apply(this,arguments)}(I,ge)}};(function X(){(0,c._registerComponent)(new J.uA(f,x,"PUBLIC")),(0,c._registerComponent)(new J.uA("installations-internal",L,"PRIVATE"))})(),(0,c.registerVersion)(be,ve),(0,c.registerVersion)(be,ve,"esm2017")},490:(Yt,je,_)=>{_.d(je,{TT:()=>Je,gf:()=>qt,ni:()=>Qt,xD:()=>ht});var B=_(467),J=(_(5557),_(8779)),_e=_(6749),le=_(1076),be=_(1631);const ve="/firebase-messaging-sw.js",R="/firebase-cloud-messaging-push-scope",e="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",rt="https://fcmregistrations.googleapis.com/v1",xe="google.c.a.c_id",De="google.c.a.c_l",Ae="google.c.a.ts";var oe=function(f){return f.PUSH_RECEIVED="push-received",f.NOTIFICATION_CLICKED="notification-clicked",f}(oe||{});function pe(f){const v=new Uint8Array(f);return btoa(String.fromCharCode(...v)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function me(f){const x=(f+"=".repeat((4-f.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),L=atob(x),X=new Uint8Array(L.length);for(let d=0;d<L.length;++d)X[d]=L.charCodeAt(d);return X}const Be="fcm_token_details_db",te=5,Q="fcm_token_object_Store";function Ne(){return Ne=(0,B.A)(function*(f){if("databases"in indexedDB&&!(yield indexedDB.databases()).map(d=>d.name).includes(Be))return null;let v=null;return(yield(0,_e.P2)(Be,te,{upgrade:(L=(0,B.A)(function*(X,d,m,I){var V;if(d<2||!X.objectStoreNames.contains(Q))return;const ge=I.objectStore(Q),ae=yield ge.index("fcmSenderId").get(f);if(yield ge.clear(),ae)if(2===d){const z=ae;if(!z.auth||!z.p256dh||!z.endpoint)return;v={token:z.fcmToken,createTime:null!==(V=z.createTime)&&void 0!==V?V:Date.now(),subscriptionOptions:{auth:z.auth,p256dh:z.p256dh,endpoint:z.endpoint,swScope:z.swScope,vapidKey:"string"==typeof z.vapidKey?z.vapidKey:pe(z.vapidKey)}}}else if(3===d){const z=ae;v={token:z.fcmToken,createTime:z.createTime,subscriptionOptions:{auth:pe(z.auth),p256dh:pe(z.p256dh),endpoint:z.endpoint,swScope:z.swScope,vapidKey:pe(z.vapidKey)}}}else if(4===d){const z=ae;v={token:z.fcmToken,createTime:z.createTime,subscriptionOptions:{auth:pe(z.auth),p256dh:pe(z.p256dh),endpoint:z.endpoint,swScope:z.swScope,vapidKey:pe(z.vapidKey)}}}}),function(d,m,I,V){return L.apply(this,arguments)})})).close(),yield(0,_e.MR)(Be),yield(0,_e.MR)("fcm_vapid_details_db"),yield(0,_e.MR)("undefined"),function et(f){if(!f||!f.subscriptionOptions)return!1;const{subscriptionOptions:v}=f;return"number"==typeof f.createTime&&f.createTime>0&&"string"==typeof f.token&&f.token.length>0&&"string"==typeof v.auth&&v.auth.length>0&&"string"==typeof v.p256dh&&v.p256dh.length>0&&"string"==typeof v.endpoint&&v.endpoint.length>0&&"string"==typeof v.swScope&&v.swScope.length>0&&"string"==typeof v.vapidKey&&v.vapidKey.length>0}(v)?v:null;var L}),Ne.apply(this,arguments)}const Ce="firebase-messaging-database",He=1,de="firebase-messaging-store";let Ye=null;function E(){return Ye||(Ye=(0,_e.P2)(Ce,He,{upgrade:(f,v)=>{0===v&&f.createObjectStore(de)}})),Ye}function T(f){return A.apply(this,arguments)}function A(){return A=(0,B.A)(function*(f){const v=O(f),L=yield(yield E()).transaction(de).objectStore(de).get(v);if(L)return L;{const X=yield function Ke(f){return Ne.apply(this,arguments)}(f.appConfig.senderId);if(X)return yield F(f,X),X}}),A.apply(this,arguments)}function F(f,v){return P.apply(this,arguments)}function P(){return(P=(0,B.A)(function*(f,v){const x=O(f),X=(yield E()).transaction(de,"readwrite");return yield X.objectStore(de).put(v,x),yield X.done,v})).apply(this,arguments)}function U(){return(U=(0,B.A)(function*(f){const v=O(f),L=(yield E()).transaction(de,"readwrite");yield L.objectStore(de).delete(v),yield L.done})).apply(this,arguments)}function O({appConfig:f}){return f.appId}const w=new le.FA("messaging","Messaging",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."});function S(f,v){return re.apply(this,arguments)}function re(){return(re=(0,B.A)(function*(f,v){const x=yield he(f),L=H(v),X={method:"POST",headers:x,body:JSON.stringify(L)};let d;try{d=yield(yield fetch(M(f.appConfig),X)).json()}catch(m){throw w.create("token-subscribe-failed",{errorInfo:m?.toString()})}if(d.error)throw w.create("token-subscribe-failed",{errorInfo:d.error.message});if(!d.token)throw w.create("token-subscribe-no-token");return d.token})).apply(this,arguments)}function Ie(){return(Ie=(0,B.A)(function*(f,v){const x=yield he(f),L=H(v.subscriptionOptions),X={method:"PATCH",headers:x,body:JSON.stringify(L)};let d;try{d=yield(yield fetch(`${M(f.appConfig)}/${v.token}`,X)).json()}catch(m){throw w.create("token-update-failed",{errorInfo:m?.toString()})}if(d.error)throw w.create("token-update-failed",{errorInfo:d.error.message});if(!d.token)throw w.create("token-update-no-token");return d.token})).apply(this,arguments)}function ne(f,v){return y.apply(this,arguments)}function y(){return(y=(0,B.A)(function*(f,v){const L={method:"DELETE",headers:yield he(f)};try{const d=yield(yield fetch(`${M(f.appConfig)}/${v}`,L)).json();if(d.error)throw w.create("token-unsubscribe-failed",{errorInfo:d.error.message})}catch(X){throw w.create("token-unsubscribe-failed",{errorInfo:X?.toString()})}})).apply(this,arguments)}function M({projectId:f}){return`${rt}/projects/${f}/registrations`}function he(f){return D.apply(this,arguments)}function D(){return(D=(0,B.A)(function*({appConfig:f,installations:v}){const x=yield v.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":f.apiKey,"x-goog-firebase-installations-auth":`FIS ${x}`})})).apply(this,arguments)}function H({p256dh:f,auth:v,endpoint:x,vapidKey:L}){const X={web:{endpoint:x,auth:v,p256dh:f}};return L!==e&&(X.web.applicationPubKey=L),X}const $=6048e5;function it(){return it=(0,B.A)(function*(f){const v=yield function It(f,v){return ct.apply(this,arguments)}(f.swRegistration,f.vapidKey),x={vapidKey:f.vapidKey,swScope:f.swRegistration.scope,endpoint:v.endpoint,auth:pe(v.getKey("auth")),p256dh:pe(v.getKey("p256dh"))},L=yield T(f.firebaseDependencies);if(L){if(function wt(f,v){return v.vapidKey===f.vapidKey&&v.endpoint===f.endpoint&&v.auth===f.auth&&v.p256dh===f.p256dh}(L.subscriptionOptions,x))return Date.now()>=L.createTime+$?function Ue(f,v){return tt.apply(this,arguments)}(f,{token:L.token,createTime:Date.now(),subscriptionOptions:x}):L.token;try{yield ne(f.firebaseDependencies,L.token)}catch(X){console.warn(X)}return Xe(f.firebaseDependencies,x)}return Xe(f.firebaseDependencies,x)}),it.apply(this,arguments)}function st(){return st=(0,B.A)(function*(f){const v=yield T(f.firebaseDependencies);v&&(yield ne(f.firebaseDependencies,v.token),yield function C(f){return U.apply(this,arguments)}(f.firebaseDependencies));const x=yield f.swRegistration.pushManager.getSubscription();return!x||x.unsubscribe()}),st.apply(this,arguments)}function tt(){return tt=(0,B.A)(function*(f,v){try{const x=yield function Z(f,v){return Ie.apply(this,arguments)}(f.firebaseDependencies,v),L=Object.assign(Object.assign({},v),{token:x,createTime:Date.now()});return yield F(f.firebaseDependencies,L),x}catch(x){throw x}}),tt.apply(this,arguments)}function Xe(f,v){return nt.apply(this,arguments)}function nt(){return(nt=(0,B.A)(function*(f,v){const L={token:yield S(f,v),createTime:Date.now(),subscriptionOptions:v};return yield F(f,L),L.token})).apply(this,arguments)}function ct(){return(ct=(0,B.A)(function*(f,v){return(yield f.pushManager.getSubscription())||f.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:me(v)})})).apply(this,arguments)}function Mt(f){const v={from:f.from,collapseKey:f.collapse_key,messageId:f.fcmMessageId};return function Rt(f,v){if(!v.notification)return;f.notification={};const x=v.notification.title;x&&(f.notification.title=x);const L=v.notification.body;L&&(f.notification.body=L);const X=v.notification.image;X&&(f.notification.image=X);const d=v.notification.icon;d&&(f.notification.icon=d)}(v,f),function Xt(f,v){v.data&&(f.data=v.data)}(v,f),function Ft(f,v){var x,L,X,d,m;if(!(v.fcmOptions||null!==(x=v.notification)&&void 0!==x&&x.click_action))return;f.fcmOptions={};const I=null!==(X=null===(L=v.fcmOptions)||void 0===L?void 0:L.link)&&void 0!==X?X:null===(d=v.notification)||void 0===d?void 0:d.click_action;I&&(f.fcmOptions.link=I);const V=null===(m=v.fcmOptions)||void 0===m?void 0:m.analytics_label;V&&(f.fcmOptions.analyticsLabel=V)}(v,f),v}function Dt(f){return w.create("missing-app-config-values",{valueName:f})}!function St(f,v){const x=[];for(let L=0;L<f.length;L++)x.push(f.charAt(L)),L<v.length&&x.push(v.charAt(L));x.join("")}("AzSCbw63g1R0nCw85jG8","Iaya3yLKwmgvh7cF0q4");class Fe{constructor(v,x,L){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const X=function Ot(f){if(!f||!f.options)throw Dt("App Configuration Object");if(!f.name)throw Dt("App Name");const v=["projectId","apiKey","appId","messagingSenderId"],{options:x}=f;for(const L of v)if(!x[L])throw Dt(L);return{appName:f.name,projectId:x.projectId,apiKey:x.apiKey,appId:x.appId,senderId:x.messagingSenderId}}(v);this.firebaseDependencies={app:v,appConfig:X,installations:x,analyticsProvider:L}}_delete(){return Promise.resolve()}}function lt(f){return ze.apply(this,arguments)}function ze(){return(ze=(0,B.A)(function*(f){try{f.swRegistration=yield navigator.serviceWorker.register(ve,{scope:R}),f.swRegistration.update().catch(()=>{})}catch(v){throw w.create("failed-service-worker-registration",{browserErrorMessage:v?.message})}})).apply(this,arguments)}function Pt(){return(Pt=(0,B.A)(function*(f,v){if(!v&&!f.swRegistration&&(yield lt(f)),v||!f.swRegistration){if(!(v instanceof ServiceWorkerRegistration))throw w.create("invalid-sw-registration");f.swRegistration=v}})).apply(this,arguments)}function gt(){return(gt=(0,B.A)(function*(f,v){v?f.vapidKey=v:f.vapidKey||(f.vapidKey=e)})).apply(this,arguments)}function jt(f,v){return mt.apply(this,arguments)}function mt(){return mt=(0,B.A)(function*(f,v){if(!navigator)throw w.create("only-available-in-window");if("default"===Notification.permission&&(yield Notification.requestPermission()),"granted"!==Notification.permission)throw w.create("permission-blocked");return yield function at(f,v){return gt.apply(this,arguments)}(f,v?.vapidKey),yield function Et(f,v){return Pt.apply(this,arguments)}(f,v?.serviceWorkerRegistration),function fe(f){return it.apply(this,arguments)}(f)}),mt.apply(this,arguments)}function Me(){return(Me=(0,B.A)(function*(f,v,x){const L=function _t(f){switch(f){case oe.NOTIFICATION_CLICKED:return"notification_open";case oe.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}(v);(yield f.firebaseDependencies.analyticsProvider.get()).logEvent(L,{message_id:x[xe],message_name:x[De],message_time:x[Ae],message_device_time:Math.floor(Date.now()/1e3)})})).apply(this,arguments)}function Bt(){return Bt=(0,B.A)(function*(f,v){const x=v.data;if(!x.isFirebaseMessaging)return;f.onMessageHandler&&x.messageType===oe.PUSH_RECEIVED&&("function"==typeof f.onMessageHandler?f.onMessageHandler(Mt(x)):f.onMessageHandler.next(Mt(x)));const L=x.data;(function Lt(f){return"object"==typeof f&&!!f&&xe in f})(L)&&"1"===L["google.c.a.e"]&&(yield function xt(f,v,x){return Me.apply(this,arguments)}(f,x.messageType,L))}),Bt.apply(this,arguments)}const At="@firebase/messaging",Tt="0.12.12",we=f=>{const v=new Fe(f.getProvider("app").getImmediate(),f.getProvider("installations-internal").getImmediate(),f.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",x=>function zt(f,v){return Bt.apply(this,arguments)}(v,x)),v},dt=f=>{const v=f.getProvider("messaging").getImmediate();return{getToken:L=>jt(v,L)}};function Je(){return vt.apply(this,arguments)}function vt(){return(vt=(0,B.A)(function*(){try{yield(0,le.eX)()}catch{return!1}return typeof window<"u"&&(0,le.zW)()&&(0,le.dM)()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")})).apply(this,arguments)}function yt(){return yt=(0,B.A)(function*(f){if(!navigator)throw w.create("only-available-in-window");return f.swRegistration||(yield lt(f)),function ot(f){return st.apply(this,arguments)}(f)}),yt.apply(this,arguments)}function qt(f,v){return Ut.apply(this,arguments)}function Ut(){return(Ut=(0,B.A)(function*(f,v){return jt(f=(0,le.Ku)(f),v)})).apply(this,arguments)}function Qt(f){return function $t(f){return yt.apply(this,arguments)}(f=(0,le.Ku)(f))}function ht(f,v){return function rn(f,v){if(!navigator)throw w.create("only-available-in-window");return f.onMessageHandler=v,()=>{f.onMessageHandler=null}}(f=(0,le.Ku)(f),v)}!function Jt(){(0,be._registerComponent)(new J.uA("messaging",we,"PUBLIC")),(0,be._registerComponent)(new J.uA("messaging-internal",dt,"PRIVATE")),(0,be.registerVersion)(At,Tt),(0,be.registerVersion)(At,Tt,"esm2017")}()}}]);