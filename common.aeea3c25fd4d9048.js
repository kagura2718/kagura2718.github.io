"use strict";(self.webpackChunkKaguraGithubPages=self.webpackChunkKaguraGithubPages||[]).push([[76],{4906:(D,O,n)=>{n.d(O,{C:()=>t});var i=n(4438);let t=(()=>{class _{transform(e){if(null===e)return null;const p=Math.floor(Date.now()/1e3),m=Math.floor(p-e.getTime()/1e3);if(m<-10)return null;if(m<60)return"\u305f\u3063\u305f\u4eca";const s=Math.floor(m/60);if(s<60)return`${s} \u5206\u524d`;const C=Math.floor(s/60);if(C<24)return`${C} \u6642\u9593\u524d`;const u=Math.floor(C/24);if(u<30)return`${u} \u65e5\u524d`;const a=Math.floor(u/30);if(a<12)return`${a} \u30f6\u6708\u524d`;const d=Math.floor(u/365);return d<10?`${d} \u5e74\u524d`:"\u304b\u306a\u308a\u6614"}static \u0275fac=function(p){return new(p||_)};static \u0275pipe=i.EJ8({name:"relativeTime",type:_,pure:!1})}return _})()},386:(D,O,n)=>{n.d(O,{d:()=>a});var i=n(467),t=n(4438),_=n(7935),e=(n(7231),n(5312)),p=n(1152),m=n(5794),s=n(177);function C(d,b){if(1&d){const c=t.RV6();t.j41(0,"div",2)(1,"button",3),t.EFF(2,"\u305d\u306e\u4ed6\u306e\u30ed\u30b0\u30a4\u30f3\u65b9\u6cd5"),t.k0s(),t.j41(3,"div",4)(4,"p"),t.EFF(5,"\u4ee5\u4e0b\u306e\u30ed\u30b0\u30a4\u30f3\u6a5f\u80fd\u3092\u4f7f\u3046\u969b\u306f\u30d6\u30e9\u30a6\u30b6\u306e\u8a2d\u5b9a\u3067 "),t.j41(6,"b"),t.EFF(7),t.k0s(),t.EFF(8,"\u304b\u3089\u306e\u7b2c\u4e09\u8005\u30af\u30c3\u30ad\u30fc (Third-Party Cookie) \u3092\u53d7\u3051\u5bb9\u308c\u308b\u8a2d\u5b9a\u306b\u3057\u3066\u304f\u3060\u3055\u3044\u3002"),t.k0s(),t.j41(9,"p"),t.EFF(10,"\u30a2\u30ab\u30a6\u30f3\u30c8\u3092\u4f5c\u3063\u3066\u3044\u306a\u3044\u5834\u5408\u306f\u81ea\u52d5\u7684\u306b\u4f5c\u6210\u3055\u308c\u307e\u3059\u3002\u5fc5\u305a "),t.j41(11,"a",5),t.EFF(12,"[\u5229\u7528\u898f\u7d04]"),t.k0s(),t.EFF(13," \u3092\u78ba\u8a8d\u3057\u3066\u304f\u3060\u3055\u3044\u3002"),t.k0s(),t.j41(14,"div")(15,"img",6),t.bIt("click",function(r){t.eBV(c);const T=t.XpG();return t.Njj(T.onClickGoogleAuth(r))}),t.k0s(),t.j41(16,"img",7),t.bIt("click",function(r){t.eBV(c);const T=t.XpG();return t.Njj(T.onClickTwitterAuth(r))}),t.k0s(),t.j41(17,"span",8),t.bIt("click",function(r){t.eBV(c);const T=t.XpG();return t.Njj(T.onClickGithubAuth(r))}),t.nrm(18,"img",9),t.EFF(19,"Sign in with Github"),t.k0s()()()()}if(2&d){const c=t.XpG();t.R7$(7),t.SpI("",c.apiHostname," ")}}function u(d,b){if(1&d){const c=t.RV6();t.j41(0,"div")(1,"img",10),t.bIt("click",function(r){t.eBV(c);const T=t.XpG();return t.Njj(T.onClickGoogleAuth(r))}),t.k0s(),t.j41(2,"img",11),t.bIt("click",function(r){t.eBV(c);const T=t.XpG();return t.Njj(T.onClickTwitterAuth(r))}),t.k0s(),t.j41(3,"img",12),t.bIt("click",function(r){t.eBV(c);const T=t.XpG();return t.Njj(T.onClickGithubAuth(r))}),t.k0s()()}}let a=(()=>{class d{auth;toastr;apiHostname=e.cA.firebaseConfig.authDomain;isTiny=!1;loginSucceeded=new t.bkB;loginFailed=new t.bkB;constructor(c,o){this.auth=c,this.toastr=o}ngOnInit(){(0,e.Oi)("OauthFederationsComponent.OnInit()")}doOauth(c){var o=this;return(0,i.A)(function*(){try{yield o.auth.signInWithPopup(c),o.loginSucceeded.next()}catch(r){o.loginFailed.next(r)}})()}onClickGoogleAuth(c){var o=this;return(0,i.A)(function*(){c.preventDefault();const r=new _.A.auth.GoogleAuthProvider;yield o.doOauth(r)})()}onClickTwitterAuth(c){var o=this;return(0,i.A)(function*(){c.preventDefault();const r=new _.A.auth.TwitterAuthProvider;yield o.doOauth(r)})()}onClickGithubAuth(c){var o=this;return(0,i.A)(function*(){c.preventDefault();const r=new _.A.auth.GithubAuthProvider;yield o.doOauth(r)})()}static \u0275fac=function(o){return new(o||d)(t.rXU(p.DS),t.rXU(m.tw))};static \u0275cmp=t.VBU({type:d,selectors:[["app-oauth-federations"]],inputs:{isTiny:"isTiny"},outputs:{loginSucceeded:"loginSucceeded",loginFailed:"loginFailed"},decls:2,vars:2,consts:[["class","row m-3",4,"ngIf"],[4,"ngIf"],[1,"row","m-3"],["type","button","data-bs-toggle","collapse","data-bs-target","#appGitfireOauthFederationsList","role","button","aria-label","Toggle other login","aria-expanded","false","aria-controls","appGitfireOauthFederationsList",1,"btn","btn-secondary","collapsed"],["id","appGitfireOauthFederationsList",1,"collapse","m-3"],["tabindex","-1","about","_blank","href","/terms.htm",1,""],["src","assets/google-login.png","alt","Google",1,"m-2","oauth-login-button","oauth-width-login-img",3,"click"],["src","assets/twitter-login.png","alt","Twitter",1,"m-2","oauth-login-button","oauth-width-login-img",3,"click"],[1,"m-2","oauth-login-button","oauth-pseudo-img",3,"click"],["src","assets/github-login.png","alt","Github",1,"m-1","oauth-circle-login-img"],["src","assets/google-login.png",1,"m-1","oauth-tiny-wide-img",3,"click"],["src","assets/twitter-login-small.png",1,"m-1","oauth-tiny-circle-img",3,"click"],["src","assets/github-login.png",1,"m-1","oauth-tiny-circle-img",3,"click"]],template:function(o,r){1&o&&t.DNE(0,C,20,1,"div",0)(1,u,4,0,"div",1),2&o&&(t.Y8G("ngIf",!r.isTiny),t.R7$(),t.Y8G("ngIf",r.isTiny))},dependencies:[s.bT],styles:[".oauth-login-button[_ngcontent-%COMP%]{cursor:pointer}.oauth-width-login-img[_ngcontent-%COMP%]{width:150px}.oauth-pseudo-img[_ngcontent-%COMP%]{border-style:ridge;border-radius:5px;padding:5px;white-space:nowrap}.oauth-circle-login-img[_ngcontent-%COMP%]{height:20px;width:20px}.oauth-tiny-wide-img[_ngcontent-%COMP%]{height:30px}.oauth-tiny-circle-img[_ngcontent-%COMP%]{width:30px}"]})}return d})()},896:(D,O,n)=>{n.d(O,{u:()=>w});var i=n(467),t=n(7935);class _{saveNeverAsk;isConfirmed}var g=function(l){return l[l.Ok=0]="Ok",l[l.No=1]="No",l[l.OkPermanent=2]="OkPermanent",l}(g||{}),e=n(4438),p=n(9417),m=n(8531),s=n(5312),C=n(177),u=n(1188);function a(l,G){1&l&&e.nrm(0,"span",12)}function d(l,G){if(1&l&&(e.qex(0),e.j41(1,"div",10),e.nrm(2,"div",13),e.k0s(),e.bVm()),2&l){const E=e.XpG();e.R7$(2),e.Y8G("innerHTML",E.tosJson.html,e.npT)}}let b=(()=>{class l extends m.s{confirmed=new e.bkB;inputConfirmForm;tosJson;constructor(){super()}ngOnInit(){(0,s.Oi)("TosConfirmComponent.OnInit()"),this.inputConfirmForm=new p.gE({}),this.inputConfirmForm.addControl("neverConfirmTosCheck",new p.MJ(!1))}ngAfterViewInit(){(0,s.Oi)("TosConfirmComponent.AfterViewInit()")}get neverCheckTosControl(){return this.inputConfirmForm.get("neverConfirmTosCheck")}onClickConfirm(E){if(E.preventDefault(),this.inputConfirmForm.markAllAsTouched(),this.inputConfirmForm.invalid)return;const h=new _,v=this.inputConfirmForm.get("neverConfirmTosCheck");h.saveNeverAsk=v.value,h.isConfirmed=!0,this.confirmed.emit(h)}static \u0275fac=function(h){return new(h||l)};static \u0275cmp=e.VBU({type:l,selectors:[["gitfire-tos-confirm"]],inputs:{tosJson:"tosJson"},outputs:{confirmed:"confirmed"},features:[e.Vt3],decls:19,vars:6,consts:[["loadingTemplate",""],[1,"container"],[4,"ngIf","ngIfElse"],[1,"text-center"],[3,"formGroup"],[1,"m-5","custom-control","custom-checkbox"],["for","appGitfireTosConfirmNeverDismissCheck",1,"visually-hidden"],["id","appGitfireTosConfirmNeverDismissCheck","name","neverConfirmTosCheck","formControlName","neverConfirmTosCheck","type","checkbox",1,"form-check-input"],[1,"text-muted","fw-light"],["routerLink","/terms.htm"],[1,"m-3"],["id","appGitfireTosConfirmButton","data-bs-dismiss","modal",1,"btn","btn-success",3,"click","disabled"],["role","status",1,"spinner-border","text-primary"],[3,"innerHTML"]],template:function(h,v){if(1&h){const F=e.RV6();e.DNE(0,a,1,0,"ng-template",null,0,e.C5r),e.j41(2,"div",1),e.DNE(3,d,3,1,"ng-container",2),e.j41(4,"div",3)(5,"form",4)(6,"div",5)(7,"label",6),e.EFF(8,"\u518d\u5ea6\u8868\u793a\u3057\u306a\u3044"),e.k0s(),e.nrm(9,"input",7),e.EFF(10,"\u518d\u5ea6\u8868\u793a\u3057\u306a\u3044"),e.k0s(),e.j41(11,"div",8),e.EFF(12,"\u8a73\u3057\u304f\u306f"),e.j41(13,"a",9),e.EFF(14,"[\u5229\u7528\u898f\u7d04]"),e.k0s(),e.EFF(15,"\u3092\u3054\u78ba\u8a8d\u304f\u3060\u3055\u3044\u3002 "),e.k0s(),e.j41(16,"div",10)(17,"button",11),e.bIt("click",function(k){return e.eBV(F),e.Njj(v.onClickConfirm(k))}),e.EFF(18,"\u78ba\u8a8d\u3057\u307e\u3057\u305f"),e.k0s()()()()()}if(2&h){const F=e.sdS(1);e.R7$(3),e.Y8G("ngIf",v.tosJson)("ngIfElse",F),e.R7$(2),e.Y8G("formGroup",v.inputConfirmForm),e.R7$(),e.AVh("was-validated",v.neverCheckTosControl.dirty||v.neverCheckTosControl.touched),e.R7$(11),e.Y8G("disabled",!v.inputConfirmForm.valid)}},dependencies:[C.bT,p.qT,p.Zm,p.BC,p.cb,p.j4,p.JD,u.Wk]})}return l})();var c=n(2275),o=n(1413),r=n(6697),T=n(5558),M=n(6354),y=n(8001),I=n(4416),j=n(8079);let w=(()=>{class l{http;dialog;store;privUser;constructor(E,h,v){this.http=E,this.dialog=h,this.store=v,this.privUser=this.store.collection("/users/v1/protected")}constructSetupTosConfirm(E,h){return v=>{v.tosJson=h.json,v.confirmed.subscribe(F=>{if(!F.isConfirmed)throw new Error("assert");h.answer=F.saveNeverAsk?g.OkPermanent:g.Ok,E.next(h)})}}confirmTos$(E,h){var v=this;if(E.match(/\/$/))throw new Error(`Assertion. Not a supported ${E}`);const F=new o.B,k=(new o.B,new o.B),x=new o.B,R=this.http.fetchGhJson(h).pipe((0,r.s)(1),(0,T.n)(f=>{const A=this.privUser.doc(`${E}/${f.version}`),B={json:f,cached:!1,cacheRef:A};return A.get().pipe((0,M.T)((P,$)=>(P.exists&&P.data().alwaysConfirmed&&((0,s.Oi)("TOS has already been confirmed."),B.cached=!0),B)))}));return x.pipe().subscribe({next:f=>{this.dialog.createDefaultBuilder().prepareBody(b).setupChild(this.constructSetupTosConfirm(k,f)).setType(c.hs.Warn).setSize(c.EV.Default).setTitle("\u5229\u7528\u898f\u7d04\u306e\u78ba\u8a8d").closeButton(()=>{f.answer=g.No,k.next(f)}).setFinalize(()=>{f.answer=g.No,k.next(f)}).open()},complete:()=>{(0,s.Oi)("completeed dialog$")},error:f=>{(0,s.sJ)("error dialog$",f)}}),R.pipe((0,r.s)(1)).subscribe({next:f=>{f.cached?F.next(!0):x.next(f)},complete:()=>{(0,s.Oi)("Completed TOS reading")},error:f=>{(0,s.sJ)("Failed reading TOS cache")}}),k.pipe((0,r.s)(1)).subscribe({next:(f=(0,i.A)(function*(A){switch(A.answer){case g.Ok:F.next(!0);break;case g.No:F.next(!1);break;case g.OkPermanent:const B={_docClass:"User:UserAgreementStore",alwaysConfirmed:!0,createdAt:v.fieldTimestamp()};F.next(!0),yield A.cacheRef.set(B);break;default:throw new Error(`Not a valid answer ${A.answer}`)}}),function(B){return f.apply(this,arguments)}),complete:()=>{(0,s.Oi)("Completed dialog result."),F.complete()},error:f=>{(0,s.sJ)("Failed receive dialog result"),F.complete()}}),F;var f}fieldTimestamp(){return t.A.firestore.FieldValue.serverTimestamp()}static \u0275fac=function(h){return new(h||l)(e.KVO(y.kl),e.KVO(I.o3),e.KVO(j.Qe))};static \u0275prov=e.jDH({token:l,factory:l.\u0275fac,providedIn:"root"})}return l})()},9243:(D,O,n)=>{n.d(O,{D:()=>m});var i=n(7673),t=n(9568),_=n(6354),g=n(4438),e=n(8079),p=n(1474);let m=(()=>{class s{store;auth;pubUser;nicknameCache={};userCache={};constructor(u,a){this.store=u,this.auth=a,this.pubUser=this.store.collection("/users/v1/public")}myNickname$(){return this.auth.myUid?this.nickname$(this.auth.myUid):(0,i.of)("")}user$(u){let a=this.userCache[u];return a||(a=this.pubUser.doc(u).valueChanges().pipe((0,t.t)(1)),this.userCache[u]=a,a)}nickname$(u){let a=this.nicknameCache[u];return a||(a=this.user$(u).pipe((0,_.T)(d=>d?d.nickname:null)),this.nicknameCache[u]=a,a)}static \u0275fac=function(a){return new(a||s)(g.KVO(e.Qe),g.KVO(p.u))};static \u0275prov=g.jDH({token:s,factory:s.\u0275fac,providedIn:"root"})}return s})()},681:(D,O,n)=>{n.d(O,{g:()=>p});var i=n(4438),t=n(177);function _(m,s){1&m&&(i.j41(0,"span",2),i.EFF(1,"[\u524a\u9664]"),i.k0s())}function g(m,s){1&m&&i.nrm(0,"img",5),2&m&&i.FS9("src",s.$implicit,i.B4B)}function e(m,s){if(1&m&&(i.j41(0,"span",3),i.DNE(1,g,1,1,"img",4),i.EFF(2),i.k0s()),2&m){const C=s.$implicit;i.FS9("title",C.about),i.R7$(),i.Y8G("ngIf",C.photoURL),i.R7$(),i.JRh(C.nickname)}}let p=(()=>{class m{userPublic;constructor(){}static \u0275fac=function(u){return new(u||m)};static \u0275cmp=i.VBU({type:m,selectors:[["gitfire-user-box"]],inputs:{userPublic:"userPublic"},decls:3,vars:2,consts:[["voidUser",""],["class","p-1",3,"title",4,"ngIf","ngIfElse"],["title","\u524a\u9664\u3055\u308c\u305f\u30e6\u30fc\u30b6\u3067\u3059",1,"text-warning"],[1,"p-1",3,"title"],["class","p-1","style","height: 100%; width: 2rem;",3,"src",4,"ngIf"],[1,"p-1",2,"height","100%","width","2rem",3,"src"]],template:function(u,a){if(1&u&&i.DNE(0,_,2,0,"ng-template",null,0,i.C5r)(2,e,3,3,"span",1),2&u){const d=i.sdS(1);i.R7$(2),i.Y8G("ngIf",a.userPublic)("ngIfElse",d)}},dependencies:[t.bT]})}return m})()},7231:(D,O,n)=>{n(4033),n(8742),n(1076),n(8041),n(1362)}}]);